(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var Wv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ag(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var C3={exports:{}},Qf={},k3={exports:{}},it={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ju=Symbol.for("react.element"),q8=Symbol.for("react.portal"),J8=Symbol.for("react.fragment"),Z8=Symbol.for("react.strict_mode"),eS=Symbol.for("react.profiler"),tS=Symbol.for("react.provider"),rS=Symbol.for("react.context"),nS=Symbol.for("react.forward_ref"),iS=Symbol.for("react.suspense"),aS=Symbol.for("react.memo"),sS=Symbol.for("react.lazy"),Hv=Symbol.iterator;function oS(t){return t===null||typeof t!="object"?null:(t=Hv&&t[Hv]||t["@@iterator"],typeof t=="function"?t:null)}var A3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F3=Object.assign,P3={};function ul(t,e,r){this.props=t,this.context=e,this.refs=P3,this.updater=r||A3}ul.prototype.isReactComponent={};ul.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ul.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function N3(){}N3.prototype=ul.prototype;function Fg(t,e,r){this.props=t,this.context=e,this.refs=P3,this.updater=r||A3}var Pg=Fg.prototype=new N3;Pg.constructor=Fg;F3(Pg,ul.prototype);Pg.isPureReactComponent=!0;var jv=Array.isArray,R3=Object.prototype.hasOwnProperty,Ng={current:null},O3={key:!0,ref:!0,__self:!0,__source:!0};function I3(t,e,r){var n,i={},a=null,s=null;if(e!=null)for(n in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(a=""+e.key),e)R3.call(e,n)&&!O3.hasOwnProperty(n)&&(i[n]=e[n]);var u=arguments.length-2;if(u===1)i.children=r;else if(1<u){for(var c=Array(u),f=0;f<u;f++)c[f]=arguments[f+2];i.children=c}if(t&&t.defaultProps)for(n in u=t.defaultProps,u)i[n]===void 0&&(i[n]=u[n]);return{$$typeof:Ju,type:t,key:a,ref:s,props:i,_owner:Ng.current}}function lS(t,e){return{$$typeof:Ju,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Rg(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ju}function uS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Vv=/\/+/g;function A1(t,e){return typeof t=="object"&&t!==null&&t.key!=null?uS(""+t.key):e.toString(36)}function bc(t,e,r,n,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case Ju:case q8:s=!0}}if(s)return s=t,i=i(s),t=n===""?"."+A1(s,0):n,jv(i)?(r="",t!=null&&(r=t.replace(Vv,"$&/")+"/"),bc(i,e,r,"",function(f){return f})):i!=null&&(Rg(i)&&(i=lS(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Vv,"$&/")+"/")+t)),e.push(i)),1;if(s=0,n=n===""?".":n+":",jv(t))for(var u=0;u<t.length;u++){a=t[u];var c=n+A1(a,u);s+=bc(a,e,r,c,i)}else if(c=oS(t),typeof c=="function")for(t=c.call(t),u=0;!(a=t.next()).done;)a=a.value,c=n+A1(a,u++),s+=bc(a,e,r,c,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function gc(t,e,r){if(t==null)return t;var n=[],i=0;return bc(t,n,"","",function(a){return e.call(r,a,i++)}),n}function cS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var sn={current:null},Xc={transition:null},fS={ReactCurrentDispatcher:sn,ReactCurrentBatchConfig:Xc,ReactCurrentOwner:Ng};function D3(){throw Error("act(...) is not supported in production builds of React.")}it.Children={map:gc,forEach:function(t,e,r){gc(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return gc(t,function(){e++}),e},toArray:function(t){return gc(t,function(e){return e})||[]},only:function(t){if(!Rg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};it.Component=ul;it.Fragment=J8;it.Profiler=eS;it.PureComponent=Fg;it.StrictMode=Z8;it.Suspense=iS;it.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fS;it.act=D3;it.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=F3({},t.props),i=t.key,a=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,s=Ng.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)R3.call(e,c)&&!O3.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&u!==void 0?u[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){u=Array(c);for(var f=0;f<c;f++)u[f]=arguments[f+2];n.children=u}return{$$typeof:Ju,type:t.type,key:i,ref:a,props:n,_owner:s}};it.createContext=function(t){return t={$$typeof:rS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:tS,_context:t},t.Consumer=t};it.createElement=I3;it.createFactory=function(t){var e=I3.bind(null,t);return e.type=t,e};it.createRef=function(){return{current:null}};it.forwardRef=function(t){return{$$typeof:nS,render:t}};it.isValidElement=Rg;it.lazy=function(t){return{$$typeof:sS,_payload:{_status:-1,_result:t},_init:cS}};it.memo=function(t,e){return{$$typeof:aS,type:t,compare:e===void 0?null:e}};it.startTransition=function(t){var e=Xc.transition;Xc.transition={};try{t()}finally{Xc.transition=e}};it.unstable_act=D3;it.useCallback=function(t,e){return sn.current.useCallback(t,e)};it.useContext=function(t){return sn.current.useContext(t)};it.useDebugValue=function(){};it.useDeferredValue=function(t){return sn.current.useDeferredValue(t)};it.useEffect=function(t,e){return sn.current.useEffect(t,e)};it.useId=function(){return sn.current.useId()};it.useImperativeHandle=function(t,e,r){return sn.current.useImperativeHandle(t,e,r)};it.useInsertionEffect=function(t,e){return sn.current.useInsertionEffect(t,e)};it.useLayoutEffect=function(t,e){return sn.current.useLayoutEffect(t,e)};it.useMemo=function(t,e){return sn.current.useMemo(t,e)};it.useReducer=function(t,e,r){return sn.current.useReducer(t,e,r)};it.useRef=function(t){return sn.current.useRef(t)};it.useState=function(t){return sn.current.useState(t)};it.useSyncExternalStore=function(t,e,r){return sn.current.useSyncExternalStore(t,e,r)};it.useTransition=function(){return sn.current.useTransition()};it.version="18.3.1";k3.exports=it;var We=k3.exports;const Xr=Ag(We);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hS=We,dS=Symbol.for("react.element"),pS=Symbol.for("react.fragment"),gS=Object.prototype.hasOwnProperty,mS=hS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vS={key:!0,ref:!0,__self:!0,__source:!0};function L3(t,e,r){var n,i={},a=null,s=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(s=e.ref);for(n in e)gS.call(e,n)&&!vS.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:dS,type:t,key:a,ref:s,props:i,_owner:mS.current}}Qf.Fragment=pS;Qf.jsx=L3;Qf.jsxs=L3;C3.exports=Qf;var Q=C3.exports,yp={},M3={exports:{}},In={},B3={exports:{}},U3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ue,xe){var ve=ue.length;ue.push(xe);e:for(;0<ve;){var we=ve-1>>>1,z=ue[we];if(0<i(z,xe))ue[we]=xe,ue[ve]=z,ve=we;else break e}}function r(ue){return ue.length===0?null:ue[0]}function n(ue){if(ue.length===0)return null;var xe=ue[0],ve=ue.pop();if(ve!==xe){ue[0]=ve;e:for(var we=0,z=ue.length,K=z>>>1;we<K;){var b=2*(we+1)-1,V=ue[b],oe=b+1,W=ue[oe];if(0>i(V,ve))oe<z&&0>i(W,V)?(ue[we]=W,ue[oe]=ve,we=oe):(ue[we]=V,ue[b]=ve,we=b);else if(oe<z&&0>i(W,ve))ue[we]=W,ue[oe]=ve,we=oe;else break e}}return xe}function i(ue,xe){var ve=ue.sortIndex-xe.sortIndex;return ve!==0?ve:ue.id-xe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var c=[],f=[],d=1,v=null,g=3,x=!1,_=!1,y=!1,E=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(ue){for(var xe=r(f);xe!==null;){if(xe.callback===null)n(f);else if(xe.startTime<=ue)n(f),xe.sortIndex=xe.expirationTime,e(c,xe);else break;xe=r(f)}}function w(ue){if(y=!1,m(ue),!_)if(r(c)!==null)_=!0,Ae(F);else{var xe=r(f);xe!==null&&Ge(w,xe.startTime-ue)}}function F(ue,xe){_=!1,y&&(y=!1,C(A),A=-1),x=!0;var ve=g;try{for(m(xe),v=r(c);v!==null&&(!(v.expirationTime>xe)||ue&&!H());){var we=v.callback;if(typeof we=="function"){v.callback=null,g=v.priorityLevel;var z=we(v.expirationTime<=xe);xe=t.unstable_now(),typeof z=="function"?v.callback=z:v===r(c)&&n(c),m(xe)}else n(c);v=r(c)}if(v!==null)var K=!0;else{var b=r(f);b!==null&&Ge(w,b.startTime-xe),K=!1}return K}finally{v=null,g=ve,x=!1}}var R=!1,N=null,A=-1,L=5,O=-1;function H(){return!(t.unstable_now()-O<L)}function j(){if(N!==null){var ue=t.unstable_now();O=ue;var xe=!0;try{xe=N(!0,ue)}finally{xe?q():(R=!1,N=null)}}else R=!1}var q;if(typeof T=="function")q=function(){T(j)};else if(typeof MessageChannel<"u"){var ye=new MessageChannel,de=ye.port2;ye.port1.onmessage=j,q=function(){de.postMessage(null)}}else q=function(){E(j,0)};function Ae(ue){N=ue,R||(R=!0,q())}function Ge(ue,xe){A=E(function(){ue(t.unstable_now())},xe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ue){ue.callback=null},t.unstable_continueExecution=function(){_||x||(_=!0,Ae(F))},t.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<ue?Math.floor(1e3/ue):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(ue){switch(g){case 1:case 2:case 3:var xe=3;break;default:xe=g}var ve=g;g=xe;try{return ue()}finally{g=ve}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ue,xe){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var ve=g;g=ue;try{return xe()}finally{g=ve}},t.unstable_scheduleCallback=function(ue,xe,ve){var we=t.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?we+ve:we):ve=we,ue){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=ve+z,ue={id:d++,callback:xe,priorityLevel:ue,startTime:ve,expirationTime:z,sortIndex:-1},ve>we?(ue.sortIndex=ve,e(f,ue),r(c)===null&&ue===r(f)&&(y?(C(A),A=-1):y=!0,Ge(w,ve-we))):(ue.sortIndex=z,e(c,ue),_||x||(_=!0,Ae(F))),ue},t.unstable_shouldYield=H,t.unstable_wrapCallback=function(ue){var xe=g;return function(){var ve=g;g=xe;try{return ue.apply(this,arguments)}finally{g=ve}}}})(U3);B3.exports=U3;var uu=B3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xS=We,Rn=uu;function Se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var z3=new Set,Cu={};function Ws(t,e){Jo(t,e),Jo(t+"Capture",e)}function Jo(t,e){for(Cu[t]=e,t=0;t<e.length;t++)z3.add(e[t])}var sa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sp=Object.prototype.hasOwnProperty,_S=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bv={},Xv={};function yS(t){return Sp.call(Xv,t)?!0:Sp.call(bv,t)?!1:_S.test(t)?Xv[t]=!0:(bv[t]=!0,!1)}function SS(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function wS(t,e,r,n){if(e===null||typeof e>"u"||SS(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function on(t,e,r,n,i,a,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=s}var Lr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Lr[t]=new on(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Lr[e]=new on(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Lr[t]=new on(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Lr[t]=new on(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Lr[t]=new on(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Lr[t]=new on(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Lr[t]=new on(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Lr[t]=new on(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Lr[t]=new on(t,5,!1,t.toLowerCase(),null,!1,!1)});var Og=/[\-:]([a-z])/g;function Ig(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Og,Ig);Lr[e]=new on(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Og,Ig);Lr[e]=new on(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Og,Ig);Lr[e]=new on(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Lr[t]=new on(t,1,!1,t.toLowerCase(),null,!1,!1)});Lr.xlinkHref=new on("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Lr[t]=new on(t,1,!1,t.toLowerCase(),null,!0,!0)});function Dg(t,e,r,n){var i=Lr.hasOwnProperty(e)?Lr[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(wS(e,r,i,n)&&(r=null),n||i===null?yS(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var ha=xS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,mc=Symbol.for("react.element"),Po=Symbol.for("react.portal"),No=Symbol.for("react.fragment"),Lg=Symbol.for("react.strict_mode"),wp=Symbol.for("react.profiler"),G3=Symbol.for("react.provider"),W3=Symbol.for("react.context"),Mg=Symbol.for("react.forward_ref"),Ep=Symbol.for("react.suspense"),Tp=Symbol.for("react.suspense_list"),Bg=Symbol.for("react.memo"),Oa=Symbol.for("react.lazy"),H3=Symbol.for("react.offscreen"),Kv=Symbol.iterator;function Vl(t){return t===null||typeof t!="object"?null:(t=Kv&&t[Kv]||t["@@iterator"],typeof t=="function"?t:null)}var jt=Object.assign,F1;function nu(t){if(F1===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);F1=e&&e[1]||""}return`
`+F1+t}var P1=!1;function N1(t,e){if(!t||P1)return"";P1=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(f){var n=f}Reflect.construct(t,[],e)}else{try{e.call()}catch(f){n=f}t.call(e.prototype)}else{try{throw Error()}catch(f){n=f}t()}}catch(f){if(f&&n&&typeof f.stack=="string"){for(var i=f.stack.split(`
`),a=n.stack.split(`
`),s=i.length-1,u=a.length-1;1<=s&&0<=u&&i[s]!==a[u];)u--;for(;1<=s&&0<=u;s--,u--)if(i[s]!==a[u]){if(s!==1||u!==1)do if(s--,u--,0>u||i[s]!==a[u]){var c=`
`+i[s].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=s&&0<=u);break}}}finally{P1=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?nu(t):""}function ES(t){switch(t.tag){case 5:return nu(t.type);case 16:return nu("Lazy");case 13:return nu("Suspense");case 19:return nu("SuspenseList");case 0:case 2:case 15:return t=N1(t.type,!1),t;case 11:return t=N1(t.type.render,!1),t;case 1:return t=N1(t.type,!0),t;default:return""}}function Cp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case No:return"Fragment";case Po:return"Portal";case wp:return"Profiler";case Lg:return"StrictMode";case Ep:return"Suspense";case Tp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case W3:return(t.displayName||"Context")+".Consumer";case G3:return(t._context.displayName||"Context")+".Provider";case Mg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Bg:return e=t.displayName||null,e!==null?e:Cp(t.type)||"Memo";case Oa:e=t._payload,t=t._init;try{return Cp(t(e))}catch{}}return null}function TS(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cp(e);case 8:return e===Lg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ya(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function j3(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function CS(t){var e=j3(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,a.call(this,s)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function vc(t){t._valueTracker||(t._valueTracker=CS(t))}function V3(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=j3(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function sf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function kp(t,e){var r=e.checked;return jt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Yv(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Ya(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function b3(t,e){e=e.checked,e!=null&&Dg(t,"checked",e,!1)}function Ap(t,e){b3(t,e);var r=Ya(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Fp(t,e.type,r):e.hasOwnProperty("defaultValue")&&Fp(t,e.type,Ya(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function $v(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Fp(t,e,r){(e!=="number"||sf(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var iu=Array.isArray;function Ho(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Ya(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Pp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Se(91));return jt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Qv(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Se(92));if(iu(r)){if(1<r.length)throw Error(Se(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ya(r)}}function X3(t,e){var r=Ya(e.value),n=Ya(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function qv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function K3(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Np(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?K3(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var xc,Y3=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(xc=xc||document.createElement("div"),xc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=xc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ku(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var cu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kS=["Webkit","ms","Moz","O"];Object.keys(cu).forEach(function(t){kS.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),cu[e]=cu[t]})});function $3(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||cu.hasOwnProperty(t)&&cu[t]?(""+e).trim():e+"px"}function Q3(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=$3(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var AS=jt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rp(t,e){if(e){if(AS[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Se(62))}}function Op(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ip=null;function Ug(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Dp=null,jo=null,Vo=null;function Jv(t){if(t=t0(t)){if(typeof Dp!="function")throw Error(Se(280));var e=t.stateNode;e&&(e=th(e),Dp(t.stateNode,t.type,e))}}function q3(t){jo?Vo?Vo.push(t):Vo=[t]:jo=t}function J3(){if(jo){var t=jo,e=Vo;if(Vo=jo=null,Jv(t),e)for(t=0;t<e.length;t++)Jv(e[t])}}function Z3(t,e){return t(e)}function e_(){}var R1=!1;function t_(t,e,r){if(R1)return t(e,r);R1=!0;try{return Z3(t,e,r)}finally{R1=!1,(jo!==null||Vo!==null)&&(e_(),J3())}}function Au(t,e){var r=t.stateNode;if(r===null)return null;var n=th(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Se(231,e,typeof r));return r}var Lp=!1;if(sa)try{var bl={};Object.defineProperty(bl,"passive",{get:function(){Lp=!0}}),window.addEventListener("test",bl,bl),window.removeEventListener("test",bl,bl)}catch{Lp=!1}function FS(t,e,r,n,i,a,s,u,c){var f=Array.prototype.slice.call(arguments,3);try{e.apply(r,f)}catch(d){this.onError(d)}}var fu=!1,of=null,lf=!1,Mp=null,PS={onError:function(t){fu=!0,of=t}};function NS(t,e,r,n,i,a,s,u,c){fu=!1,of=null,FS.apply(PS,arguments)}function RS(t,e,r,n,i,a,s,u,c){if(NS.apply(this,arguments),fu){if(fu){var f=of;fu=!1,of=null}else throw Error(Se(198));lf||(lf=!0,Mp=f)}}function Hs(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function r_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Zv(t){if(Hs(t)!==t)throw Error(Se(188))}function OS(t){var e=t.alternate;if(!e){if(e=Hs(t),e===null)throw Error(Se(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return Zv(i),t;if(a===n)return Zv(i),e;a=a.sibling}throw Error(Se(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,u=i.child;u;){if(u===r){s=!0,r=i,n=a;break}if(u===n){s=!0,n=i,r=a;break}u=u.sibling}if(!s){for(u=a.child;u;){if(u===r){s=!0,r=a,n=i;break}if(u===n){s=!0,n=a,r=i;break}u=u.sibling}if(!s)throw Error(Se(189))}}if(r.alternate!==n)throw Error(Se(190))}if(r.tag!==3)throw Error(Se(188));return r.stateNode.current===r?t:e}function n_(t){return t=OS(t),t!==null?i_(t):null}function i_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=i_(t);if(e!==null)return e;t=t.sibling}return null}var a_=Rn.unstable_scheduleCallback,ex=Rn.unstable_cancelCallback,IS=Rn.unstable_shouldYield,DS=Rn.unstable_requestPaint,qt=Rn.unstable_now,LS=Rn.unstable_getCurrentPriorityLevel,zg=Rn.unstable_ImmediatePriority,s_=Rn.unstable_UserBlockingPriority,uf=Rn.unstable_NormalPriority,MS=Rn.unstable_LowPriority,o_=Rn.unstable_IdlePriority,qf=null,Mi=null;function BS(t){if(Mi&&typeof Mi.onCommitFiberRoot=="function")try{Mi.onCommitFiberRoot(qf,t,void 0,(t.current.flags&128)===128)}catch{}}var gi=Math.clz32?Math.clz32:GS,US=Math.log,zS=Math.LN2;function GS(t){return t>>>=0,t===0?32:31-(US(t)/zS|0)|0}var _c=64,yc=4194304;function au(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function cf(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,a=t.pingedLanes,s=r&268435455;if(s!==0){var u=s&~i;u!==0?n=au(u):(a&=s,a!==0&&(n=au(a)))}else s=r&~i,s!==0?n=au(s):a!==0&&(n=au(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-gi(e),i=1<<r,n|=t[r],e&=~i;return n}function WS(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function HS(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var s=31-gi(a),u=1<<s,c=i[s];c===-1?(!(u&r)||u&n)&&(i[s]=WS(u,e)):c<=e&&(t.expiredLanes|=u),a&=~u}}function Bp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function l_(){var t=_c;return _c<<=1,!(_c&4194240)&&(_c=64),t}function O1(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Zu(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-gi(e),t[e]=r}function jS(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-gi(r),a=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~a}}function Gg(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-gi(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var yt=0;function u_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var c_,Wg,f_,h_,d_,Up=!1,Sc=[],Ga=null,Wa=null,Ha=null,Fu=new Map,Pu=new Map,Da=[],VS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tx(t,e){switch(t){case"focusin":case"focusout":Ga=null;break;case"dragenter":case"dragleave":Wa=null;break;case"mouseover":case"mouseout":Ha=null;break;case"pointerover":case"pointerout":Fu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pu.delete(e.pointerId)}}function Xl(t,e,r,n,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},e!==null&&(e=t0(e),e!==null&&Wg(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function bS(t,e,r,n,i){switch(e){case"focusin":return Ga=Xl(Ga,t,e,r,n,i),!0;case"dragenter":return Wa=Xl(Wa,t,e,r,n,i),!0;case"mouseover":return Ha=Xl(Ha,t,e,r,n,i),!0;case"pointerover":var a=i.pointerId;return Fu.set(a,Xl(Fu.get(a)||null,t,e,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,Pu.set(a,Xl(Pu.get(a)||null,t,e,r,n,i)),!0}return!1}function p_(t){var e=As(t.target);if(e!==null){var r=Hs(e);if(r!==null){if(e=r.tag,e===13){if(e=r_(r),e!==null){t.blockedOn=e,d_(t.priority,function(){f_(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Kc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=zp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Ip=n,r.target.dispatchEvent(n),Ip=null}else return e=t0(r),e!==null&&Wg(e),t.blockedOn=r,!1;e.shift()}return!0}function rx(t,e,r){Kc(t)&&r.delete(e)}function XS(){Up=!1,Ga!==null&&Kc(Ga)&&(Ga=null),Wa!==null&&Kc(Wa)&&(Wa=null),Ha!==null&&Kc(Ha)&&(Ha=null),Fu.forEach(rx),Pu.forEach(rx)}function Kl(t,e){t.blockedOn===e&&(t.blockedOn=null,Up||(Up=!0,Rn.unstable_scheduleCallback(Rn.unstable_NormalPriority,XS)))}function Nu(t){function e(i){return Kl(i,t)}if(0<Sc.length){Kl(Sc[0],t);for(var r=1;r<Sc.length;r++){var n=Sc[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Ga!==null&&Kl(Ga,t),Wa!==null&&Kl(Wa,t),Ha!==null&&Kl(Ha,t),Fu.forEach(e),Pu.forEach(e),r=0;r<Da.length;r++)n=Da[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Da.length&&(r=Da[0],r.blockedOn===null);)p_(r),r.blockedOn===null&&Da.shift()}var bo=ha.ReactCurrentBatchConfig,ff=!0;function KS(t,e,r,n){var i=yt,a=bo.transition;bo.transition=null;try{yt=1,Hg(t,e,r,n)}finally{yt=i,bo.transition=a}}function YS(t,e,r,n){var i=yt,a=bo.transition;bo.transition=null;try{yt=4,Hg(t,e,r,n)}finally{yt=i,bo.transition=a}}function Hg(t,e,r,n){if(ff){var i=zp(t,e,r,n);if(i===null)H1(t,e,n,hf,r),tx(t,n);else if(bS(i,t,e,r,n))n.stopPropagation();else if(tx(t,n),e&4&&-1<VS.indexOf(t)){for(;i!==null;){var a=t0(i);if(a!==null&&c_(a),a=zp(t,e,r,n),a===null&&H1(t,e,n,hf,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else H1(t,e,n,null,r)}}var hf=null;function zp(t,e,r,n){if(hf=null,t=Ug(n),t=As(t),t!==null)if(e=Hs(t),e===null)t=null;else if(r=e.tag,r===13){if(t=r_(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return hf=t,null}function g_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(LS()){case zg:return 1;case s_:return 4;case uf:case MS:return 16;case o_:return 536870912;default:return 16}default:return 16}}var Ma=null,jg=null,Yc=null;function m_(){if(Yc)return Yc;var t,e=jg,r=e.length,n,i="value"in Ma?Ma.value:Ma.textContent,a=i.length;for(t=0;t<r&&e[t]===i[t];t++);var s=r-t;for(n=1;n<=s&&e[r-n]===i[a-n];n++);return Yc=i.slice(t,1<n?1-n:void 0)}function $c(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function wc(){return!0}function nx(){return!1}function Dn(t){function e(r,n,i,a,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(r=t[u],this[u]=r?r(a):a[u]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?wc:nx,this.isPropagationStopped=nx,this}return jt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=wc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=wc)},persist:function(){},isPersistent:wc}),e}var cl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vg=Dn(cl),e0=jt({},cl,{view:0,detail:0}),$S=Dn(e0),I1,D1,Yl,Jf=jt({},e0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Yl&&(Yl&&t.type==="mousemove"?(I1=t.screenX-Yl.screenX,D1=t.screenY-Yl.screenY):D1=I1=0,Yl=t),I1)},movementY:function(t){return"movementY"in t?t.movementY:D1}}),ix=Dn(Jf),QS=jt({},Jf,{dataTransfer:0}),qS=Dn(QS),JS=jt({},e0,{relatedTarget:0}),L1=Dn(JS),ZS=jt({},cl,{animationName:0,elapsedTime:0,pseudoElement:0}),ew=Dn(ZS),tw=jt({},cl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),rw=Dn(tw),nw=jt({},cl,{data:0}),ax=Dn(nw),iw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ow(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=sw[t])?!!e[t]:!1}function bg(){return ow}var lw=jt({},e0,{key:function(t){if(t.key){var e=iw[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=$c(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?aw[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bg,charCode:function(t){return t.type==="keypress"?$c(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?$c(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),uw=Dn(lw),cw=jt({},Jf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sx=Dn(cw),fw=jt({},e0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bg}),hw=Dn(fw),dw=jt({},cl,{propertyName:0,elapsedTime:0,pseudoElement:0}),pw=Dn(dw),gw=jt({},Jf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),mw=Dn(gw),vw=[9,13,27,32],Xg=sa&&"CompositionEvent"in window,hu=null;sa&&"documentMode"in document&&(hu=document.documentMode);var xw=sa&&"TextEvent"in window&&!hu,v_=sa&&(!Xg||hu&&8<hu&&11>=hu),ox=" ",lx=!1;function x_(t,e){switch(t){case"keyup":return vw.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function __(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ro=!1;function _w(t,e){switch(t){case"compositionend":return __(e);case"keypress":return e.which!==32?null:(lx=!0,ox);case"textInput":return t=e.data,t===ox&&lx?null:t;default:return null}}function yw(t,e){if(Ro)return t==="compositionend"||!Xg&&x_(t,e)?(t=m_(),Yc=jg=Ma=null,Ro=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return v_&&e.locale!=="ko"?null:e.data;default:return null}}var Sw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ux(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Sw[t.type]:e==="textarea"}function y_(t,e,r,n){q3(n),e=df(e,"onChange"),0<e.length&&(r=new Vg("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var du=null,Ru=null;function ww(t){R_(t,0)}function Zf(t){var e=Do(t);if(V3(e))return t}function Ew(t,e){if(t==="change")return e}var S_=!1;if(sa){var M1;if(sa){var B1="oninput"in document;if(!B1){var cx=document.createElement("div");cx.setAttribute("oninput","return;"),B1=typeof cx.oninput=="function"}M1=B1}else M1=!1;S_=M1&&(!document.documentMode||9<document.documentMode)}function fx(){du&&(du.detachEvent("onpropertychange",w_),Ru=du=null)}function w_(t){if(t.propertyName==="value"&&Zf(Ru)){var e=[];y_(e,Ru,t,Ug(t)),t_(ww,e)}}function Tw(t,e,r){t==="focusin"?(fx(),du=e,Ru=r,du.attachEvent("onpropertychange",w_)):t==="focusout"&&fx()}function Cw(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Zf(Ru)}function kw(t,e){if(t==="click")return Zf(e)}function Aw(t,e){if(t==="input"||t==="change")return Zf(e)}function Fw(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var _i=typeof Object.is=="function"?Object.is:Fw;function Ou(t,e){if(_i(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Sp.call(e,i)||!_i(t[i],e[i]))return!1}return!0}function hx(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function dx(t,e){var r=hx(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=hx(r)}}function E_(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?E_(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function T_(){for(var t=window,e=sf();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=sf(t.document)}return e}function Kg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Pw(t){var e=T_(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&E_(r.ownerDocument.documentElement,r)){if(n!==null&&Kg(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!t.extend&&a>n&&(i=n,n=a,a=i),i=dx(r,a);var s=dx(r,n);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Nw=sa&&"documentMode"in document&&11>=document.documentMode,Oo=null,Gp=null,pu=null,Wp=!1;function px(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Wp||Oo==null||Oo!==sf(n)||(n=Oo,"selectionStart"in n&&Kg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),pu&&Ou(pu,n)||(pu=n,n=df(Gp,"onSelect"),0<n.length&&(e=new Vg("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Oo)))}function Ec(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Io={animationend:Ec("Animation","AnimationEnd"),animationiteration:Ec("Animation","AnimationIteration"),animationstart:Ec("Animation","AnimationStart"),transitionend:Ec("Transition","TransitionEnd")},U1={},C_={};sa&&(C_=document.createElement("div").style,"AnimationEvent"in window||(delete Io.animationend.animation,delete Io.animationiteration.animation,delete Io.animationstart.animation),"TransitionEvent"in window||delete Io.transitionend.transition);function eh(t){if(U1[t])return U1[t];if(!Io[t])return t;var e=Io[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in C_)return U1[t]=e[r];return t}var k_=eh("animationend"),A_=eh("animationiteration"),F_=eh("animationstart"),P_=eh("transitionend"),N_=new Map,gx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function es(t,e){N_.set(t,e),Ws(e,[t])}for(var z1=0;z1<gx.length;z1++){var G1=gx[z1],Rw=G1.toLowerCase(),Ow=G1[0].toUpperCase()+G1.slice(1);es(Rw,"on"+Ow)}es(k_,"onAnimationEnd");es(A_,"onAnimationIteration");es(F_,"onAnimationStart");es("dblclick","onDoubleClick");es("focusin","onFocus");es("focusout","onBlur");es(P_,"onTransitionEnd");Jo("onMouseEnter",["mouseout","mouseover"]);Jo("onMouseLeave",["mouseout","mouseover"]);Jo("onPointerEnter",["pointerout","pointerover"]);Jo("onPointerLeave",["pointerout","pointerover"]);Ws("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ws("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ws("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ws("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ws("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ws("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var su="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Iw=new Set("cancel close invalid load scroll toggle".split(" ").concat(su));function mx(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,RS(n,e,void 0,t),t.currentTarget=null}function R_(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var s=n.length-1;0<=s;s--){var u=n[s],c=u.instance,f=u.currentTarget;if(u=u.listener,c!==a&&i.isPropagationStopped())break e;mx(i,u,f),a=c}else for(s=0;s<n.length;s++){if(u=n[s],c=u.instance,f=u.currentTarget,u=u.listener,c!==a&&i.isPropagationStopped())break e;mx(i,u,f),a=c}}}if(lf)throw t=Mp,lf=!1,Mp=null,t}function Rt(t,e){var r=e[Xp];r===void 0&&(r=e[Xp]=new Set);var n=t+"__bubble";r.has(n)||(O_(e,t,2,!1),r.add(n))}function W1(t,e,r){var n=0;e&&(n|=4),O_(r,t,n,e)}var Tc="_reactListening"+Math.random().toString(36).slice(2);function Iu(t){if(!t[Tc]){t[Tc]=!0,z3.forEach(function(r){r!=="selectionchange"&&(Iw.has(r)||W1(r,!1,t),W1(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Tc]||(e[Tc]=!0,W1("selectionchange",!1,e))}}function O_(t,e,r,n){switch(g_(e)){case 1:var i=KS;break;case 4:i=YS;break;default:i=Hg}r=i.bind(null,e,r,t),i=void 0,!Lp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function H1(t,e,r,n,i){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var u=n.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;s=s.return}for(;u!==null;){if(s=As(u),s===null)return;if(c=s.tag,c===5||c===6){n=a=s;continue e}u=u.parentNode}}n=n.return}t_(function(){var f=a,d=Ug(r),v=[];e:{var g=N_.get(t);if(g!==void 0){var x=Vg,_=t;switch(t){case"keypress":if($c(r)===0)break e;case"keydown":case"keyup":x=uw;break;case"focusin":_="focus",x=L1;break;case"focusout":_="blur",x=L1;break;case"beforeblur":case"afterblur":x=L1;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=ix;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=qS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=hw;break;case k_:case A_:case F_:x=ew;break;case P_:x=pw;break;case"scroll":x=$S;break;case"wheel":x=mw;break;case"copy":case"cut":case"paste":x=rw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=sx}var y=(e&4)!==0,E=!y&&t==="scroll",C=y?g!==null?g+"Capture":null:g;y=[];for(var T=f,m;T!==null;){m=T;var w=m.stateNode;if(m.tag===5&&w!==null&&(m=w,C!==null&&(w=Au(T,C),w!=null&&y.push(Du(T,w,m)))),E)break;T=T.return}0<y.length&&(g=new x(g,_,null,r,d),v.push({event:g,listeners:y}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",g&&r!==Ip&&(_=r.relatedTarget||r.fromElement)&&(As(_)||_[oa]))break e;if((x||g)&&(g=d.window===d?d:(g=d.ownerDocument)?g.defaultView||g.parentWindow:window,x?(_=r.relatedTarget||r.toElement,x=f,_=_?As(_):null,_!==null&&(E=Hs(_),_!==E||_.tag!==5&&_.tag!==6)&&(_=null)):(x=null,_=f),x!==_)){if(y=ix,w="onMouseLeave",C="onMouseEnter",T="mouse",(t==="pointerout"||t==="pointerover")&&(y=sx,w="onPointerLeave",C="onPointerEnter",T="pointer"),E=x==null?g:Do(x),m=_==null?g:Do(_),g=new y(w,T+"leave",x,r,d),g.target=E,g.relatedTarget=m,w=null,As(d)===f&&(y=new y(C,T+"enter",_,r,d),y.target=m,y.relatedTarget=E,w=y),E=w,x&&_)t:{for(y=x,C=_,T=0,m=y;m;m=_o(m))T++;for(m=0,w=C;w;w=_o(w))m++;for(;0<T-m;)y=_o(y),T--;for(;0<m-T;)C=_o(C),m--;for(;T--;){if(y===C||C!==null&&y===C.alternate)break t;y=_o(y),C=_o(C)}y=null}else y=null;x!==null&&vx(v,g,x,y,!1),_!==null&&E!==null&&vx(v,E,_,y,!0)}}e:{if(g=f?Do(f):window,x=g.nodeName&&g.nodeName.toLowerCase(),x==="select"||x==="input"&&g.type==="file")var F=Ew;else if(ux(g))if(S_)F=Aw;else{F=Cw;var R=Tw}else(x=g.nodeName)&&x.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(F=kw);if(F&&(F=F(t,f))){y_(v,F,r,d);break e}R&&R(t,g,f),t==="focusout"&&(R=g._wrapperState)&&R.controlled&&g.type==="number"&&Fp(g,"number",g.value)}switch(R=f?Do(f):window,t){case"focusin":(ux(R)||R.contentEditable==="true")&&(Oo=R,Gp=f,pu=null);break;case"focusout":pu=Gp=Oo=null;break;case"mousedown":Wp=!0;break;case"contextmenu":case"mouseup":case"dragend":Wp=!1,px(v,r,d);break;case"selectionchange":if(Nw)break;case"keydown":case"keyup":px(v,r,d)}var N;if(Xg)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Ro?x_(t,r)&&(A="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(v_&&r.locale!=="ko"&&(Ro||A!=="onCompositionStart"?A==="onCompositionEnd"&&Ro&&(N=m_()):(Ma=d,jg="value"in Ma?Ma.value:Ma.textContent,Ro=!0)),R=df(f,A),0<R.length&&(A=new ax(A,t,null,r,d),v.push({event:A,listeners:R}),N?A.data=N:(N=__(r),N!==null&&(A.data=N)))),(N=xw?_w(t,r):yw(t,r))&&(f=df(f,"onBeforeInput"),0<f.length&&(d=new ax("onBeforeInput","beforeinput",null,r,d),v.push({event:d,listeners:f}),d.data=N))}R_(v,e)})}function Du(t,e,r){return{instance:t,listener:e,currentTarget:r}}function df(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Au(t,r),a!=null&&n.unshift(Du(t,a,i)),a=Au(t,e),a!=null&&n.push(Du(t,a,i))),t=t.return}return n}function _o(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function vx(t,e,r,n,i){for(var a=e._reactName,s=[];r!==null&&r!==n;){var u=r,c=u.alternate,f=u.stateNode;if(c!==null&&c===n)break;u.tag===5&&f!==null&&(u=f,i?(c=Au(r,a),c!=null&&s.unshift(Du(r,c,u))):i||(c=Au(r,a),c!=null&&s.push(Du(r,c,u)))),r=r.return}s.length!==0&&t.push({event:e,listeners:s})}var Dw=/\r\n?/g,Lw=/\u0000|\uFFFD/g;function xx(t){return(typeof t=="string"?t:""+t).replace(Dw,`
`).replace(Lw,"")}function Cc(t,e,r){if(e=xx(e),xx(t)!==e&&r)throw Error(Se(425))}function pf(){}var Hp=null,jp=null;function Vp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var bp=typeof setTimeout=="function"?setTimeout:void 0,Mw=typeof clearTimeout=="function"?clearTimeout:void 0,_x=typeof Promise=="function"?Promise:void 0,Bw=typeof queueMicrotask=="function"?queueMicrotask:typeof _x<"u"?function(t){return _x.resolve(null).then(t).catch(Uw)}:bp;function Uw(t){setTimeout(function(){throw t})}function j1(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Nu(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Nu(e)}function ja(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function yx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var fl=Math.random().toString(36).slice(2),Di="__reactFiber$"+fl,Lu="__reactProps$"+fl,oa="__reactContainer$"+fl,Xp="__reactEvents$"+fl,zw="__reactListeners$"+fl,Gw="__reactHandles$"+fl;function As(t){var e=t[Di];if(e)return e;for(var r=t.parentNode;r;){if(e=r[oa]||r[Di]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=yx(t);t!==null;){if(r=t[Di])return r;t=yx(t)}return e}t=r,r=t.parentNode}return null}function t0(t){return t=t[Di]||t[oa],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Do(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Se(33))}function th(t){return t[Lu]||null}var Kp=[],Lo=-1;function ts(t){return{current:t}}function Ot(t){0>Lo||(t.current=Kp[Lo],Kp[Lo]=null,Lo--)}function Pt(t,e){Lo++,Kp[Lo]=t.current,t.current=e}var $a={},Qr=ts($a),mn=ts(!1),Is=$a;function Zo(t,e){var r=t.type.contextTypes;if(!r)return $a;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function vn(t){return t=t.childContextTypes,t!=null}function gf(){Ot(mn),Ot(Qr)}function Sx(t,e,r){if(Qr.current!==$a)throw Error(Se(168));Pt(Qr,e),Pt(mn,r)}function I_(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Se(108,TS(t)||"Unknown",i));return jt({},r,n)}function mf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||$a,Is=Qr.current,Pt(Qr,t),Pt(mn,mn.current),!0}function wx(t,e,r){var n=t.stateNode;if(!n)throw Error(Se(169));r?(t=I_(t,e,Is),n.__reactInternalMemoizedMergedChildContext=t,Ot(mn),Ot(Qr),Pt(Qr,t)):Ot(mn),Pt(mn,r)}var Ji=null,rh=!1,V1=!1;function D_(t){Ji===null?Ji=[t]:Ji.push(t)}function Ww(t){rh=!0,D_(t)}function rs(){if(!V1&&Ji!==null){V1=!0;var t=0,e=yt;try{var r=Ji;for(yt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Ji=null,rh=!1}catch(i){throw Ji!==null&&(Ji=Ji.slice(t+1)),a_(zg,rs),i}finally{yt=e,V1=!1}}return null}var Mo=[],Bo=0,vf=null,xf=0,Kn=[],Yn=0,Ds=null,Zi=1,ea="";function Es(t,e){Mo[Bo++]=xf,Mo[Bo++]=vf,vf=t,xf=e}function L_(t,e,r){Kn[Yn++]=Zi,Kn[Yn++]=ea,Kn[Yn++]=Ds,Ds=t;var n=Zi;t=ea;var i=32-gi(n)-1;n&=~(1<<i),r+=1;var a=32-gi(e)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Zi=1<<32-gi(e)+i|r<<i|n,ea=a+t}else Zi=1<<a|r<<i|n,ea=t}function Yg(t){t.return!==null&&(Es(t,1),L_(t,1,0))}function $g(t){for(;t===vf;)vf=Mo[--Bo],Mo[Bo]=null,xf=Mo[--Bo],Mo[Bo]=null;for(;t===Ds;)Ds=Kn[--Yn],Kn[Yn]=null,ea=Kn[--Yn],Kn[Yn]=null,Zi=Kn[--Yn],Kn[Yn]=null}var Nn=null,Pn=null,Bt=!1,hi=null;function M_(t,e){var r=$n(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Ex(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Nn=t,Pn=ja(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Nn=t,Pn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Ds!==null?{id:Zi,overflow:ea}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=$n(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Nn=t,Pn=null,!0):!1;default:return!1}}function Yp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function $p(t){if(Bt){var e=Pn;if(e){var r=e;if(!Ex(t,e)){if(Yp(t))throw Error(Se(418));e=ja(r.nextSibling);var n=Nn;e&&Ex(t,e)?M_(n,r):(t.flags=t.flags&-4097|2,Bt=!1,Nn=t)}}else{if(Yp(t))throw Error(Se(418));t.flags=t.flags&-4097|2,Bt=!1,Nn=t}}}function Tx(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Nn=t}function kc(t){if(t!==Nn)return!1;if(!Bt)return Tx(t),Bt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Vp(t.type,t.memoizedProps)),e&&(e=Pn)){if(Yp(t))throw B_(),Error(Se(418));for(;e;)M_(t,e),e=ja(e.nextSibling)}if(Tx(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Pn=ja(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Pn=null}}else Pn=Nn?ja(t.stateNode.nextSibling):null;return!0}function B_(){for(var t=Pn;t;)t=ja(t.nextSibling)}function el(){Pn=Nn=null,Bt=!1}function Qg(t){hi===null?hi=[t]:hi.push(t)}var Hw=ha.ReactCurrentBatchConfig;function $l(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Se(309));var n=r.stateNode}if(!n)throw Error(Se(147,t));var i=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(s){var u=i.refs;s===null?delete u[a]:u[a]=s},e._stringRef=a,e)}if(typeof t!="string")throw Error(Se(284));if(!r._owner)throw Error(Se(290,t))}return t}function Ac(t,e){throw t=Object.prototype.toString.call(e),Error(Se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Cx(t){var e=t._init;return e(t._payload)}function U_(t){function e(C,T){if(t){var m=C.deletions;m===null?(C.deletions=[T],C.flags|=16):m.push(T)}}function r(C,T){if(!t)return null;for(;T!==null;)e(C,T),T=T.sibling;return null}function n(C,T){for(C=new Map;T!==null;)T.key!==null?C.set(T.key,T):C.set(T.index,T),T=T.sibling;return C}function i(C,T){return C=Ka(C,T),C.index=0,C.sibling=null,C}function a(C,T,m){return C.index=m,t?(m=C.alternate,m!==null?(m=m.index,m<T?(C.flags|=2,T):m):(C.flags|=2,T)):(C.flags|=1048576,T)}function s(C){return t&&C.alternate===null&&(C.flags|=2),C}function u(C,T,m,w){return T===null||T.tag!==6?(T=q1(m,C.mode,w),T.return=C,T):(T=i(T,m),T.return=C,T)}function c(C,T,m,w){var F=m.type;return F===No?d(C,T,m.props.children,w,m.key):T!==null&&(T.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Oa&&Cx(F)===T.type)?(w=i(T,m.props),w.ref=$l(C,T,m),w.return=C,w):(w=rf(m.type,m.key,m.props,null,C.mode,w),w.ref=$l(C,T,m),w.return=C,w)}function f(C,T,m,w){return T===null||T.tag!==4||T.stateNode.containerInfo!==m.containerInfo||T.stateNode.implementation!==m.implementation?(T=J1(m,C.mode,w),T.return=C,T):(T=i(T,m.children||[]),T.return=C,T)}function d(C,T,m,w,F){return T===null||T.tag!==7?(T=Rs(m,C.mode,w,F),T.return=C,T):(T=i(T,m),T.return=C,T)}function v(C,T,m){if(typeof T=="string"&&T!==""||typeof T=="number")return T=q1(""+T,C.mode,m),T.return=C,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case mc:return m=rf(T.type,T.key,T.props,null,C.mode,m),m.ref=$l(C,null,T),m.return=C,m;case Po:return T=J1(T,C.mode,m),T.return=C,T;case Oa:var w=T._init;return v(C,w(T._payload),m)}if(iu(T)||Vl(T))return T=Rs(T,C.mode,m,null),T.return=C,T;Ac(C,T)}return null}function g(C,T,m,w){var F=T!==null?T.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return F!==null?null:u(C,T,""+m,w);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case mc:return m.key===F?c(C,T,m,w):null;case Po:return m.key===F?f(C,T,m,w):null;case Oa:return F=m._init,g(C,T,F(m._payload),w)}if(iu(m)||Vl(m))return F!==null?null:d(C,T,m,w,null);Ac(C,m)}return null}function x(C,T,m,w,F){if(typeof w=="string"&&w!==""||typeof w=="number")return C=C.get(m)||null,u(T,C,""+w,F);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case mc:return C=C.get(w.key===null?m:w.key)||null,c(T,C,w,F);case Po:return C=C.get(w.key===null?m:w.key)||null,f(T,C,w,F);case Oa:var R=w._init;return x(C,T,m,R(w._payload),F)}if(iu(w)||Vl(w))return C=C.get(m)||null,d(T,C,w,F,null);Ac(T,w)}return null}function _(C,T,m,w){for(var F=null,R=null,N=T,A=T=0,L=null;N!==null&&A<m.length;A++){N.index>A?(L=N,N=null):L=N.sibling;var O=g(C,N,m[A],w);if(O===null){N===null&&(N=L);break}t&&N&&O.alternate===null&&e(C,N),T=a(O,T,A),R===null?F=O:R.sibling=O,R=O,N=L}if(A===m.length)return r(C,N),Bt&&Es(C,A),F;if(N===null){for(;A<m.length;A++)N=v(C,m[A],w),N!==null&&(T=a(N,T,A),R===null?F=N:R.sibling=N,R=N);return Bt&&Es(C,A),F}for(N=n(C,N);A<m.length;A++)L=x(N,C,A,m[A],w),L!==null&&(t&&L.alternate!==null&&N.delete(L.key===null?A:L.key),T=a(L,T,A),R===null?F=L:R.sibling=L,R=L);return t&&N.forEach(function(H){return e(C,H)}),Bt&&Es(C,A),F}function y(C,T,m,w){var F=Vl(m);if(typeof F!="function")throw Error(Se(150));if(m=F.call(m),m==null)throw Error(Se(151));for(var R=F=null,N=T,A=T=0,L=null,O=m.next();N!==null&&!O.done;A++,O=m.next()){N.index>A?(L=N,N=null):L=N.sibling;var H=g(C,N,O.value,w);if(H===null){N===null&&(N=L);break}t&&N&&H.alternate===null&&e(C,N),T=a(H,T,A),R===null?F=H:R.sibling=H,R=H,N=L}if(O.done)return r(C,N),Bt&&Es(C,A),F;if(N===null){for(;!O.done;A++,O=m.next())O=v(C,O.value,w),O!==null&&(T=a(O,T,A),R===null?F=O:R.sibling=O,R=O);return Bt&&Es(C,A),F}for(N=n(C,N);!O.done;A++,O=m.next())O=x(N,C,A,O.value,w),O!==null&&(t&&O.alternate!==null&&N.delete(O.key===null?A:O.key),T=a(O,T,A),R===null?F=O:R.sibling=O,R=O);return t&&N.forEach(function(j){return e(C,j)}),Bt&&Es(C,A),F}function E(C,T,m,w){if(typeof m=="object"&&m!==null&&m.type===No&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case mc:e:{for(var F=m.key,R=T;R!==null;){if(R.key===F){if(F=m.type,F===No){if(R.tag===7){r(C,R.sibling),T=i(R,m.props.children),T.return=C,C=T;break e}}else if(R.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Oa&&Cx(F)===R.type){r(C,R.sibling),T=i(R,m.props),T.ref=$l(C,R,m),T.return=C,C=T;break e}r(C,R);break}else e(C,R);R=R.sibling}m.type===No?(T=Rs(m.props.children,C.mode,w,m.key),T.return=C,C=T):(w=rf(m.type,m.key,m.props,null,C.mode,w),w.ref=$l(C,T,m),w.return=C,C=w)}return s(C);case Po:e:{for(R=m.key;T!==null;){if(T.key===R)if(T.tag===4&&T.stateNode.containerInfo===m.containerInfo&&T.stateNode.implementation===m.implementation){r(C,T.sibling),T=i(T,m.children||[]),T.return=C,C=T;break e}else{r(C,T);break}else e(C,T);T=T.sibling}T=J1(m,C.mode,w),T.return=C,C=T}return s(C);case Oa:return R=m._init,E(C,T,R(m._payload),w)}if(iu(m))return _(C,T,m,w);if(Vl(m))return y(C,T,m,w);Ac(C,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,T!==null&&T.tag===6?(r(C,T.sibling),T=i(T,m),T.return=C,C=T):(r(C,T),T=q1(m,C.mode,w),T.return=C,C=T),s(C)):r(C,T)}return E}var tl=U_(!0),z_=U_(!1),_f=ts(null),yf=null,Uo=null,qg=null;function Jg(){qg=Uo=yf=null}function Zg(t){var e=_f.current;Ot(_f),t._currentValue=e}function Qp(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Xo(t,e){yf=t,qg=Uo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(gn=!0),t.firstContext=null)}function qn(t){var e=t._currentValue;if(qg!==t)if(t={context:t,memoizedValue:e,next:null},Uo===null){if(yf===null)throw Error(Se(308));Uo=t,yf.dependencies={lanes:0,firstContext:t}}else Uo=Uo.next=t;return e}var Fs=null;function e2(t){Fs===null?Fs=[t]:Fs.push(t)}function G_(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,e2(e)):(r.next=i.next,i.next=r),e.interleaved=r,la(t,n)}function la(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Ia=!1;function t2(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function W_(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ta(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Va(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,lt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,la(t,r)}return i=n.interleaved,i===null?(e.next=e,e2(n)):(e.next=i.next,i.next=e),n.interleaved=e,la(t,r)}function Qc(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Gg(t,r)}}function kx(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=s:a=a.next=s,r=r.next}while(r!==null);a===null?i=a=e:a=a.next=e}else i=a=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Sf(t,e,r,n){var i=t.updateQueue;Ia=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var c=u,f=c.next;c.next=null,s===null?a=f:s.next=f,s=c;var d=t.alternate;d!==null&&(d=d.updateQueue,u=d.lastBaseUpdate,u!==s&&(u===null?d.firstBaseUpdate=f:u.next=f,d.lastBaseUpdate=c))}if(a!==null){var v=i.baseState;s=0,d=f=c=null,u=a;do{var g=u.lane,x=u.eventTime;if((n&g)===g){d!==null&&(d=d.next={eventTime:x,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var _=t,y=u;switch(g=e,x=r,y.tag){case 1:if(_=y.payload,typeof _=="function"){v=_.call(x,v,g);break e}v=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=y.payload,g=typeof _=="function"?_.call(x,v,g):_,g==null)break e;v=jt({},v,g);break e;case 2:Ia=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[u]:g.push(u))}else x={eventTime:x,lane:g,tag:u.tag,payload:u.payload,callback:u.callback,next:null},d===null?(f=d=x,c=v):d=d.next=x,s|=g;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;g=u,u=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(d===null&&(c=v),i.baseState=c,i.firstBaseUpdate=f,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);Ms|=s,t.lanes=s,t.memoizedState=v}}function Ax(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Se(191,i));i.call(n)}}}var r0={},Bi=ts(r0),Mu=ts(r0),Bu=ts(r0);function Ps(t){if(t===r0)throw Error(Se(174));return t}function r2(t,e){switch(Pt(Bu,e),Pt(Mu,t),Pt(Bi,r0),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Np(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Np(e,t)}Ot(Bi),Pt(Bi,e)}function rl(){Ot(Bi),Ot(Mu),Ot(Bu)}function H_(t){Ps(Bu.current);var e=Ps(Bi.current),r=Np(e,t.type);e!==r&&(Pt(Mu,t),Pt(Bi,r))}function n2(t){Mu.current===t&&(Ot(Bi),Ot(Mu))}var Wt=ts(0);function wf(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var b1=[];function i2(){for(var t=0;t<b1.length;t++)b1[t]._workInProgressVersionPrimary=null;b1.length=0}var qc=ha.ReactCurrentDispatcher,X1=ha.ReactCurrentBatchConfig,Ls=0,Ht=null,fr=null,yr=null,Ef=!1,gu=!1,Uu=0,jw=0;function Vr(){throw Error(Se(321))}function a2(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!_i(t[r],e[r]))return!1;return!0}function s2(t,e,r,n,i,a){if(Ls=a,Ht=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,qc.current=t===null||t.memoizedState===null?Kw:Yw,t=r(n,i),gu){a=0;do{if(gu=!1,Uu=0,25<=a)throw Error(Se(301));a+=1,yr=fr=null,e.updateQueue=null,qc.current=$w,t=r(n,i)}while(gu)}if(qc.current=Tf,e=fr!==null&&fr.next!==null,Ls=0,yr=fr=Ht=null,Ef=!1,e)throw Error(Se(300));return t}function o2(){var t=Uu!==0;return Uu=0,t}function Ii(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yr===null?Ht.memoizedState=yr=t:yr=yr.next=t,yr}function Jn(){if(fr===null){var t=Ht.alternate;t=t!==null?t.memoizedState:null}else t=fr.next;var e=yr===null?Ht.memoizedState:yr.next;if(e!==null)yr=e,fr=t;else{if(t===null)throw Error(Se(310));fr=t,t={memoizedState:fr.memoizedState,baseState:fr.baseState,baseQueue:fr.baseQueue,queue:fr.queue,next:null},yr===null?Ht.memoizedState=yr=t:yr=yr.next=t}return yr}function zu(t,e){return typeof e=="function"?e(t):e}function K1(t){var e=Jn(),r=e.queue;if(r===null)throw Error(Se(311));r.lastRenderedReducer=t;var n=fr,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var u=s=null,c=null,f=a;do{var d=f.lane;if((Ls&d)===d)c!==null&&(c=c.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),n=f.hasEagerState?f.eagerState:t(n,f.action);else{var v={lane:d,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};c===null?(u=c=v,s=n):c=c.next=v,Ht.lanes|=d,Ms|=d}f=f.next}while(f!==null&&f!==a);c===null?s=n:c.next=u,_i(n,e.memoizedState)||(gn=!0),e.memoizedState=n,e.baseState=s,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do a=i.lane,Ht.lanes|=a,Ms|=a,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Y1(t){var e=Jn(),r=e.queue;if(r===null)throw Error(Se(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,a=e.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do a=t(a,s.action),s=s.next;while(s!==i);_i(a,e.memoizedState)||(gn=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function j_(){}function V_(t,e){var r=Ht,n=Jn(),i=e(),a=!_i(n.memoizedState,i);if(a&&(n.memoizedState=i,gn=!0),n=n.queue,l2(K_.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||yr!==null&&yr.memoizedState.tag&1){if(r.flags|=2048,Gu(9,X_.bind(null,r,n,i,e),void 0,null),Tr===null)throw Error(Se(349));Ls&30||b_(r,e,i)}return i}function b_(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ht.updateQueue,e===null?(e={lastEffect:null,stores:null},Ht.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function X_(t,e,r,n){e.value=r,e.getSnapshot=n,Y_(e)&&$_(t)}function K_(t,e,r){return r(function(){Y_(e)&&$_(t)})}function Y_(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!_i(t,r)}catch{return!0}}function $_(t){var e=la(t,1);e!==null&&mi(e,t,1,-1)}function Fx(t){var e=Ii();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zu,lastRenderedState:t},e.queue=t,t=t.dispatch=Xw.bind(null,Ht,t),[e.memoizedState,t]}function Gu(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ht.updateQueue,e===null?(e={lastEffect:null,stores:null},Ht.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Q_(){return Jn().memoizedState}function Jc(t,e,r,n){var i=Ii();Ht.flags|=t,i.memoizedState=Gu(1|e,r,void 0,n===void 0?null:n)}function nh(t,e,r,n){var i=Jn();n=n===void 0?null:n;var a=void 0;if(fr!==null){var s=fr.memoizedState;if(a=s.destroy,n!==null&&a2(n,s.deps)){i.memoizedState=Gu(e,r,a,n);return}}Ht.flags|=t,i.memoizedState=Gu(1|e,r,a,n)}function Px(t,e){return Jc(8390656,8,t,e)}function l2(t,e){return nh(2048,8,t,e)}function q_(t,e){return nh(4,2,t,e)}function J_(t,e){return nh(4,4,t,e)}function Z_(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function ey(t,e,r){return r=r!=null?r.concat([t]):null,nh(4,4,Z_.bind(null,e,t),r)}function u2(){}function ty(t,e){var r=Jn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&a2(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function ry(t,e){var r=Jn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&a2(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function ny(t,e,r){return Ls&21?(_i(r,e)||(r=l_(),Ht.lanes|=r,Ms|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,gn=!0),t.memoizedState=r)}function Vw(t,e){var r=yt;yt=r!==0&&4>r?r:4,t(!0);var n=X1.transition;X1.transition={};try{t(!1),e()}finally{yt=r,X1.transition=n}}function iy(){return Jn().memoizedState}function bw(t,e,r){var n=Xa(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ay(t))sy(e,r);else if(r=G_(t,e,r,n),r!==null){var i=nn();mi(r,t,n,i),oy(r,e,n)}}function Xw(t,e,r){var n=Xa(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ay(t))sy(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var s=e.lastRenderedState,u=a(s,r);if(i.hasEagerState=!0,i.eagerState=u,_i(u,s)){var c=e.interleaved;c===null?(i.next=i,e2(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}r=G_(t,e,i,n),r!==null&&(i=nn(),mi(r,t,n,i),oy(r,e,n))}}function ay(t){var e=t.alternate;return t===Ht||e!==null&&e===Ht}function sy(t,e){gu=Ef=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function oy(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Gg(t,r)}}var Tf={readContext:qn,useCallback:Vr,useContext:Vr,useEffect:Vr,useImperativeHandle:Vr,useInsertionEffect:Vr,useLayoutEffect:Vr,useMemo:Vr,useReducer:Vr,useRef:Vr,useState:Vr,useDebugValue:Vr,useDeferredValue:Vr,useTransition:Vr,useMutableSource:Vr,useSyncExternalStore:Vr,useId:Vr,unstable_isNewReconciler:!1},Kw={readContext:qn,useCallback:function(t,e){return Ii().memoizedState=[t,e===void 0?null:e],t},useContext:qn,useEffect:Px,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Jc(4194308,4,Z_.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Jc(4194308,4,t,e)},useInsertionEffect:function(t,e){return Jc(4,2,t,e)},useMemo:function(t,e){var r=Ii();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Ii();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=bw.bind(null,Ht,t),[n.memoizedState,t]},useRef:function(t){var e=Ii();return t={current:t},e.memoizedState=t},useState:Fx,useDebugValue:u2,useDeferredValue:function(t){return Ii().memoizedState=t},useTransition:function(){var t=Fx(!1),e=t[0];return t=Vw.bind(null,t[1]),Ii().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ht,i=Ii();if(Bt){if(r===void 0)throw Error(Se(407));r=r()}else{if(r=e(),Tr===null)throw Error(Se(349));Ls&30||b_(n,e,r)}i.memoizedState=r;var a={value:r,getSnapshot:e};return i.queue=a,Px(K_.bind(null,n,a,t),[t]),n.flags|=2048,Gu(9,X_.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=Ii(),e=Tr.identifierPrefix;if(Bt){var r=ea,n=Zi;r=(n&~(1<<32-gi(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Uu++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=jw++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Yw={readContext:qn,useCallback:ty,useContext:qn,useEffect:l2,useImperativeHandle:ey,useInsertionEffect:q_,useLayoutEffect:J_,useMemo:ry,useReducer:K1,useRef:Q_,useState:function(){return K1(zu)},useDebugValue:u2,useDeferredValue:function(t){var e=Jn();return ny(e,fr.memoizedState,t)},useTransition:function(){var t=K1(zu)[0],e=Jn().memoizedState;return[t,e]},useMutableSource:j_,useSyncExternalStore:V_,useId:iy,unstable_isNewReconciler:!1},$w={readContext:qn,useCallback:ty,useContext:qn,useEffect:l2,useImperativeHandle:ey,useInsertionEffect:q_,useLayoutEffect:J_,useMemo:ry,useReducer:Y1,useRef:Q_,useState:function(){return Y1(zu)},useDebugValue:u2,useDeferredValue:function(t){var e=Jn();return fr===null?e.memoizedState=t:ny(e,fr.memoizedState,t)},useTransition:function(){var t=Y1(zu)[0],e=Jn().memoizedState;return[t,e]},useMutableSource:j_,useSyncExternalStore:V_,useId:iy,unstable_isNewReconciler:!1};function ci(t,e){if(t&&t.defaultProps){e=jt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function qp(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:jt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var ih={isMounted:function(t){return(t=t._reactInternals)?Hs(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=nn(),i=Xa(t),a=ta(n,i);a.payload=e,r!=null&&(a.callback=r),e=Va(t,a,i),e!==null&&(mi(e,t,i,n),Qc(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=nn(),i=Xa(t),a=ta(n,i);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=Va(t,a,i),e!==null&&(mi(e,t,i,n),Qc(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=nn(),n=Xa(t),i=ta(r,n);i.tag=2,e!=null&&(i.callback=e),e=Va(t,i,n),e!==null&&(mi(e,t,n,r),Qc(e,t,n))}};function Nx(t,e,r,n,i,a,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,s):e.prototype&&e.prototype.isPureReactComponent?!Ou(r,n)||!Ou(i,a):!0}function ly(t,e,r){var n=!1,i=$a,a=e.contextType;return typeof a=="object"&&a!==null?a=qn(a):(i=vn(e)?Is:Qr.current,n=e.contextTypes,a=(n=n!=null)?Zo(t,i):$a),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ih,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function Rx(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&ih.enqueueReplaceState(e,e.state,null)}function Jp(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},t2(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=qn(a):(a=vn(e)?Is:Qr.current,i.context=Zo(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(qp(t,e,a,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&ih.enqueueReplaceState(i,i.state,null),Sf(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function nl(t,e){try{var r="",n=e;do r+=ES(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function $1(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Zp(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Qw=typeof WeakMap=="function"?WeakMap:Map;function uy(t,e,r){r=ta(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){kf||(kf=!0,ug=n),Zp(t,e)},r}function cy(t,e,r){r=ta(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Zp(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Zp(t,e),typeof n!="function"&&(ba===null?ba=new Set([this]):ba.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),r}function Ox(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new Qw;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=c9.bind(null,t,e,r),e.then(t,t))}function Ix(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Dx(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=ta(-1,1),e.tag=2,Va(r,e,1))),r.lanes|=1),t)}var qw=ha.ReactCurrentOwner,gn=!1;function en(t,e,r,n){e.child=t===null?z_(e,null,r,n):tl(e,t.child,r,n)}function Lx(t,e,r,n,i){r=r.render;var a=e.ref;return Xo(e,i),n=s2(t,e,r,n,a,i),r=o2(),t!==null&&!gn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ua(t,e,i)):(Bt&&r&&Yg(e),e.flags|=1,en(t,e,n,i),e.child)}function Mx(t,e,r,n,i){if(t===null){var a=r.type;return typeof a=="function"&&!v2(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,fy(t,e,a,n,i)):(t=rf(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var s=a.memoizedProps;if(r=r.compare,r=r!==null?r:Ou,r(s,n)&&t.ref===e.ref)return ua(t,e,i)}return e.flags|=1,t=Ka(a,n),t.ref=e.ref,t.return=e,e.child=t}function fy(t,e,r,n,i){if(t!==null){var a=t.memoizedProps;if(Ou(a,n)&&t.ref===e.ref)if(gn=!1,e.pendingProps=n=a,(t.lanes&i)!==0)t.flags&131072&&(gn=!0);else return e.lanes=t.lanes,ua(t,e,i)}return eg(t,e,r,n,i)}function hy(t,e,r){var n=e.pendingProps,i=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pt(Go,Cn),Cn|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Pt(Go,Cn),Cn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Pt(Go,Cn),Cn|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,Pt(Go,Cn),Cn|=n;return en(t,e,i,r),e.child}function dy(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function eg(t,e,r,n,i){var a=vn(r)?Is:Qr.current;return a=Zo(e,a),Xo(e,i),r=s2(t,e,r,n,a,i),n=o2(),t!==null&&!gn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ua(t,e,i)):(Bt&&n&&Yg(e),e.flags|=1,en(t,e,r,i),e.child)}function Bx(t,e,r,n,i){if(vn(r)){var a=!0;mf(e)}else a=!1;if(Xo(e,i),e.stateNode===null)Zc(t,e),ly(e,r,n),Jp(e,r,n,i),n=!0;else if(t===null){var s=e.stateNode,u=e.memoizedProps;s.props=u;var c=s.context,f=r.contextType;typeof f=="object"&&f!==null?f=qn(f):(f=vn(r)?Is:Qr.current,f=Zo(e,f));var d=r.getDerivedStateFromProps,v=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function";v||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(u!==n||c!==f)&&Rx(e,s,n,f),Ia=!1;var g=e.memoizedState;s.state=g,Sf(e,n,s,i),c=e.memoizedState,u!==n||g!==c||mn.current||Ia?(typeof d=="function"&&(qp(e,r,d,n),c=e.memoizedState),(u=Ia||Nx(e,r,u,n,g,c,f))?(v||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),s.props=n,s.state=c,s.context=f,n=u):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{s=e.stateNode,W_(t,e),u=e.memoizedProps,f=e.type===e.elementType?u:ci(e.type,u),s.props=f,v=e.pendingProps,g=s.context,c=r.contextType,typeof c=="object"&&c!==null?c=qn(c):(c=vn(r)?Is:Qr.current,c=Zo(e,c));var x=r.getDerivedStateFromProps;(d=typeof x=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(u!==v||g!==c)&&Rx(e,s,n,c),Ia=!1,g=e.memoizedState,s.state=g,Sf(e,n,s,i);var _=e.memoizedState;u!==v||g!==_||mn.current||Ia?(typeof x=="function"&&(qp(e,r,x,n),_=e.memoizedState),(f=Ia||Nx(e,r,f,n,g,_,c)||!1)?(d||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,_,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,_,c)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||u===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=_),s.props=n,s.state=_,s.context=c,n=f):(typeof s.componentDidUpdate!="function"||u===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),n=!1)}return tg(t,e,r,n,a,i)}function tg(t,e,r,n,i,a){dy(t,e);var s=(e.flags&128)!==0;if(!n&&!s)return i&&wx(e,r,!1),ua(t,e,a);n=e.stateNode,qw.current=e;var u=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&s?(e.child=tl(e,t.child,null,a),e.child=tl(e,null,u,a)):en(t,e,u,a),e.memoizedState=n.state,i&&wx(e,r,!0),e.child}function py(t){var e=t.stateNode;e.pendingContext?Sx(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Sx(t,e.context,!1),r2(t,e.containerInfo)}function Ux(t,e,r,n,i){return el(),Qg(i),e.flags|=256,en(t,e,r,n),e.child}var rg={dehydrated:null,treeContext:null,retryLane:0};function ng(t){return{baseLanes:t,cachePool:null,transitions:null}}function gy(t,e,r){var n=e.pendingProps,i=Wt.current,a=!1,s=(e.flags&128)!==0,u;if((u=s)||(u=t!==null&&t.memoizedState===null?!1:(i&2)!==0),u?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Pt(Wt,i&1),t===null)return $p(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=n.children,t=n.fallback,a?(n=e.mode,a=e.child,s={mode:"hidden",children:s},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=oh(s,n,0,null),t=Rs(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=ng(r),e.memoizedState=rg,t):c2(e,s));if(i=t.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return Jw(t,e,s,n,u,i,r);if(a){a=n.fallback,s=e.mode,i=t.child,u=i.sibling;var c={mode:"hidden",children:n.children};return!(s&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Ka(i,c),n.subtreeFlags=i.subtreeFlags&14680064),u!==null?a=Ka(u,a):(a=Rs(a,s,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,s=t.child.memoizedState,s=s===null?ng(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=t.childLanes&~r,e.memoizedState=rg,n}return a=t.child,t=a.sibling,n=Ka(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function c2(t,e){return e=oh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Fc(t,e,r,n){return n!==null&&Qg(n),tl(e,t.child,null,r),t=c2(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Jw(t,e,r,n,i,a,s){if(r)return e.flags&256?(e.flags&=-257,n=$1(Error(Se(422))),Fc(t,e,s,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,i=e.mode,n=oh({mode:"visible",children:n.children},i,0,null),a=Rs(a,i,s,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&tl(e,t.child,null,s),e.child.memoizedState=ng(s),e.memoizedState=rg,a);if(!(e.mode&1))return Fc(t,e,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var u=n.dgst;return n=u,a=Error(Se(419)),n=$1(a,n,void 0),Fc(t,e,s,n)}if(u=(s&t.childLanes)!==0,gn||u){if(n=Tr,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,la(t,i),mi(n,t,i,-1))}return m2(),n=$1(Error(Se(421))),Fc(t,e,s,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=f9.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,Pn=ja(i.nextSibling),Nn=e,Bt=!0,hi=null,t!==null&&(Kn[Yn++]=Zi,Kn[Yn++]=ea,Kn[Yn++]=Ds,Zi=t.id,ea=t.overflow,Ds=e),e=c2(e,n.children),e.flags|=4096,e)}function zx(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Qp(t.return,e,r)}function Q1(t,e,r,n,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function my(t,e,r){var n=e.pendingProps,i=n.revealOrder,a=n.tail;if(en(t,e,n.children,r),n=Wt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&zx(t,r,e);else if(t.tag===19)zx(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Pt(Wt,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&wf(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Q1(e,!1,i,r,a);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&wf(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Q1(e,!0,r,null,a);break;case"together":Q1(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Zc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ua(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ms|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Se(153));if(e.child!==null){for(t=e.child,r=Ka(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Ka(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Zw(t,e,r){switch(e.tag){case 3:py(e),el();break;case 5:H_(e);break;case 1:vn(e.type)&&mf(e);break;case 4:r2(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;Pt(_f,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Pt(Wt,Wt.current&1),e.flags|=128,null):r&e.child.childLanes?gy(t,e,r):(Pt(Wt,Wt.current&1),t=ua(t,e,r),t!==null?t.sibling:null);Pt(Wt,Wt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return my(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Pt(Wt,Wt.current),n)break;return null;case 22:case 23:return e.lanes=0,hy(t,e,r)}return ua(t,e,r)}var vy,ig,xy,_y;vy=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};ig=function(){};xy=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Ps(Bi.current);var a=null;switch(r){case"input":i=kp(t,i),n=kp(t,n),a=[];break;case"select":i=jt({},i,{value:void 0}),n=jt({},n,{value:void 0}),a=[];break;case"textarea":i=Pp(t,i),n=Pp(t,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=pf)}Rp(r,n);var s;r=null;for(f in i)if(!n.hasOwnProperty(f)&&i.hasOwnProperty(f)&&i[f]!=null)if(f==="style"){var u=i[f];for(s in u)u.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(Cu.hasOwnProperty(f)?a||(a=[]):(a=a||[]).push(f,null));for(f in n){var c=n[f];if(u=i!=null?i[f]:void 0,n.hasOwnProperty(f)&&c!==u&&(c!=null||u!=null))if(f==="style")if(u){for(s in u)!u.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&u[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(a||(a=[]),a.push(f,r)),r=c;else f==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,u=u?u.__html:void 0,c!=null&&u!==c&&(a=a||[]).push(f,c)):f==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(f,""+c):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(Cu.hasOwnProperty(f)?(c!=null&&f==="onScroll"&&Rt("scroll",t),a||u===c||(a=[])):(a=a||[]).push(f,c))}r&&(a=a||[]).push("style",r);var f=a;(e.updateQueue=f)&&(e.flags|=4)}};_y=function(t,e,r,n){r!==n&&(e.flags|=4)};function Ql(t,e){if(!Bt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function br(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function e9(t,e,r){var n=e.pendingProps;switch($g(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return br(e),null;case 1:return vn(e.type)&&gf(),br(e),null;case 3:return n=e.stateNode,rl(),Ot(mn),Ot(Qr),i2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(kc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,hi!==null&&(hg(hi),hi=null))),ig(t,e),br(e),null;case 5:n2(e);var i=Ps(Bu.current);if(r=e.type,t!==null&&e.stateNode!=null)xy(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Se(166));return br(e),null}if(t=Ps(Bi.current),kc(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[Di]=e,n[Lu]=a,t=(e.mode&1)!==0,r){case"dialog":Rt("cancel",n),Rt("close",n);break;case"iframe":case"object":case"embed":Rt("load",n);break;case"video":case"audio":for(i=0;i<su.length;i++)Rt(su[i],n);break;case"source":Rt("error",n);break;case"img":case"image":case"link":Rt("error",n),Rt("load",n);break;case"details":Rt("toggle",n);break;case"input":Yv(n,a),Rt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Rt("invalid",n);break;case"textarea":Qv(n,a),Rt("invalid",n)}Rp(r,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var u=a[s];s==="children"?typeof u=="string"?n.textContent!==u&&(a.suppressHydrationWarning!==!0&&Cc(n.textContent,u,t),i=["children",u]):typeof u=="number"&&n.textContent!==""+u&&(a.suppressHydrationWarning!==!0&&Cc(n.textContent,u,t),i=["children",""+u]):Cu.hasOwnProperty(s)&&u!=null&&s==="onScroll"&&Rt("scroll",n)}switch(r){case"input":vc(n),$v(n,a,!0);break;case"textarea":vc(n),qv(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=pf)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=K3(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=s.createElement(r,{is:n.is}):(t=s.createElement(r),r==="select"&&(s=t,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):t=s.createElementNS(t,r),t[Di]=e,t[Lu]=n,vy(t,e,!1,!1),e.stateNode=t;e:{switch(s=Op(r,n),r){case"dialog":Rt("cancel",t),Rt("close",t),i=n;break;case"iframe":case"object":case"embed":Rt("load",t),i=n;break;case"video":case"audio":for(i=0;i<su.length;i++)Rt(su[i],t);i=n;break;case"source":Rt("error",t),i=n;break;case"img":case"image":case"link":Rt("error",t),Rt("load",t),i=n;break;case"details":Rt("toggle",t),i=n;break;case"input":Yv(t,n),i=kp(t,n),Rt("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=jt({},n,{value:void 0}),Rt("invalid",t);break;case"textarea":Qv(t,n),i=Pp(t,n),Rt("invalid",t);break;default:i=n}Rp(r,i),u=i;for(a in u)if(u.hasOwnProperty(a)){var c=u[a];a==="style"?Q3(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Y3(t,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&ku(t,c):typeof c=="number"&&ku(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Cu.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Rt("scroll",t):c!=null&&Dg(t,a,c,s))}switch(r){case"input":vc(t),$v(t,n,!1);break;case"textarea":vc(t),qv(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ya(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?Ho(t,!!n.multiple,a,!1):n.defaultValue!=null&&Ho(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=pf)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return br(e),null;case 6:if(t&&e.stateNode!=null)_y(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Se(166));if(r=Ps(Bu.current),Ps(Bi.current),kc(e)){if(n=e.stateNode,r=e.memoizedProps,n[Di]=e,(a=n.nodeValue!==r)&&(t=Nn,t!==null))switch(t.tag){case 3:Cc(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Cc(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Di]=e,e.stateNode=n}return br(e),null;case 13:if(Ot(Wt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Bt&&Pn!==null&&e.mode&1&&!(e.flags&128))B_(),el(),e.flags|=98560,a=!1;else if(a=kc(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(Se(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Se(317));a[Di]=e}else el(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;br(e),a=!1}else hi!==null&&(hg(hi),hi=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Wt.current&1?hr===0&&(hr=3):m2())),e.updateQueue!==null&&(e.flags|=4),br(e),null);case 4:return rl(),ig(t,e),t===null&&Iu(e.stateNode.containerInfo),br(e),null;case 10:return Zg(e.type._context),br(e),null;case 17:return vn(e.type)&&gf(),br(e),null;case 19:if(Ot(Wt),a=e.memoizedState,a===null)return br(e),null;if(n=(e.flags&128)!==0,s=a.rendering,s===null)if(n)Ql(a,!1);else{if(hr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=wf(t),s!==null){for(e.flags|=128,Ql(a,!1),n=s.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,t=s.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Pt(Wt,Wt.current&1|2),e.child}t=t.sibling}a.tail!==null&&qt()>il&&(e.flags|=128,n=!0,Ql(a,!1),e.lanes=4194304)}else{if(!n)if(t=wf(s),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Ql(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!Bt)return br(e),null}else 2*qt()-a.renderingStartTime>il&&r!==1073741824&&(e.flags|=128,n=!0,Ql(a,!1),e.lanes=4194304);a.isBackwards?(s.sibling=e.child,e.child=s):(r=a.last,r!==null?r.sibling=s:e.child=s,a.last=s)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=qt(),e.sibling=null,r=Wt.current,Pt(Wt,n?r&1|2:r&1),e):(br(e),null);case 22:case 23:return g2(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Cn&1073741824&&(br(e),e.subtreeFlags&6&&(e.flags|=8192)):br(e),null;case 24:return null;case 25:return null}throw Error(Se(156,e.tag))}function t9(t,e){switch($g(e),e.tag){case 1:return vn(e.type)&&gf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return rl(),Ot(mn),Ot(Qr),i2(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return n2(e),null;case 13:if(Ot(Wt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Se(340));el()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ot(Wt),null;case 4:return rl(),null;case 10:return Zg(e.type._context),null;case 22:case 23:return g2(),null;case 24:return null;default:return null}}var Pc=!1,Kr=!1,r9=typeof WeakSet=="function"?WeakSet:Set,Le=null;function zo(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){bt(t,e,n)}else r.current=null}function ag(t,e,r){try{r()}catch(n){bt(t,e,n)}}var Gx=!1;function n9(t,e){if(Hp=ff,t=T_(),Kg(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var s=0,u=-1,c=-1,f=0,d=0,v=t,g=null;t:for(;;){for(var x;v!==r||i!==0&&v.nodeType!==3||(u=s+i),v!==a||n!==0&&v.nodeType!==3||(c=s+n),v.nodeType===3&&(s+=v.nodeValue.length),(x=v.firstChild)!==null;)g=v,v=x;for(;;){if(v===t)break t;if(g===r&&++f===i&&(u=s),g===a&&++d===n&&(c=s),(x=v.nextSibling)!==null)break;v=g,g=v.parentNode}v=x}r=u===-1||c===-1?null:{start:u,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(jp={focusedElem:t,selectionRange:r},ff=!1,Le=e;Le!==null;)if(e=Le,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Le=t;else for(;Le!==null;){e=Le;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var y=_.memoizedProps,E=_.memoizedState,C=e.stateNode,T=C.getSnapshotBeforeUpdate(e.elementType===e.type?y:ci(e.type,y),E);C.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var m=e.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Se(163))}}catch(w){bt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,Le=t;break}Le=e.return}return _=Gx,Gx=!1,_}function mu(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&ag(e,r,a)}i=i.next}while(i!==n)}}function ah(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function sg(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function yy(t){var e=t.alternate;e!==null&&(t.alternate=null,yy(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Di],delete e[Lu],delete e[Xp],delete e[zw],delete e[Gw])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Sy(t){return t.tag===5||t.tag===3||t.tag===4}function Wx(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Sy(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function og(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=pf));else if(n!==4&&(t=t.child,t!==null))for(og(t,e,r),t=t.sibling;t!==null;)og(t,e,r),t=t.sibling}function lg(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(lg(t,e,r),t=t.sibling;t!==null;)lg(t,e,r),t=t.sibling}var Pr=null,fi=!1;function Fa(t,e,r){for(r=r.child;r!==null;)wy(t,e,r),r=r.sibling}function wy(t,e,r){if(Mi&&typeof Mi.onCommitFiberUnmount=="function")try{Mi.onCommitFiberUnmount(qf,r)}catch{}switch(r.tag){case 5:Kr||zo(r,e);case 6:var n=Pr,i=fi;Pr=null,Fa(t,e,r),Pr=n,fi=i,Pr!==null&&(fi?(t=Pr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Pr.removeChild(r.stateNode));break;case 18:Pr!==null&&(fi?(t=Pr,r=r.stateNode,t.nodeType===8?j1(t.parentNode,r):t.nodeType===1&&j1(t,r),Nu(t)):j1(Pr,r.stateNode));break;case 4:n=Pr,i=fi,Pr=r.stateNode.containerInfo,fi=!0,Fa(t,e,r),Pr=n,fi=i;break;case 0:case 11:case 14:case 15:if(!Kr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&ag(r,e,s),i=i.next}while(i!==n)}Fa(t,e,r);break;case 1:if(!Kr&&(zo(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(u){bt(r,e,u)}Fa(t,e,r);break;case 21:Fa(t,e,r);break;case 22:r.mode&1?(Kr=(n=Kr)||r.memoizedState!==null,Fa(t,e,r),Kr=n):Fa(t,e,r);break;default:Fa(t,e,r)}}function Hx(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new r9),e.forEach(function(n){var i=h9.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function si(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=t,s=e,u=s;e:for(;u!==null;){switch(u.tag){case 5:Pr=u.stateNode,fi=!1;break e;case 3:Pr=u.stateNode.containerInfo,fi=!0;break e;case 4:Pr=u.stateNode.containerInfo,fi=!0;break e}u=u.return}if(Pr===null)throw Error(Se(160));wy(a,s,i),Pr=null,fi=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(f){bt(i,e,f)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Ey(e,t),e=e.sibling}function Ey(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(si(e,t),Ni(t),n&4){try{mu(3,t,t.return),ah(3,t)}catch(y){bt(t,t.return,y)}try{mu(5,t,t.return)}catch(y){bt(t,t.return,y)}}break;case 1:si(e,t),Ni(t),n&512&&r!==null&&zo(r,r.return);break;case 5:if(si(e,t),Ni(t),n&512&&r!==null&&zo(r,r.return),t.flags&32){var i=t.stateNode;try{ku(i,"")}catch(y){bt(t,t.return,y)}}if(n&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,s=r!==null?r.memoizedProps:a,u=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{u==="input"&&a.type==="radio"&&a.name!=null&&b3(i,a),Op(u,s);var f=Op(u,a);for(s=0;s<c.length;s+=2){var d=c[s],v=c[s+1];d==="style"?Q3(i,v):d==="dangerouslySetInnerHTML"?Y3(i,v):d==="children"?ku(i,v):Dg(i,d,v,f)}switch(u){case"input":Ap(i,a);break;case"textarea":X3(i,a);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var x=a.value;x!=null?Ho(i,!!a.multiple,x,!1):g!==!!a.multiple&&(a.defaultValue!=null?Ho(i,!!a.multiple,a.defaultValue,!0):Ho(i,!!a.multiple,a.multiple?[]:"",!1))}i[Lu]=a}catch(y){bt(t,t.return,y)}}break;case 6:if(si(e,t),Ni(t),n&4){if(t.stateNode===null)throw Error(Se(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(y){bt(t,t.return,y)}}break;case 3:if(si(e,t),Ni(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Nu(e.containerInfo)}catch(y){bt(t,t.return,y)}break;case 4:si(e,t),Ni(t);break;case 13:si(e,t),Ni(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(d2=qt())),n&4&&Hx(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Kr=(f=Kr)||d,si(e,t),Kr=f):si(e,t),Ni(t),n&8192){if(f=t.memoizedState!==null,(t.stateNode.isHidden=f)&&!d&&t.mode&1)for(Le=t,d=t.child;d!==null;){for(v=Le=d;Le!==null;){switch(g=Le,x=g.child,g.tag){case 0:case 11:case 14:case 15:mu(4,g,g.return);break;case 1:zo(g,g.return);var _=g.stateNode;if(typeof _.componentWillUnmount=="function"){n=g,r=g.return;try{e=n,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(y){bt(n,r,y)}}break;case 5:zo(g,g.return);break;case 22:if(g.memoizedState!==null){Vx(v);continue}}x!==null?(x.return=g,Le=x):Vx(v)}d=d.sibling}e:for(d=null,v=t;;){if(v.tag===5){if(d===null){d=v;try{i=v.stateNode,f?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(u=v.stateNode,c=v.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,u.style.display=$3("display",s))}catch(y){bt(t,t.return,y)}}}else if(v.tag===6){if(d===null)try{v.stateNode.nodeValue=f?"":v.memoizedProps}catch(y){bt(t,t.return,y)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===t)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;d===v&&(d=null),v=v.return}d===v&&(d=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:si(e,t),Ni(t),n&4&&Hx(t);break;case 21:break;default:si(e,t),Ni(t)}}function Ni(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Sy(r)){var n=r;break e}r=r.return}throw Error(Se(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(ku(i,""),n.flags&=-33);var a=Wx(t);lg(t,a,i);break;case 3:case 4:var s=n.stateNode.containerInfo,u=Wx(t);og(t,u,s);break;default:throw Error(Se(161))}}catch(c){bt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function i9(t,e,r){Le=t,Ty(t)}function Ty(t,e,r){for(var n=(t.mode&1)!==0;Le!==null;){var i=Le,a=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||Pc;if(!s){var u=i.alternate,c=u!==null&&u.memoizedState!==null||Kr;u=Pc;var f=Kr;if(Pc=s,(Kr=c)&&!f)for(Le=i;Le!==null;)s=Le,c=s.child,s.tag===22&&s.memoizedState!==null?bx(i):c!==null?(c.return=s,Le=c):bx(i);for(;a!==null;)Le=a,Ty(a),a=a.sibling;Le=i,Pc=u,Kr=f}jx(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Le=a):jx(t)}}function jx(t){for(;Le!==null;){var e=Le;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Kr||ah(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Kr)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:ci(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&Ax(e,a,n);break;case 3:var s=e.updateQueue;if(s!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Ax(e,s,r)}break;case 5:var u=e.stateNode;if(r===null&&e.flags&4){r=u;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var f=e.alternate;if(f!==null){var d=f.memoizedState;if(d!==null){var v=d.dehydrated;v!==null&&Nu(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Se(163))}Kr||e.flags&512&&sg(e)}catch(g){bt(e,e.return,g)}}if(e===t){Le=null;break}if(r=e.sibling,r!==null){r.return=e.return,Le=r;break}Le=e.return}}function Vx(t){for(;Le!==null;){var e=Le;if(e===t){Le=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Le=r;break}Le=e.return}}function bx(t){for(;Le!==null;){var e=Le;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{ah(4,e)}catch(c){bt(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(c){bt(e,i,c)}}var a=e.return;try{sg(e)}catch(c){bt(e,a,c)}break;case 5:var s=e.return;try{sg(e)}catch(c){bt(e,s,c)}}}catch(c){bt(e,e.return,c)}if(e===t){Le=null;break}var u=e.sibling;if(u!==null){u.return=e.return,Le=u;break}Le=e.return}}var a9=Math.ceil,Cf=ha.ReactCurrentDispatcher,f2=ha.ReactCurrentOwner,Qn=ha.ReactCurrentBatchConfig,lt=0,Tr=null,nr=null,Ir=0,Cn=0,Go=ts(0),hr=0,Wu=null,Ms=0,sh=0,h2=0,vu=null,pn=null,d2=0,il=1/0,qi=null,kf=!1,ug=null,ba=null,Nc=!1,Ba=null,Af=0,xu=0,cg=null,ef=-1,tf=0;function nn(){return lt&6?qt():ef!==-1?ef:ef=qt()}function Xa(t){return t.mode&1?lt&2&&Ir!==0?Ir&-Ir:Hw.transition!==null?(tf===0&&(tf=l_()),tf):(t=yt,t!==0||(t=window.event,t=t===void 0?16:g_(t.type)),t):1}function mi(t,e,r,n){if(50<xu)throw xu=0,cg=null,Error(Se(185));Zu(t,r,n),(!(lt&2)||t!==Tr)&&(t===Tr&&(!(lt&2)&&(sh|=r),hr===4&&La(t,Ir)),xn(t,n),r===1&&lt===0&&!(e.mode&1)&&(il=qt()+500,rh&&rs()))}function xn(t,e){var r=t.callbackNode;HS(t,e);var n=cf(t,t===Tr?Ir:0);if(n===0)r!==null&&ex(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&ex(r),e===1)t.tag===0?Ww(Xx.bind(null,t)):D_(Xx.bind(null,t)),Bw(function(){!(lt&6)&&rs()}),r=null;else{switch(u_(n)){case 1:r=zg;break;case 4:r=s_;break;case 16:r=uf;break;case 536870912:r=o_;break;default:r=uf}r=Oy(r,Cy.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Cy(t,e){if(ef=-1,tf=0,lt&6)throw Error(Se(327));var r=t.callbackNode;if(Ko()&&t.callbackNode!==r)return null;var n=cf(t,t===Tr?Ir:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Ff(t,n);else{e=n;var i=lt;lt|=2;var a=Ay();(Tr!==t||Ir!==e)&&(qi=null,il=qt()+500,Ns(t,e));do try{l9();break}catch(u){ky(t,u)}while(!0);Jg(),Cf.current=a,lt=i,nr!==null?e=0:(Tr=null,Ir=0,e=hr)}if(e!==0){if(e===2&&(i=Bp(t),i!==0&&(n=i,e=fg(t,i))),e===1)throw r=Wu,Ns(t,0),La(t,n),xn(t,qt()),r;if(e===6)La(t,n);else{if(i=t.current.alternate,!(n&30)&&!s9(i)&&(e=Ff(t,n),e===2&&(a=Bp(t),a!==0&&(n=a,e=fg(t,a))),e===1))throw r=Wu,Ns(t,0),La(t,n),xn(t,qt()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Se(345));case 2:Ts(t,pn,qi);break;case 3:if(La(t,n),(n&130023424)===n&&(e=d2+500-qt(),10<e)){if(cf(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){nn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=bp(Ts.bind(null,t,pn,qi),e);break}Ts(t,pn,qi);break;case 4:if(La(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var s=31-gi(n);a=1<<s,s=e[s],s>i&&(i=s),n&=~a}if(n=i,n=qt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*a9(n/1960))-n,10<n){t.timeoutHandle=bp(Ts.bind(null,t,pn,qi),n);break}Ts(t,pn,qi);break;case 5:Ts(t,pn,qi);break;default:throw Error(Se(329))}}}return xn(t,qt()),t.callbackNode===r?Cy.bind(null,t):null}function fg(t,e){var r=vu;return t.current.memoizedState.isDehydrated&&(Ns(t,e).flags|=256),t=Ff(t,e),t!==2&&(e=pn,pn=r,e!==null&&hg(e)),t}function hg(t){pn===null?pn=t:pn.push.apply(pn,t)}function s9(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!_i(a(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function La(t,e){for(e&=~h2,e&=~sh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-gi(e),n=1<<r;t[r]=-1,e&=~n}}function Xx(t){if(lt&6)throw Error(Se(327));Ko();var e=cf(t,0);if(!(e&1))return xn(t,qt()),null;var r=Ff(t,e);if(t.tag!==0&&r===2){var n=Bp(t);n!==0&&(e=n,r=fg(t,n))}if(r===1)throw r=Wu,Ns(t,0),La(t,e),xn(t,qt()),r;if(r===6)throw Error(Se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ts(t,pn,qi),xn(t,qt()),null}function p2(t,e){var r=lt;lt|=1;try{return t(e)}finally{lt=r,lt===0&&(il=qt()+500,rh&&rs())}}function Bs(t){Ba!==null&&Ba.tag===0&&!(lt&6)&&Ko();var e=lt;lt|=1;var r=Qn.transition,n=yt;try{if(Qn.transition=null,yt=1,t)return t()}finally{yt=n,Qn.transition=r,lt=e,!(lt&6)&&rs()}}function g2(){Cn=Go.current,Ot(Go)}function Ns(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Mw(r)),nr!==null)for(r=nr.return;r!==null;){var n=r;switch($g(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&gf();break;case 3:rl(),Ot(mn),Ot(Qr),i2();break;case 5:n2(n);break;case 4:rl();break;case 13:Ot(Wt);break;case 19:Ot(Wt);break;case 10:Zg(n.type._context);break;case 22:case 23:g2()}r=r.return}if(Tr=t,nr=t=Ka(t.current,null),Ir=Cn=e,hr=0,Wu=null,h2=sh=Ms=0,pn=vu=null,Fs!==null){for(e=0;e<Fs.length;e++)if(r=Fs[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var s=a.next;a.next=i,n.next=s}r.pending=n}Fs=null}return t}function ky(t,e){do{var r=nr;try{if(Jg(),qc.current=Tf,Ef){for(var n=Ht.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Ef=!1}if(Ls=0,yr=fr=Ht=null,gu=!1,Uu=0,f2.current=null,r===null||r.return===null){hr=1,Wu=e,nr=null;break}e:{var a=t,s=r.return,u=r,c=e;if(e=Ir,u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var f=c,d=u,v=d.tag;if(!(d.mode&1)&&(v===0||v===11||v===15)){var g=d.alternate;g?(d.updateQueue=g.updateQueue,d.memoizedState=g.memoizedState,d.lanes=g.lanes):(d.updateQueue=null,d.memoizedState=null)}var x=Ix(s);if(x!==null){x.flags&=-257,Dx(x,s,u,a,e),x.mode&1&&Ox(a,f,e),e=x,c=f;var _=e.updateQueue;if(_===null){var y=new Set;y.add(c),e.updateQueue=y}else _.add(c);break e}else{if(!(e&1)){Ox(a,f,e),m2();break e}c=Error(Se(426))}}else if(Bt&&u.mode&1){var E=Ix(s);if(E!==null){!(E.flags&65536)&&(E.flags|=256),Dx(E,s,u,a,e),Qg(nl(c,u));break e}}a=c=nl(c,u),hr!==4&&(hr=2),vu===null?vu=[a]:vu.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var C=uy(a,c,e);kx(a,C);break e;case 1:u=c;var T=a.type,m=a.stateNode;if(!(a.flags&128)&&(typeof T.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(ba===null||!ba.has(m)))){a.flags|=65536,e&=-e,a.lanes|=e;var w=cy(a,u,e);kx(a,w);break e}}a=a.return}while(a!==null)}Py(r)}catch(F){e=F,nr===r&&r!==null&&(nr=r=r.return);continue}break}while(!0)}function Ay(){var t=Cf.current;return Cf.current=Tf,t===null?Tf:t}function m2(){(hr===0||hr===3||hr===2)&&(hr=4),Tr===null||!(Ms&268435455)&&!(sh&268435455)||La(Tr,Ir)}function Ff(t,e){var r=lt;lt|=2;var n=Ay();(Tr!==t||Ir!==e)&&(qi=null,Ns(t,e));do try{o9();break}catch(i){ky(t,i)}while(!0);if(Jg(),lt=r,Cf.current=n,nr!==null)throw Error(Se(261));return Tr=null,Ir=0,hr}function o9(){for(;nr!==null;)Fy(nr)}function l9(){for(;nr!==null&&!IS();)Fy(nr)}function Fy(t){var e=Ry(t.alternate,t,Cn);t.memoizedProps=t.pendingProps,e===null?Py(t):nr=e,f2.current=null}function Py(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=t9(r,e),r!==null){r.flags&=32767,nr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{hr=6,nr=null;return}}else if(r=e9(r,e,Cn),r!==null){nr=r;return}if(e=e.sibling,e!==null){nr=e;return}nr=e=t}while(e!==null);hr===0&&(hr=5)}function Ts(t,e,r){var n=yt,i=Qn.transition;try{Qn.transition=null,yt=1,u9(t,e,r,n)}finally{Qn.transition=i,yt=n}return null}function u9(t,e,r,n){do Ko();while(Ba!==null);if(lt&6)throw Error(Se(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Se(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(jS(t,a),t===Tr&&(nr=Tr=null,Ir=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Nc||(Nc=!0,Oy(uf,function(){return Ko(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Qn.transition,Qn.transition=null;var s=yt;yt=1;var u=lt;lt|=4,f2.current=null,n9(t,r),Ey(r,t),Pw(jp),ff=!!Hp,jp=Hp=null,t.current=r,i9(r),DS(),lt=u,yt=s,Qn.transition=a}else t.current=r;if(Nc&&(Nc=!1,Ba=t,Af=i),a=t.pendingLanes,a===0&&(ba=null),BS(r.stateNode),xn(t,qt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(kf)throw kf=!1,t=ug,ug=null,t;return Af&1&&t.tag!==0&&Ko(),a=t.pendingLanes,a&1?t===cg?xu++:(xu=0,cg=t):xu=0,rs(),null}function Ko(){if(Ba!==null){var t=u_(Af),e=Qn.transition,r=yt;try{if(Qn.transition=null,yt=16>t?16:t,Ba===null)var n=!1;else{if(t=Ba,Ba=null,Af=0,lt&6)throw Error(Se(331));var i=lt;for(lt|=4,Le=t.current;Le!==null;){var a=Le,s=a.child;if(Le.flags&16){var u=a.deletions;if(u!==null){for(var c=0;c<u.length;c++){var f=u[c];for(Le=f;Le!==null;){var d=Le;switch(d.tag){case 0:case 11:case 15:mu(8,d,a)}var v=d.child;if(v!==null)v.return=d,Le=v;else for(;Le!==null;){d=Le;var g=d.sibling,x=d.return;if(yy(d),d===f){Le=null;break}if(g!==null){g.return=x,Le=g;break}Le=x}}}var _=a.alternate;if(_!==null){var y=_.child;if(y!==null){_.child=null;do{var E=y.sibling;y.sibling=null,y=E}while(y!==null)}}Le=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,Le=s;else e:for(;Le!==null;){if(a=Le,a.flags&2048)switch(a.tag){case 0:case 11:case 15:mu(9,a,a.return)}var C=a.sibling;if(C!==null){C.return=a.return,Le=C;break e}Le=a.return}}var T=t.current;for(Le=T;Le!==null;){s=Le;var m=s.child;if(s.subtreeFlags&2064&&m!==null)m.return=s,Le=m;else e:for(s=T;Le!==null;){if(u=Le,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:ah(9,u)}}catch(F){bt(u,u.return,F)}if(u===s){Le=null;break e}var w=u.sibling;if(w!==null){w.return=u.return,Le=w;break e}Le=u.return}}if(lt=i,rs(),Mi&&typeof Mi.onPostCommitFiberRoot=="function")try{Mi.onPostCommitFiberRoot(qf,t)}catch{}n=!0}return n}finally{yt=r,Qn.transition=e}}return!1}function Kx(t,e,r){e=nl(r,e),e=uy(t,e,1),t=Va(t,e,1),e=nn(),t!==null&&(Zu(t,1,e),xn(t,e))}function bt(t,e,r){if(t.tag===3)Kx(t,t,r);else for(;e!==null;){if(e.tag===3){Kx(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ba===null||!ba.has(n))){t=nl(r,t),t=cy(e,t,1),e=Va(e,t,1),t=nn(),e!==null&&(Zu(e,1,t),xn(e,t));break}}e=e.return}}function c9(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=nn(),t.pingedLanes|=t.suspendedLanes&r,Tr===t&&(Ir&r)===r&&(hr===4||hr===3&&(Ir&130023424)===Ir&&500>qt()-d2?Ns(t,0):h2|=r),xn(t,e)}function Ny(t,e){e===0&&(t.mode&1?(e=yc,yc<<=1,!(yc&130023424)&&(yc=4194304)):e=1);var r=nn();t=la(t,e),t!==null&&(Zu(t,e,r),xn(t,r))}function f9(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Ny(t,r)}function h9(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Se(314))}n!==null&&n.delete(e),Ny(t,r)}var Ry;Ry=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||mn.current)gn=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return gn=!1,Zw(t,e,r);gn=!!(t.flags&131072)}else gn=!1,Bt&&e.flags&1048576&&L_(e,xf,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Zc(t,e),t=e.pendingProps;var i=Zo(e,Qr.current);Xo(e,r),i=s2(null,e,n,t,i,r);var a=o2();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,vn(n)?(a=!0,mf(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,t2(e),i.updater=ih,e.stateNode=i,i._reactInternals=e,Jp(e,n,t,r),e=tg(null,e,n,!0,a,r)):(e.tag=0,Bt&&a&&Yg(e),en(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Zc(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=p9(n),t=ci(n,t),i){case 0:e=eg(null,e,n,t,r);break e;case 1:e=Bx(null,e,n,t,r);break e;case 11:e=Lx(null,e,n,t,r);break e;case 14:e=Mx(null,e,n,ci(n.type,t),r);break e}throw Error(Se(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ci(n,i),eg(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ci(n,i),Bx(t,e,n,i,r);case 3:e:{if(py(e),t===null)throw Error(Se(387));n=e.pendingProps,a=e.memoizedState,i=a.element,W_(t,e),Sf(e,n,null,r);var s=e.memoizedState;if(n=s.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=nl(Error(Se(423)),e),e=Ux(t,e,n,r,i);break e}else if(n!==i){i=nl(Error(Se(424)),e),e=Ux(t,e,n,r,i);break e}else for(Pn=ja(e.stateNode.containerInfo.firstChild),Nn=e,Bt=!0,hi=null,r=z_(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(el(),n===i){e=ua(t,e,r);break e}en(t,e,n,r)}e=e.child}return e;case 5:return H_(e),t===null&&$p(e),n=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,s=i.children,Vp(n,i)?s=null:a!==null&&Vp(n,a)&&(e.flags|=32),dy(t,e),en(t,e,s,r),e.child;case 6:return t===null&&$p(e),null;case 13:return gy(t,e,r);case 4:return r2(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=tl(e,null,n,r):en(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ci(n,i),Lx(t,e,n,i,r);case 7:return en(t,e,e.pendingProps,r),e.child;case 8:return en(t,e,e.pendingProps.children,r),e.child;case 12:return en(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,a=e.memoizedProps,s=i.value,Pt(_f,n._currentValue),n._currentValue=s,a!==null)if(_i(a.value,s)){if(a.children===i.children&&!mn.current){e=ua(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var u=a.dependencies;if(u!==null){s=a.child;for(var c=u.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=ta(-1,r&-r),c.tag=2;var f=a.updateQueue;if(f!==null){f=f.shared;var d=f.pending;d===null?c.next=c:(c.next=d.next,d.next=c),f.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),Qp(a.return,r,e),u.lanes|=r;break}c=c.next}}else if(a.tag===10)s=a.type===e.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(Se(341));s.lanes|=r,u=s.alternate,u!==null&&(u.lanes|=r),Qp(s,r,e),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===e){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}en(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Xo(e,r),i=qn(i),n=n(i),e.flags|=1,en(t,e,n,r),e.child;case 14:return n=e.type,i=ci(n,e.pendingProps),i=ci(n.type,i),Mx(t,e,n,i,r);case 15:return fy(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ci(n,i),Zc(t,e),e.tag=1,vn(n)?(t=!0,mf(e)):t=!1,Xo(e,r),ly(e,n,i),Jp(e,n,i,r),tg(null,e,n,!0,t,r);case 19:return my(t,e,r);case 22:return hy(t,e,r)}throw Error(Se(156,e.tag))};function Oy(t,e){return a_(t,e)}function d9(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $n(t,e,r,n){return new d9(t,e,r,n)}function v2(t){return t=t.prototype,!(!t||!t.isReactComponent)}function p9(t){if(typeof t=="function")return v2(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Mg)return 11;if(t===Bg)return 14}return 2}function Ka(t,e){var r=t.alternate;return r===null?(r=$n(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function rf(t,e,r,n,i,a){var s=2;if(n=t,typeof t=="function")v2(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case No:return Rs(r.children,i,a,e);case Lg:s=8,i|=8;break;case wp:return t=$n(12,r,e,i|2),t.elementType=wp,t.lanes=a,t;case Ep:return t=$n(13,r,e,i),t.elementType=Ep,t.lanes=a,t;case Tp:return t=$n(19,r,e,i),t.elementType=Tp,t.lanes=a,t;case H3:return oh(r,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case G3:s=10;break e;case W3:s=9;break e;case Mg:s=11;break e;case Bg:s=14;break e;case Oa:s=16,n=null;break e}throw Error(Se(130,t==null?t:typeof t,""))}return e=$n(s,r,e,i),e.elementType=t,e.type=n,e.lanes=a,e}function Rs(t,e,r,n){return t=$n(7,t,n,e),t.lanes=r,t}function oh(t,e,r,n){return t=$n(22,t,n,e),t.elementType=H3,t.lanes=r,t.stateNode={isHidden:!1},t}function q1(t,e,r){return t=$n(6,t,null,e),t.lanes=r,t}function J1(t,e,r){return e=$n(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function g9(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=O1(0),this.expirationTimes=O1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=O1(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function x2(t,e,r,n,i,a,s,u,c){return t=new g9(t,e,r,u,c),e===1?(e=1,a===!0&&(e|=8)):e=0,a=$n(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},t2(a),t}function m9(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Po,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function Iy(t){if(!t)return $a;t=t._reactInternals;e:{if(Hs(t)!==t||t.tag!==1)throw Error(Se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(vn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Se(171))}if(t.tag===1){var r=t.type;if(vn(r))return I_(t,r,e)}return e}function Dy(t,e,r,n,i,a,s,u,c){return t=x2(r,n,!0,t,i,a,s,u,c),t.context=Iy(null),r=t.current,n=nn(),i=Xa(r),a=ta(n,i),a.callback=e??null,Va(r,a,i),t.current.lanes=i,Zu(t,i,n),xn(t,n),t}function lh(t,e,r,n){var i=e.current,a=nn(),s=Xa(i);return r=Iy(r),e.context===null?e.context=r:e.pendingContext=r,e=ta(a,s),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Va(i,e,s),t!==null&&(mi(t,i,s,a),Qc(t,i,s)),s}function Pf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Yx(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function _2(t,e){Yx(t,e),(t=t.alternate)&&Yx(t,e)}function v9(){return null}var Ly=typeof reportError=="function"?reportError:function(t){console.error(t)};function y2(t){this._internalRoot=t}uh.prototype.render=y2.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Se(409));lh(t,e,null,null)};uh.prototype.unmount=y2.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Bs(function(){lh(null,t,null,null)}),e[oa]=null}};function uh(t){this._internalRoot=t}uh.prototype.unstable_scheduleHydration=function(t){if(t){var e=h_();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Da.length&&e!==0&&e<Da[r].priority;r++);Da.splice(r,0,t),r===0&&p_(t)}};function S2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ch(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function $x(){}function x9(t,e,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var f=Pf(s);a.call(f)}}var s=Dy(e,n,t,0,null,!1,!1,"",$x);return t._reactRootContainer=s,t[oa]=s.current,Iu(t.nodeType===8?t.parentNode:t),Bs(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var u=n;n=function(){var f=Pf(c);u.call(f)}}var c=x2(t,0,!1,null,null,!1,!1,"",$x);return t._reactRootContainer=c,t[oa]=c.current,Iu(t.nodeType===8?t.parentNode:t),Bs(function(){lh(e,c,r,n)}),c}function fh(t,e,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var u=i;i=function(){var c=Pf(s);u.call(c)}}lh(e,s,t,i)}else s=x9(r,e,t,i,n);return Pf(s)}c_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=au(e.pendingLanes);r!==0&&(Gg(e,r|1),xn(e,qt()),!(lt&6)&&(il=qt()+500,rs()))}break;case 13:Bs(function(){var n=la(t,1);if(n!==null){var i=nn();mi(n,t,1,i)}}),_2(t,1)}};Wg=function(t){if(t.tag===13){var e=la(t,134217728);if(e!==null){var r=nn();mi(e,t,134217728,r)}_2(t,134217728)}};f_=function(t){if(t.tag===13){var e=Xa(t),r=la(t,e);if(r!==null){var n=nn();mi(r,t,e,n)}_2(t,e)}};h_=function(){return yt};d_=function(t,e){var r=yt;try{return yt=t,e()}finally{yt=r}};Dp=function(t,e,r){switch(e){case"input":if(Ap(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=th(n);if(!i)throw Error(Se(90));V3(n),Ap(n,i)}}}break;case"textarea":X3(t,r);break;case"select":e=r.value,e!=null&&Ho(t,!!r.multiple,e,!1)}};Z3=p2;e_=Bs;var _9={usingClientEntryPoint:!1,Events:[t0,Do,th,q3,J3,p2]},ql={findFiberByHostInstance:As,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},y9={bundleType:ql.bundleType,version:ql.version,rendererPackageName:ql.rendererPackageName,rendererConfig:ql.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ha.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=n_(t),t===null?null:t.stateNode},findFiberByHostInstance:ql.findFiberByHostInstance||v9,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rc.isDisabled&&Rc.supportsFiber)try{qf=Rc.inject(y9),Mi=Rc}catch{}}In.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_9;In.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!S2(e))throw Error(Se(200));return m9(t,e,null,r)};In.createRoot=function(t,e){if(!S2(t))throw Error(Se(299));var r=!1,n="",i=Ly;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=x2(t,1,!1,null,null,r,!1,n,i),t[oa]=e.current,Iu(t.nodeType===8?t.parentNode:t),new y2(e)};In.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Se(188)):(t=Object.keys(t).join(","),Error(Se(268,t)));return t=n_(e),t=t===null?null:t.stateNode,t};In.flushSync=function(t){return Bs(t)};In.hydrate=function(t,e,r){if(!ch(e))throw Error(Se(200));return fh(null,t,e,!0,r)};In.hydrateRoot=function(t,e,r){if(!S2(t))throw Error(Se(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",s=Ly;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),e=Dy(e,null,t,1,r??null,i,!1,a,s),t[oa]=e.current,Iu(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new uh(e)};In.render=function(t,e,r){if(!ch(e))throw Error(Se(200));return fh(null,t,e,!1,r)};In.unmountComponentAtNode=function(t){if(!ch(t))throw Error(Se(40));return t._reactRootContainer?(Bs(function(){fh(null,null,t,!1,function(){t._reactRootContainer=null,t[oa]=null})}),!0):!1};In.unstable_batchedUpdates=p2;In.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!ch(r))throw Error(Se(200));if(t==null||t._reactInternals===void 0)throw Error(Se(38));return fh(t,e,r,!1,n)};In.version="18.3.1-next-f1338f8080-20240426";function My(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(My)}catch(t){console.error(t)}}My(),M3.exports=In;var S9=M3.exports,Qx=S9;yp.createRoot=Qx.createRoot,yp.hydrateRoot=Qx.hydrateRoot;const w9=({currentView:t,onNavigate:e,investigations:r=[],currentInvestigation:n,onNewInvestigation:i,onShowResults:a,onSave:s})=>{const u=r.length>0;return Q.jsx("header",{className:"header",children:Q.jsxs("div",{className:"header-content",children:[Q.jsxs("div",{className:"title-section",children:[Q.jsx("div",{className:"earth-emoji",children:"🌍"}),Q.jsxs("div",{className:"title-text",children:[Q.jsx("h1",{className:"main-title",children:"Albedomåling"}),Q.jsx("p",{className:"main-subtitle",children:"Analyse af Satellitbilleder"}),Q.jsx("div",{className:"version-text",style:{color:"#6c757d",fontSize:"0.7rem",fontWeight:"400",display:"inline-block",marginTop:"4px",opacity:"0.7"},children:"v2.3"})]})]}),Q.jsxs("div",{className:"nav-buttons",children:[t!=="mainMenu"&&Q.jsx("button",{className:"nav-btn",onClick:()=>e("mainMenu"),children:"← Tilbage"}),u&&s&&Q.jsx("button",{className:"nav-btn nav-btn-secondary",onClick:s,children:"Gem"}),Q.jsx("button",{className:"nav-btn nav-btn-primary",onClick:i,children:"Ny Undersøgelse"}),u&&t==="mainMenu"&&Q.jsx("button",{className:"nav-btn",onClick:()=>e("results"),children:"Se Resultater"})]})]})})},qx=({investigations:t,onNewInvestigation:e,onOpenInvestigation:r,onDeleteInvestigation:n,onShowResults:i,onImageUpload:a})=>{const[s,u]=We.useState(!1),[c,f]=We.useState(!1),[d,v]=We.useState(!1),g=We.useRef(null),x=t.length>0,_=(w,F=1200,R=.8)=>new Promise(N=>{const A=document.createElement("canvas"),L=A.getContext("2d"),O=new Image;O.onload=()=>{const H=O.height/O.width,j=Math.min(F,O.width),q=j*H;A.width=j,A.height=q,L.drawImage(O,0,0,j,q);const ye=A.toDataURL("image/jpeg",R);N({url:ye,name:w.name,size:ye.length,type:"image/jpeg",lastModified:w.lastModified,dimensions:{width:j,height:q},compressed:!0})},O.src=URL.createObjectURL(w)}),y=async w=>{if(!w||!w.type.startsWith("image/")){alert("Vælg venligst en gyldig billedfil (JPG, PNG, GIF)");return}v(!0);try{const F=await _(w);a&&a(F),u(!1)}catch(F){console.error("Error processing image:",F),alert("Der opstod en fejl ved behandling af billedet")}finally{v(!1)}},E=w=>{const F=w.target.files[0];F&&y(F)},C=w=>{w.preventDefault(),f(!1);const F=w.dataTransfer.files[0];F&&y(F)},T=w=>{w.preventDefault(),f(!0)},m=w=>{w.preventDefault(),f(!1)};return Q.jsxs("div",{className:"info-card",children:[Q.jsxs("div",{className:"card-header",children:[Q.jsx("h2",{className:"card-title",children:"Undersøgelser"}),Q.jsx("p",{style:{margin:"8px 0 0 0",color:"#6b7280",fontSize:"0.9rem"},children:"Administrer dine albedo undersøgelser og tilgå resultater"})]}),x&&Q.jsxs("div",{style:{marginTop:"30px"},children:[Q.jsx("h3",{style:{marginBottom:"16px",color:"#374151"},children:"Seneste Undersøgelser"}),Q.jsx("div",{className:"grid grid-2",children:t.slice(-4).reverse().map(w=>Q.jsx("div",{className:"info-card",style:{cursor:"pointer",transition:"transform 0.2s ease",border:"1px solid #E9ECEF"},onClick:()=>r(w),onMouseEnter:F=>F.target.style.transform="translateY(-2px)",onMouseLeave:F=>F.target.style.transform="translateY(0)",children:Q.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Q.jsxs("div",{style:{flex:1},children:[Q.jsx("h4",{style:{margin:"0 0 8px 0",color:"#111827"},children:w.name}),Q.jsxs("p",{style:{margin:"0",color:"#6b7280",fontSize:"0.9rem"},children:[w.year," • ",w.location.name]})]}),Q.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[Q.jsxs("div",{style:{background:"#f3f4f6",padding:"8px 12px",borderRadius:"6px",fontSize:"0.8rem",color:"#374151"},children:[w.measurements.length," målinger"]}),Q.jsx("button",{className:"btn btn-warning",onClick:F=>{F.stopPropagation(),window.confirm(`Er du sikker på at du vil slette "${w.name}"?`)&&n(w.id)},style:{fontSize:"0.7rem",padding:"6px 10px",minWidth:"auto"},title:"Slet undersøgelse",children:"Slet"})]})]})},w.id))})]}),!x&&Q.jsxs("div",{style:{textAlign:"center",padding:"40px 20px",color:"#6b7280"},children:[Q.jsx("h3",{style:{marginBottom:"8px",color:"#374151"},children:"Velkommen til Albedo Måling"}),Q.jsx("p",{children:"Start din første undersøgelse for at måle albedo i satellitbilleder"})]}),Q.jsxs("div",{style:{marginTop:"30px",display:"flex",gap:"12px",flexWrap:"wrap",justifyContent:"center"},children:[Q.jsx("button",{className:"btn btn-primary",onClick:e,style:{fontSize:"1rem",padding:"12px 24px",fontWeight:"600"},children:"Ny Undersøgelse"}),Q.jsxs("div",{style:{position:"relative"},children:[Q.jsx("button",{className:"btn btn-success",onClick:()=>u(!s),disabled:d,style:{fontSize:"1rem",padding:"12px 24px",fontWeight:"600"},children:d?"Uploader...":"Upload Billede"}),s&&Q.jsxs("div",{style:{position:"absolute",top:"100%",left:"0",right:"0",background:"white",border:"1px solid #dee2e6",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",zIndex:1e3,marginTop:"4px",padding:"16px",minWidth:"300px"},onDrop:C,onDragOver:T,onDragLeave:m,children:[Q.jsxs("div",{style:{border:c?"2px dashed #28a745":"2px dashed #dee2e6",borderRadius:"8px",padding:"20px",textAlign:"center",background:c?"#f8fff9":"#f8f9fa",transition:"all 0.2s ease"},children:[Q.jsx("p",{style:{margin:"0 0 12px 0",color:"#6c757d"},children:c?"Slip billedet her":"Træk og slip et billede her"}),Q.jsx("button",{className:"btn btn-outline-primary",onClick:()=>{var w;return(w=g.current)==null?void 0:w.click()},style:{fontSize:"0.9rem"},children:"Eller klik for at vælge fil"}),Q.jsx("input",{ref:g,type:"file",accept:"image/*",onChange:E,style:{display:"none"}})]}),Q.jsxs("div",{style:{marginTop:"12px",fontSize:"0.8rem",color:"#6c757d"},children:[Q.jsx("p",{style:{margin:"0"},children:"Understøttede formater: JPG, PNG, GIF"}),Q.jsx("p",{style:{margin:"4px 0 0 0"},children:"Maksimal størrelse: 10MB"})]})]})]}),x&&Q.jsx("button",{className:"btn btn-info",onClick:i,style:{fontSize:"1rem",padding:"12px 24px",fontWeight:"600"},children:"Se Alle Resultater"})]})]})};var By={exports:{}},hh={},Nf={},Ze={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof Wv<"u"?Wv:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return t.Konva.angleDeg?i*e:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var i;return(i=t.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(i){t.glob.Konva=i}};const n=i=>{t.Konva[i.prototype.getClassName()]=i};t._registerNode=n,t.Konva._injectGlobal(t.Konva)})(Ze);var Vt={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=Ze;class r{constructor(w=[1,0,0,1,0,0]){this.dirty=!1,this.m=w&&w.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(w){w.m[0]=this.m[0],w.m[1]=this.m[1],w.m[2]=this.m[2],w.m[3]=this.m[3],w.m[4]=this.m[4],w.m[5]=this.m[5]}point(w){const F=this.m;return{x:F[0]*w.x+F[2]*w.y+F[4],y:F[1]*w.x+F[3]*w.y+F[5]}}translate(w,F){return this.m[4]+=this.m[0]*w+this.m[2]*F,this.m[5]+=this.m[1]*w+this.m[3]*F,this}scale(w,F){return this.m[0]*=w,this.m[1]*=w,this.m[2]*=F,this.m[3]*=F,this}rotate(w){const F=Math.cos(w),R=Math.sin(w),N=this.m[0]*F+this.m[2]*R,A=this.m[1]*F+this.m[3]*R,L=this.m[0]*-R+this.m[2]*F,O=this.m[1]*-R+this.m[3]*F;return this.m[0]=N,this.m[1]=A,this.m[2]=L,this.m[3]=O,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(w,F){const R=this.m[0]+this.m[2]*F,N=this.m[1]+this.m[3]*F,A=this.m[2]+this.m[0]*w,L=this.m[3]+this.m[1]*w;return this.m[0]=R,this.m[1]=N,this.m[2]=A,this.m[3]=L,this}multiply(w){const F=this.m[0]*w.m[0]+this.m[2]*w.m[1],R=this.m[1]*w.m[0]+this.m[3]*w.m[1],N=this.m[0]*w.m[2]+this.m[2]*w.m[3],A=this.m[1]*w.m[2]+this.m[3]*w.m[3],L=this.m[0]*w.m[4]+this.m[2]*w.m[5]+this.m[4],O=this.m[1]*w.m[4]+this.m[3]*w.m[5]+this.m[5];return this.m[0]=F,this.m[1]=R,this.m[2]=N,this.m[3]=A,this.m[4]=L,this.m[5]=O,this}invert(){const w=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),F=this.m[3]*w,R=-this.m[1]*w,N=-this.m[2]*w,A=this.m[0]*w,L=w*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),O=w*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=F,this.m[1]=R,this.m[2]=N,this.m[3]=A,this.m[4]=L,this.m[5]=O,this}getMatrix(){return this.m}decompose(){const w=this.m[0],F=this.m[1],R=this.m[2],N=this.m[3],A=this.m[4],L=this.m[5],O=w*N-F*R,H={x:A,y:L,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(w!=0||F!=0){const j=Math.sqrt(w*w+F*F);H.rotation=F>0?Math.acos(w/j):-Math.acos(w/j),H.scaleX=j,H.scaleY=O/j,H.skewX=(w*R+F*N)/O,H.skewY=0}else if(R!=0||N!=0){const j=Math.sqrt(R*R+N*N);H.rotation=Math.PI/2-(N>0?Math.acos(-R/j):-Math.acos(R/j)),H.scaleX=O/j,H.scaleY=j,H.skewX=0,H.skewY=(w*R+F*N)/O}return H.rotation=t.Util._getRotation(H.rotation),H}}t.Transform=r;const n="[object Array]",i="[object Number]",a="[object String]",s="[object Boolean]",u=Math.PI/180,c=180/Math.PI,f="#",d="",v="0",g="Konva warning: ",x="Konva error: ",_="rgb(",y={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},E=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let C=[];const T=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(m){setTimeout(m,60)};t.Util={_isElement(m){return!!(m&&m.nodeType==1)},_isFunction(m){return!!(m&&m.constructor&&m.call&&m.apply)},_isPlainObject(m){return!!m&&m.constructor===Object},_isArray(m){return Object.prototype.toString.call(m)===n},_isNumber(m){return Object.prototype.toString.call(m)===i&&!isNaN(m)&&isFinite(m)},_isString(m){return Object.prototype.toString.call(m)===a},_isBoolean(m){return Object.prototype.toString.call(m)===s},isObject(m){return m instanceof Object},isValidSelector(m){if(typeof m!="string")return!1;const w=m[0];return w==="#"||w==="."||w===w.toUpperCase()},_sign(m){return m===0||m>0?1:-1},requestAnimFrame(m){C.push(m),C.length===1&&T(function(){const w=C;C=[],w.forEach(function(F){F()})})},createCanvasElement(){const m=document.createElement("canvas");try{m.style=m.style||{}}catch{}return m},createImageElement(){return document.createElement("img")},_isInDocument(m){for(;m=m.parentNode;)if(m==document)return!0;return!1},_urlToImage(m,w){const F=t.Util.createImageElement();F.onload=function(){w(F)},F.src=m},_rgbToHex(m,w,F){return((1<<24)+(m<<16)+(w<<8)+F).toString(16).slice(1)},_hexToRgb(m){m=m.replace(f,d);const w=parseInt(m,16);return{r:w>>16&255,g:w>>8&255,b:w&255}},getRandomColor(){let m=(Math.random()*16777215<<0).toString(16);for(;m.length<6;)m=v+m;return f+m},getRGB(m){let w;return m in y?(w=y[m],{r:w[0],g:w[1],b:w[2]}):m[0]===f?this._hexToRgb(m.substring(1)):m.substr(0,4)===_?(w=E.exec(m.replace(/ /g,"")),{r:parseInt(w[1],10),g:parseInt(w[2],10),b:parseInt(w[3],10)}):{r:0,g:0,b:0}},colorToRGBA(m){return m=m||"black",t.Util._namedColorToRBA(m)||t.Util._hex3ColorToRGBA(m)||t.Util._hex4ColorToRGBA(m)||t.Util._hex6ColorToRGBA(m)||t.Util._hex8ColorToRGBA(m)||t.Util._rgbColorToRGBA(m)||t.Util._rgbaColorToRGBA(m)||t.Util._hslColorToRGBA(m)},_namedColorToRBA(m){const w=y[m.toLowerCase()];return w?{r:w[0],g:w[1],b:w[2],a:1}:null},_rgbColorToRGBA(m){if(m.indexOf("rgb(")===0){m=m.match(/rgb\(([^)]+)\)/)[1];const w=m.split(/ *, */).map(Number);return{r:w[0],g:w[1],b:w[2],a:1}}},_rgbaColorToRGBA(m){if(m.indexOf("rgba(")===0){m=m.match(/rgba\(([^)]+)\)/)[1];const w=m.split(/ *, */).map((F,R)=>F.slice(-1)==="%"?R===3?parseInt(F)/100:parseInt(F)/100*255:Number(F));return{r:w[0],g:w[1],b:w[2],a:w[3]}}},_hex8ColorToRGBA(m){if(m[0]==="#"&&m.length===9)return{r:parseInt(m.slice(1,3),16),g:parseInt(m.slice(3,5),16),b:parseInt(m.slice(5,7),16),a:parseInt(m.slice(7,9),16)/255}},_hex6ColorToRGBA(m){if(m[0]==="#"&&m.length===7)return{r:parseInt(m.slice(1,3),16),g:parseInt(m.slice(3,5),16),b:parseInt(m.slice(5,7),16),a:1}},_hex4ColorToRGBA(m){if(m[0]==="#"&&m.length===5)return{r:parseInt(m[1]+m[1],16),g:parseInt(m[2]+m[2],16),b:parseInt(m[3]+m[3],16),a:parseInt(m[4]+m[4],16)/255}},_hex3ColorToRGBA(m){if(m[0]==="#"&&m.length===4)return{r:parseInt(m[1]+m[1],16),g:parseInt(m[2]+m[2],16),b:parseInt(m[3]+m[3],16),a:1}},_hslColorToRGBA(m){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(m)){const[w,...F]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(m),R=Number(F[0])/360,N=Number(F[1])/100,A=Number(F[2])/100;let L,O,H;if(N===0)return H=A*255,{r:Math.round(H),g:Math.round(H),b:Math.round(H),a:1};A<.5?L=A*(1+N):L=A+N-A*N;const j=2*A-L,q=[0,0,0];for(let ye=0;ye<3;ye++)O=R+1/3*-(ye-1),O<0&&O++,O>1&&O--,6*O<1?H=j+(L-j)*6*O:2*O<1?H=L:3*O<2?H=j+(L-j)*(2/3-O)*6:H=j,q[ye]=H*255;return{r:Math.round(q[0]),g:Math.round(q[1]),b:Math.round(q[2]),a:1}}},haveIntersection(m,w){return!(w.x>m.x+m.width||w.x+w.width<m.x||w.y>m.y+m.height||w.y+w.height<m.y)},cloneObject(m){const w={};for(const F in m)this._isPlainObject(m[F])?w[F]=this.cloneObject(m[F]):this._isArray(m[F])?w[F]=this.cloneArray(m[F]):w[F]=m[F];return w},cloneArray(m){return m.slice(0)},degToRad(m){return m*u},radToDeg(m){return m*c},_degToRad(m){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(m)},_radToDeg(m){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(m)},_getRotation(m){return e.Konva.angleDeg?t.Util.radToDeg(m):m},_capitalize(m){return m.charAt(0).toUpperCase()+m.slice(1)},throw(m){throw new Error(x+m)},error(m){console.error(x+m)},warn(m){e.Konva.showWarnings&&console.warn(g+m)},each(m,w){for(const F in m)w(F,m[F])},_inRange(m,w,F){return w<=m&&m<F},_getProjectionToSegment(m,w,F,R,N,A){let L,O,H;const j=(m-F)*(m-F)+(w-R)*(w-R);if(j==0)L=m,O=w,H=(N-F)*(N-F)+(A-R)*(A-R);else{const q=((N-m)*(F-m)+(A-w)*(R-w))/j;q<0?(L=m,O=w,H=(m-N)*(m-N)+(w-A)*(w-A)):q>1?(L=F,O=R,H=(F-N)*(F-N)+(R-A)*(R-A)):(L=m+q*(F-m),O=w+q*(R-w),H=(L-N)*(L-N)+(O-A)*(O-A))}return[L,O,H]},_getProjectionToLine(m,w,F){const R=t.Util.cloneObject(m);let N=Number.MAX_VALUE;return w.forEach(function(A,L){if(!F&&L===w.length-1)return;const O=w[(L+1)%w.length],H=t.Util._getProjectionToSegment(A.x,A.y,O.x,O.y,m.x,m.y),j=H[0],q=H[1],ye=H[2];ye<N&&(R.x=j,R.y=q,N=ye)}),R},_prepareArrayForTween(m,w,F){const R=[],N=[];if(m.length>w.length){const L=w;w=m,m=L}for(let L=0;L<m.length;L+=2)R.push({x:m[L],y:m[L+1]});for(let L=0;L<w.length;L+=2)N.push({x:w[L],y:w[L+1]});const A=[];return N.forEach(function(L){const O=t.Util._getProjectionToLine(L,R,F);A.push(O.x),A.push(O.y)}),A},_prepareToStringify(m){let w;m.visitedByCircularReferenceRemoval=!0;for(const F in m)if(m.hasOwnProperty(F)&&m[F]&&typeof m[F]=="object"){if(w=Object.getOwnPropertyDescriptor(m,F),m[F].visitedByCircularReferenceRemoval||t.Util._isElement(m[F]))if(w.configurable)delete m[F];else return null;else if(t.Util._prepareToStringify(m[F])===null)if(w.configurable)delete m[F];else return null}return delete m.visitedByCircularReferenceRemoval,m},_assign(m,w){for(const F in w)m[F]=w[F];return m},_getFirstPointerId(m){return m.touches?m.changedTouches[0].identifier:m.pointerId||999},releaseCanvas(...m){e.Konva.releaseCanvasOnDestroy&&m.forEach(w=>{w.width=0,w.height=0})},drawRoundedRectPath(m,w,F,R){let N=0,A=0,L=0,O=0;typeof R=="number"?N=A=L=O=Math.min(R,w/2,F/2):(N=Math.min(R[0]||0,w/2,F/2),A=Math.min(R[1]||0,w/2,F/2),O=Math.min(R[2]||0,w/2,F/2),L=Math.min(R[3]||0,w/2,F/2)),m.moveTo(N,0),m.lineTo(w-A,0),m.arc(w-A,A,A,Math.PI*3/2,0,!1),m.lineTo(w,F-O),m.arc(w-O,F-O,O,0,Math.PI/2,!1),m.lineTo(L,F),m.arc(L,F-L,L,Math.PI/2,Math.PI,!1),m.lineTo(0,N),m.arc(N,N,N,Math.PI,Math.PI*3/2,!1)}}})(Vt);var Ut={},vi={},ra={};Object.defineProperty(ra,"__esModule",{value:!0});ra.HitContext=ra.SceneContext=ra.Context=void 0;const Uy=Vt,E9=Ze;function T9(t){const e=[],r=t.length,n=Uy.Util;for(let i=0;i<r;i++){let a=t[i];n._isNumber(a)?a=Math.round(a*1e3)/1e3:n._isString(a)||(a=a+""),e.push(a)}return e}const Jx=",",C9="(",k9=")",A9="([",F9="])",P9=";",N9="()",R9="=",Zx=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],O9=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],I9=100;class dh{constructor(e){this.canvas=e,E9.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,r){let n=this.traceArr,i=n.length,a="",s,u,c,f;for(s=0;s<i;s++)u=n[s],c=u.method,c?(f=u.args,a+=c,e?a+=N9:Uy.Util._isArray(f[0])?a+=A9+f.join(Jx)+F9:(r&&(f=f.map(d=>typeof d=="number"?Math.floor(d):d)),a+=C9+f.join(Jx)+k9)):(a+=u.property,e||(a+=R9+u.val)),a+=P9;return a}clearTrace(){this.traceArr=[]}_trace(e){let r=this.traceArr,n;r.push(e),n=r.length,n>=I9&&r.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const r=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,r.getWidth()/r.pixelRatio,r.getHeight()/r.pixelRatio)}_applyLineCap(e){const r=e.attrs.lineCap;r&&this.setAttr("lineCap",r)}_applyOpacity(e){const r=e.getAbsoluteOpacity();r!==1&&this.setAttr("globalAlpha",r)}_applyLineJoin(e){const r=e.attrs.lineJoin;r&&this.setAttr("lineJoin",r)}setAttr(e,r){this._context[e]=r}arc(e,r,n,i,a,s){this._context.arc(e,r,n,i,a,s)}arcTo(e,r,n,i,a){this._context.arcTo(e,r,n,i,a)}beginPath(){this._context.beginPath()}bezierCurveTo(e,r,n,i,a,s){this._context.bezierCurveTo(e,r,n,i,a,s)}clearRect(e,r,n,i){this._context.clearRect(e,r,n,i)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,r){const n=arguments;if(n.length===2)return this._context.createImageData(e,r);if(n.length===1)return this._context.createImageData(e)}createLinearGradient(e,r,n,i){return this._context.createLinearGradient(e,r,n,i)}createPattern(e,r){return this._context.createPattern(e,r)}createRadialGradient(e,r,n,i,a,s){return this._context.createRadialGradient(e,r,n,i,a,s)}drawImage(e,r,n,i,a,s,u,c,f){const d=arguments,v=this._context;d.length===3?v.drawImage(e,r,n):d.length===5?v.drawImage(e,r,n,i,a):d.length===9&&v.drawImage(e,r,n,i,a,s,u,c,f)}ellipse(e,r,n,i,a,s,u,c){this._context.ellipse(e,r,n,i,a,s,u,c)}isPointInPath(e,r,n,i){return n?this._context.isPointInPath(n,e,r,i):this._context.isPointInPath(e,r,i)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,r,n,i){this._context.fillRect(e,r,n,i)}strokeRect(e,r,n,i){this._context.strokeRect(e,r,n,i)}fillText(e,r,n,i){i?this._context.fillText(e,r,n,i):this._context.fillText(e,r,n)}measureText(e){return this._context.measureText(e)}getImageData(e,r,n,i){return this._context.getImageData(e,r,n,i)}lineTo(e,r){this._context.lineTo(e,r)}moveTo(e,r){this._context.moveTo(e,r)}rect(e,r,n,i){this._context.rect(e,r,n,i)}roundRect(e,r,n,i,a){this._context.roundRect(e,r,n,i,a)}putImageData(e,r,n){this._context.putImageData(e,r,n)}quadraticCurveTo(e,r,n,i){this._context.quadraticCurveTo(e,r,n,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,r){this._context.scale(e,r)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,r,n,i,a,s){this._context.setTransform(e,r,n,i,a,s)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,r,n,i){this._context.strokeText(e,r,n,i)}transform(e,r,n,i,a,s){this._context.transform(e,r,n,i,a,s)}translate(e,r){this._context.translate(e,r)}_enableTrace(){let e=this,r=Zx.length,n=this.setAttr,i,a;const s=function(u){let c=e[u],f;e[u]=function(){return a=T9(Array.prototype.slice.call(arguments,0)),f=c.apply(e,arguments),e._trace({method:u,args:a}),f}};for(i=0;i<r;i++)s(Zx[i]);e.setAttr=function(){n.apply(e,arguments);const u=arguments[0];let c=arguments[1];(u==="shadowOffsetX"||u==="shadowOffsetY"||u==="shadowBlur")&&(c=c/this.canvas.getPixelRatio()),e._trace({property:u,val:c})}}_applyGlobalCompositeOperation(e){const r=e.attrs.globalCompositeOperation;!r||r==="source-over"||this.setAttr("globalCompositeOperation",r)}}ra.Context=dh;O9.forEach(function(t){Object.defineProperty(dh.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})});class D9 extends dh{constructor(e,{willReadFrequently:r=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:r})}_fillColor(e){const r=e.fill();this.setAttr("fillStyle",r),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const r=e._getLinearGradient();r&&(this.setAttr("fillStyle",r),e._fillFunc(this))}_fillRadialGradient(e){const r=e._getRadialGradient();r&&(this.setAttr("fillStyle",r),e._fillFunc(this))}_fill(e){const r=e.fill(),n=e.getFillPriority();if(r&&n==="color"){this._fillColor(e);return}const i=e.getFillPatternImage();if(i&&n==="pattern"){this._fillPattern(e);return}const a=e.getFillLinearGradientColorStops();if(a&&n==="linear-gradient"){this._fillLinearGradient(e);return}const s=e.getFillRadialGradientColorStops();if(s&&n==="radial-gradient"){this._fillRadialGradient(e);return}r?this._fillColor(e):i?this._fillPattern(e):a?this._fillLinearGradient(e):s&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const r=e.getStrokeLinearGradientStartPoint(),n=e.getStrokeLinearGradientEndPoint(),i=e.getStrokeLinearGradientColorStops(),a=this.createLinearGradient(r.x,r.y,n.x,n.y);if(i){for(let s=0;s<i.length;s+=2)a.addColorStop(i[s],i[s+1]);this.setAttr("strokeStyle",a)}}_stroke(e){const r=e.dash(),n=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!n){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e),r&&e.dashEnabled()&&(this.setLineDash(r),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),n||this.restore()}}_applyShadow(e){var r,n,i;const a=(r=e.getShadowRGBA())!==null&&r!==void 0?r:"black",s=(n=e.getShadowBlur())!==null&&n!==void 0?n:5,u=(i=e.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},c=e.getAbsoluteScale(),f=this.canvas.getPixelRatio(),d=c.x*f,v=c.y*f;this.setAttr("shadowColor",a),this.setAttr("shadowBlur",s*Math.min(Math.abs(d),Math.abs(v))),this.setAttr("shadowOffsetX",u.x*d),this.setAttr("shadowOffsetY",u.y*v)}}ra.SceneContext=D9;class L9 extends dh{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const r=e.getStrokeScaleEnabled();if(!r){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e);const n=e.hitStrokeWidth(),i=n==="auto"?e.strokeWidth():n;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),r||this.restore()}}}ra.HitContext=L9;Object.defineProperty(vi,"__esModule",{value:!0});vi.HitCanvas=vi.SceneCanvas=vi.Canvas=void 0;const Rf=Vt,zy=ra,Gy=Ze;let Oc;function M9(){if(Oc)return Oc;const t=Rf.Util.createCanvasElement(),e=t.getContext("2d");return Oc=function(){const r=Gy.Konva._global.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return r/n}(),Rf.Util.releaseCanvas(t),Oc}class w2{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const n=(e||{}).pixelRatio||Gy.Konva.pixelRatio||M9();this.pixelRatio=n,this._canvas=Rf.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const r=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/r,this.getHeight()/r)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,r){this.setWidth(e||0),this.setHeight(r||0)}toDataURL(e,r){try{return this._canvas.toDataURL(e,r)}catch{try{return this._canvas.toDataURL()}catch(i){return Rf.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}vi.Canvas=w2;class B9 extends w2{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new zy.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}vi.SceneCanvas=B9;class U9 extends w2{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new zy.HitContext(this),this.setSize(e.width,e.height)}}vi.HitCanvas=U9;var ph={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=Ze,r=Vt;t.DD={get isDragging(){let n=!1;return t.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return t.DD._dragElements.forEach(i=>{n=i.node}),n},_dragElements:new Map,_drag(n){const i=[];t.DD._dragElements.forEach((a,s)=>{const{node:u}=a,c=u.getStage();c.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const f=c._changedPointerPositions.find(d=>d.id===a.pointerId);if(f){if(a.dragStatus!=="dragging"){const d=u.dragDistance();if(Math.max(Math.abs(f.x-a.startPointerPos.x),Math.abs(f.y-a.startPointerPos.y))<d||(u.startDrag({evt:n}),!u.isDragging()))return}u._setDragPosition(n,a),i.push(u)}}),i.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const i=[];t.DD._dragElements.forEach(a=>{const{node:s}=a,u=s.getStage();if(n&&u.setPointersPositions(n),!u._changedPointerPositions.find(d=>d.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,a.dragStatus="stopped");const f=a.node.getLayer()||a.node instanceof e.Konva.Stage&&a.node;f&&i.indexOf(f)===-1&&i.push(f)}),i.forEach(a=>{a.draw()})},_endDragAfter(n){t.DD._dragElements.forEach((i,a)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:n},!0),i.dragStatus!=="dragging"&&t.DD._dragElements.delete(a)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))})(ph);var nt={},je={};Object.defineProperty(je,"__esModule",{value:!0});je.RGBComponent=z9;je.alphaComponent=G9;je.getNumberValidator=W9;je.getNumberOrArrayOfNumbersValidator=H9;je.getNumberOrAutoValidator=j9;je.getStringValidator=V9;je.getStringOrGradientValidator=b9;je.getFunctionValidator=X9;je.getNumberArrayValidator=K9;je.getBooleanValidator=Y9;je.getComponentValidator=$9;const da=Ze,Kt=Vt;function pa(t){return Kt.Util._isString(t)?'"'+t+'"':Object.prototype.toString.call(t)==="[object Number]"||Kt.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function z9(t){return t>255?255:t<0?0:Math.round(t)}function G9(t){return t>1?1:t<1e-4?1e-4:t}function W9(){if(da.Konva.isUnminified)return function(t,e){return Kt.Util._isNumber(t)||Kt.Util.warn(pa(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function H9(t){if(da.Konva.isUnminified)return function(e,r){let n=Kt.Util._isNumber(e),i=Kt.Util._isArray(e)&&e.length==t;return!n&&!i&&Kt.Util.warn(pa(e)+' is a not valid value for "'+r+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function j9(){if(da.Konva.isUnminified)return function(t,e){return Kt.Util._isNumber(t)||t==="auto"||Kt.Util.warn(pa(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function V9(){if(da.Konva.isUnminified)return function(t,e){return Kt.Util._isString(t)||Kt.Util.warn(pa(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function b9(){if(da.Konva.isUnminified)return function(t,e){const r=Kt.Util._isString(t),n=Object.prototype.toString.call(t)==="[object CanvasGradient]"||t&&t.addColorStop;return r||n||Kt.Util.warn(pa(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function X9(){if(da.Konva.isUnminified)return function(t,e){return Kt.Util._isFunction(t)||Kt.Util.warn(pa(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}function K9(){if(da.Konva.isUnminified)return function(t,e){const r=Int8Array?Object.getPrototypeOf(Int8Array):null;return r&&t instanceof r||(Kt.Util._isArray(t)?t.forEach(function(n){Kt.Util._isNumber(n)||Kt.Util.warn('"'+e+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):Kt.Util.warn(pa(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}}function Y9(){if(da.Konva.isUnminified)return function(t,e){return t===!0||t===!1||Kt.Util.warn(pa(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}function $9(t){if(da.Konva.isUnminified)return function(e,r){return e==null||Kt.Util.isObject(e)||Kt.Util.warn(pa(e)+' is a not valid value for "'+r+'" attribute. The value should be an object with properties '+t),e}}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=Vt,r=je,n="get",i="set";t.Factory={addGetterSetter(a,s,u,c,f){t.Factory.addGetter(a,s,u),t.Factory.addSetter(a,s,c,f),t.Factory.addOverloadedGetterSetter(a,s)},addGetter(a,s,u){const c=n+e.Util._capitalize(s);a.prototype[c]=a.prototype[c]||function(){const f=this.attrs[s];return f===void 0?u:f}},addSetter(a,s,u,c){const f=i+e.Util._capitalize(s);a.prototype[f]||t.Factory.overWriteSetter(a,s,u,c)},overWriteSetter(a,s,u,c){const f=i+e.Util._capitalize(s);a.prototype[f]=function(d){return u&&d!==void 0&&d!==null&&(d=u.call(this,d,s)),this._setAttr(s,d),c&&c.call(this),this}},addComponentsGetterSetter(a,s,u,c,f){const d=u.length,v=e.Util._capitalize,g=n+v(s),x=i+v(s);a.prototype[g]=function(){const y={};for(let E=0;E<d;E++){const C=u[E];y[C]=this.getAttr(s+v(C))}return y};const _=(0,r.getComponentValidator)(u);a.prototype[x]=function(y){const E=this.attrs[s];c&&(y=c.call(this,y,s)),_&&_.call(this,y,s);for(const C in y)y.hasOwnProperty(C)&&this._setAttr(s+v(C),y[C]);return y||u.forEach(C=>{this._setAttr(s+v(C),void 0)}),this._fireChangeEvent(s,E,y),f&&f.call(this),this},t.Factory.addOverloadedGetterSetter(a,s)},addOverloadedGetterSetter(a,s){const u=e.Util._capitalize(s),c=i+u,f=n+u;a.prototype[s]=function(){return arguments.length?(this[c](arguments[0]),this):this[f]()}},addDeprecatedGetterSetter(a,s,u,c){e.Util.error("Adding deprecated "+s);const f=n+e.Util._capitalize(s),d=s+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[f]=function(){e.Util.error(d);const v=this.attrs[s];return v===void 0?u:v},t.Factory.addSetter(a,s,c,function(){e.Util.error(d)}),t.Factory.addOverloadedGetterSetter(a,s)},backCompat(a,s){e.Util.each(s,function(u,c){const f=a.prototype[c],d=n+e.Util._capitalize(u),v=i+e.Util._capitalize(u);function g(){f.apply(this,arguments),e.Util.error('"'+u+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}a.prototype[u]=g,a.prototype[d]=g,a.prototype[v]=g})},afterSetFilter(){this._filterUpToDate=!1}}})(nt);Object.defineProperty(Ut,"__esModule",{value:!0});Ut.Node=void 0;const yo=vi,Vn=ph,n0=nt,Pa=Ze,st=Vt,Jt=je,nf="absoluteOpacity",Ic="allEventListeners",Qi="absoluteTransform",e4="absoluteScale",ws="canvas",Q9="Change",q9="children",J9="konva",dg="listening",Z9="mouseenter",e7="mouseleave",t7="pointerenter",r7="pointerleave",n7="touchenter",i7="touchleave",t4="set",r4="Shape",af=" ",n4="stage",Ra="transform",a7="Stage",pg="visible",s7=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(af);let o7=1;class be{constructor(e){this._id=o7++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===Ra||e===Qi)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,r){let n=this._cache.get(e);return(n===void 0||(e===Ra||e===Qi)&&n.dirty===!0)&&(n=r.call(this),this._cache.set(e,n)),n}_calculate(e,r,n){if(!this._attachedDepsListeners.get(e)){const i=r.map(a=>a+"Change.konva").join(af);this.on(i,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,n)}_getCanvasCache(){return this._cache.get(ws)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Qi&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(ws)){const{scene:e,filter:r,hit:n,buffer:i}=this._cache.get(ws);st.Util.releaseCanvas(e,r,n,i),this._cache.delete(ws)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const r=e||{};let n={};(r.x===void 0||r.y===void 0||r.width===void 0||r.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(r.width||n.width),a=Math.ceil(r.height||n.height),s=r.pixelRatio,u=r.x===void 0?Math.floor(n.x):r.x,c=r.y===void 0?Math.floor(n.y):r.y,f=r.offset||0,d=r.drawBorder||!1,v=r.hitCanvasPixelRatio||1;if(!i||!a){st.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const g=Math.abs(Math.round(n.x)-u)>.5?1:0,x=Math.abs(Math.round(n.y)-c)>.5?1:0;i+=f*2+g,a+=f*2+x,u-=f,c-=f;const _=new yo.SceneCanvas({pixelRatio:s,width:i,height:a}),y=new yo.SceneCanvas({pixelRatio:s,width:0,height:0,willReadFrequently:!0}),E=new yo.HitCanvas({pixelRatio:v,width:i,height:a}),C=_.getContext(),T=E.getContext(),m=new yo.SceneCanvas({width:_.width/_.pixelRatio+Math.abs(u),height:_.height/_.pixelRatio+Math.abs(c),pixelRatio:_.pixelRatio}),w=m.getContext();return E.isCache=!0,_.isCache=!0,this._cache.delete(ws),this._filterUpToDate=!1,r.imageSmoothingEnabled===!1&&(_.getContext()._context.imageSmoothingEnabled=!1,y.getContext()._context.imageSmoothingEnabled=!1),C.save(),T.save(),w.save(),C.translate(-u,-c),T.translate(-u,-c),w.translate(-u,-c),m.x=u,m.y=c,this._isUnderCache=!0,this._clearSelfAndDescendantCache(nf),this._clearSelfAndDescendantCache(e4),this.drawScene(_,this,m),this.drawHit(E,this),this._isUnderCache=!1,C.restore(),T.restore(),d&&(C.save(),C.beginPath(),C.rect(0,0,i,a),C.closePath(),C.setAttr("strokeStyle","red"),C.setAttr("lineWidth",5),C.stroke(),C.restore()),this._cache.set(ws,{scene:_,filter:y,hit:E,buffer:m,x:u,y:c}),this._requestDraw(),this}isCached(){return this._cache.has(ws)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,r){const n=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let i=1/0,a=1/0,s=-1/0,u=-1/0;const c=this.getAbsoluteTransform(r);return n.forEach(function(f){const d=c.point(f);i===void 0&&(i=s=d.x,a=u=d.y),i=Math.min(i,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),u=Math.max(u,d.y)}),{x:i,y:a,width:s-i,height:u-a}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const r=this._getCanvasCache();e.translate(r.x,r.y);const n=this._getCachedSceneCanvas(),i=n.pixelRatio;e.drawImage(n._canvas,0,0,n.width/i,n.height/i),e.restore()}_drawCachedHitCanvas(e){const r=this._getCanvasCache(),n=r.hit;e.save(),e.translate(r.x,r.y),e.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),r=this._getCanvasCache(),n=r.scene,i=r.filter,a=i.getContext(),s,u,c,f;if(e){if(!this._filterUpToDate){const d=n.pixelRatio;i.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(s=e.length,a.clear(),a.drawImage(n._canvas,0,0,n.getWidth()/d,n.getHeight()/d),u=a.getImageData(0,0,i.getWidth(),i.getHeight()),c=0;c<s;c++){if(f=e[c],typeof f!="function"){st.Util.error("Filter should be type of function, but got "+typeof f+" instead. Please check correct filters");continue}f.call(this,u),a.putImageData(u,0,0)}}catch(v){st.Util.error("Unable to apply filter. "+v.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return n}on(e,r){if(this._cache&&this._cache.delete(Ic),arguments.length===3)return this._delegate.apply(this,arguments);const n=e.split(af);for(let i=0;i<n.length;i++){const s=n[i].split("."),u=s[0],c=s[1]||"";this.eventListeners[u]||(this.eventListeners[u]=[]),this.eventListeners[u].push({name:c,handler:r})}return this}off(e,r){let n=(e||"").split(af),i=n.length,a,s,u,c,f,d;if(this._cache&&this._cache.delete(Ic),!e)for(s in this.eventListeners)this._off(s);for(a=0;a<i;a++)if(u=n[a],c=u.split("."),f=c[0],d=c[1],f)this.eventListeners[f]&&this._off(f,d,r);else for(s in this.eventListeners)this._off(s,d,r);return this}dispatchEvent(e){const r={target:this,type:e.type,evt:e};return this.fire(e.type,r),this}addEventListener(e,r){return this.on(e,function(n){r.call(this,n.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,r,n){const i=this;this.on(e,function(a){const s=a.target.findAncestors(r,!0,i);for(let u=0;u<s.length;u++)a=st.Util.cloneObject(a),a.currentTarget=s[u],n.call(s[u],a)})}remove(){return this.isDragging()&&this.stopDrag(),Vn.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Qi),this._clearSelfAndDescendantCache(nf),this._clearSelfAndDescendantCache(e4),this._clearSelfAndDescendantCache(n4),this._clearSelfAndDescendantCache(pg),this._clearSelfAndDescendantCache(dg)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const r="get"+st.Util._capitalize(e);return st.Util._isFunction(this[r])?this[r]():this.attrs[e]}getAncestors(){let e=this.getParent(),r=[];for(;e;)r.push(e),e=e.getParent();return r}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let r,n;if(!e)return this;for(r in e)r!==q9&&(n=t4+st.Util._capitalize(r),st.Util._isFunction(this[n])?this[n](e[r]):this._setAttr(r,e[r]))}),this}isListening(){return this._getCache(dg,this._isListening)}_isListening(e){if(!this.listening())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isListening(e):!0}isVisible(){return this._getCache(pg,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isVisible(e):!0}shouldDrawHit(e,r=!1){if(e)return this._isVisible(e)&&this._isListening(e);const n=this.getLayer();let i=!1;Vn.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(s.node.nodeType==="Stage"||s.node.getLayer()===n)&&(i=!0)});const a=!r&&!Pa.Konva.hitOnDragEnabled&&(i||Pa.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!a}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),r=this,n=0,i,a,s,u;function c(d){for(i=[],a=d.length,s=0;s<a;s++)u=d[s],n++,u.nodeType!==r4&&(i=i.concat(u.getChildren().slice())),u._id===r._id&&(s=a);i.length>0&&i[0].getDepth()<=e&&c(i)}const f=this.getStage();return r.nodeType!==a7&&f&&c(f.getChildren()),n}getDepth(){let e=0,r=this.parent;for(;r;)e++,r=r.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Ra),this._clearSelfAndDescendantCache(Qi)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const r=e.getPointerPosition();if(!r)return null;const n=this.getAbsoluteTransform().copy();return n.invert(),n.point(r)}getAbsolutePosition(e){let r=!1,n=this.parent;for(;n;){if(n.isCached()){r=!0;break}n=n.parent}r&&!e&&(e=!0);const i=this.getAbsoluteTransform(e).getMatrix(),a=new st.Transform,s=this.offset();return a.m=i.slice(),a.translate(s.x,s.y),a.getTranslation()}setAbsolutePosition(e){const{x:r,y:n,...i}=this._clearTransform();this.attrs.x=r,this.attrs.y=n,this._clearCache(Ra);const a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(e.x,e.y),e={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(i),this.setPosition({x:e.x,y:e.y}),this._clearCache(Ra),this._clearSelfAndDescendantCache(Qi),this}_setTransform(e){let r;for(r in e)this.attrs[r]=e[r]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let r=e.x,n=e.y,i=this.x(),a=this.y();return r!==void 0&&(i+=r),n!==void 0&&(a+=n),this.setPosition({x:i,y:a}),this}_eachAncestorReverse(e,r){let n=[],i=this.getParent(),a,s;if(!(r&&r._id===this._id)){for(n.unshift(this);i&&(!r||i._id!==r._id);)n.unshift(i),i=i.parent;for(a=n.length,s=0;s<a;s++)e(n[s])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return st.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,r=this.parent.getChildren().length;return e<r-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return st.Util.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,r=this.parent.getChildren().length;return e<r-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return st.Util.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return st.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return st.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&st.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const r=this.index;return this.parent.children.splice(r,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(nf,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const r=this.getParent();return r&&!r._isUnderCache&&(e*=r.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),r,n,i,a,s;const u={attrs:{},className:this.getClassName()};for(r in e)n=e[r],s=st.Util.isObject(n)&&!st.Util._isPlainObject(n)&&!st.Util._isArray(n),!s&&(i=typeof this[r]=="function"&&this[r],delete e[r],a=i?i.call(this):null,e[r]=n,a!==n&&(u.attrs[r]=n));return st.Util._prepareToStringify(u)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,r,n){const i=[];r&&this._isMatch(e)&&i.push(this);let a=this.parent;for(;a;){if(a===n)return i;a._isMatch(e)&&i.push(a),a=a.parent}return i}isAncestorOf(e){return!1}findAncestor(e,r,n){return this.findAncestors(e,r,n)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let r=e.replace(/ /g,"").split(","),n=r.length,i,a;for(i=0;i<n;i++)if(a=r[i],st.Util.isValidSelector(a)||(st.Util.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),st.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),st.Util.warn("Konva is awesome, right?")),a.charAt(0)==="#"){if(this.id()===a.slice(1))return!0}else if(a.charAt(0)==="."){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(n4,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,r={},n){return r.target=r.target||this,n?this._fireAndBubble(e,r):this._fire(e,r),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Qi,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let r;if(e)return r=new st.Transform,this._eachAncestorReverse(function(n){const i=n.transformsEnabled();i==="all"?r.multiply(n.getTransform()):i==="position"&&r.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},e),r;{r=this._cache.get(Qi)||new st.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(r):r.reset();const n=this.transformsEnabled();if(n==="all")r.multiply(this.getTransform());else if(n==="position"){const i=this.attrs.x||0,a=this.attrs.y||0,s=this.attrs.offsetX||0,u=this.attrs.offsetY||0;r.translate(i-s,a-u)}return r.dirty=!1,r}}getAbsoluteScale(e){let r=this;for(;r;)r._isUnderCache&&(e=r),r=r.getParent();const i=this.getAbsoluteTransform(e).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Ra,this._getTransform)}_getTransform(){var e,r;const n=this._cache.get(Ra)||new st.Transform;n.reset();const i=this.x(),a=this.y(),s=Pa.Konva.getAngle(this.rotation()),u=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,c=(r=this.attrs.scaleY)!==null&&r!==void 0?r:1,f=this.attrs.skewX||0,d=this.attrs.skewY||0,v=this.attrs.offsetX||0,g=this.attrs.offsetY||0;return(i!==0||a!==0)&&n.translate(i,a),s!==0&&n.rotate(s),(f!==0||d!==0)&&n.skew(f,d),(u!==1||c!==1)&&n.scale(u,c),(v!==0||g!==0)&&n.translate(-1*v,-1*g),n.dirty=!1,n}clone(e){let r=st.Util.cloneObject(this.attrs),n,i,a,s,u;for(n in e)r[n]=e[n];const c=new this.constructor(r);for(n in this.eventListeners)for(i=this.eventListeners[n],a=i.length,s=0;s<a;s++)u=i[s],u.name.indexOf(J9)<0&&(c.eventListeners[n]||(c.eventListeners[n]=[]),c.eventListeners[n].push(u));return c}_toKonvaCanvas(e){e=e||{};const r=this.getClientRect(),n=this.getStage(),i=e.x!==void 0?e.x:Math.floor(r.x),a=e.y!==void 0?e.y:Math.floor(r.y),s=e.pixelRatio||1,u=new yo.SceneCanvas({width:e.width||Math.ceil(r.width)||(n?n.width():0),height:e.height||Math.ceil(r.height)||(n?n.height():0),pixelRatio:s}),c=u.getContext(),f=new yo.SceneCanvas({width:u.width/u.pixelRatio+Math.abs(i),height:u.height/u.pixelRatio+Math.abs(a),pixelRatio:u.pixelRatio});return e.imageSmoothingEnabled===!1&&(c._context.imageSmoothingEnabled=!1),c.save(),(i||a)&&c.translate(-1*i,-1*a),this.drawScene(u,void 0,f),c.restore(),u}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const r=e.mimeType||null,n=e.quality||null,i=this._toKonvaCanvas(e).toDataURL(r,n);return e.callback&&e.callback(i),i}toImage(e){return new Promise((r,n)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,st.Util._urlToImage(this.toDataURL(e),function(a){r(a),i==null||i(a)})}catch(i){n(i)}})}toBlob(e){return new Promise((r,n)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,this.toCanvas(e).toBlob(a=>{r(a),i==null||i(a)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(i){n(i)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Pa.Konva.dragDistance}_off(e,r,n){let i=this.eventListeners[e],a,s,u;for(a=0;a<i.length;a++)if(s=i[a].name,u=i[a].handler,(s!=="konva"||r==="konva")&&(!r||s===r)&&(!n||n===u)){if(i.splice(a,1),i.length===0){delete this.eventListeners[e];break}a--}}_fireChangeEvent(e,r,n){this._fire(e+Q9,{oldVal:r,newVal:n})}addName(e){if(!this.hasName(e)){const r=this.name(),n=r?r+" "+e:e;this.name(n)}return this}hasName(e){if(!e)return!1;const r=this.name();return r?(r||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const r=(this.name()||"").split(/\s/g),n=r.indexOf(e);return n!==-1&&(r.splice(n,1),this.name(r.join(" "))),this}setAttr(e,r){const n=this[t4+st.Util._capitalize(e)];return st.Util._isFunction(n)?n.call(this,r):this._setAttr(e,r),this}_requestDraw(){if(Pa.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,r){const n=this.attrs[e];n===r&&!st.Util.isObject(r)||(r==null?delete this.attrs[e]:this.attrs[e]=r,this._shouldFireChangeEvents&&this._fireChangeEvent(e,n,r),this._requestDraw())}_setComponentAttr(e,r,n){let i;n!==void 0&&(i=this.attrs[e],i||(this.attrs[e]=this.getAttr(e)),this.attrs[e][r]=n,this._fireChangeEvent(e,i,n))}_fireAndBubble(e,r,n){r&&this.nodeType===r4&&(r.target=this);const i=[Z9,e7,t7,r7,n7,i7];if(!(i.indexOf(e)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(e,r);const s=i.indexOf(e)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(r&&!r.cancelBubble||!r)&&this.parent&&this.parent.isListening()&&!s&&(n&&n.parent?this._fireAndBubble.call(this.parent,e,r,n):this._fireAndBubble.call(this.parent,e,r))}}_getProtoListeners(e){var r,n,i;const a=(r=this._cache.get(Ic))!==null&&r!==void 0?r:{};let s=a==null?void 0:a[e];if(s===void 0){s=[];let u=Object.getPrototypeOf(this);for(;u;){const c=(i=(n=u.eventListeners)===null||n===void 0?void 0:n[e])!==null&&i!==void 0?i:[];s.push(...c),u=Object.getPrototypeOf(u)}a[e]=s,this._cache.set(Ic,a)}return s}_fire(e,r){r=r||{},r.currentTarget=this,r.type=e;const n=this._getProtoListeners(e);if(n)for(let a=0;a<n.length;a++)n[a].handler.call(this,r);const i=this.eventListeners[e];if(i)for(let a=0;a<i.length;a++)i[a].handler.call(this,r)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const r=e?e.pointerId:void 0,n=this.getStage(),i=this.getAbsolutePosition();if(!n)return;const a=n._getPointerById(r)||n._changedPointerPositions[0]||i;Vn.DD._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-i.x,y:a.y-i.y},dragStatus:"ready",pointerId:r})}startDrag(e,r=!0){Vn.DD._dragElements.has(this._id)||this._createDragElement(e);const n=Vn.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},r)}_setDragPosition(e,r){const n=this.getStage()._getPointerById(r.pointerId);if(!n)return;let i={x:n.x-r.offset.x,y:n.y-r.offset.y};const a=this.dragBoundFunc();if(a!==void 0){const s=a.call(this,i,e);s?i=s:st.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(e){const r=Vn.DD._dragElements.get(this._id);r&&(r.dragStatus="stopped"),Vn.DD._endDragBefore(e),Vn.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=Vn.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||Pa.Konva.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let i=!1;Vn.DD._dragElements.forEach(a=>{this.isAncestorOf(a.node)&&(i=!0)}),i||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const r=Vn.DD._dragElements.get(this._id),n=r&&r.dragStatus==="dragging",i=r&&r.dragStatus==="ready";n?this.stopDrag():i&&Vn.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const r=this.getStage();if(!r)return!1;const n={x:-e.x,y:-e.y,width:r.width()+2*e.x,height:r.height()+2*e.y};return st.Util.haveIntersection(n,this.getClientRect())}static create(e,r){return st.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,r)}static _createNode(e,r){let n=be.prototype.getClassName.call(e),i=e.children,a,s,u;r&&(e.attrs.container=r),Pa.Konva[n]||(st.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");const c=Pa.Konva[n];if(a=new c(e.attrs),i)for(s=i.length,u=0;u<s;u++)a.add(be._createNode(i[u]));return a}}Ut.Node=be;be.prototype.nodeType="Node";be.prototype._attrsAffectingSize=[];be.prototype.eventListeners={};be.prototype.on.call(be.prototype,s7,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Ra),this._clearSelfAndDescendantCache(Qi)});be.prototype.on.call(be.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(pg)});be.prototype.on.call(be.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(dg)});be.prototype.on.call(be.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(nf)});const kt=n0.Factory.addGetterSetter;kt(be,"zIndex");kt(be,"absolutePosition");kt(be,"position");kt(be,"x",0,(0,Jt.getNumberValidator)());kt(be,"y",0,(0,Jt.getNumberValidator)());kt(be,"globalCompositeOperation","source-over",(0,Jt.getStringValidator)());kt(be,"opacity",1,(0,Jt.getNumberValidator)());kt(be,"name","",(0,Jt.getStringValidator)());kt(be,"id","",(0,Jt.getStringValidator)());kt(be,"rotation",0,(0,Jt.getNumberValidator)());n0.Factory.addComponentsGetterSetter(be,"scale",["x","y"]);kt(be,"scaleX",1,(0,Jt.getNumberValidator)());kt(be,"scaleY",1,(0,Jt.getNumberValidator)());n0.Factory.addComponentsGetterSetter(be,"skew",["x","y"]);kt(be,"skewX",0,(0,Jt.getNumberValidator)());kt(be,"skewY",0,(0,Jt.getNumberValidator)());n0.Factory.addComponentsGetterSetter(be,"offset",["x","y"]);kt(be,"offsetX",0,(0,Jt.getNumberValidator)());kt(be,"offsetY",0,(0,Jt.getNumberValidator)());kt(be,"dragDistance",void 0,(0,Jt.getNumberValidator)());kt(be,"width",0,(0,Jt.getNumberValidator)());kt(be,"height",0,(0,Jt.getNumberValidator)());kt(be,"listening",!0,(0,Jt.getBooleanValidator)());kt(be,"preventDefault",!0,(0,Jt.getBooleanValidator)());kt(be,"filters",void 0,function(t){return this._filterUpToDate=!1,t});kt(be,"visible",!0,(0,Jt.getBooleanValidator)());kt(be,"transformsEnabled","all",(0,Jt.getStringValidator)());kt(be,"size");kt(be,"dragBoundFunc");kt(be,"draggable",!1,(0,Jt.getBooleanValidator)());n0.Factory.backCompat(be,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var js={};Object.defineProperty(js,"__esModule",{value:!0});js.Container=void 0;const hl=nt,Z1=Ut,gh=je;class Vs extends Z1.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){const r=this.children||[];return e?r.filter(e):r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let n=0;n<e.length;n++)this.add(e[n]);return this}const r=e[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const r=this._generalFind(e,!0);return r.length>0?r[0]:void 0}_generalFind(e,r){const n=[];return this._descendants(i=>{const a=i._isMatch(e);return a&&n.push(i),!!(a&&r)}),n}_descendants(e){let r=!1;const n=this.getChildren();for(const i of n){if(r=e(i),r)return!0;if(i.hasChildren()&&(r=i._descendants(e),r))return!0}return!1}toObject(){const e=Z1.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(r=>{e.children.push(r.toObject())}),e}isAncestorOf(e){let r=e.getParent();for(;r;){if(r._id===this._id)return!0;r=r.getParent()}return!1}clone(e){const r=Z1.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(n){r.add(n.clone())}),r}getAllIntersections(e){const r=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(e)&&r.push(n)}),r}_clearSelfAndDescendantCache(e){var r;super._clearSelfAndDescendantCache(e),!this.isCached()&&((r=this.children)===null||r===void 0||r.forEach(function(n){n._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(r,n){r.index=n}),this._requestDraw()}drawScene(e,r,n){const i=this.getLayer(),a=e||i&&i.getCanvas(),s=a&&a.getContext(),u=this._getCanvasCache(),c=u&&u.scene,f=a&&a.isCache;if(!this.isVisible()&&!f)return this;if(c){s.save();const d=this.getAbsoluteTransform(r).getMatrix();s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",a,r,n);return this}drawHit(e,r){if(!this.shouldDrawHit(r))return this;const n=this.getLayer(),i=e||n&&n.hitCanvas,a=i&&i.getContext(),s=this._getCanvasCache();if(s&&s.hit){a.save();const c=this.getAbsoluteTransform(r).getMatrix();a.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedHitCanvas(a),a.restore()}else this._drawChildren("drawHit",i,r);return this}_drawChildren(e,r,n,i){var a;const s=r&&r.getContext(),u=this.clipWidth(),c=this.clipHeight(),f=this.clipFunc(),d=typeof u=="number"&&typeof c=="number"||f,v=n===this;if(d){s.save();const x=this.getAbsoluteTransform(n);let _=x.getMatrix();s.transform(_[0],_[1],_[2],_[3],_[4],_[5]),s.beginPath();let y;if(f)y=f.call(this,s,this);else{const E=this.clipX(),C=this.clipY();s.rect(E||0,C||0,u,c)}s.clip.apply(s,y),_=x.copy().invert().getMatrix(),s.transform(_[0],_[1],_[2],_[3],_[4],_[5])}const g=!v&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";g&&(s.save(),s._applyGlobalCompositeOperation(this)),(a=this.children)===null||a===void 0||a.forEach(function(x){x[e](r,n,i)}),g&&s.restore(),d&&s.restore()}getClientRect(e={}){var r;const n=e.skipTransform,i=e.relativeTo;let a,s,u,c,f={x:1/0,y:1/0,width:0,height:0};const d=this;(r=this.children)===null||r===void 0||r.forEach(function(x){if(!x.visible())return;const _=x.getClientRect({relativeTo:d,skipShadow:e.skipShadow,skipStroke:e.skipStroke});_.width===0&&_.height===0||(a===void 0?(a=_.x,s=_.y,u=_.x+_.width,c=_.y+_.height):(a=Math.min(a,_.x),s=Math.min(s,_.y),u=Math.max(u,_.x+_.width),c=Math.max(c,_.y+_.height)))});const v=this.find("Shape");let g=!1;for(let x=0;x<v.length;x++)if(v[x]._isVisible(this)){g=!0;break}return g&&a!==void 0?f={x:a,y:s,width:u-a,height:c-s}:f={x:0,y:0,width:0,height:0},n?f:this._transformedRect(f,i)}}js.Container=Vs;hl.Factory.addComponentsGetterSetter(Vs,"clip",["x","y","width","height"]);hl.Factory.addGetterSetter(Vs,"clipX",void 0,(0,gh.getNumberValidator)());hl.Factory.addGetterSetter(Vs,"clipY",void 0,(0,gh.getNumberValidator)());hl.Factory.addGetterSetter(Vs,"clipWidth",void 0,(0,gh.getNumberValidator)());hl.Factory.addGetterSetter(Vs,"clipHeight",void 0,(0,gh.getNumberValidator)());hl.Factory.addGetterSetter(Vs,"clipFunc");var Wy={},ns={};Object.defineProperty(ns,"__esModule",{value:!0});ns.getCapturedShape=u7;ns.createEvent=E2;ns.hasPointerCapture=c7;ns.setPointerCapture=f7;ns.releaseCapture=jy;const l7=Ze,Hu=new Map,Hy=l7.Konva._global.PointerEvent!==void 0;function u7(t){return Hu.get(t)}function E2(t){return{evt:t,pointerId:t.pointerId}}function c7(t,e){return Hu.get(t)===e}function f7(t,e){jy(t),e.getStage()&&(Hu.set(t,e),Hy&&e._fire("gotpointercapture",E2(new PointerEvent("gotpointercapture"))))}function jy(t,e){const r=Hu.get(t);if(!r)return;const n=r.getStage();n&&n.content,Hu.delete(t),Hy&&r._fire("lostpointercapture",E2(new PointerEvent("lostpointercapture")))}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=Vt,r=nt,n=js,i=Ze,a=vi,s=ph,u=Ze,c=ns,f="Stage",d="string",v="px",g="mouseout",x="mouseleave",_="mouseover",y="mouseenter",E="mousemove",C="mousedown",T="mouseup",m="pointermove",w="pointerdown",F="pointerup",R="pointercancel",N="lostpointercapture",A="pointerout",L="pointerleave",O="pointerover",H="pointerenter",j="contextmenu",q="touchstart",ye="touchend",de="touchmove",Ae="touchcancel",Ge="wheel",ue=5,xe=[[y,"_pointerenter"],[C,"_pointerdown"],[E,"_pointermove"],[T,"_pointerup"],[x,"_pointerleave"],[q,"_pointerdown"],[de,"_pointermove"],[ye,"_pointerup"],[Ae,"_pointercancel"],[_,"_pointerover"],[Ge,"_wheel"],[j,"_contextmenu"],[w,"_pointerdown"],[m,"_pointermove"],[F,"_pointerup"],[R,"_pointercancel"],[L,"_pointerleave"],[N,"_lostpointercapture"]],ve={mouse:{[A]:g,[L]:x,[O]:_,[H]:y,[m]:E,[w]:C,[F]:T,[R]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[A]:"touchout",[L]:"touchleave",[O]:"touchover",[H]:"touchenter",[m]:de,[w]:q,[F]:ye,[R]:Ae,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[A]:A,[L]:L,[O]:O,[H]:H,[m]:m,[w]:w,[F]:F,[R]:R,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},we=oe=>oe.indexOf("pointer")>=0?"pointer":oe.indexOf("touch")>=0?"touch":"mouse",z=oe=>{const W=we(oe);if(W==="pointer")return i.Konva.pointerEventsEnabled&&ve.pointer;if(W==="touch")return ve.touch;if(W==="mouse")return ve.mouse};function K(oe={}){return(oe.clipFunc||oe.clipWidth||oe.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),oe}const b="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class V extends n.Container{constructor(W){super(K(W)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{K(this.attrs)}),this._checkVisibility()}_validateAdd(W){const Z=W.getType()==="Layer",he=W.getType()==="FastLayer";Z||he||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const W=this.visible()?"":"none";this.content.style.display=W}setContainer(W){if(typeof W===d){let Z;if(W.charAt(0)==="."){const he=W.slice(1);W=document.getElementsByClassName(he)[0]}else W.charAt(0)!=="#"?Z=W:Z=W.slice(1),W=document.getElementById(Z);if(!W)throw"Can not find container in document with id "+Z}return this._setAttr("container",W),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),W.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const W=this.children,Z=W.length;for(let he=0;he<Z;he++)W[he].clear();return this}clone(W){return W||(W={}),W.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,W)}destroy(){super.destroy();const W=this.content;W&&e.Util._isInDocument(W)&&this.container().removeChild(W);const Z=t.stages.indexOf(this);return Z>-1&&t.stages.splice(Z,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const W=this._pointerPositions[0]||this._changedPointerPositions[0];return W?{x:W.x,y:W.y}:(e.Util.warn(b),null)}_getPointerById(W){return this._pointerPositions.find(Z=>Z.id===W)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(W){W=W||{},W.x=W.x||0,W.y=W.y||0,W.width=W.width||this.width(),W.height=W.height||this.height();const Z=new a.SceneCanvas({width:W.width,height:W.height,pixelRatio:W.pixelRatio||1}),he=Z.getContext()._context,ge=this.children;return(W.x||W.y)&&he.translate(-1*W.x,-1*W.y),ge.forEach(function(Ne){if(!Ne.isVisible())return;const Be=Ne._toKonvaCanvas(W);he.drawImage(Be._canvas,W.x,W.y,Be.getWidth()/Be.getPixelRatio(),Be.getHeight()/Be.getPixelRatio())}),Z}getIntersection(W){if(!W)return null;const Z=this.children,he=Z.length,ge=he-1;for(let Ne=ge;Ne>=0;Ne--){const Be=Z[Ne].getIntersection(W);if(Be)return Be}return null}_resizeDOM(){const W=this.width(),Z=this.height();this.content&&(this.content.style.width=W+v,this.content.style.height=Z+v),this.bufferCanvas.setSize(W,Z),this.bufferHitCanvas.setSize(W,Z),this.children.forEach(he=>{he.setSize({width:W,height:Z}),he.draw()})}add(W,...Z){if(arguments.length>1){for(let ge=0;ge<arguments.length;ge++)this.add(arguments[ge]);return this}super.add(W);const he=this.children.length;return he>ue&&e.Util.warn("The stage has "+he+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),W.setSize({width:this.width(),height:this.height()}),W.draw(),i.Konva.isBrowser&&this.content.appendChild(W.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(W){return c.hasPointerCapture(W,this)}setPointerCapture(W){c.setPointerCapture(W,this)}releaseCapture(W){c.releaseCapture(W,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&xe.forEach(([W,Z])=>{this.content.addEventListener(W,he=>{this[Z](he)},{passive:!1})})}_pointerenter(W){this.setPointersPositions(W);const Z=z(W.type);Z&&this._fire(Z.pointerenter,{evt:W,target:this,currentTarget:this})}_pointerover(W){this.setPointersPositions(W);const Z=z(W.type);Z&&this._fire(Z.pointerover,{evt:W,target:this,currentTarget:this})}_getTargetShape(W){let Z=this[W+"targetShape"];return Z&&!Z.getStage()&&(Z=null),Z}_pointerleave(W){const Z=z(W.type),he=we(W.type);if(!Z)return;this.setPointersPositions(W);const ge=this._getTargetShape(he),Ne=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;ge&&Ne?(ge._fireAndBubble(Z.pointerout,{evt:W}),ge._fireAndBubble(Z.pointerleave,{evt:W}),this._fire(Z.pointerleave,{evt:W,target:this,currentTarget:this}),this[he+"targetShape"]=null):Ne&&(this._fire(Z.pointerleave,{evt:W,target:this,currentTarget:this}),this._fire(Z.pointerout,{evt:W,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(W){const Z=z(W.type),he=we(W.type);if(!Z)return;this.setPointersPositions(W);let ge=!1;this._changedPointerPositions.forEach(Ne=>{const Be=this.getIntersection(Ne);if(s.DD.justDragged=!1,i.Konva["_"+he+"ListenClick"]=!0,!Be||!Be.isListening()){this[he+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&Be.setPointerCapture(Ne.id),this[he+"ClickStartShape"]=Be,Be._fireAndBubble(Z.pointerdown,{evt:W,pointerId:Ne.id}),ge=!0;const Ke=W.type.indexOf("touch")>=0;Be.preventDefault()&&W.cancelable&&Ke&&W.preventDefault()}),ge||this._fire(Z.pointerdown,{evt:W,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(W){const Z=z(W.type),he=we(W.type);if(!Z||(i.Konva.isDragging()&&s.DD.node.preventDefault()&&W.cancelable&&W.preventDefault(),this.setPointersPositions(W),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const Ne={};let Be=!1;const Ke=this._getTargetShape(he);this._changedPointerPositions.forEach(Ye=>{const et=c.getCapturedShape(Ye.id)||this.getIntersection(Ye),se=Ye.id,ae={evt:W,pointerId:se},me=Ke!==et;if(me&&Ke&&(Ke._fireAndBubble(Z.pointerout,{...ae},et),Ke._fireAndBubble(Z.pointerleave,{...ae},et)),et){if(Ne[et._id])return;Ne[et._id]=!0}et&&et.isListening()?(Be=!0,me&&(et._fireAndBubble(Z.pointerover,{...ae},Ke),et._fireAndBubble(Z.pointerenter,{...ae},Ke),this[he+"targetShape"]=et),et._fireAndBubble(Z.pointermove,{...ae})):Ke&&(this._fire(Z.pointerover,{evt:W,target:this,currentTarget:this,pointerId:se}),this[he+"targetShape"]=null)}),Be||this._fire(Z.pointermove,{evt:W,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(W){const Z=z(W.type),he=we(W.type);if(!Z)return;this.setPointersPositions(W);const ge=this[he+"ClickStartShape"],Ne=this[he+"ClickEndShape"],Be={};let Ke=!1;this._changedPointerPositions.forEach(Ye=>{const et=c.getCapturedShape(Ye.id)||this.getIntersection(Ye);if(et){if(et.releaseCapture(Ye.id),Be[et._id])return;Be[et._id]=!0}const se=Ye.id,ae={evt:W,pointerId:se};let me=!1;i.Konva["_"+he+"InDblClickWindow"]?(me=!0,clearTimeout(this[he+"DblTimeout"])):s.DD.justDragged||(i.Konva["_"+he+"InDblClickWindow"]=!0,clearTimeout(this[he+"DblTimeout"])),this[he+"DblTimeout"]=setTimeout(function(){i.Konva["_"+he+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),et&&et.isListening()?(Ke=!0,this[he+"ClickEndShape"]=et,et._fireAndBubble(Z.pointerup,{...ae}),i.Konva["_"+he+"ListenClick"]&&ge&&ge===et&&(et._fireAndBubble(Z.pointerclick,{...ae}),me&&Ne&&Ne===et&&et._fireAndBubble(Z.pointerdblclick,{...ae}))):(this[he+"ClickEndShape"]=null,i.Konva["_"+he+"ListenClick"]&&this._fire(Z.pointerclick,{evt:W,target:this,currentTarget:this,pointerId:se}),me&&this._fire(Z.pointerdblclick,{evt:W,target:this,currentTarget:this,pointerId:se}))}),Ke||this._fire(Z.pointerup,{evt:W,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+he+"ListenClick"]=!1,W.cancelable&&he!=="touch"&&he!=="pointer"&&W.preventDefault()}_contextmenu(W){this.setPointersPositions(W);const Z=this.getIntersection(this.getPointerPosition());Z&&Z.isListening()?Z._fireAndBubble(j,{evt:W}):this._fire(j,{evt:W,target:this,currentTarget:this})}_wheel(W){this.setPointersPositions(W);const Z=this.getIntersection(this.getPointerPosition());Z&&Z.isListening()?Z._fireAndBubble(Ge,{evt:W}):this._fire(Ge,{evt:W,target:this,currentTarget:this})}_pointercancel(W){this.setPointersPositions(W);const Z=c.getCapturedShape(W.pointerId)||this.getIntersection(this.getPointerPosition());Z&&Z._fireAndBubble(F,c.createEvent(W)),c.releaseCapture(W.pointerId)}_lostpointercapture(W){c.releaseCapture(W.pointerId)}setPointersPositions(W){const Z=this._getContentPosition();let he=null,ge=null;W=W||window.event,W.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(W.touches,Ne=>{this._pointerPositions.push({id:Ne.identifier,x:(Ne.clientX-Z.left)/Z.scaleX,y:(Ne.clientY-Z.top)/Z.scaleY})}),Array.prototype.forEach.call(W.changedTouches||W.touches,Ne=>{this._changedPointerPositions.push({id:Ne.identifier,x:(Ne.clientX-Z.left)/Z.scaleX,y:(Ne.clientY-Z.top)/Z.scaleY})})):(he=(W.clientX-Z.left)/Z.scaleX,ge=(W.clientY-Z.top)/Z.scaleY,this.pointerPos={x:he,y:ge},this._pointerPositions=[{x:he,y:ge,id:e.Util._getFirstPointerId(W)}],this._changedPointerPositions=[{x:he,y:ge,id:e.Util._getFirstPointerId(W)}])}_setPointerPosition(W){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(W)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const W=this.content.getBoundingClientRect();return{top:W.top,left:W.left,scaleX:W.width/this.content.clientWidth||1,scaleY:W.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const W=this.container();if(!W)throw"Stage has no container. A container is required.";W.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),W.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(W){W.batchDraw()}),this}}t.Stage=V,V.prototype.nodeType=f,(0,u._registerNode)(V),r.Factory.addGetterSetter(V,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(oe=>{oe.batchDraw()})})})(Wy);var i0={},dr={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=Ze,r=Vt,n=nt,i=Ut,a=je,s=Ze,u=ns,c="hasShadow",f="shadowRGBA",d="patternImage",v="linearGradient",g="radialGradient";let x;function _(){return x||(x=r.Util.createCanvasElement().getContext("2d"),x)}t.shapes={};function y(L){const O=this.attrs.fillRule;O?L.fill(O):L.fill()}function E(L){L.stroke()}function C(L){const O=this.attrs.fillRule;O?L.fill(O):L.fill()}function T(L){L.stroke()}function m(){this._clearCache(c)}function w(){this._clearCache(f)}function F(){this._clearCache(d)}function R(){this._clearCache(v)}function N(){this._clearCache(g)}class A extends i.Node{constructor(O){super(O);let H;for(;H=r.Util.getRandomColor(),!(H&&!(H in t.shapes)););this.colorKey=H,t.shapes[H]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const H=_().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(H&&H.setTransform){const j=new r.Transform;j.translate(this.fillPatternX(),this.fillPatternY()),j.rotate(e.Konva.getAngle(this.fillPatternRotation())),j.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),j.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const q=j.getMatrix(),ye=typeof DOMMatrix>"u"?{a:q[0],b:q[1],c:q[2],d:q[3],e:q[4],f:q[5]}:new DOMMatrix(q);H.setTransform(ye)}return H}}_getLinearGradient(){return this._getCache(v,this.__getLinearGradient)}__getLinearGradient(){const O=this.fillLinearGradientColorStops();if(O){const H=_(),j=this.fillLinearGradientStartPoint(),q=this.fillLinearGradientEndPoint(),ye=H.createLinearGradient(j.x,j.y,q.x,q.y);for(let de=0;de<O.length;de+=2)ye.addColorStop(O[de],O[de+1]);return ye}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){const O=this.fillRadialGradientColorStops();if(O){const H=_(),j=this.fillRadialGradientStartPoint(),q=this.fillRadialGradientEndPoint(),ye=H.createRadialGradient(j.x,j.y,this.fillRadialGradientStartRadius(),q.x,q.y,this.fillRadialGradientEndRadius());for(let de=0;de<O.length;de+=2)ye.addColorStop(O[de],O[de+1]);return ye}}getShadowRGBA(){return this._getCache(f,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const O=r.Util.colorToRGBA(this.shadowColor());if(O)return"rgba("+O.r+","+O.g+","+O.b+","+O.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const O=this.hitStrokeWidth();return O==="auto"?this.hasStroke():this.strokeEnabled()&&!!O}intersects(O){const H=this.getStage();if(!H)return!1;const j=H.bufferHitCanvas;return j.getContext().clear(),this.drawHit(j,void 0,!0),j.context.getImageData(Math.round(O.x),Math.round(O.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(O){var H;if(!((H=this.attrs.perfectDrawEnabled)!==null&&H!==void 0?H:!0))return!1;const q=O||this.hasFill(),ye=this.hasStroke(),de=this.getAbsoluteOpacity()!==1;if(q&&ye&&de)return!0;const Ae=this.hasShadow(),Ge=this.shadowForStrokeEnabled();return!!(q&&ye&&Ae&&Ge)}setStrokeHitEnabled(O){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),O?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const O=this.size();return{x:this._centroid?-O.width/2:0,y:this._centroid?-O.height/2:0,width:O.width,height:O.height}}getClientRect(O={}){let H=!1,j=this.getParent();for(;j;){if(j.isCached()){H=!0;break}j=j.getParent()}const q=O.skipTransform,ye=O.relativeTo||H&&this.getStage()||void 0,de=this.getSelfRect(),Ge=!O.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,ue=de.width+Ge,xe=de.height+Ge,ve=!O.skipShadow&&this.hasShadow(),we=ve?this.shadowOffsetX():0,z=ve?this.shadowOffsetY():0,K=ue+Math.abs(we),b=xe+Math.abs(z),V=ve&&this.shadowBlur()||0,oe=K+V*2,W=b+V*2,Z={width:oe,height:W,x:-(Ge/2+V)+Math.min(we,0)+de.x,y:-(Ge/2+V)+Math.min(z,0)+de.y};return q?Z:this._transformedRect(Z,ye)}drawScene(O,H,j){const q=this.getLayer(),ye=O||q.getCanvas(),de=ye.getContext(),Ae=this._getCanvasCache(),Ge=this.getSceneFunc(),ue=this.hasShadow();let xe;const ve=H===this;if(!this.isVisible()&&!ve)return this;if(Ae){de.save();const we=this.getAbsoluteTransform(H).getMatrix();return de.transform(we[0],we[1],we[2],we[3],we[4],we[5]),this._drawCachedSceneCanvas(de),de.restore(),this}if(!Ge)return this;if(de.save(),this._useBufferCanvas()){xe=this.getStage();const we=j||xe.bufferCanvas,z=we.getContext();z.clear(),z.save(),z._applyLineJoin(this);const K=this.getAbsoluteTransform(H).getMatrix();z.transform(K[0],K[1],K[2],K[3],K[4],K[5]),Ge.call(this,z,this),z.restore();const b=we.pixelRatio;ue&&de._applyShadow(this),de._applyOpacity(this),de._applyGlobalCompositeOperation(this),de.drawImage(we._canvas,we.x||0,we.y||0,we.width/b,we.height/b)}else{if(de._applyLineJoin(this),!ve){const we=this.getAbsoluteTransform(H).getMatrix();de.transform(we[0],we[1],we[2],we[3],we[4],we[5]),de._applyOpacity(this),de._applyGlobalCompositeOperation(this)}ue&&de._applyShadow(this),Ge.call(this,de,this)}return de.restore(),this}drawHit(O,H,j=!1){if(!this.shouldDrawHit(H,j))return this;const q=this.getLayer(),ye=O||q.hitCanvas,de=ye&&ye.getContext(),Ae=this.hitFunc()||this.sceneFunc(),Ge=this._getCanvasCache(),ue=Ge&&Ge.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),ue){de.save();const ve=this.getAbsoluteTransform(H).getMatrix();return de.transform(ve[0],ve[1],ve[2],ve[3],ve[4],ve[5]),this._drawCachedHitCanvas(de),de.restore(),this}if(!Ae)return this;if(de.save(),de._applyLineJoin(this),!(this===H)){const ve=this.getAbsoluteTransform(H).getMatrix();de.transform(ve[0],ve[1],ve[2],ve[3],ve[4],ve[5])}return Ae.call(this,de,this),de.restore(),this}drawHitFromCache(O=0){const H=this._getCanvasCache(),j=this._getCachedSceneCanvas(),q=H.hit,ye=q.getContext(),de=q.getWidth(),Ae=q.getHeight();ye.clear(),ye.drawImage(j._canvas,0,0,de,Ae);try{const Ge=ye.getImageData(0,0,de,Ae),ue=Ge.data,xe=ue.length,ve=r.Util._hexToRgb(this.colorKey);for(let we=0;we<xe;we+=4)ue[we+3]>O?(ue[we]=ve.r,ue[we+1]=ve.g,ue[we+2]=ve.b,ue[we+3]=255):ue[we+3]=0;ye.putImageData(Ge,0,0)}catch(Ge){r.Util.error("Unable to draw hit graph from cached scene canvas. "+Ge.message)}return this}hasPointerCapture(O){return u.hasPointerCapture(O,this)}setPointerCapture(O){u.setPointerCapture(O,this)}releaseCapture(O){u.releaseCapture(O,this)}}t.Shape=A,A.prototype._fillFunc=y,A.prototype._strokeFunc=E,A.prototype._fillFuncHit=C,A.prototype._strokeFuncHit=T,A.prototype._centroid=!1,A.prototype.nodeType="Shape",(0,s._registerNode)(A),A.prototype.eventListeners={},A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",m),A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",F),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",R),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",N),n.Factory.addGetterSetter(A,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(A,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(A,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(A,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(A,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(A,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(A,"lineJoin"),n.Factory.addGetterSetter(A,"lineCap"),n.Factory.addGetterSetter(A,"sceneFunc"),n.Factory.addGetterSetter(A,"hitFunc"),n.Factory.addGetterSetter(A,"dash"),n.Factory.addGetterSetter(A,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(A,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(A,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(A,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternImage"),n.Factory.addGetterSetter(A,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(A,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(A,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(A,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(A,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(A,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(A,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(A,"fillEnabled",!0),n.Factory.addGetterSetter(A,"strokeEnabled",!0),n.Factory.addGetterSetter(A,"shadowEnabled",!0),n.Factory.addGetterSetter(A,"dashEnabled",!0),n.Factory.addGetterSetter(A,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(A,"fillPriority","color"),n.Factory.addComponentsGetterSetter(A,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(A,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(A,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(A,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(A,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(A,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(A,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(A,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(A,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(A,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(A,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(A,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(A,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(A,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(A,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(A,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(A,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(A,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(A,"fillPatternRotation",0),n.Factory.addGetterSetter(A,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(A,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(dr);Object.defineProperty(i0,"__esModule",{value:!0});i0.Layer=void 0;const $i=Vt,ep=js,So=Ut,T2=nt,i4=vi,h7=je,d7=dr,p7=Ze,g7="#",m7="beforeDraw",v7="draw",Vy=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],x7=Vy.length;let dl=class extends ep.Container{constructor(e){super(e),this.canvas=new i4.SceneCanvas,this.hitCanvas=new i4.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const r=this.getStage();return r&&r.content&&(r.content.removeChild(this.getNativeCanvasElement()),e<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[e+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){So.Node.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!So.Node.prototype.moveUp.call(this))return!1;const r=this.getStage();return!r||!r.content?!1:(r.content.removeChild(this.getNativeCanvasElement()),this.index<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[this.index+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(So.Node.prototype.moveDown.call(this)){const e=this.getStage();if(e){const r=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),r[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(So.Node.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const r=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),r[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return So.Node.prototype.remove.call(this),e&&e.parentNode&&$i.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:r}){return this.canvas.setSize(e,r),this.hitCanvas.setSize(e,r),this._setSmoothEnabled(),this}_validateAdd(e){const r=e.getType();r!=="Group"&&r!=="Shape"&&$i.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),So.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){$i.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){$i.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,$i.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let r=1,n=!1;for(;;){for(let i=0;i<x7;i++){const a=Vy[i],s=this._getIntersection({x:e.x+a.x*r,y:e.y+a.y*r}),u=s.shape;if(u)return u;if(n=!!s.antialiased,!s.antialiased)break}if(n)r+=1;else return null}}_getIntersection(e){const r=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(e.x*r),Math.round(e.y*r),1,1).data,i=n[3];if(i===255){const a=$i.Util._rgbToHex(n[0],n[1],n[2]),s=d7.shapes[g7+a];return s?{shape:s}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(e,r,n){const i=this.getLayer(),a=e||i&&i.getCanvas();return this._fire(m7,{node:this}),this.clearBeforeDraw()&&a.getContext().clear(),ep.Container.prototype.drawScene.call(this,a,r,n),this._fire(v7,{node:this}),this}drawHit(e,r){const n=this.getLayer(),i=e||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),ep.Container.prototype.drawHit.call(this,i,r),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){$i.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return $i.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return $i.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};i0.Layer=dl;dl.prototype.nodeType="Layer";(0,p7._registerNode)(dl);T2.Factory.addGetterSetter(dl,"imageSmoothingEnabled",!0);T2.Factory.addGetterSetter(dl,"clearBeforeDraw",!0);T2.Factory.addGetterSetter(dl,"hitGraphEnabled",!0,(0,h7.getBooleanValidator)());var mh={};Object.defineProperty(mh,"__esModule",{value:!0});mh.FastLayer=void 0;const _7=Vt,y7=i0,S7=Ze;class C2 extends y7.Layer{constructor(e){super(e),this.listening(!1),_7.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}mh.FastLayer=C2;C2.prototype.nodeType="FastLayer";(0,S7._registerNode)(C2);var pl={};Object.defineProperty(pl,"__esModule",{value:!0});pl.Group=void 0;const w7=Vt,E7=js,T7=Ze;let k2=class extends E7.Container{_validateAdd(e){const r=e.getType();r!=="Group"&&r!=="Shape"&&w7.Util.throw("You may only add groups and shapes to groups.")}};pl.Group=k2;k2.prototype.nodeType="Group";(0,T7._registerNode)(k2);var gl={};Object.defineProperty(gl,"__esModule",{value:!0});gl.Animation=void 0;const tp=Ze,a4=Vt,rp=function(){return tp.glob.performance&&tp.glob.performance.now?function(){return tp.glob.performance.now()}:function(){return new Date().getTime()}}();class Li{constructor(e,r){this.id=Li.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:rp(),frameRate:0},this.func=e,this.setLayers(r)}setLayers(e){let r=[];return e&&(r=Array.isArray(e)?e:[e]),this.layers=r,this}getLayers(){return this.layers}addLayer(e){const r=this.layers,n=r.length;for(let i=0;i<n;i++)if(r[i]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const r=Li.animations,n=r.length;for(let i=0;i<n;i++)if(r[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=rp(),Li._addAnimation(this),this}stop(){return Li._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const r=e.id,n=this.animations,i=n.length;for(let a=0;a<i;a++)if(n[a].id===r){this.animations.splice(a,1);break}}static _runFrames(){const e={},r=this.animations;for(let n=0;n<r.length;n++){const i=r[n],a=i.layers,s=i.func;i._updateFrameObject(rp());const u=a.length;let c;if(s?c=s.call(i,i.frame)!==!1:c=!0,!!c)for(let f=0;f<u;f++){const d=a[f];d._id!==void 0&&(e[d._id]=d)}}for(const n in e)e.hasOwnProperty(n)&&e[n].batchDraw()}static _animationLoop(){const e=Li;e.animations.length?(e._runFrames(),a4.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,a4.Util.requestAnimFrame(this._animationLoop))}}gl.Animation=Li;Li.animations=[];Li.animIdCounter=0;Li.animRunning=!1;var by={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=Vt,r=gl,n=Ut,i=Ze,a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},s=1,u=2,c=3,f=["fill","stroke","shadowColor"];let d=0;class v{constructor(_,y,E,C,T,m,w){this.prop=_,this.propFunc=y,this.begin=C,this._pos=C,this.duration=m,this._change=0,this.prevPos=0,this.yoyo=w,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=E,this._change=T-this.begin,this.pause()}fire(_){const y=this[_];y&&y()}setTime(_){_>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():_<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=_,this.update())}getTime(){return this._time}setPosition(_){this.prevPos=this._pos,this.propFunc(_),this._pos=_}getPosition(_){return _===void 0&&(_=this._time),this.func(_,this.begin,this._change,this.duration)}play(){this.state=u,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(_){this.pause(),this._time=_,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const _=this.getTimer()-this._startTime;this.state===u?this.setTime(_):this.state===c&&this.setTime(this.duration-_)}pause(){this.state=s,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(_){const y=this,E=_.node,C=E._id,T=_.easing||t.Easings.Linear,m=!!_.yoyo;let w,F;typeof _.duration>"u"?w=.3:_.duration===0?w=.001:w=_.duration,this.node=E,this._id=d++;const R=E.getLayer()||(E instanceof i.Konva.Stage?E.getLayers():null);R||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){y.tween.onEnterFrame()},R),this.tween=new v(F,function(N){y._tweenFunc(N)},T,0,1,w*1e3,m),this._addListeners(),g.attrs[C]||(g.attrs[C]={}),g.attrs[C][this._id]||(g.attrs[C][this._id]={}),g.tweens[C]||(g.tweens[C]={});for(F in _)a[F]===void 0&&this._addAttr(F,_[F]);this.reset(),this.onFinish=_.onFinish,this.onReset=_.onReset,this.onUpdate=_.onUpdate}_addAttr(_,y){const E=this.node,C=E._id;let T,m,w,F,R;const N=g.tweens[C][_];N&&delete g.attrs[C][N][_];let A=E.getAttr(_);if(e.Util._isArray(y))if(T=[],m=Math.max(y.length,A.length),_==="points"&&y.length!==A.length&&(y.length>A.length?(F=A,A=e.Util._prepareArrayForTween(A,y,E.closed())):(w=y,y=e.Util._prepareArrayForTween(y,A,E.closed()))),_.indexOf("fill")===0)for(let L=0;L<m;L++)if(L%2===0)T.push(y[L]-A[L]);else{const O=e.Util.colorToRGBA(A[L]);R=e.Util.colorToRGBA(y[L]),A[L]=O,T.push({r:R.r-O.r,g:R.g-O.g,b:R.b-O.b,a:R.a-O.a})}else for(let L=0;L<m;L++)T.push(y[L]-A[L]);else f.indexOf(_)!==-1?(A=e.Util.colorToRGBA(A),R=e.Util.colorToRGBA(y),T={r:R.r-A.r,g:R.g-A.g,b:R.b-A.b,a:R.a-A.a}):T=y-A;g.attrs[C][this._id][_]={start:A,diff:T,end:y,trueEnd:w,trueStart:F},g.tweens[C][_]=this._id}_tweenFunc(_){const y=this.node,E=g.attrs[y._id][this._id];let C,T,m,w,F,R,N,A;for(C in E){if(T=E[C],m=T.start,w=T.diff,A=T.end,e.Util._isArray(m))if(F=[],N=Math.max(m.length,A.length),C.indexOf("fill")===0)for(R=0;R<N;R++)R%2===0?F.push((m[R]||0)+w[R]*_):F.push("rgba("+Math.round(m[R].r+w[R].r*_)+","+Math.round(m[R].g+w[R].g*_)+","+Math.round(m[R].b+w[R].b*_)+","+(m[R].a+w[R].a*_)+")");else for(R=0;R<N;R++)F.push((m[R]||0)+w[R]*_);else f.indexOf(C)!==-1?F="rgba("+Math.round(m.r+w.r*_)+","+Math.round(m.g+w.g*_)+","+Math.round(m.b+w.b*_)+","+(m.a+w.a*_)+")":F=m+w*_;y.setAttr(C,F)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const _=this.node,y=g.attrs[_._id][this._id];y.points&&y.points.trueEnd&&_.setAttr("points",y.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const _=this.node,y=g.attrs[_._id][this._id];y.points&&y.points.trueStart&&_.points(y.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(_){return this.tween.seek(_*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const _=this.node._id,y=this._id,E=g.tweens[_];this.pause(),this.anim&&this.anim.stop();for(const C in E)delete g.tweens[_][C];delete g.attrs[_][y],g.tweens[_]&&(Object.keys(g.tweens[_]).length===0&&delete g.tweens[_],Object.keys(g.attrs[_]).length===0&&delete g.attrs[_])}}t.Tween=g,g.attrs={},g.tweens={},n.Node.prototype.to=function(x){const _=x.onFinish;x.node=this,x.onFinish=function(){this.destroy(),_&&_()},new g(x).play()},t.Easings={BackEaseIn(x,_,y,E){return y*(x/=E)*x*((1.70158+1)*x-1.70158)+_},BackEaseOut(x,_,y,E){return y*((x=x/E-1)*x*((1.70158+1)*x+1.70158)+1)+_},BackEaseInOut(x,_,y,E){let C=1.70158;return(x/=E/2)<1?y/2*(x*x*(((C*=1.525)+1)*x-C))+_:y/2*((x-=2)*x*(((C*=1.525)+1)*x+C)+2)+_},ElasticEaseIn(x,_,y,E,C,T){let m=0;return x===0?_:(x/=E)===1?_+y:(T||(T=E*.3),!C||C<Math.abs(y)?(C=y,m=T/4):m=T/(2*Math.PI)*Math.asin(y/C),-(C*Math.pow(2,10*(x-=1))*Math.sin((x*E-m)*(2*Math.PI)/T))+_)},ElasticEaseOut(x,_,y,E,C,T){let m=0;return x===0?_:(x/=E)===1?_+y:(T||(T=E*.3),!C||C<Math.abs(y)?(C=y,m=T/4):m=T/(2*Math.PI)*Math.asin(y/C),C*Math.pow(2,-10*x)*Math.sin((x*E-m)*(2*Math.PI)/T)+y+_)},ElasticEaseInOut(x,_,y,E,C,T){let m=0;return x===0?_:(x/=E/2)===2?_+y:(T||(T=E*(.3*1.5)),!C||C<Math.abs(y)?(C=y,m=T/4):m=T/(2*Math.PI)*Math.asin(y/C),x<1?-.5*(C*Math.pow(2,10*(x-=1))*Math.sin((x*E-m)*(2*Math.PI)/T))+_:C*Math.pow(2,-10*(x-=1))*Math.sin((x*E-m)*(2*Math.PI)/T)*.5+y+_)},BounceEaseOut(x,_,y,E){return(x/=E)<1/2.75?y*(7.5625*x*x)+_:x<2/2.75?y*(7.5625*(x-=1.5/2.75)*x+.75)+_:x<2.5/2.75?y*(7.5625*(x-=2.25/2.75)*x+.9375)+_:y*(7.5625*(x-=2.625/2.75)*x+.984375)+_},BounceEaseIn(x,_,y,E){return y-t.Easings.BounceEaseOut(E-x,0,y,E)+_},BounceEaseInOut(x,_,y,E){return x<E/2?t.Easings.BounceEaseIn(x*2,0,y,E)*.5+_:t.Easings.BounceEaseOut(x*2-E,0,y,E)*.5+y*.5+_},EaseIn(x,_,y,E){return y*(x/=E)*x+_},EaseOut(x,_,y,E){return-y*(x/=E)*(x-2)+_},EaseInOut(x,_,y,E){return(x/=E/2)<1?y/2*x*x+_:-y/2*(--x*(x-2)-1)+_},StrongEaseIn(x,_,y,E){return y*(x/=E)*x*x*x*x+_},StrongEaseOut(x,_,y,E){return y*((x=x/E-1)*x*x*x*x+1)+_},StrongEaseInOut(x,_,y,E){return(x/=E/2)<1?y/2*x*x*x*x*x+_:y/2*((x-=2)*x*x*x*x+2)+_},Linear(x,_,y,E){return y*x/E+_}}})(by);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=Ze,r=Vt,n=Ut,i=js,a=Wy,s=i0,u=mh,c=pl,f=ph,d=dr,v=gl,g=by,x=ra,_=vi;t.Konva=r.Util._assign(e.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:i.Container,Stage:a.Stage,stages:a.stages,Layer:s.Layer,FastLayer:u.FastLayer,Group:c.Group,DD:f.DD,Shape:d.Shape,shapes:d.shapes,Animation:v.Animation,Tween:g.Tween,Easings:g.Easings,Context:x.Context,Canvas:_.Canvas}),t.default=t.Konva})(Nf);var vh={};Object.defineProperty(vh,"__esModule",{value:!0});vh.Arc=void 0;const xh=nt,C7=dr,s4=Ze,_h=je,k7=Ze;class ga extends C7.Shape{_sceneFunc(e){const r=s4.Konva.getAngle(this.angle()),n=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,r,n),e.arc(0,0,this.innerRadius(),r,0,!n),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),r=this.outerRadius(),n=this.clockwise(),i=s4.Konva.getAngle(n?360-this.angle():this.angle()),a=Math.cos(Math.min(i,Math.PI)),s=1,u=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),c=Math.sin(Math.min(i,Math.PI/2)),f=a*(a>0?e:r),d=s*r,v=u*(u>0?e:r),g=c*(c>0?r:e);return{x:f,y:n?-1*g:v,width:d-f,height:g-v}}}vh.Arc=ga;ga.prototype._centroid=!0;ga.prototype.className="Arc";ga.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,k7._registerNode)(ga);xh.Factory.addGetterSetter(ga,"innerRadius",0,(0,_h.getNumberValidator)());xh.Factory.addGetterSetter(ga,"outerRadius",0,(0,_h.getNumberValidator)());xh.Factory.addGetterSetter(ga,"angle",0,(0,_h.getNumberValidator)());xh.Factory.addGetterSetter(ga,"clockwise",!1,(0,_h.getBooleanValidator)());var yh={},a0={};Object.defineProperty(a0,"__esModule",{value:!0});a0.Line=void 0;const Sh=nt,A7=Ze,F7=dr,Xy=je;function gg(t,e,r,n,i,a,s){const u=Math.sqrt(Math.pow(r-t,2)+Math.pow(n-e,2)),c=Math.sqrt(Math.pow(i-r,2)+Math.pow(a-n,2)),f=s*u/(u+c),d=s*c/(u+c),v=r-f*(i-t),g=n-f*(a-e),x=r+d*(i-t),_=n+d*(a-e);return[v,g,x,_]}function o4(t,e){const r=t.length,n=[];for(let i=2;i<r-2;i+=2){const a=gg(t[i-2],t[i-1],t[i],t[i+1],t[i+2],t[i+3],e);isNaN(a[0])||(n.push(a[0]),n.push(a[1]),n.push(t[i]),n.push(t[i+1]),n.push(a[2]),n.push(a[3]))}return n}class is extends F7.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){const r=this.points(),n=r.length,i=this.tension(),a=this.closed(),s=this.bezier();if(!n)return;let u=0;if(e.beginPath(),e.moveTo(r[0],r[1]),i!==0&&n>4){const c=this.getTensionPoints(),f=c.length;for(u=a?0:4,a||e.quadraticCurveTo(c[0],c[1],c[2],c[3]);u<f-2;)e.bezierCurveTo(c[u++],c[u++],c[u++],c[u++],c[u++],c[u++]);a||e.quadraticCurveTo(c[f-2],c[f-1],r[n-2],r[n-1])}else if(s)for(u=2;u<n;)e.bezierCurveTo(r[u++],r[u++],r[u++],r[u++],r[u++],r[u++]);else for(u=2;u<n;u+=2)e.lineTo(r[u],r[u+1]);a?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():o4(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),r=e.length,n=this.tension(),i=gg(e[r-2],e[r-1],e[0],e[1],e[2],e[3],n),a=gg(e[r-4],e[r-3],e[r-2],e[r-1],e[0],e[1],n),s=o4(e,n);return[i[2],i[3]].concat(s).concat([a[0],a[1],e[r-2],e[r-1],a[2],a[3],i[0],i[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let r=e[0],n=e[0],i=e[1],a=e[1],s,u;for(let c=0;c<e.length/2;c++)s=e[c*2],u=e[c*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,u),a=Math.max(a,u);return{x:r,y:i,width:n-r,height:a-i}}}a0.Line=is;is.prototype.className="Line";is.prototype._attrsAffectingSize=["points","bezier","tension"];(0,A7._registerNode)(is);Sh.Factory.addGetterSetter(is,"closed",!1);Sh.Factory.addGetterSetter(is,"bezier",!1);Sh.Factory.addGetterSetter(is,"tension",0,(0,Xy.getNumberValidator)());Sh.Factory.addGetterSetter(is,"points",[],(0,Xy.getNumberArrayValidator)());var ml={},Ky={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(s,u,c)=>{let f,d;const g=c/2;f=0;for(let x=0;x<20;x++)d=g*t.tValues[20][x]+g,f+=t.cValues[20][x]*n(s,u,d);return g*f};t.getCubicArcLength=e;const r=(s,u,c)=>{c===void 0&&(c=1);const f=s[0]-2*s[1]+s[2],d=u[0]-2*u[1]+u[2],v=2*s[1]-2*s[0],g=2*u[1]-2*u[0],x=4*(f*f+d*d),_=4*(f*v+d*g),y=v*v+g*g;if(x===0)return c*Math.sqrt(Math.pow(s[2]-s[0],2)+Math.pow(u[2]-u[0],2));const E=_/(2*x),C=y/x,T=c+E,m=C-E*E,w=T*T+m>0?Math.sqrt(T*T+m):0,F=E*E+m>0?Math.sqrt(E*E+m):0,R=E+Math.sqrt(E*E+m)!==0?m*Math.log(Math.abs((T+w)/(E+F))):0;return Math.sqrt(x)/2*(T*w-E*F+R)};t.getQuadraticArcLength=r;function n(s,u,c){const f=i(1,c,s),d=i(1,c,u),v=f*f+d*d;return Math.sqrt(v)}const i=(s,u,c)=>{const f=c.length-1;let d,v;if(f===0)return 0;if(s===0){v=0;for(let g=0;g<=f;g++)v+=t.binomialCoefficients[f][g]*Math.pow(1-u,f-g)*Math.pow(u,g)*c[g];return v}else{d=new Array(f);for(let g=0;g<f;g++)d[g]=f*(c[g+1]-c[g]);return i(s-1,u,d)}},a=(s,u,c)=>{let f=1,d=s/u,v=(s-c(d))/u,g=0;for(;f>.001;){const x=c(d+v),_=Math.abs(s-x)/u;if(_<f)f=_,d+=v;else{const y=c(d-v),E=Math.abs(s-y)/u;E<f?(f=E,d-=v):v/=2}if(g++,g>500)break}return d};t.t2length=a})(Ky);Object.defineProperty(ml,"__esModule",{value:!0});ml.Path=void 0;const P7=nt,N7=Ze,R7=dr,wo=Ky;class cr extends R7.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=cr.parsePathData(this.data()),this.pathLength=cr.getPathLength(this.dataArray)}_sceneFunc(e){const r=this.dataArray;e.beginPath();let n=!1;for(let i=0;i<r.length;i++){const a=r[i].command,s=r[i].points;switch(a){case"L":e.lineTo(s[0],s[1]);break;case"M":e.moveTo(s[0],s[1]);break;case"C":e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":e.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":const u=s[0],c=s[1],f=s[2],d=s[3],v=s[4],g=s[5],x=s[6],_=s[7],y=f>d?f:d,E=f>d?1:f/d,C=f>d?d/f:1;e.translate(u,c),e.rotate(x),e.scale(E,C),e.arc(0,0,y,v,v+g,1-_),e.scale(1/E,1/C),e.rotate(-x),e.translate(-u,-c);break;case"z":n=!0,e.closePath();break}}!n&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(c){if(c.command==="A"){const f=c.points[4],d=c.points[5],v=c.points[4]+d;let g=Math.PI/180;if(Math.abs(f-v)<g&&(g=Math.abs(f-v)),d<0)for(let x=f-g;x>v;x-=g){const _=cr.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],x,0);e.push(_.x,_.y)}else for(let x=f+g;x<v;x+=g){const _=cr.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],x,0);e.push(_.x,_.y)}}else if(c.command==="C")for(let f=0;f<=1;f+=.01){const d=cr.getPointOnCubicBezier(f,c.start.x,c.start.y,c.points[0],c.points[1],c.points[2],c.points[3],c.points[4],c.points[5]);e.push(d.x,d.y)}else e=e.concat(c.points)});let r=e[0],n=e[0],i=e[1],a=e[1],s,u;for(let c=0;c<e.length/2;c++)s=e[c*2],u=e[c*2+1],isNaN(s)||(r=Math.min(r,s),n=Math.max(n,s)),isNaN(u)||(i=Math.min(i,u),a=Math.max(a,u));return{x:r,y:i,width:n-r,height:a-i}}getLength(){return this.pathLength}getPointAtLength(e){return cr.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,r,n,i){return Math.sqrt((n-e)*(n-e)+(i-r)*(i-r))}static getPathLength(e){let r=0;for(let n=0;n<e.length;++n)r+=e[n].pathLength;return r}static getPointAtLengthOfDataArray(e,r){let n,i=0,a=r.length;if(!a)return null;for(;i<a&&e>r[i].pathLength;)e-=r[i].pathLength,++i;if(i===a)return n=r[i-1].points.slice(-2),{x:n[0],y:n[1]};if(e<.01)return r[i].command==="M"?(n=r[i].points.slice(0,2),{x:n[0],y:n[1]}):{x:r[i].start.x,y:r[i].start.y};const s=r[i],u=s.points;switch(s.command){case"L":return cr.getPointOnLine(e,s.start.x,s.start.y,u[0],u[1]);case"C":return cr.getPointOnCubicBezier((0,wo.t2length)(e,cr.getPathLength(r),y=>(0,wo.getCubicArcLength)([s.start.x,u[0],u[2],u[4]],[s.start.y,u[1],u[3],u[5]],y)),s.start.x,s.start.y,u[0],u[1],u[2],u[3],u[4],u[5]);case"Q":return cr.getPointOnQuadraticBezier((0,wo.t2length)(e,cr.getPathLength(r),y=>(0,wo.getQuadraticArcLength)([s.start.x,u[0],u[2]],[s.start.y,u[1],u[3]],y)),s.start.x,s.start.y,u[0],u[1],u[2],u[3]);case"A":const c=u[0],f=u[1],d=u[2],v=u[3],g=u[5],x=u[6];let _=u[4];return _+=g*e/s.pathLength,cr.getPointOnEllipticalArc(c,f,d,v,_,x)}return null}static getPointOnLine(e,r,n,i,a,s,u){s=s??r,u=u??n;const c=this.getLineLength(r,n,i,a);if(c<1e-10)return{x:r,y:n};if(i===r)return{x:s,y:u+(a>n?e:-e)};const f=(a-n)/(i-r),d=Math.sqrt(e*e/(1+f*f))*(i<r?-1:1),v=f*d;if(Math.abs(u-n-f*(s-r))<1e-10)return{x:s+d,y:u+v};const g=((s-r)*(i-r)+(u-n)*(a-n))/(c*c),x=r+g*(i-r),_=n+g*(a-n),y=this.getLineLength(s,u,x,_),E=Math.sqrt(e*e-y*y),C=Math.sqrt(E*E/(1+f*f))*(i<r?-1:1),T=f*C;return{x:x+C,y:_+T}}static getPointOnCubicBezier(e,r,n,i,a,s,u,c,f){function d(E){return E*E*E}function v(E){return 3*E*E*(1-E)}function g(E){return 3*E*(1-E)*(1-E)}function x(E){return(1-E)*(1-E)*(1-E)}const _=c*d(e)+s*v(e)+i*g(e)+r*x(e),y=f*d(e)+u*v(e)+a*g(e)+n*x(e);return{x:_,y}}static getPointOnQuadraticBezier(e,r,n,i,a,s,u){function c(x){return x*x}function f(x){return 2*x*(1-x)}function d(x){return(1-x)*(1-x)}const v=s*c(e)+i*f(e)+r*d(e),g=u*c(e)+a*f(e)+n*d(e);return{x:v,y:g}}static getPointOnEllipticalArc(e,r,n,i,a,s){const u=Math.cos(s),c=Math.sin(s),f={x:n*Math.cos(a),y:i*Math.sin(a)};return{x:e+(f.x*u-f.y*c),y:r+(f.x*c+f.y*u)}}static parsePathData(e){if(!e)return[];let r=e;const n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];r=r.replace(new RegExp(" ","g"),",");for(let v=0;v<n.length;v++)r=r.replace(new RegExp(n[v],"g"),"|"+n[v]);const i=r.split("|"),a=[],s=[];let u=0,c=0;const f=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let d;for(let v=1;v<i.length;v++){let g=i[v],x=g.charAt(0);for(g=g.slice(1),s.length=0;d=f.exec(g);)s.push(d[0]);const _=[];for(let y=0,E=s.length;y<E;y++){if(s[y]==="00"){_.push(0,0);continue}const C=parseFloat(s[y]);isNaN(C)?_.push(0):_.push(C)}for(;_.length>0&&!isNaN(_[0]);){let y="",E=[];const C=u,T=c;let m,w,F,R,N,A,L,O,H,j;switch(x){case"l":u+=_.shift(),c+=_.shift(),y="L",E.push(u,c);break;case"L":u=_.shift(),c=_.shift(),E.push(u,c);break;case"m":const q=_.shift(),ye=_.shift();if(u+=q,c+=ye,y="M",a.length>2&&a[a.length-1].command==="z"){for(let de=a.length-2;de>=0;de--)if(a[de].command==="M"){u=a[de].points[0]+q,c=a[de].points[1]+ye;break}}E.push(u,c),x="l";break;case"M":u=_.shift(),c=_.shift(),y="M",E.push(u,c),x="L";break;case"h":u+=_.shift(),y="L",E.push(u,c);break;case"H":u=_.shift(),y="L",E.push(u,c);break;case"v":c+=_.shift(),y="L",E.push(u,c);break;case"V":c=_.shift(),y="L",E.push(u,c);break;case"C":E.push(_.shift(),_.shift(),_.shift(),_.shift()),u=_.shift(),c=_.shift(),E.push(u,c);break;case"c":E.push(u+_.shift(),c+_.shift(),u+_.shift(),c+_.shift()),u+=_.shift(),c+=_.shift(),y="C",E.push(u,c);break;case"S":w=u,F=c,m=a[a.length-1],m.command==="C"&&(w=u+(u-m.points[2]),F=c+(c-m.points[3])),E.push(w,F,_.shift(),_.shift()),u=_.shift(),c=_.shift(),y="C",E.push(u,c);break;case"s":w=u,F=c,m=a[a.length-1],m.command==="C"&&(w=u+(u-m.points[2]),F=c+(c-m.points[3])),E.push(w,F,u+_.shift(),c+_.shift()),u+=_.shift(),c+=_.shift(),y="C",E.push(u,c);break;case"Q":E.push(_.shift(),_.shift()),u=_.shift(),c=_.shift(),E.push(u,c);break;case"q":E.push(u+_.shift(),c+_.shift()),u+=_.shift(),c+=_.shift(),y="Q",E.push(u,c);break;case"T":w=u,F=c,m=a[a.length-1],m.command==="Q"&&(w=u+(u-m.points[0]),F=c+(c-m.points[1])),u=_.shift(),c=_.shift(),y="Q",E.push(w,F,u,c);break;case"t":w=u,F=c,m=a[a.length-1],m.command==="Q"&&(w=u+(u-m.points[0]),F=c+(c-m.points[1])),u+=_.shift(),c+=_.shift(),y="Q",E.push(w,F,u,c);break;case"A":R=_.shift(),N=_.shift(),A=_.shift(),L=_.shift(),O=_.shift(),H=u,j=c,u=_.shift(),c=_.shift(),y="A",E=this.convertEndpointToCenterParameterization(H,j,u,c,L,O,R,N,A);break;case"a":R=_.shift(),N=_.shift(),A=_.shift(),L=_.shift(),O=_.shift(),H=u,j=c,u+=_.shift(),c+=_.shift(),y="A",E=this.convertEndpointToCenterParameterization(H,j,u,c,L,O,R,N,A);break}a.push({command:y||x,points:E,start:{x:C,y:T},pathLength:this.calcLength(C,T,y||x,E)})}(x==="z"||x==="Z")&&a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(e,r,n,i){let a,s,u,c;const f=cr;switch(n){case"L":return f.getLineLength(e,r,i[0],i[1]);case"C":return(0,wo.getCubicArcLength)([e,i[0],i[2],i[4]],[r,i[1],i[3],i[5]],1);case"Q":return(0,wo.getQuadraticArcLength)([e,i[0],i[2]],[r,i[1],i[3]],1);case"A":a=0;const d=i[4],v=i[5],g=i[4]+v;let x=Math.PI/180;if(Math.abs(d-g)<x&&(x=Math.abs(d-g)),s=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],d,0),v<0)for(c=d-x;c>g;c-=x)u=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),a+=f.getLineLength(s.x,s.y,u.x,u.y),s=u;else for(c=d+x;c<g;c+=x)u=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),a+=f.getLineLength(s.x,s.y,u.x,u.y),s=u;return u=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],g,0),a+=f.getLineLength(s.x,s.y,u.x,u.y),a}return 0}static convertEndpointToCenterParameterization(e,r,n,i,a,s,u,c,f){const d=f*(Math.PI/180),v=Math.cos(d)*(e-n)/2+Math.sin(d)*(r-i)/2,g=-1*Math.sin(d)*(e-n)/2+Math.cos(d)*(r-i)/2,x=v*v/(u*u)+g*g/(c*c);x>1&&(u*=Math.sqrt(x),c*=Math.sqrt(x));let _=Math.sqrt((u*u*(c*c)-u*u*(g*g)-c*c*(v*v))/(u*u*(g*g)+c*c*(v*v)));a===s&&(_*=-1),isNaN(_)&&(_=0);const y=_*u*g/c,E=_*-c*v/u,C=(e+n)/2+Math.cos(d)*y-Math.sin(d)*E,T=(r+i)/2+Math.sin(d)*y+Math.cos(d)*E,m=function(O){return Math.sqrt(O[0]*O[0]+O[1]*O[1])},w=function(O,H){return(O[0]*H[0]+O[1]*H[1])/(m(O)*m(H))},F=function(O,H){return(O[0]*H[1]<O[1]*H[0]?-1:1)*Math.acos(w(O,H))},R=F([1,0],[(v-y)/u,(g-E)/c]),N=[(v-y)/u,(g-E)/c],A=[(-1*v-y)/u,(-1*g-E)/c];let L=F(N,A);return w(N,A)<=-1&&(L=Math.PI),w(N,A)>=1&&(L=0),s===0&&L>0&&(L=L-2*Math.PI),s===1&&L<0&&(L=L+2*Math.PI),[C,T,u,c,R,L,d,s]}}ml.Path=cr;cr.prototype.className="Path";cr.prototype._attrsAffectingSize=["data"];(0,N7._registerNode)(cr);P7.Factory.addGetterSetter(cr,"data");Object.defineProperty(yh,"__esModule",{value:!0});yh.Arrow=void 0;const wh=nt,O7=a0,Yy=je,I7=Ze,l4=ml;class bs extends O7.Line{_sceneFunc(e){super._sceneFunc(e);const r=Math.PI*2,n=this.points();let i=n;const a=this.tension()!==0&&n.length>4;a&&(i=this.getTensionPoints());const s=this.pointerLength(),u=n.length;let c,f;if(a){const g=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],n[u-2],n[u-1]],x=l4.Path.calcLength(i[i.length-4],i[i.length-3],"C",g),_=l4.Path.getPointOnQuadraticBezier(Math.min(1,1-s/x),g[0],g[1],g[2],g[3],g[4],g[5]);c=n[u-2]-_.x,f=n[u-1]-_.y}else c=n[u-2]-n[u-4],f=n[u-1]-n[u-3];const d=(Math.atan2(f,c)+r)%r,v=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(n[u-2],n[u-1]),e.rotate(d),e.moveTo(0,0),e.lineTo(-s,v/2),e.lineTo(-s,-v/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(n[0],n[1]),a?(c=(i[0]+i[2])/2-n[0],f=(i[1]+i[3])/2-n[1]):(c=n[2]-n[0],f=n[3]-n[1]),e.rotate((Math.atan2(-f,-c)+r)%r),e.moveTo(0,0),e.lineTo(-s,v/2),e.lineTo(-s,-v/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const r=this.dashEnabled();r&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),r&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),r=this.pointerWidth()/2;return{x:e.x,y:e.y-r,width:e.width,height:e.height+r*2}}}yh.Arrow=bs;bs.prototype.className="Arrow";(0,I7._registerNode)(bs);wh.Factory.addGetterSetter(bs,"pointerLength",10,(0,Yy.getNumberValidator)());wh.Factory.addGetterSetter(bs,"pointerWidth",10,(0,Yy.getNumberValidator)());wh.Factory.addGetterSetter(bs,"pointerAtBeginning",!1);wh.Factory.addGetterSetter(bs,"pointerAtEnding",!0);var Eh={};Object.defineProperty(Eh,"__esModule",{value:!0});Eh.Circle=void 0;const D7=nt,L7=dr,M7=je,B7=Ze;class vl extends L7.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}Eh.Circle=vl;vl.prototype._centroid=!0;vl.prototype.className="Circle";vl.prototype._attrsAffectingSize=["radius"];(0,B7._registerNode)(vl);D7.Factory.addGetterSetter(vl,"radius",0,(0,M7.getNumberValidator)());var Th={};Object.defineProperty(Th,"__esModule",{value:!0});Th.Ellipse=void 0;const A2=nt,U7=dr,$y=je,z7=Ze;class as extends U7.Shape{_sceneFunc(e){const r=this.radiusX(),n=this.radiusY();e.beginPath(),e.save(),r!==n&&e.scale(1,n/r),e.arc(0,0,r,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}Th.Ellipse=as;as.prototype.className="Ellipse";as.prototype._centroid=!0;as.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,z7._registerNode)(as);A2.Factory.addComponentsGetterSetter(as,"radius",["x","y"]);A2.Factory.addGetterSetter(as,"radiusX",0,(0,$y.getNumberValidator)());A2.Factory.addGetterSetter(as,"radiusY",0,(0,$y.getNumberValidator)());var Ch={};Object.defineProperty(Ch,"__esModule",{value:!0});Ch.Image=void 0;const np=Vt,Xs=nt,G7=dr,W7=Ze,s0=je;let zi=class Qy extends G7.Shape{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",r=>{this._removeImageLoad(r.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),r=this.hasShadow();return e&&r?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const r=this.getWidth(),n=this.getHeight(),i=this.cornerRadius(),a=this.attrs.image;let s;if(a){const u=this.attrs.cropWidth,c=this.attrs.cropHeight;u&&c?s=[a,this.cropX(),this.cropY(),u,c,0,0,r,n]:s=[a,0,0,r,n]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?np.Util.drawRoundedRectPath(e,r,n,i):e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)),a&&(i&&e.clip(),e.drawImage.apply(e,s))}_hitFunc(e){const r=this.width(),n=this.height(),i=this.cornerRadius();e.beginPath(),i?np.Util.drawRoundedRectPath(e,r,n,i):e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,r;return(e=this.attrs.width)!==null&&e!==void 0?e:(r=this.image())===null||r===void 0?void 0:r.width}getHeight(){var e,r;return(e=this.attrs.height)!==null&&e!==void 0?e:(r=this.image())===null||r===void 0?void 0:r.height}static fromURL(e,r,n=null){const i=np.Util.createImageElement();i.onload=function(){const a=new Qy({image:i});r(a)},i.onerror=n,i.crossOrigin="Anonymous",i.src=e}};Ch.Image=zi;zi.prototype.className="Image";(0,W7._registerNode)(zi);Xs.Factory.addGetterSetter(zi,"cornerRadius",0,(0,s0.getNumberOrArrayOfNumbersValidator)(4));Xs.Factory.addGetterSetter(zi,"image");Xs.Factory.addComponentsGetterSetter(zi,"crop",["x","y","width","height"]);Xs.Factory.addGetterSetter(zi,"cropX",0,(0,s0.getNumberValidator)());Xs.Factory.addGetterSetter(zi,"cropY",0,(0,s0.getNumberValidator)());Xs.Factory.addGetterSetter(zi,"cropWidth",0,(0,s0.getNumberValidator)());Xs.Factory.addGetterSetter(zi,"cropHeight",0,(0,s0.getNumberValidator)());var al={};Object.defineProperty(al,"__esModule",{value:!0});al.Tag=al.Label=void 0;const kh=nt,H7=dr,j7=pl,F2=je,qy=Ze,Jy=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],V7="Change.konva",b7="none",mg="up",vg="right",xg="down",_g="left",X7=Jy.length;class P2 extends j7.Group{constructor(e){super(e),this.on("add.konva",function(r){this._addListeners(r.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let r=this,n;const i=function(){r._sync()};for(n=0;n<X7;n++)e.on(Jy[n]+V7,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),r=this.getTag(),n,i,a,s,u,c,f;if(e&&r){switch(n=e.width(),i=e.height(),a=r.pointerDirection(),s=r.pointerWidth(),f=r.pointerHeight(),u=0,c=0,a){case mg:u=n/2,c=-1*f;break;case vg:u=n+s,c=i/2;break;case xg:u=n/2,c=i+f;break;case _g:u=-1*s,c=i/2;break}r.setAttrs({x:-1*u,y:-1*c,width:n,height:i}),e.setAttrs({x:-1*u,y:-1*c})}}}al.Label=P2;P2.prototype.className="Label";(0,qy._registerNode)(P2);class Ks extends H7.Shape{_sceneFunc(e){const r=this.width(),n=this.height(),i=this.pointerDirection(),a=this.pointerWidth(),s=this.pointerHeight(),u=this.cornerRadius();let c=0,f=0,d=0,v=0;typeof u=="number"?c=f=d=v=Math.min(u,r/2,n/2):(c=Math.min(u[0]||0,r/2,n/2),f=Math.min(u[1]||0,r/2,n/2),v=Math.min(u[2]||0,r/2,n/2),d=Math.min(u[3]||0,r/2,n/2)),e.beginPath(),e.moveTo(c,0),i===mg&&(e.lineTo((r-a)/2,0),e.lineTo(r/2,-1*s),e.lineTo((r+a)/2,0)),e.lineTo(r-f,0),e.arc(r-f,f,f,Math.PI*3/2,0,!1),i===vg&&(e.lineTo(r,(n-s)/2),e.lineTo(r+a,n/2),e.lineTo(r,(n+s)/2)),e.lineTo(r,n-v),e.arc(r-v,n-v,v,0,Math.PI/2,!1),i===xg&&(e.lineTo((r+a)/2,n),e.lineTo(r/2,n+s),e.lineTo((r-a)/2,n)),e.lineTo(d,n),e.arc(d,n-d,d,Math.PI/2,Math.PI,!1),i===_g&&(e.lineTo(0,(n+s)/2),e.lineTo(-1*a,n/2),e.lineTo(0,(n-s)/2)),e.lineTo(0,c),e.arc(c,c,c,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,r=0,n=this.pointerWidth(),i=this.pointerHeight(),a=this.pointerDirection(),s=this.width(),u=this.height();return a===mg?(r-=i,u+=i):a===xg?u+=i:a===_g?(e-=n*1.5,s+=n):a===vg&&(s+=n*1.5),{x:e,y:r,width:s,height:u}}}al.Tag=Ks;Ks.prototype.className="Tag";(0,qy._registerNode)(Ks);kh.Factory.addGetterSetter(Ks,"pointerDirection",b7);kh.Factory.addGetterSetter(Ks,"pointerWidth",0,(0,F2.getNumberValidator)());kh.Factory.addGetterSetter(Ks,"pointerHeight",0,(0,F2.getNumberValidator)());kh.Factory.addGetterSetter(Ks,"cornerRadius",0,(0,F2.getNumberOrArrayOfNumbersValidator)(4));var o0={};Object.defineProperty(o0,"__esModule",{value:!0});o0.Rect=void 0;const K7=nt,Y7=dr,$7=Ze,Q7=Vt,q7=je;let Ah=class extends Y7.Shape{_sceneFunc(e){const r=this.cornerRadius(),n=this.width(),i=this.height();e.beginPath(),r?Q7.Util.drawRoundedRectPath(e,n,i,r):e.rect(0,0,n,i),e.closePath(),e.fillStrokeShape(this)}};o0.Rect=Ah;Ah.prototype.className="Rect";(0,$7._registerNode)(Ah);K7.Factory.addGetterSetter(Ah,"cornerRadius",0,(0,q7.getNumberOrArrayOfNumbersValidator)(4));var Fh={};Object.defineProperty(Fh,"__esModule",{value:!0});Fh.RegularPolygon=void 0;const Zy=nt,J7=dr,e5=je,Z7=Ze;class Ys extends J7.Shape{_sceneFunc(e){const r=this._getPoints();e.beginPath(),e.moveTo(r[0].x,r[0].y);for(let n=1;n<r.length;n++)e.lineTo(r[n].x,r[n].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,r=this.attrs.radius||0,n=[];for(let i=0;i<e;i++)n.push({x:r*Math.sin(i*2*Math.PI/e),y:-1*r*Math.cos(i*2*Math.PI/e)});return n}getSelfRect(){const e=this._getPoints();let r=e[0].x,n=e[0].y,i=e[0].x,a=e[0].y;return e.forEach(s=>{r=Math.min(r,s.x),n=Math.max(n,s.x),i=Math.min(i,s.y),a=Math.max(a,s.y)}),{x:r,y:i,width:n-r,height:a-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}Fh.RegularPolygon=Ys;Ys.prototype.className="RegularPolygon";Ys.prototype._centroid=!0;Ys.prototype._attrsAffectingSize=["radius"];(0,Z7._registerNode)(Ys);Zy.Factory.addGetterSetter(Ys,"radius",0,(0,e5.getNumberValidator)());Zy.Factory.addGetterSetter(Ys,"sides",0,(0,e5.getNumberValidator)());var Ph={};Object.defineProperty(Ph,"__esModule",{value:!0});Ph.Ring=void 0;const t5=nt,eE=dr,r5=je,tE=Ze,u4=Math.PI*2;class $s extends eE.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,u4,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),u4,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Ph.Ring=$s;$s.prototype.className="Ring";$s.prototype._centroid=!0;$s.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,tE._registerNode)($s);t5.Factory.addGetterSetter($s,"innerRadius",0,(0,r5.getNumberValidator)());t5.Factory.addGetterSetter($s,"outerRadius",0,(0,r5.getNumberValidator)());var Nh={};Object.defineProperty(Nh,"__esModule",{value:!0});Nh.Sprite=void 0;const Qs=nt,rE=dr,nE=gl,n5=je,iE=Ze;class Gi extends rE.Shape{constructor(e){super(e),this._updated=!0,this.anim=new nE.Animation(()=>{const r=this._updated;return this._updated=!1,r}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),u=a[i+0],c=a[i+1],f=a[i+2],d=a[i+3],v=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,f,d),e.closePath(),e.fillStrokeShape(this)),v)if(s){const g=s[r],x=n*2;e.drawImage(v,u,c,f,d,g[x+0],g[x+1],f,d)}else e.drawImage(v,u,c,f,d,0,0,f,d)}_hitFunc(e){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),u=a[i+2],c=a[i+3];if(e.beginPath(),s){const f=s[r],d=n*2;e.rect(f[d+0],f[d+1],u,c)}else e.rect(0,0,u,c);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),r=this.animation(),n=this.animations(),i=n[r],a=i.length/4;e<a-1?this.frameIndex(e+1):this.frameIndex(0)}}Nh.Sprite=Gi;Gi.prototype.className="Sprite";(0,iE._registerNode)(Gi);Qs.Factory.addGetterSetter(Gi,"animation");Qs.Factory.addGetterSetter(Gi,"animations");Qs.Factory.addGetterSetter(Gi,"frameOffsets");Qs.Factory.addGetterSetter(Gi,"image");Qs.Factory.addGetterSetter(Gi,"frameIndex",0,(0,n5.getNumberValidator)());Qs.Factory.addGetterSetter(Gi,"frameRate",17,(0,n5.getNumberValidator)());Qs.Factory.backCompat(Gi,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Rh={};Object.defineProperty(Rh,"__esModule",{value:!0});Rh.Star=void 0;const N2=nt,aE=dr,R2=je,sE=Ze;class ss extends aE.Shape{_sceneFunc(e){const r=this.innerRadius(),n=this.outerRadius(),i=this.numPoints();e.beginPath(),e.moveTo(0,0-n);for(let a=1;a<i*2;a++){const s=a%2===0?n:r,u=s*Math.sin(a*Math.PI/i),c=-1*s*Math.cos(a*Math.PI/i);e.lineTo(u,c)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Rh.Star=ss;ss.prototype.className="Star";ss.prototype._centroid=!0;ss.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,sE._registerNode)(ss);N2.Factory.addGetterSetter(ss,"numPoints",5,(0,R2.getNumberValidator)());N2.Factory.addGetterSetter(ss,"innerRadius",0,(0,R2.getNumberValidator)());N2.Factory.addGetterSetter(ss,"outerRadius",0,(0,R2.getNumberValidator)());var xl={};Object.defineProperty(xl,"__esModule",{value:!0});xl.Text=void 0;xl.stringToArray=Cs;const yg=Vt,qr=nt,oE=dr,ip=Ze,os=je,lE=Ze;function Cs(t){return[...t].reduce((e,r,n,i)=>{if(new RegExp("\\p{Emoji}","u").test(r)){const a=i[n+1];a&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(a)?(e.push(r+a),i[n+1]=""):e.push(r)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(r+(i[n+1]||""))?e.push(r+i[n+1]):n>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(r)?e[e.length-1]+=r:r&&e.push(r);return e},[])}const Eo="auto",uE="center",i5="inherit",Jl="justify",cE="Change.konva",fE="2d",c4="-",a5="left",hE="text",dE="Text",pE="top",gE="bottom",f4="middle",s5="normal",mE="px ",Dc=" ",vE="right",h4="rtl",xE="word",_E="char",d4="none",ap="…",o5=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],yE=o5.length;function SE(t){return t.split(",").map(e=>{e=e.trim();const r=e.indexOf(" ")>=0,n=e.indexOf('"')>=0||e.indexOf("'")>=0;return r&&!n&&(e=`"${e}"`),e}).join(", ")}let Lc;function sp(){return Lc||(Lc=yg.Util.createCanvasElement().getContext(fE),Lc)}function wE(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function EE(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function TE(t){return t=t||{},!t.fillLinearGradientColorStops&&!t.fillRadialGradientColorStops&&!t.fillPatternImage&&(t.fill=t.fill||"black"),t}let $t=class extends oE.Shape{constructor(e){super(TE(e)),this._partialTextX=0,this._partialTextY=0;for(let r=0;r<yE;r++)this.on(o5[r]+cE,this._setTextData);this._setTextData()}_sceneFunc(e){const r=this.textArr,n=r.length;if(!this.text())return;let i=this.padding(),a=this.fontSize(),s=this.lineHeight()*a,u=this.verticalAlign(),c=this.direction(),f=0,d=this.align(),v=this.getWidth(),g=this.letterSpacing(),x=this.fill(),_=this.textDecoration(),y=_.indexOf("underline")!==-1,E=_.indexOf("line-through")!==-1,C;c=c===i5?e.direction:c;let T=s/2,m=f4;if(ip.Konva._fixTextRendering){const w=this.measureSize("M");m="alphabetic",T=(w.fontBoundingBoxAscent-w.fontBoundingBoxDescent)/2+s/2}for(c===h4&&e.setAttr("direction",c),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",m),e.setAttr("textAlign",a5),u===f4?f=(this.getHeight()-n*s-i*2)/2:u===gE&&(f=this.getHeight()-n*s-i*2),e.translate(i,f+i),C=0;C<n;C++){let w=0,F=0;const R=r[C],N=R.text,A=R.width,L=R.lastInParagraph;if(e.save(),d===vE?w+=v-A-i*2:d===uE&&(w+=(v-A-i*2)/2),y){e.save(),e.beginPath();const O=ip.Konva._fixTextRendering?Math.round(a/4):Math.round(a/2),H=w,j=T+F+O;e.moveTo(H,j);const q=d===Jl&&!L?v-i*2:A;e.lineTo(H+Math.round(q),j),e.lineWidth=a/15;const ye=this._getLinearGradient();e.strokeStyle=ye||x,e.stroke(),e.restore()}if(E){e.save(),e.beginPath();const O=ip.Konva._fixTextRendering?-Math.round(a/4):0;e.moveTo(w,T+F+O);const H=d===Jl&&!L?v-i*2:A;e.lineTo(w+Math.round(H),T+F+O),e.lineWidth=a/15;const j=this._getLinearGradient();e.strokeStyle=j||x,e.stroke(),e.restore()}if(c!==h4&&(g!==0||d===Jl)){const O=N.split(" ").length-1,H=Cs(N);for(let j=0;j<H.length;j++){const q=H[j];q===" "&&!L&&d===Jl&&(w+=(v-i*2-A)/O),this._partialTextX=w,this._partialTextY=T+F,this._partialText=q,e.fillStrokeShape(this),w+=this.measureSize(q).width+g}}else g!==0&&e.setAttr("letterSpacing",`${g}px`),this._partialTextX=w,this._partialTextY=T+F,this._partialText=N,e.fillStrokeShape(this);e.restore(),n>1&&(T+=s)}}_hitFunc(e){const r=this.getWidth(),n=this.getHeight();e.beginPath(),e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)}setText(e){const r=yg.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(hE,r),this}getWidth(){return this.attrs.width===Eo||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Eo||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return yg.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var r,n,i,a,s,u,c,f,d,v,g;let x=sp(),_=this.fontSize(),y;x.save(),x.font=this._getContextFont(),y=x.measureText(e),x.restore();const E=_/100;return{actualBoundingBoxAscent:(r=y.actualBoundingBoxAscent)!==null&&r!==void 0?r:71.58203125*E,actualBoundingBoxDescent:(n=y.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(i=y.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*E,actualBoundingBoxRight:(a=y.actualBoundingBoxRight)!==null&&a!==void 0?a:75.732421875*E,alphabeticBaseline:(s=y.alphabeticBaseline)!==null&&s!==void 0?s:0,emHeightAscent:(u=y.emHeightAscent)!==null&&u!==void 0?u:100*E,emHeightDescent:(c=y.emHeightDescent)!==null&&c!==void 0?c:-20*E,fontBoundingBoxAscent:(f=y.fontBoundingBoxAscent)!==null&&f!==void 0?f:91*E,fontBoundingBoxDescent:(d=y.fontBoundingBoxDescent)!==null&&d!==void 0?d:21*E,hangingBaseline:(v=y.hangingBaseline)!==null&&v!==void 0?v:72.80000305175781*E,ideographicBaseline:(g=y.ideographicBaseline)!==null&&g!==void 0?g:-21*E,width:y.width,height:_}}_getContextFont(){return this.fontStyle()+Dc+this.fontVariant()+Dc+(this.fontSize()+mE)+SE(this.fontFamily())}_addTextLine(e){this.align()===Jl&&(e=e.trim());const n=this._getTextWidth(e);return this.textArr.push({text:e,width:n,lastInParagraph:!1})}_getTextWidth(e){const r=this.letterSpacing(),n=e.length;return sp().measureText(e).width+r*n}_setTextData(){let e=this.text().split(`
`),r=+this.fontSize(),n=0,i=this.lineHeight()*r,a=this.attrs.width,s=this.attrs.height,u=a!==Eo&&a!==void 0,c=s!==Eo&&s!==void 0,f=this.padding(),d=a-f*2,v=s-f*2,g=0,x=this.wrap(),_=x!==d4,y=x!==_E&&_,E=this.ellipsis();this.textArr=[],sp().font=this._getContextFont();const C=E?this._getTextWidth(ap):0;for(let T=0,m=e.length;T<m;++T){let w=e[T],F=this._getTextWidth(w);if(u&&F>d)for(;w.length>0;){let R=0,N=Cs(w).length,A="",L=0;for(;R<N;){const O=R+N>>>1,H=Cs(w),j=H.slice(0,O+1).join(""),q=this._getTextWidth(j);(E&&c&&g+i>v?q+C:q)<=d?(R=O+1,A=j,L=q):N=O}if(A){if(y){const j=Cs(w),q=Cs(A),ye=j[q.length],de=ye===Dc||ye===c4;let Ae;if(de&&L<=d)Ae=q.length;else{const Ge=q.lastIndexOf(Dc),ue=q.lastIndexOf(c4);Ae=Math.max(Ge,ue)+1}Ae>0&&(R=Ae,A=j.slice(0,R).join(""),L=this._getTextWidth(A))}if(A=A.trimRight(),this._addTextLine(A),n=Math.max(n,L),g+=i,this._shouldHandleEllipsis(g)){this._tryToAddEllipsisToLastLine();break}if(w=Cs(w).slice(R).join("").trimLeft(),w.length>0&&(F=this._getTextWidth(w),F<=d)){this._addTextLine(w),g+=i,n=Math.max(n,F);break}}else break}else this._addTextLine(w),g+=i,n=Math.max(n,F),this._shouldHandleEllipsis(g)&&T<m-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),c&&g+i>v)break}this.textHeight=r,this.textWidth=n}_shouldHandleEllipsis(e){const r=+this.fontSize(),n=this.lineHeight()*r,i=this.attrs.height,a=i!==Eo&&i!==void 0,s=this.padding(),u=i-s*2;return!(this.wrap()!==d4)||a&&e+n>u}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,r=e!==Eo&&e!==void 0,n=this.padding(),i=e-n*2,a=this.ellipsis(),s=this.textArr[this.textArr.length-1];!s||!a||(r&&(this._getTextWidth(s.text+ap)<i||(s.text=s.text.slice(0,s.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(s.text+ap))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,r=this.hasShadow();return e&&r?!0:super._useBufferCanvas()}};xl.Text=$t;$t.prototype._fillFunc=wE;$t.prototype._strokeFunc=EE;$t.prototype.className=dE;$t.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,lE._registerNode)($t);qr.Factory.overWriteSetter($t,"width",(0,os.getNumberOrAutoValidator)());qr.Factory.overWriteSetter($t,"height",(0,os.getNumberOrAutoValidator)());qr.Factory.addGetterSetter($t,"direction",i5);qr.Factory.addGetterSetter($t,"fontFamily","Arial");qr.Factory.addGetterSetter($t,"fontSize",12,(0,os.getNumberValidator)());qr.Factory.addGetterSetter($t,"fontStyle",s5);qr.Factory.addGetterSetter($t,"fontVariant",s5);qr.Factory.addGetterSetter($t,"padding",0,(0,os.getNumberValidator)());qr.Factory.addGetterSetter($t,"align",a5);qr.Factory.addGetterSetter($t,"verticalAlign",pE);qr.Factory.addGetterSetter($t,"lineHeight",1,(0,os.getNumberValidator)());qr.Factory.addGetterSetter($t,"wrap",xE);qr.Factory.addGetterSetter($t,"ellipsis",!1,(0,os.getBooleanValidator)());qr.Factory.addGetterSetter($t,"letterSpacing",0,(0,os.getNumberValidator)());qr.Factory.addGetterSetter($t,"text","",(0,os.getStringValidator)());qr.Factory.addGetterSetter($t,"textDecoration","");var Oh={};Object.defineProperty(Oh,"__esModule",{value:!0});Oh.TextPath=void 0;const op=Vt,yi=nt,CE=dr,Zl=ml,lp=xl,l5=je,kE=Ze,AE="",u5="normal";function c5(t){t.fillText(this.partialText,0,0)}function f5(t){t.strokeText(this.partialText,0,0)}class pr extends CE.Shape{constructor(e){super(e),this.dummyCanvas=op.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Zl.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const r=this.pathLength;return e-1>r?null:Zl.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=Zl.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const r=this.textDecoration(),n=this.fill(),i=this.fontSize(),a=this.glyphInfo;r==="underline"&&e.beginPath();for(let s=0;s<a.length;s++){e.save();const u=a[s].p0;e.translate(u.x,u.y),e.rotate(a[s].rotation),this.partialText=a[s].text,e.fillStrokeShape(this),r==="underline"&&(s===0&&e.moveTo(0,i/2+1),e.lineTo(i,i/2+1)),e.restore()}r==="underline"&&(e.strokeStyle=n,e.lineWidth=i/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const r=this.glyphInfo;if(r.length>=1){const n=r[0].p0;e.moveTo(n.x,n.y)}for(let n=0;n<r.length;n++){const i=r[n].p1;e.lineTo(i.x,i.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return op.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return lp.Text.prototype.setText.call(this,e)}_getContextFont(){return lp.Text.prototype._getContextFont.call(this)}_getTextSize(e){const n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();const i=n.measureText(e);return n.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const n=this.letterSpacing(),i=this.align(),a=this.kerningFunc(),s=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);let u=0;i==="center"&&(u=Math.max(0,this.pathLength/2-s/2)),i==="right"&&(u=Math.max(0,this.pathLength-s));const c=(0,lp.stringToArray)(this.text());let f=u;for(let d=0;d<c.length;d++){const v=this._getPointAtLength(f);if(!v)return;let g=this._getTextSize(c[d]).width+n;if(c[d]===" "&&i==="justify"){const T=this.text().split(" ").length-1;g+=(this.pathLength-s)/T}const x=this._getPointAtLength(f+g);if(!x)return;const _=Zl.Path.getLineLength(v.x,v.y,x.x,x.y);let y=0;if(a)try{y=a(c[d-1],c[d])*this.fontSize()}catch{y=0}v.x+=y,x.x+=y,this.textWidth+=y;const E=Zl.Path.getPointOnLine(y+_/2,v.x,v.y,x.x,x.y),C=Math.atan2(x.y-v.y,x.x-v.x);this.glyphInfo.push({transposeX:E.x,transposeY:E.y,text:c[d],rotation:C,p0:v,p1:x}),f+=g}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(f){e.push(f.p0.x),e.push(f.p0.y),e.push(f.p1.x),e.push(f.p1.y)});let r=e[0]||0,n=e[0]||0,i=e[1]||0,a=e[1]||0,s,u;for(let f=0;f<e.length/2;f++)s=e[f*2],u=e[f*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,u),a=Math.max(a,u);const c=this.fontSize();return{x:r-c/2,y:i-c/2,width:n-r+c,height:a-i+c}}destroy(){return op.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}Oh.TextPath=pr;pr.prototype._fillFunc=c5;pr.prototype._strokeFunc=f5;pr.prototype._fillFuncHit=c5;pr.prototype._strokeFuncHit=f5;pr.prototype.className="TextPath";pr.prototype._attrsAffectingSize=["text","fontSize","data"];(0,kE._registerNode)(pr);yi.Factory.addGetterSetter(pr,"data");yi.Factory.addGetterSetter(pr,"fontFamily","Arial");yi.Factory.addGetterSetter(pr,"fontSize",12,(0,l5.getNumberValidator)());yi.Factory.addGetterSetter(pr,"fontStyle",u5);yi.Factory.addGetterSetter(pr,"align","left");yi.Factory.addGetterSetter(pr,"letterSpacing",0,(0,l5.getNumberValidator)());yi.Factory.addGetterSetter(pr,"textBaseline","middle");yi.Factory.addGetterSetter(pr,"fontVariant",u5);yi.Factory.addGetterSetter(pr,"text",AE);yi.Factory.addGetterSetter(pr,"textDecoration","");yi.Factory.addGetterSetter(pr,"kerningFunc",void 0);var Ih={};Object.defineProperty(Ih,"__esModule",{value:!0});Ih.Transformer=void 0;const wt=Vt,pt=nt,p4=Ut,FE=dr,PE=o0,g4=pl,ui=Ze,ls=je,NE=Ze,h5="tr-konva",RE=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(t=>t+`.${h5}`).join(" "),m4="nodesRect",OE=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],IE={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},DE="ontouchstart"in ui.Konva._global;function LE(t,e,r){if(t==="rotater")return r;e+=wt.Util.degToRad(IE[t]||0);const n=(wt.Util.radToDeg(e)%360+360)%360;return wt.Util._inRange(n,315+22.5,360)||wt.Util._inRange(n,0,22.5)?"ns-resize":wt.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":wt.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":wt.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":wt.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":wt.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":wt.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":wt.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(wt.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}const Of=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function ME(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function d5(t,e,r){const n=r.x+(t.x-r.x)*Math.cos(e)-(t.y-r.y)*Math.sin(e),i=r.y+(t.x-r.x)*Math.sin(e)+(t.y-r.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:n,y:i}}function BE(t,e){const r=ME(t);return d5(t,e,r)}function UE(t,e,r){let n=e;for(let i=0;i<t.length;i++){const a=ui.Konva.getAngle(t[i]),s=Math.abs(a-e)%(Math.PI*2);Math.min(s,Math.PI*2-s)<r&&(n=a)}return n}let Sg=0,ot=class extends g4.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(RE,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return wt.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return h5+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const r=e.filter(i=>i.isAncestorOf(this)?(wt.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=r,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const a=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const s=i._attrsAffectingSize.map(u=>u+"Change."+this._getEventNamespace()).join(" ");i.on(s,a)}i.on(OE.map(s=>s+`.${this._getEventNamespace()}`).join(" "),a),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,a),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let r;e.on(`dragstart.${this._getEventNamespace()}`,n=>{r=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(n,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!r)return;const i=e.getAbsolutePosition(),a=i.x-r.x,s=i.y-r.y;this.nodes().forEach(u=>{if(u===e||u.isDragging())return;const c=u.getAbsolutePosition();u.setAbsolutePosition({x:c.x+a,y:c.y+s}),u.startDrag(n)}),r=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(m4),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(m4,this.__getNodeRect)}__getNodeShape(e,r=this.rotation(),n){const i=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),a=e.getAbsoluteScale(n),s=e.getAbsolutePosition(n),u=i.x*a.x-e.offsetX()*a.x,c=i.y*a.y-e.offsetY()*a.y,f=(ui.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),d={x:s.x+u*Math.cos(f)+c*Math.sin(-f),y:s.y+c*Math.cos(f)+u*Math.sin(f),width:i.width*a.x,height:i.height*a.y,rotation:f};return d5(d,-ui.Konva.getAngle(r),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const r=[];this.nodes().map(f=>{const d=f.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),v=[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}],g=f.getAbsoluteTransform();v.forEach(function(x){const _=g.point(x);r.push(_)})});const n=new wt.Transform;n.rotate(-ui.Konva.getAngle(this.rotation()));let i=1/0,a=1/0,s=-1/0,u=-1/0;r.forEach(function(f){const d=n.point(f);i===void 0&&(i=s=d.x,a=u=d.y),i=Math.min(i,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),u=Math.max(u,d.y)}),n.invert();const c=n.point({x:i,y:a});return{x:c.x,y:c.y,width:s-i,height:u-a,rotation:ui.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Of.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const r=new PE.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:DE?10:"auto"}),n=this;r.on("mousedown touchstart",function(i){n._handleMouseDown(i)}),r.on("dragstart",i=>{r.stopDrag(),i.cancelBubble=!0}),r.on("dragend",i=>{i.cancelBubble=!0}),r.on("mouseenter",()=>{const i=ui.Konva.getAngle(this.rotation()),a=this.rotateAnchorCursor(),s=LE(e,i,a);r.getStage().content&&(r.getStage().content.style.cursor=s),this._cursorChange=!0}),r.on("mouseout",()=>{r.getStage().content&&(r.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(r)}_createBack(){const e=new FE.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(r,n){const i=n.getParent(),a=i.padding();r.beginPath(),r.rect(-a,-a,n.width()+a*2,n.height()+a*2),r.moveTo(n.width()/2,-a),i.rotateEnabled()&&i.rotateLineVisible()&&r.lineTo(n.width()/2,-i.rotateAnchorOffset()*wt.Util._sign(n.height())-a),r.fillStrokeShape(n)},hitFunc:(r,n)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();r.beginPath(),r.rect(-i,-i,n.width()+i*2,n.height()+i*2),r.fillStrokeShape(n)}});this.add(e),this._proxyDrag(e),e.on("dragstart",r=>{r.cancelBubble=!0}),e.on("dragmove",r=>{r.cancelBubble=!0}),e.on("dragend",r=>{r.cancelBubble=!0}),this.on("dragmove",r=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const r=this._getNodeRect(),n=r.width,i=r.height,a=Math.sqrt(Math.pow(n,2)+Math.pow(i,2));this.sin=Math.abs(i/a),this.cos=Math.abs(n/a),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const s=e.target.getAbsolutePosition(),u=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:u.x-s.x,y:u.y-s.y},Sg++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(c=>{c._fire("transformstart",{evt:e.evt,target:c})})}_handleMouseMove(e){let r,n,i;const a=this.findOne("."+this._movingAnchorName),s=a.getStage();s.setPointersPositions(e);const u=s.getPointerPosition();let c={x:u.x-this._anchorDragOffset.x,y:u.y-this._anchorDragOffset.y};const f=a.getAbsolutePosition();this.anchorDragBoundFunc()&&(c=this.anchorDragBoundFunc()(f,c,e)),a.setAbsolutePosition(c);const d=a.getAbsolutePosition();if(f.x===d.x&&f.y===d.y)return;if(this._movingAnchorName==="rotater"){const T=this._getNodeRect();r=a.x()-T.width/2,n=-a.y()+T.height/2;let m=Math.atan2(-n,r)+Math.PI/2;T.height<0&&(m-=Math.PI);const F=ui.Konva.getAngle(this.rotation())+m,R=ui.Konva.getAngle(this.rotationSnapTolerance()),A=UE(this.rotationSnaps(),F,R)-T.rotation,L=BE(T,A);this._fitNodesInto(L,e);return}const v=this.shiftBehavior();let g;v==="inverted"?g=this.keepRatio()&&!e.shiftKey:v==="none"?g=this.keepRatio():g=this.keepRatio()||e.shiftKey;let x=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(g){const T=x?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(T.x-a.x(),2)+Math.pow(T.y-a.y(),2));const m=this.findOne(".top-left").x()>T.x?-1:1,w=this.findOne(".top-left").y()>T.y?-1:1;r=i*this.cos*m,n=i*this.sin*w,this.findOne(".top-left").x(T.x-r),this.findOne(".top-left").y(T.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(a.y());else if(this._movingAnchorName==="top-right"){if(g){const T=x?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(a.x()-T.x,2)+Math.pow(T.y-a.y(),2));const m=this.findOne(".top-right").x()<T.x?-1:1,w=this.findOne(".top-right").y()>T.y?-1:1;r=i*this.cos*m,n=i*this.sin*w,this.findOne(".top-right").x(T.x+r),this.findOne(".top-right").y(T.y-n)}var _=a.position();this.findOne(".top-left").y(_.y),this.findOne(".bottom-right").x(_.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(a.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(a.x());else if(this._movingAnchorName==="bottom-left"){if(g){const T=x?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(T.x-a.x(),2)+Math.pow(a.y()-T.y,2));const m=T.x<a.x()?-1:1,w=a.y()<T.y?-1:1;r=i*this.cos*m,n=i*this.sin*w,a.x(T.x-r),a.y(T.y+n)}_=a.position(),this.findOne(".top-left").x(_.x),this.findOne(".bottom-right").y(_.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(a.y());else if(this._movingAnchorName==="bottom-right"){if(g){const T=x?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(a.x()-T.x,2)+Math.pow(a.y()-T.y,2));const m=this.findOne(".bottom-right").x()<T.x?-1:1,w=this.findOne(".bottom-right").y()<T.y?-1:1;r=i*this.cos*m,n=i*this.sin*w,this.findOne(".bottom-right").x(T.x+r),this.findOne(".bottom-right").y(T.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(x=this.centeredScaling()||e.altKey,x){const T=this.findOne(".top-left"),m=this.findOne(".bottom-right"),w=T.x(),F=T.y(),R=this.getWidth()-m.x(),N=this.getHeight()-m.y();m.move({x:-w,y:-F}),T.move({x:R,y:N})}const y=this.findOne(".top-left").getAbsolutePosition();r=y.x,n=y.y;const E=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),C=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:r,y:n,width:E,height:C,rotation:ui.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var r;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const n=this.getNode();Sg--,this._fire("transformend",{evt:e,target:n}),(r=this.getLayer())===null||r===void 0||r.batchDraw(),n&&this._nodes.forEach(i=>{var a;i._fire("transformend",{evt:e,target:i}),(a=i.getLayer())===null||a===void 0||a.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,r){const n=this._getNodeRect(),i=1;if(wt.Util._inRange(e.width,-this.padding()*2-i,i)){this.update();return}if(wt.Util._inRange(e.height,-this.padding()*2-i,i)){this.update();return}const a=new wt.Transform;if(a.rotate(ui.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const g=a.point({x:-this.padding()*2,y:0});e.x+=g.x,e.y+=g.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const g=a.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const g=a.point({x:0,y:-this.padding()*2});e.x+=g.x,e.y+=g.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const g=a.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const g=this.boundBoxFunc()(n,e);g?e=g:wt.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const s=1e7,u=new wt.Transform;u.translate(n.x,n.y),u.rotate(n.rotation),u.scale(n.width/s,n.height/s);const c=new wt.Transform,f=e.width/s,d=e.height/s;this.flipEnabled()===!1?(c.translate(e.x,e.y),c.rotate(e.rotation),c.translate(e.width<0?e.width:0,e.height<0?e.height:0),c.scale(Math.abs(f),Math.abs(d))):(c.translate(e.x,e.y),c.rotate(e.rotation),c.scale(f,d));const v=c.multiply(u.invert());this._nodes.forEach(g=>{var x;const _=g.getParent().getAbsoluteTransform(),y=g.getTransform().copy();y.translate(g.offsetX(),g.offsetY());const E=new wt.Transform;E.multiply(_.copy().invert()).multiply(v).multiply(_).multiply(y);const C=E.decompose();g.setAttrs(C),(x=g.getLayer())===null||x===void 0||x.batchDraw()}),this.rotation(wt.Util._getRotation(e.rotation)),this._nodes.forEach(g=>{this._fire("transform",{evt:r,target:g}),g._fire("transform",{evt:r,target:g})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,r){this.findOne(e).setAttrs(r)}update(){var e;const r=this._getNodeRect();this.rotation(wt.Util._getRotation(r.rotation));const n=r.width,i=r.height,a=this.enabledAnchors(),s=this.resizeEnabled(),u=this.padding(),c=this.anchorSize(),f=this.find("._anchor");f.forEach(v=>{v.setAttrs({width:c,height:c,offsetX:c/2,offsetY:c/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:c/2+u,offsetY:c/2+u,visible:s&&a.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:c/2+u,visible:s&&a.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:c/2-u,offsetY:c/2+u,visible:s&&a.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:c/2+u,visible:s&&a.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:i/2,offsetX:c/2-u,visible:s&&a.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:c/2+u,offsetY:c/2-u,visible:s&&a.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:i,offsetY:c/2-u,visible:s&&a.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:i,offsetX:c/2-u,offsetY:c/2-u,visible:s&&a.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*wt.Util._sign(i)-u,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const d=this.anchorStyleFunc();d&&f.forEach(v=>{d(v)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),g4.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return p4.Node.prototype.toObject.call(this)}clone(e){return p4.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Ih.Transformer=ot;ot.isTransforming=()=>Sg>0;function zE(t){return t instanceof Array||wt.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(e){Of.indexOf(e)===-1&&wt.Util.warn("Unknown anchor name: "+e+". Available names are: "+Of.join(", "))}),t||[]}ot.prototype.className="Transformer";(0,NE._registerNode)(ot);pt.Factory.addGetterSetter(ot,"enabledAnchors",Of,zE);pt.Factory.addGetterSetter(ot,"flipEnabled",!0,(0,ls.getBooleanValidator)());pt.Factory.addGetterSetter(ot,"resizeEnabled",!0);pt.Factory.addGetterSetter(ot,"anchorSize",10,(0,ls.getNumberValidator)());pt.Factory.addGetterSetter(ot,"rotateEnabled",!0);pt.Factory.addGetterSetter(ot,"rotateLineVisible",!0);pt.Factory.addGetterSetter(ot,"rotationSnaps",[]);pt.Factory.addGetterSetter(ot,"rotateAnchorOffset",50,(0,ls.getNumberValidator)());pt.Factory.addGetterSetter(ot,"rotateAnchorCursor","crosshair");pt.Factory.addGetterSetter(ot,"rotationSnapTolerance",5,(0,ls.getNumberValidator)());pt.Factory.addGetterSetter(ot,"borderEnabled",!0);pt.Factory.addGetterSetter(ot,"anchorStroke","rgb(0, 161, 255)");pt.Factory.addGetterSetter(ot,"anchorStrokeWidth",1,(0,ls.getNumberValidator)());pt.Factory.addGetterSetter(ot,"anchorFill","white");pt.Factory.addGetterSetter(ot,"anchorCornerRadius",0,(0,ls.getNumberValidator)());pt.Factory.addGetterSetter(ot,"borderStroke","rgb(0, 161, 255)");pt.Factory.addGetterSetter(ot,"borderStrokeWidth",1,(0,ls.getNumberValidator)());pt.Factory.addGetterSetter(ot,"borderDash");pt.Factory.addGetterSetter(ot,"keepRatio",!0);pt.Factory.addGetterSetter(ot,"shiftBehavior","default");pt.Factory.addGetterSetter(ot,"centeredScaling",!1);pt.Factory.addGetterSetter(ot,"ignoreStroke",!1);pt.Factory.addGetterSetter(ot,"padding",0,(0,ls.getNumberValidator)());pt.Factory.addGetterSetter(ot,"nodes");pt.Factory.addGetterSetter(ot,"node");pt.Factory.addGetterSetter(ot,"boundBoxFunc");pt.Factory.addGetterSetter(ot,"anchorDragBoundFunc");pt.Factory.addGetterSetter(ot,"anchorStyleFunc");pt.Factory.addGetterSetter(ot,"shouldOverdrawWholeArea",!1);pt.Factory.addGetterSetter(ot,"useSingleNodeRotation",!0);pt.Factory.backCompat(ot,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var Dh={};Object.defineProperty(Dh,"__esModule",{value:!0});Dh.Wedge=void 0;const Lh=nt,GE=dr,WE=Ze,p5=je,HE=Ze;class ma extends GE.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,WE.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}Dh.Wedge=ma;ma.prototype.className="Wedge";ma.prototype._centroid=!0;ma.prototype._attrsAffectingSize=["radius"];(0,HE._registerNode)(ma);Lh.Factory.addGetterSetter(ma,"radius",0,(0,p5.getNumberValidator)());Lh.Factory.addGetterSetter(ma,"angle",0,(0,p5.getNumberValidator)());Lh.Factory.addGetterSetter(ma,"clockwise",!1);Lh.Factory.backCompat(ma,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var Mh={};Object.defineProperty(Mh,"__esModule",{value:!0});Mh.Blur=void 0;const v4=nt,jE=Ut,VE=je;function x4(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const bE=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],XE=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function KE(t,e){const r=t.data,n=t.width,i=t.height;let a,s,u,c,f,d,v,g,x,_,y,E,C,T,m,w,F,R,N,A;const L=e+e+1,O=n-1,H=i-1,j=e+1,q=j*(j+1)/2,ye=new x4,de=bE[e],Ae=XE[e];let Ge=null,ue=ye,xe=null,ve=null;for(let we=1;we<L;we++)ue=ue.next=new x4,we===j&&(Ge=ue);ue.next=ye,u=s=0;for(let we=0;we<i;we++){E=C=T=m=c=f=d=v=0,g=j*(w=r[s]),x=j*(F=r[s+1]),_=j*(R=r[s+2]),y=j*(N=r[s+3]),c+=q*w,f+=q*F,d+=q*R,v+=q*N,ue=ye;for(let z=0;z<j;z++)ue.r=w,ue.g=F,ue.b=R,ue.a=N,ue=ue.next;for(let z=1;z<j;z++)a=s+((O<z?O:z)<<2),c+=(ue.r=w=r[a])*(A=j-z),f+=(ue.g=F=r[a+1])*A,d+=(ue.b=R=r[a+2])*A,v+=(ue.a=N=r[a+3])*A,E+=w,C+=F,T+=R,m+=N,ue=ue.next;xe=ye,ve=Ge;for(let z=0;z<n;z++)r[s+3]=N=v*de>>Ae,N!==0?(N=255/N,r[s]=(c*de>>Ae)*N,r[s+1]=(f*de>>Ae)*N,r[s+2]=(d*de>>Ae)*N):r[s]=r[s+1]=r[s+2]=0,c-=g,f-=x,d-=_,v-=y,g-=xe.r,x-=xe.g,_-=xe.b,y-=xe.a,a=u+((a=z+e+1)<O?a:O)<<2,E+=xe.r=r[a],C+=xe.g=r[a+1],T+=xe.b=r[a+2],m+=xe.a=r[a+3],c+=E,f+=C,d+=T,v+=m,xe=xe.next,g+=w=ve.r,x+=F=ve.g,_+=R=ve.b,y+=N=ve.a,E-=w,C-=F,T-=R,m-=N,ve=ve.next,s+=4;u+=n}for(let we=0;we<n;we++){C=T=m=E=f=d=v=c=0,s=we<<2,g=j*(w=r[s]),x=j*(F=r[s+1]),_=j*(R=r[s+2]),y=j*(N=r[s+3]),c+=q*w,f+=q*F,d+=q*R,v+=q*N,ue=ye;for(let K=0;K<j;K++)ue.r=w,ue.g=F,ue.b=R,ue.a=N,ue=ue.next;let z=n;for(let K=1;K<=e;K++)s=z+we<<2,c+=(ue.r=w=r[s])*(A=j-K),f+=(ue.g=F=r[s+1])*A,d+=(ue.b=R=r[s+2])*A,v+=(ue.a=N=r[s+3])*A,E+=w,C+=F,T+=R,m+=N,ue=ue.next,K<H&&(z+=n);s=we,xe=ye,ve=Ge;for(let K=0;K<i;K++)a=s<<2,r[a+3]=N=v*de>>Ae,N>0?(N=255/N,r[a]=(c*de>>Ae)*N,r[a+1]=(f*de>>Ae)*N,r[a+2]=(d*de>>Ae)*N):r[a]=r[a+1]=r[a+2]=0,c-=g,f-=x,d-=_,v-=y,g-=xe.r,x-=xe.g,_-=xe.b,y-=xe.a,a=we+((a=K+j)<H?a:H)*n<<2,c+=E+=xe.r=r[a],f+=C+=xe.g=r[a+1],d+=T+=xe.b=r[a+2],v+=m+=xe.a=r[a+3],xe=xe.next,g+=w=ve.r,x+=F=ve.g,_+=R=ve.b,y+=N=ve.a,E-=w,C-=F,T-=R,m-=N,ve=ve.next,s+=n}}const YE=function(e){const r=Math.round(this.blurRadius());r>0&&KE(e,r)};Mh.Blur=YE;v4.Factory.addGetterSetter(jE.Node,"blurRadius",0,(0,VE.getNumberValidator)(),v4.Factory.afterSetFilter);var Bh={};Object.defineProperty(Bh,"__esModule",{value:!0});Bh.Brighten=void 0;const _4=nt,$E=Ut,QE=je,qE=function(t){const e=this.brightness()*255,r=t.data,n=r.length;for(let i=0;i<n;i+=4)r[i]+=e,r[i+1]+=e,r[i+2]+=e};Bh.Brighten=qE;_4.Factory.addGetterSetter($E.Node,"brightness",0,(0,QE.getNumberValidator)(),_4.Factory.afterSetFilter);var Uh={};Object.defineProperty(Uh,"__esModule",{value:!0});Uh.Contrast=void 0;const y4=nt,JE=Ut,ZE=je,eT=function(t){const e=Math.pow((this.contrast()+100)/100,2),r=t.data,n=r.length;let i=150,a=150,s=150;for(let u=0;u<n;u+=4)i=r[u],a=r[u+1],s=r[u+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,a/=255,a-=.5,a*=e,a+=.5,a*=255,s/=255,s-=.5,s*=e,s+=.5,s*=255,i=i<0?0:i>255?255:i,a=a<0?0:a>255?255:a,s=s<0?0:s>255?255:s,r[u]=i,r[u+1]=a,r[u+2]=s};Uh.Contrast=eT;y4.Factory.addGetterSetter(JE.Node,"contrast",0,(0,ZE.getNumberValidator)(),y4.Factory.afterSetFilter);var zh={};Object.defineProperty(zh,"__esModule",{value:!0});zh.Emboss=void 0;const Qa=nt,Gh=Ut,tT=Vt,g5=je,rT=function(t){const e=this.embossStrength()*10,r=this.embossWhiteLevel()*255,n=this.embossDirection(),i=this.embossBlend(),a=t.data,s=t.width,u=t.height,c=s*4;let f=0,d=0,v=u;switch(n){case"top-left":f=-1,d=-1;break;case"top":f=-1,d=0;break;case"top-right":f=-1,d=1;break;case"right":f=0,d=1;break;case"bottom-right":f=1,d=1;break;case"bottom":f=1,d=0;break;case"bottom-left":f=1,d=-1;break;case"left":f=0,d=-1;break;default:tT.Util.error("Unknown emboss direction: "+n)}do{const g=(v-1)*c;let x=f;v+x<1&&(x=0),v+x>u&&(x=0);const _=(v-1+x)*s*4;let y=s;do{const E=g+(y-1)*4;let C=d;y+C<1&&(C=0),y+C>s&&(C=0);const T=_+(y-1+C)*4,m=a[E]-a[T],w=a[E+1]-a[T+1],F=a[E+2]-a[T+2];let R=m;const N=R>0?R:-R,A=w>0?w:-w,L=F>0?F:-F;if(A>N&&(R=w),L>N&&(R=F),R*=e,i){const O=a[E]+R,H=a[E+1]+R,j=a[E+2]+R;a[E]=O>255?255:O<0?0:O,a[E+1]=H>255?255:H<0?0:H,a[E+2]=j>255?255:j<0?0:j}else{let O=r-R;O<0?O=0:O>255&&(O=255),a[E]=a[E+1]=a[E+2]=O}}while(--y)}while(--v)};zh.Emboss=rT;Qa.Factory.addGetterSetter(Gh.Node,"embossStrength",.5,(0,g5.getNumberValidator)(),Qa.Factory.afterSetFilter);Qa.Factory.addGetterSetter(Gh.Node,"embossWhiteLevel",.5,(0,g5.getNumberValidator)(),Qa.Factory.afterSetFilter);Qa.Factory.addGetterSetter(Gh.Node,"embossDirection","top-left",void 0,Qa.Factory.afterSetFilter);Qa.Factory.addGetterSetter(Gh.Node,"embossBlend",!1,void 0,Qa.Factory.afterSetFilter);var Wh={};Object.defineProperty(Wh,"__esModule",{value:!0});Wh.Enhance=void 0;const S4=nt,nT=Ut,iT=je;function up(t,e,r,n,i){const a=r-e,s=i-n;if(a===0)return n+s/2;if(s===0)return n;let u=(t-e)/a;return u=s*u+n,u}const aT=function(t){const e=t.data,r=e.length;let n=e[0],i=n,a,s=e[1],u=s,c,f=e[2],d=f,v;const g=this.enhance();if(g===0)return;for(let m=0;m<r;m+=4)a=e[m+0],a<n?n=a:a>i&&(i=a),c=e[m+1],c<s?s=c:c>u&&(u=c),v=e[m+2],v<f?f=v:v>d&&(d=v);i===n&&(i=255,n=0),u===s&&(u=255,s=0),d===f&&(d=255,f=0);let x,_,y,E,C,T;if(g>0)x=i+g*(255-i),_=n-g*(n-0),y=u+g*(255-u),E=s-g*(s-0),C=d+g*(255-d),T=f-g*(f-0);else{const m=(i+n)*.5;x=i+g*(i-m),_=n+g*(n-m);const w=(u+s)*.5;y=u+g*(u-w),E=s+g*(s-w);const F=(d+f)*.5;C=d+g*(d-F),T=f+g*(f-F)}for(let m=0;m<r;m+=4)e[m+0]=up(e[m+0],n,i,_,x),e[m+1]=up(e[m+1],s,u,E,y),e[m+2]=up(e[m+2],f,d,T,C)};Wh.Enhance=aT;S4.Factory.addGetterSetter(nT.Node,"enhance",0,(0,iT.getNumberValidator)(),S4.Factory.afterSetFilter);var Hh={};Object.defineProperty(Hh,"__esModule",{value:!0});Hh.Grayscale=void 0;const sT=function(t){const e=t.data,r=e.length;for(let n=0;n<r;n+=4){const i=.34*e[n]+.5*e[n+1]+.16*e[n+2];e[n]=i,e[n+1]=i,e[n+2]=i}};Hh.Grayscale=sT;var jh={};Object.defineProperty(jh,"__esModule",{value:!0});jh.HSL=void 0;const sl=nt,O2=Ut,I2=je;sl.Factory.addGetterSetter(O2.Node,"hue",0,(0,I2.getNumberValidator)(),sl.Factory.afterSetFilter);sl.Factory.addGetterSetter(O2.Node,"saturation",0,(0,I2.getNumberValidator)(),sl.Factory.afterSetFilter);sl.Factory.addGetterSetter(O2.Node,"luminance",0,(0,I2.getNumberValidator)(),sl.Factory.afterSetFilter);const oT=function(t){const e=t.data,r=e.length,n=1,i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=this.luminance()*127,u=n*i*Math.cos(a*Math.PI/180),c=n*i*Math.sin(a*Math.PI/180),f=.299*n+.701*u+.167*c,d=.587*n-.587*u+.33*c,v=.114*n-.114*u-.497*c,g=.299*n-.299*u-.328*c,x=.587*n+.413*u+.035*c,_=.114*n-.114*u+.293*c,y=.299*n-.3*u+1.25*c,E=.587*n-.586*u-1.05*c,C=.114*n+.886*u-.2*c;let T,m,w,F;for(let R=0;R<r;R+=4)T=e[R+0],m=e[R+1],w=e[R+2],F=e[R+3],e[R+0]=f*T+d*m+v*w+s,e[R+1]=g*T+x*m+_*w+s,e[R+2]=y*T+E*m+C*w+s,e[R+3]=F};jh.HSL=oT;var Vh={};Object.defineProperty(Vh,"__esModule",{value:!0});Vh.HSV=void 0;const ol=nt,D2=Ut,L2=je,lT=function(t){const e=t.data,r=e.length,n=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=n*i*Math.cos(a*Math.PI/180),u=n*i*Math.sin(a*Math.PI/180),c=.299*n+.701*s+.167*u,f=.587*n-.587*s+.33*u,d=.114*n-.114*s-.497*u,v=.299*n-.299*s-.328*u,g=.587*n+.413*s+.035*u,x=.114*n-.114*s+.293*u,_=.299*n-.3*s+1.25*u,y=.587*n-.586*s-1.05*u,E=.114*n+.886*s-.2*u;for(let C=0;C<r;C+=4){const T=e[C+0],m=e[C+1],w=e[C+2],F=e[C+3];e[C+0]=c*T+f*m+d*w,e[C+1]=v*T+g*m+x*w,e[C+2]=_*T+y*m+E*w,e[C+3]=F}};Vh.HSV=lT;ol.Factory.addGetterSetter(D2.Node,"hue",0,(0,L2.getNumberValidator)(),ol.Factory.afterSetFilter);ol.Factory.addGetterSetter(D2.Node,"saturation",0,(0,L2.getNumberValidator)(),ol.Factory.afterSetFilter);ol.Factory.addGetterSetter(D2.Node,"value",0,(0,L2.getNumberValidator)(),ol.Factory.afterSetFilter);var bh={};Object.defineProperty(bh,"__esModule",{value:!0});bh.Invert=void 0;const uT=function(t){const e=t.data,r=e.length;for(let n=0;n<r;n+=4)e[n]=255-e[n],e[n+1]=255-e[n+1],e[n+2]=255-e[n+2]};bh.Invert=uT;var Xh={};Object.defineProperty(Xh,"__esModule",{value:!0});Xh.Kaleidoscope=void 0;const If=nt,m5=Ut,w4=Vt,v5=je,cT=function(t,e,r){const n=t.data,i=e.data,a=t.width,s=t.height,u=r.polarCenterX||a/2,c=r.polarCenterY||s/2;let f=Math.sqrt(u*u+c*c),d=a-u,v=s-c;const g=Math.sqrt(d*d+v*v);f=g>f?g:f;const x=s,_=a,y=360/_*Math.PI/180;for(let E=0;E<_;E+=1){const C=Math.sin(E*y),T=Math.cos(E*y);for(let m=0;m<x;m+=1){d=Math.floor(u+f*m/x*T),v=Math.floor(c+f*m/x*C);let w=(v*a+d)*4;const F=n[w+0],R=n[w+1],N=n[w+2],A=n[w+3];w=(E+m*a)*4,i[w+0]=F,i[w+1]=R,i[w+2]=N,i[w+3]=A}}},fT=function(t,e,r){const n=t.data,i=e.data,a=t.width,s=t.height,u=r.polarCenterX||a/2,c=r.polarCenterY||s/2;let f=Math.sqrt(u*u+c*c),d=a-u,v=s-c;const g=Math.sqrt(d*d+v*v);f=g>f?g:f;const x=s,_=a,y=0;let E,C;for(d=0;d<a;d+=1)for(v=0;v<s;v+=1){const T=d-u,m=v-c,w=Math.sqrt(T*T+m*m)*x/f;let F=(Math.atan2(m,T)*180/Math.PI+360+y)%360;F=F*_/360,E=Math.floor(F),C=Math.floor(w);let R=(C*a+E)*4;const N=n[R+0],A=n[R+1],L=n[R+2],O=n[R+3];R=(v*a+d)*4,i[R+0]=N,i[R+1]=A,i[R+2]=L,i[R+3]=O}},hT=function(t){const e=t.width,r=t.height;let n,i,a,s,u,c,f,d,v,g,x=Math.round(this.kaleidoscopePower());const _=Math.round(this.kaleidoscopeAngle()),y=Math.floor(e*(_%360)/360);if(x<1)return;const E=w4.Util.createCanvasElement();E.width=e,E.height=r;const C=E.getContext("2d").getImageData(0,0,e,r);w4.Util.releaseCanvas(E),cT(t,C,{polarCenterX:e/2,polarCenterY:r/2});let T=e/Math.pow(2,x);for(;T<=8;)T=T*2,x-=1;T=Math.ceil(T);let m=T,w=0,F=m,R=1;for(y+T>e&&(w=m,F=0,R=-1),i=0;i<r;i+=1)for(n=w;n!==F;n+=R)a=Math.round(n+y)%e,v=(e*i+a)*4,u=C.data[v+0],c=C.data[v+1],f=C.data[v+2],d=C.data[v+3],g=(e*i+n)*4,C.data[g+0]=u,C.data[g+1]=c,C.data[g+2]=f,C.data[g+3]=d;for(i=0;i<r;i+=1)for(m=Math.floor(T),s=0;s<x;s+=1){for(n=0;n<m+1;n+=1)v=(e*i+n)*4,u=C.data[v+0],c=C.data[v+1],f=C.data[v+2],d=C.data[v+3],g=(e*i+m*2-n-1)*4,C.data[g+0]=u,C.data[g+1]=c,C.data[g+2]=f,C.data[g+3]=d;m*=2}fT(C,t,{})};Xh.Kaleidoscope=hT;If.Factory.addGetterSetter(m5.Node,"kaleidoscopePower",2,(0,v5.getNumberValidator)(),If.Factory.afterSetFilter);If.Factory.addGetterSetter(m5.Node,"kaleidoscopeAngle",0,(0,v5.getNumberValidator)(),If.Factory.afterSetFilter);var Kh={};Object.defineProperty(Kh,"__esModule",{value:!0});Kh.Mask=void 0;const E4=nt,dT=Ut,pT=je;function Mc(t,e,r){let n=(r*t.width+e)*4;const i=[];return i.push(t.data[n++],t.data[n++],t.data[n++],t.data[n++]),i}function eu(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function gT(t){const e=[0,0,0];for(let r=0;r<t.length;r++)e[0]+=t[r][0],e[1]+=t[r][1],e[2]+=t[r][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function mT(t,e){const r=Mc(t,0,0),n=Mc(t,t.width-1,0),i=Mc(t,0,t.height-1),a=Mc(t,t.width-1,t.height-1),s=e||10;if(eu(r,n)<s&&eu(n,a)<s&&eu(a,i)<s&&eu(i,r)<s){const u=gT([n,r,a,i]),c=[];for(let f=0;f<t.width*t.height;f++){const d=eu(u,[t.data[f*4],t.data[f*4+1],t.data[f*4+2]]);c[f]=d<s?0:255}return c}}function vT(t,e){for(let r=0;r<t.width*t.height;r++)t.data[4*r+3]=e[r]}function xT(t,e,r){const n=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let u=0;u<r;u++)for(let c=0;c<e;c++){const f=u*e+c;let d=0;for(let v=0;v<i;v++)for(let g=0;g<i;g++){const x=u+v-a,_=c+g-a;if(x>=0&&x<r&&_>=0&&_<e){const y=x*e+_,E=n[v*i+g];d+=t[y]*E}}s[f]=d===255*8?255:0}return s}function _T(t,e,r){const n=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let u=0;u<r;u++)for(let c=0;c<e;c++){const f=u*e+c;let d=0;for(let v=0;v<i;v++)for(let g=0;g<i;g++){const x=u+v-a,_=c+g-a;if(x>=0&&x<r&&_>=0&&_<e){const y=x*e+_,E=n[v*i+g];d+=t[y]*E}}s[f]=d>=255*4?255:0}return s}function yT(t,e,r){const n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let u=0;u<r;u++)for(let c=0;c<e;c++){const f=u*e+c;let d=0;for(let v=0;v<i;v++)for(let g=0;g<i;g++){const x=u+v-a,_=c+g-a;if(x>=0&&x<r&&_>=0&&_<e){const y=x*e+_,E=n[v*i+g];d+=t[y]*E}}s[f]=d}return s}const ST=function(t){const e=this.threshold();let r=mT(t,e);return r&&(r=xT(r,t.width,t.height),r=_T(r,t.width,t.height),r=yT(r,t.width,t.height),vT(t,r)),t};Kh.Mask=ST;E4.Factory.addGetterSetter(dT.Node,"threshold",0,(0,pT.getNumberValidator)(),E4.Factory.afterSetFilter);var Yh={};Object.defineProperty(Yh,"__esModule",{value:!0});Yh.Noise=void 0;const T4=nt,wT=Ut,ET=je,TT=function(t){const e=this.noise()*255,r=t.data,n=r.length,i=e/2;for(let a=0;a<n;a+=4)r[a+0]+=i-2*i*Math.random(),r[a+1]+=i-2*i*Math.random(),r[a+2]+=i-2*i*Math.random()};Yh.Noise=TT;T4.Factory.addGetterSetter(wT.Node,"noise",.2,(0,ET.getNumberValidator)(),T4.Factory.afterSetFilter);var $h={};Object.defineProperty($h,"__esModule",{value:!0});$h.Pixelate=void 0;const C4=nt,CT=Vt,kT=Ut,AT=je,FT=function(t){let e=Math.ceil(this.pixelSize()),r=t.width,n=t.height,i=Math.ceil(r/e),a=Math.ceil(n/e),s=t.data;if(e<=0){CT.Util.error("pixelSize value can not be <= 0");return}for(let u=0;u<i;u+=1)for(let c=0;c<a;c+=1){let f=0,d=0,v=0,g=0;const x=u*e,_=x+e,y=c*e,E=y+e;let C=0;for(let T=x;T<_;T+=1)if(!(T>=r))for(let m=y;m<E;m+=1){if(m>=n)continue;const w=(r*m+T)*4;f+=s[w+0],d+=s[w+1],v+=s[w+2],g+=s[w+3],C+=1}f=f/C,d=d/C,v=v/C,g=g/C;for(let T=x;T<_;T+=1)if(!(T>=r))for(let m=y;m<E;m+=1){if(m>=n)continue;const w=(r*m+T)*4;s[w+0]=f,s[w+1]=d,s[w+2]=v,s[w+3]=g}}};$h.Pixelate=FT;C4.Factory.addGetterSetter(kT.Node,"pixelSize",8,(0,AT.getNumberValidator)(),C4.Factory.afterSetFilter);var Qh={};Object.defineProperty(Qh,"__esModule",{value:!0});Qh.Posterize=void 0;const k4=nt,PT=Ut,NT=je,RT=function(t){const e=Math.round(this.levels()*254)+1,r=t.data,n=r.length,i=255/e;for(let a=0;a<n;a+=1)r[a]=Math.floor(r[a]/i)*i};Qh.Posterize=RT;k4.Factory.addGetterSetter(PT.Node,"levels",.5,(0,NT.getNumberValidator)(),k4.Factory.afterSetFilter);var qh={};Object.defineProperty(qh,"__esModule",{value:!0});qh.RGB=void 0;const Df=nt,M2=Ut,OT=je,IT=function(t){const e=t.data,r=e.length,n=this.red(),i=this.green(),a=this.blue();for(let s=0;s<r;s+=4){const u=(.34*e[s]+.5*e[s+1]+.16*e[s+2])/255;e[s]=u*n,e[s+1]=u*i,e[s+2]=u*a,e[s+3]=e[s+3]}};qh.RGB=IT;Df.Factory.addGetterSetter(M2.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Df.Factory.addGetterSetter(M2.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Df.Factory.addGetterSetter(M2.Node,"blue",0,OT.RGBComponent,Df.Factory.afterSetFilter);var Jh={};Object.defineProperty(Jh,"__esModule",{value:!0});Jh.RGBA=void 0;const ju=nt,Zh=Ut,DT=je,LT=function(t){const e=t.data,r=e.length,n=this.red(),i=this.green(),a=this.blue(),s=this.alpha();for(let u=0;u<r;u+=4){const c=1-s;e[u]=n*s+e[u]*c,e[u+1]=i*s+e[u+1]*c,e[u+2]=a*s+e[u+2]*c}};Jh.RGBA=LT;ju.Factory.addGetterSetter(Zh.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});ju.Factory.addGetterSetter(Zh.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});ju.Factory.addGetterSetter(Zh.Node,"blue",0,DT.RGBComponent,ju.Factory.afterSetFilter);ju.Factory.addGetterSetter(Zh.Node,"alpha",1,function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t});var ed={};Object.defineProperty(ed,"__esModule",{value:!0});ed.Sepia=void 0;const MT=function(t){const e=t.data,r=e.length;for(let n=0;n<r;n+=4){const i=e[n+0],a=e[n+1],s=e[n+2];e[n+0]=Math.min(255,i*.393+a*.769+s*.189),e[n+1]=Math.min(255,i*.349+a*.686+s*.168),e[n+2]=Math.min(255,i*.272+a*.534+s*.131)}};ed.Sepia=MT;var td={};Object.defineProperty(td,"__esModule",{value:!0});td.Solarize=void 0;const BT=function(t){const e=t.data,r=t.width,n=t.height,i=r*4;let a=n;do{const s=(a-1)*i;let u=r;do{const c=s+(u-1)*4;let f=e[c],d=e[c+1],v=e[c+2];f>127&&(f=255-f),d>127&&(d=255-d),v>127&&(v=255-v),e[c]=f,e[c+1]=d,e[c+2]=v}while(--u)}while(--a)};td.Solarize=BT;var rd={};Object.defineProperty(rd,"__esModule",{value:!0});rd.Threshold=void 0;const A4=nt,UT=Ut,zT=je,GT=function(t){const e=this.threshold()*255,r=t.data,n=r.length;for(let i=0;i<n;i+=1)r[i]=r[i]<e?0:255};rd.Threshold=GT;A4.Factory.addGetterSetter(UT.Node,"threshold",.5,(0,zT.getNumberValidator)(),A4.Factory.afterSetFilter);Object.defineProperty(hh,"__esModule",{value:!0});hh.Konva=void 0;const F4=Nf,WT=vh,HT=yh,jT=Eh,VT=Th,bT=Ch,P4=al,XT=a0,KT=ml,YT=o0,$T=Fh,QT=Ph,qT=Nh,JT=Rh,ZT=xl,eC=Oh,tC=Ih,rC=Dh,nC=Mh,iC=Bh,aC=Uh,sC=zh,oC=Wh,lC=Hh,uC=jh,cC=Vh,fC=bh,hC=Xh,dC=Kh,pC=Yh,gC=$h,mC=Qh,vC=qh,xC=Jh,_C=ed,yC=td,SC=rd;hh.Konva=F4.Konva.Util._assign(F4.Konva,{Arc:WT.Arc,Arrow:HT.Arrow,Circle:jT.Circle,Ellipse:VT.Ellipse,Image:bT.Image,Label:P4.Label,Tag:P4.Tag,Line:XT.Line,Path:KT.Path,Rect:YT.Rect,RegularPolygon:$T.RegularPolygon,Ring:QT.Ring,Sprite:qT.Sprite,Star:JT.Star,Text:ZT.Text,TextPath:eC.TextPath,Transformer:tC.Transformer,Wedge:rC.Wedge,Filters:{Blur:nC.Blur,Brighten:iC.Brighten,Contrast:aC.Contrast,Emboss:sC.Emboss,Enhance:oC.Enhance,Grayscale:lC.Grayscale,HSL:uC.HSL,HSV:cC.HSV,Invert:fC.Invert,Kaleidoscope:hC.Kaleidoscope,Mask:dC.Mask,Noise:pC.Noise,Pixelate:gC.Pixelate,Posterize:mC.Posterize,RGB:vC.RGB,RGBA:xC.RGBA,Sepia:_C.Sepia,Solarize:yC.Solarize,Threshold:SC.Threshold}});var wC=By.exports;Object.defineProperty(wC,"__esModule",{value:!0});const EC=hh;By.exports=EC.Konva;var wg={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var r=Nf;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=Nf;t.exports=n.Konva})(wg,wg.exports);var TC=wg.exports;const Vu=Ag(TC);var x5={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CC=function(e){var r={},n=We,i=uu,a=Object.assign;function s(o){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+o,h=1;h<arguments.length;h++)l+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+o+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),f=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),_=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),w=Symbol.for("react.offscreen"),F=Symbol.iterator;function R(o){return o===null||typeof o!="object"?null:(o=F&&o[F]||o["@@iterator"],typeof o=="function"?o:null)}function N(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case d:return"Fragment";case f:return"Portal";case g:return"Profiler";case v:return"StrictMode";case E:return"Suspense";case C:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case _:return(o.displayName||"Context")+".Consumer";case x:return(o._context.displayName||"Context")+".Provider";case y:var l=o.render;return o=o.displayName,o||(o=l.displayName||l.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case T:return l=o.displayName||null,l!==null?l:N(o.type)||"Memo";case m:l=o._payload,o=o._init;try{return N(o(l))}catch{}}return null}function A(o){var l=o.type;switch(o.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=l.render,o=o.displayName||o.name||"",l.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return N(l);case 8:return l===v?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function L(o){var l=o,h=o;if(o.alternate)for(;l.return;)l=l.return;else{o=l;do l=o,l.flags&4098&&(h=l.return),o=l.return;while(o)}return l.tag===3?h:null}function O(o){if(L(o)!==o)throw Error(s(188))}function H(o){var l=o.alternate;if(!l){if(l=L(o),l===null)throw Error(s(188));return l!==o?null:o}for(var h=o,p=l;;){var S=h.return;if(S===null)break;var k=S.alternate;if(k===null){if(p=S.return,p!==null){h=p;continue}break}if(S.child===k.child){for(k=S.child;k;){if(k===h)return O(S),o;if(k===p)return O(S),l;k=k.sibling}throw Error(s(188))}if(h.return!==p.return)h=S,p=k;else{for(var D=!1,X=S.child;X;){if(X===h){D=!0,h=S,p=k;break}if(X===p){D=!0,p=S,h=k;break}X=X.sibling}if(!D){for(X=k.child;X;){if(X===h){D=!0,h=k,p=S;break}if(X===p){D=!0,p=k,h=S;break}X=X.sibling}if(!D)throw Error(s(189))}}if(h.alternate!==p)throw Error(s(190))}if(h.tag!==3)throw Error(s(188));return h.stateNode.current===h?o:l}function j(o){return o=H(o),o!==null?q(o):null}function q(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var l=q(o);if(l!==null)return l;o=o.sibling}return null}function ye(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){if(o.tag!==4){var l=ye(o);if(l!==null)return l}o=o.sibling}return null}var de=Array.isArray,Ae=e.getPublicInstance,Ge=e.getRootHostContext,ue=e.getChildHostContext,xe=e.prepareForCommit,ve=e.resetAfterCommit,we=e.createInstance,z=e.appendInitialChild,K=e.finalizeInitialChildren,b=e.prepareUpdate,V=e.shouldSetTextContent,oe=e.createTextInstance,W=e.scheduleTimeout,Z=e.cancelTimeout,he=e.noTimeout,ge=e.isPrimaryRenderer,Ne=e.supportsMutation,Be=e.supportsPersistence,Ke=e.supportsHydration,Ye=e.getInstanceFromNode,et=e.preparePortalMount,se=e.getCurrentEventPriority,ae=e.detachDeletedInstance,me=e.supportsMicrotasks,ze=e.scheduleMicrotask,Ue=e.supportsTestSelectors,Xe=e.findFiberRoot,sr=e.getBoundingRect,At=e.getTextContent,tt=e.isHiddenSubtree,Dt=e.matchAccessibilityRole,Jr=e.setFocusIfFocusable,Zt=e.setupIntersectionObserver,Ft=e.appendChild,Cr=e.appendChildToContainer,Br=e.commitTextUpdate,gr=e.commitMount,Si=e.commitUpdate,xa=e.insertBefore,no=e.insertInContainerBefore,p0=e.removeChild,hd=e.removeChildFromContainer,g0=e.resetTextContent,m0=e.hideInstance,v0=e.hideTextInstance,x0=e.unhideInstance,dd=e.unhideTextInstance,pd=e.clearContainer,io=e.cloneInstance,_0=e.createContainerChildSet,y0=e.appendChildToContainerChildSet,gd=e.finalizeContainerChildren,El=e.replaceContainerChildren,S0=e.cloneHiddenInstance,w0=e.cloneHiddenTextInstance,md=e.canHydrateInstance,vd=e.canHydrateTextInstance,Tl=e.canHydrateSuspenseInstance,E0=e.isSuspenseInstancePending,Cl=e.isSuspenseInstanceFallback,xd=e.getSuspenseInstanceFallbackErrorDetails,P=e.registerSuspenseInstanceRetry,B=e.getNextHydratableSibling,I=e.getFirstHydratableChild,M=e.getFirstHydratableChildWithinContainer,U=e.getFirstHydratableChildWithinSuspenseInstance,G=e.hydrateInstance,ee=e.hydrateTextInstance,fe=e.hydrateSuspenseInstance,J=e.getNextHydratableInstanceAfterSuspenseInstance,te=e.commitHydratedContainer,re=e.commitHydratedSuspenseInstance,_e=e.clearSuspenseBoundary,Fe=e.clearSuspenseBoundaryFromContainer,Ie=e.shouldDeleteUnhydratedTailInstances,Ee=e.didNotMatchHydratedContainerTextInstance,Pe=e.didNotMatchHydratedTextInstance,Ve;function gt(o){if(Ve===void 0)try{throw Error()}catch(h){var l=h.stack.trim().match(/\n( *(at )?)/);Ve=l&&l[1]||""}return`
`+Ve+o}var Tt=!1;function er(o,l){if(!o||Tt)return"";Tt=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(Te){var p=Te}Reflect.construct(o,[],l)}else{try{l.call()}catch(Te){p=Te}o.call(l.prototype)}else{try{throw Error()}catch(Te){p=Te}o()}}catch(Te){if(Te&&p&&typeof Te.stack=="string"){for(var S=Te.stack.split(`
`),k=p.stack.split(`
`),D=S.length-1,X=k.length-1;1<=D&&0<=X&&S[D]!==k[X];)X--;for(;1<=D&&0<=X;D--,X--)if(S[D]!==k[X]){if(D!==1||X!==1)do if(D--,X--,0>X||S[D]!==k[X]){var ie=`
`+S[D].replace(" at new "," at ");return o.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",o.displayName)),ie}while(1<=D&&0<=X);break}}}finally{Tt=!1,Error.prepareStackTrace=h}return(o=o?o.displayName||o.name:"")?gt(o):""}var fs=Object.prototype.hasOwnProperty,Wi=[],Ln=-1;function Ur(o){return{current:o}}function mt(o){0>Ln||(o.current=Wi[Ln],Wi[Ln]=null,Ln--)}function at(o,l){Ln++,Wi[Ln]=o.current,o.current=l}var _a={},zr=Ur(_a),ln=Ur(!1),hs=_a;function ao(o,l){var h=o.type.contextTypes;if(!h)return _a;var p=o.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===l)return p.__reactInternalMemoizedMaskedChildContext;var S={},k;for(k in h)S[k]=l[k];return p&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=l,o.__reactInternalMemoizedMaskedChildContext=S),S}function un(o){return o=o.childContextTypes,o!=null}function T0(){mt(ln),mt(zr)}function sm(o,l,h){if(zr.current!==_a)throw Error(s(168));at(zr,l),at(ln,h)}function om(o,l,h){var p=o.stateNode;if(l=l.childContextTypes,typeof p.getChildContext!="function")return h;p=p.getChildContext();for(var S in p)if(!(S in l))throw Error(s(108,A(o)||"Unknown",S));return a({},h,p)}function C0(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||_a,hs=zr.current,at(zr,o),at(ln,ln.current),!0}function lm(o,l,h){var p=o.stateNode;if(!p)throw Error(s(169));h?(o=om(o,l,hs),p.__reactInternalMemoizedMergedChildContext=o,mt(ln),mt(zr),at(zr,o)):mt(ln),at(ln,h)}var ei=Math.clz32?Math.clz32:l8,s8=Math.log,o8=Math.LN2;function l8(o){return o>>>=0,o===0?32:31-(s8(o)/o8|0)|0}var k0=64,A0=4194304;function kl(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function F0(o,l){var h=o.pendingLanes;if(h===0)return 0;var p=0,S=o.suspendedLanes,k=o.pingedLanes,D=h&268435455;if(D!==0){var X=D&~S;X!==0?p=kl(X):(k&=D,k!==0&&(p=kl(k)))}else D=h&~S,D!==0?p=kl(D):k!==0&&(p=kl(k));if(p===0)return 0;if(l!==0&&l!==p&&!(l&S)&&(S=p&-p,k=l&-l,S>=k||S===16&&(k&4194240)!==0))return l;if(p&4&&(p|=h&16),l=o.entangledLanes,l!==0)for(o=o.entanglements,l&=p;0<l;)h=31-ei(l),S=1<<h,p|=o[h],l&=~S;return p}function u8(o,l){switch(o){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function c8(o,l){for(var h=o.suspendedLanes,p=o.pingedLanes,S=o.expirationTimes,k=o.pendingLanes;0<k;){var D=31-ei(k),X=1<<D,ie=S[D];ie===-1?(!(X&h)||X&p)&&(S[D]=u8(X,l)):ie<=l&&(o.expiredLanes|=X),k&=~X}}function _d(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function um(){var o=k0;return k0<<=1,!(k0&4194240)&&(k0=64),o}function yd(o){for(var l=[],h=0;31>h;h++)l.push(o);return l}function Al(o,l,h){o.pendingLanes|=l,l!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,l=31-ei(l),o[l]=h}function f8(o,l){var h=o.pendingLanes&~l;o.pendingLanes=l,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=l,o.mutableReadLanes&=l,o.entangledLanes&=l,l=o.entanglements;var p=o.eventTimes;for(o=o.expirationTimes;0<h;){var S=31-ei(h),k=1<<S;l[S]=0,p[S]=-1,o[S]=-1,h&=~k}}function Sd(o,l){var h=o.entangledLanes|=l;for(o=o.entanglements;h;){var p=31-ei(h),S=1<<p;S&l|o[p]&l&&(o[p]|=l),h&=~S}}var ut=0;function cm(o){return o&=-o,1<o?4<o?o&268435455?16:536870912:4:1}var wd=i.unstable_scheduleCallback,fm=i.unstable_cancelCallback,h8=i.unstable_shouldYield,d8=i.unstable_requestPaint,mr=i.unstable_now,Ed=i.unstable_ImmediatePriority,p8=i.unstable_UserBlockingPriority,Td=i.unstable_NormalPriority,g8=i.unstable_IdlePriority,P0=null,wi=null;function m8(o){if(wi&&typeof wi.onCommitFiberRoot=="function")try{wi.onCommitFiberRoot(P0,o,void 0,(o.current.flags&128)===128)}catch{}}function v8(o,l){return o===l&&(o!==0||1/o===1/l)||o!==o&&l!==l}var ti=typeof Object.is=="function"?Object.is:v8,Hi=null,N0=!1,Cd=!1;function hm(o){Hi===null?Hi=[o]:Hi.push(o)}function x8(o){N0=!0,hm(o)}function Ei(){if(!Cd&&Hi!==null){Cd=!0;var o=0,l=ut;try{var h=Hi;for(ut=1;o<h.length;o++){var p=h[o];do p=p(!0);while(p!==null)}Hi=null,N0=!1}catch(S){throw Hi!==null&&(Hi=Hi.slice(o+1)),wd(Ed,Ei),S}finally{ut=l,Cd=!1}}return null}var so=[],oo=0,R0=null,O0=0,Mn=[],Bn=0,ds=null,ji=1,Vi="";function ps(o,l){so[oo++]=O0,so[oo++]=R0,R0=o,O0=l}function dm(o,l,h){Mn[Bn++]=ji,Mn[Bn++]=Vi,Mn[Bn++]=ds,ds=o;var p=ji;o=Vi;var S=32-ei(p)-1;p&=~(1<<S),h+=1;var k=32-ei(l)+S;if(30<k){var D=S-S%5;k=(p&(1<<D)-1).toString(32),p>>=D,S-=D,ji=1<<32-ei(l)+S|h<<S|p,Vi=k+o}else ji=1<<k|h<<S|p,Vi=o}function kd(o){o.return!==null&&(ps(o,1),dm(o,1,0))}function Ad(o){for(;o===R0;)R0=so[--oo],so[oo]=null,O0=so[--oo],so[oo]=null;for(;o===ds;)ds=Mn[--Bn],Mn[Bn]=null,Vi=Mn[--Bn],Mn[Bn]=null,ji=Mn[--Bn],Mn[Bn]=null}var wn=null,Un=null,Lt=!1,Fl=!1,ri=null;function pm(o,l){var h=jn(5,null,null,0);h.elementType="DELETED",h.stateNode=l,h.return=o,l=o.deletions,l===null?(o.deletions=[h],o.flags|=16):l.push(h)}function gm(o,l){switch(o.tag){case 5:return l=md(l,o.type,o.pendingProps),l!==null?(o.stateNode=l,wn=o,Un=I(l),!0):!1;case 6:return l=vd(l,o.pendingProps),l!==null?(o.stateNode=l,wn=o,Un=null,!0):!1;case 13:if(l=Tl(l),l!==null){var h=ds!==null?{id:ji,overflow:Vi}:null;return o.memoizedState={dehydrated:l,treeContext:h,retryLane:1073741824},h=jn(18,null,null,0),h.stateNode=l,h.return=o,o.child=h,wn=o,Un=null,!0}return!1;default:return!1}}function Fd(o){return(o.mode&1)!==0&&(o.flags&128)===0}function Pd(o){if(Lt){var l=Un;if(l){var h=l;if(!gm(o,l)){if(Fd(o))throw Error(s(418));l=B(h);var p=wn;l&&gm(o,l)?pm(p,h):(o.flags=o.flags&-4097|2,Lt=!1,wn=o)}}else{if(Fd(o))throw Error(s(418));o.flags=o.flags&-4097|2,Lt=!1,wn=o}}}function mm(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;wn=o}function I0(o){if(!Ke||o!==wn)return!1;if(!Lt)return mm(o),Lt=!0,!1;if(o.tag!==3&&(o.tag!==5||Ie(o.type)&&!V(o.type,o.memoizedProps))){var l=Un;if(l){if(Fd(o))throw vm(),Error(s(418));for(;l;)pm(o,l),l=B(l)}}if(mm(o),o.tag===13){if(!Ke)throw Error(s(316));if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(s(317));Un=J(o)}else Un=wn?B(o.stateNode):null;return!0}function vm(){for(var o=Un;o;)o=B(o)}function lo(){Ke&&(Un=wn=null,Fl=Lt=!1)}function Nd(o){ri===null?ri=[o]:ri.push(o)}var _8=u.ReactCurrentBatchConfig;function D0(o,l){if(ti(o,l))return!0;if(typeof o!="object"||o===null||typeof l!="object"||l===null)return!1;var h=Object.keys(o),p=Object.keys(l);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var S=h[p];if(!fs.call(l,S)||!ti(o[S],l[S]))return!1}return!0}function y8(o){switch(o.tag){case 5:return gt(o.type);case 16:return gt("Lazy");case 13:return gt("Suspense");case 19:return gt("SuspenseList");case 0:case 2:case 15:return o=er(o.type,!1),o;case 11:return o=er(o.type.render,!1),o;case 1:return o=er(o.type,!0),o;default:return""}}function Pl(o,l,h){if(o=h.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(s(309));var p=h.stateNode}if(!p)throw Error(s(147,o));var S=p,k=""+o;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===k?l.ref:(l=function(D){var X=S.refs;D===null?delete X[k]:X[k]=D},l._stringRef=k,l)}if(typeof o!="string")throw Error(s(284));if(!h._owner)throw Error(s(290,o))}return o}function L0(o,l){throw o=Object.prototype.toString.call(l),Error(s(31,o==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":o))}function xm(o){var l=o._init;return l(o._payload)}function _m(o){function l(ne,Y){if(o){var le=ne.deletions;le===null?(ne.deletions=[Y],ne.flags|=16):le.push(Y)}}function h(ne,Y){if(!o)return null;for(;Y!==null;)l(ne,Y),Y=Y.sibling;return null}function p(ne,Y){for(ne=new Map;Y!==null;)Y.key!==null?ne.set(Y.key,Y):ne.set(Y.index,Y),Y=Y.sibling;return ne}function S(ne,Y){return ne=ka(ne,Y),ne.index=0,ne.sibling=null,ne}function k(ne,Y,le){return ne.index=le,o?(le=ne.alternate,le!==null?(le=le.index,le<Y?(ne.flags|=2,Y):le):(ne.flags|=2,Y)):(ne.flags|=1048576,Y)}function D(ne){return o&&ne.alternate===null&&(ne.flags|=2),ne}function X(ne,Y,le,Oe){return Y===null||Y.tag!==6?(Y=C1(le,ne.mode,Oe),Y.return=ne,Y):(Y=S(Y,le),Y.return=ne,Y)}function ie(ne,Y,le,Oe){var He=le.type;return He===d?Me(ne,Y,le.props.children,Oe,le.key):Y!==null&&(Y.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===m&&xm(He)===Y.type)?(Oe=S(Y,le.props),Oe.ref=Pl(ne,Y,le),Oe.return=ne,Oe):(Oe=hc(le.type,le.key,le.props,null,ne.mode,Oe),Oe.ref=Pl(ne,Y,le),Oe.return=ne,Oe)}function Te(ne,Y,le,Oe){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==le.containerInfo||Y.stateNode.implementation!==le.implementation?(Y=k1(le,ne.mode,Oe),Y.return=ne,Y):(Y=S(Y,le.children||[]),Y.return=ne,Y)}function Me(ne,Y,le,Oe,He){return Y===null||Y.tag!==7?(Y=Ss(le,ne.mode,Oe,He),Y.return=ne,Y):(Y=S(Y,le),Y.return=ne,Y)}function $e(ne,Y,le){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Y=C1(""+Y,ne.mode,le),Y.return=ne,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case c:return le=hc(Y.type,Y.key,Y.props,null,ne.mode,le),le.ref=Pl(ne,null,Y),le.return=ne,le;case f:return Y=k1(Y,ne.mode,le),Y.return=ne,Y;case m:var Oe=Y._init;return $e(ne,Oe(Y._payload),le)}if(de(Y)||R(Y))return Y=Ss(Y,ne.mode,le,null),Y.return=ne,Y;L0(ne,Y)}return null}function Re(ne,Y,le,Oe){var He=Y!==null?Y.key:null;if(typeof le=="string"&&le!==""||typeof le=="number")return He!==null?null:X(ne,Y,""+le,Oe);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case c:return le.key===He?ie(ne,Y,le,Oe):null;case f:return le.key===He?Te(ne,Y,le,Oe):null;case m:return He=le._init,Re(ne,Y,He(le._payload),Oe)}if(de(le)||R(le))return He!==null?null:Me(ne,Y,le,Oe,null);L0(ne,le)}return null}function Nt(ne,Y,le,Oe,He){if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number")return ne=ne.get(le)||null,X(Y,ne,""+Oe,He);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case c:return ne=ne.get(Oe.key===null?le:Oe.key)||null,ie(Y,ne,Oe,He);case f:return ne=ne.get(Oe.key===null?le:Oe.key)||null,Te(Y,ne,Oe,He);case m:var qe=Oe._init;return Nt(ne,Y,le,qe(Oe._payload),He)}if(de(Oe)||R(Oe))return ne=ne.get(le)||null,Me(Y,ne,Oe,He,null);L0(Y,Oe)}return null}function Ct(ne,Y,le,Oe){for(var He=null,qe=null,Qe=Y,ct=Y=0,_r=null;Qe!==null&&ct<le.length;ct++){Qe.index>ct?(_r=Qe,Qe=null):_r=Qe.sibling;var ft=Re(ne,Qe,le[ct],Oe);if(ft===null){Qe===null&&(Qe=_r);break}o&&Qe&&ft.alternate===null&&l(ne,Qe),Y=k(ft,Y,ct),qe===null?He=ft:qe.sibling=ft,qe=ft,Qe=_r}if(ct===le.length)return h(ne,Qe),Lt&&ps(ne,ct),He;if(Qe===null){for(;ct<le.length;ct++)Qe=$e(ne,le[ct],Oe),Qe!==null&&(Y=k(Qe,Y,ct),qe===null?He=Qe:qe.sibling=Qe,qe=Qe);return Lt&&ps(ne,ct),He}for(Qe=p(ne,Qe);ct<le.length;ct++)_r=Nt(Qe,ne,ct,le[ct],Oe),_r!==null&&(o&&_r.alternate!==null&&Qe.delete(_r.key===null?ct:_r.key),Y=k(_r,Y,ct),qe===null?He=_r:qe.sibling=_r,qe=_r);return o&&Qe.forEach(function(Aa){return l(ne,Aa)}),Lt&&ps(ne,ct),He}function dn(ne,Y,le,Oe){var He=R(le);if(typeof He!="function")throw Error(s(150));if(le=He.call(le),le==null)throw Error(s(151));for(var qe=He=null,Qe=Y,ct=Y=0,_r=null,ft=le.next();Qe!==null&&!ft.done;ct++,ft=le.next()){Qe.index>ct?(_r=Qe,Qe=null):_r=Qe.sibling;var Aa=Re(ne,Qe,ft.value,Oe);if(Aa===null){Qe===null&&(Qe=_r);break}o&&Qe&&Aa.alternate===null&&l(ne,Qe),Y=k(Aa,Y,ct),qe===null?He=Aa:qe.sibling=Aa,qe=Aa,Qe=_r}if(ft.done)return h(ne,Qe),Lt&&ps(ne,ct),He;if(Qe===null){for(;!ft.done;ct++,ft=le.next())ft=$e(ne,ft.value,Oe),ft!==null&&(Y=k(ft,Y,ct),qe===null?He=ft:qe.sibling=ft,qe=ft);return Lt&&ps(ne,ct),He}for(Qe=p(ne,Qe);!ft.done;ct++,ft=le.next())ft=Nt(Qe,ne,ct,ft.value,Oe),ft!==null&&(o&&ft.alternate!==null&&Qe.delete(ft.key===null?ct:ft.key),Y=k(ft,Y,ct),qe===null?He=ft:qe.sibling=ft,qe=ft);return o&&Qe.forEach(function(Q8){return l(ne,Q8)}),Lt&&ps(ne,ct),He}function Yi(ne,Y,le,Oe){if(typeof le=="object"&&le!==null&&le.type===d&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case c:e:{for(var He=le.key,qe=Y;qe!==null;){if(qe.key===He){if(He=le.type,He===d){if(qe.tag===7){h(ne,qe.sibling),Y=S(qe,le.props.children),Y.return=ne,ne=Y;break e}}else if(qe.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===m&&xm(He)===qe.type){h(ne,qe.sibling),Y=S(qe,le.props),Y.ref=Pl(ne,qe,le),Y.return=ne,ne=Y;break e}h(ne,qe);break}else l(ne,qe);qe=qe.sibling}le.type===d?(Y=Ss(le.props.children,ne.mode,Oe,le.key),Y.return=ne,ne=Y):(Oe=hc(le.type,le.key,le.props,null,ne.mode,Oe),Oe.ref=Pl(ne,Y,le),Oe.return=ne,ne=Oe)}return D(ne);case f:e:{for(qe=le.key;Y!==null;){if(Y.key===qe)if(Y.tag===4&&Y.stateNode.containerInfo===le.containerInfo&&Y.stateNode.implementation===le.implementation){h(ne,Y.sibling),Y=S(Y,le.children||[]),Y.return=ne,ne=Y;break e}else{h(ne,Y);break}else l(ne,Y);Y=Y.sibling}Y=k1(le,ne.mode,Oe),Y.return=ne,ne=Y}return D(ne);case m:return qe=le._init,Yi(ne,Y,qe(le._payload),Oe)}if(de(le))return Ct(ne,Y,le,Oe);if(R(le))return dn(ne,Y,le,Oe);L0(ne,le)}return typeof le=="string"&&le!==""||typeof le=="number"?(le=""+le,Y!==null&&Y.tag===6?(h(ne,Y.sibling),Y=S(Y,le),Y.return=ne,ne=Y):(h(ne,Y),Y=C1(le,ne.mode,Oe),Y.return=ne,ne=Y),D(ne)):h(ne,Y)}return Yi}var uo=_m(!0),ym=_m(!1),M0=Ur(null),B0=null,co=null,Rd=null;function Od(){Rd=co=B0=null}function Sm(o,l,h){ge?(at(M0,l._currentValue),l._currentValue=h):(at(M0,l._currentValue2),l._currentValue2=h)}function Id(o){var l=M0.current;mt(M0),ge?o._currentValue=l:o._currentValue2=l}function Dd(o,l,h){for(;o!==null;){var p=o.alternate;if((o.childLanes&l)!==l?(o.childLanes|=l,p!==null&&(p.childLanes|=l)):p!==null&&(p.childLanes&l)!==l&&(p.childLanes|=l),o===h)break;o=o.return}}function fo(o,l){B0=o,Rd=co=null,o=o.dependencies,o!==null&&o.firstContext!==null&&(o.lanes&l&&(cn=!0),o.firstContext=null)}function zn(o){var l=ge?o._currentValue:o._currentValue2;if(Rd!==o)if(o={context:o,memoizedValue:l,next:null},co===null){if(B0===null)throw Error(s(308));co=o,B0.dependencies={lanes:0,firstContext:o}}else co=co.next=o;return l}var gs=null;function Ld(o){gs===null?gs=[o]:gs.push(o)}function wm(o,l,h,p){var S=l.interleaved;return S===null?(h.next=h,Ld(l)):(h.next=S.next,S.next=h),l.interleaved=h,Ti(o,p)}function Ti(o,l){o.lanes|=l;var h=o.alternate;for(h!==null&&(h.lanes|=l),h=o,o=o.return;o!==null;)o.childLanes|=l,h=o.alternate,h!==null&&(h.childLanes|=l),h=o,o=o.return;return h.tag===3?h.stateNode:null}var ya=!1;function Md(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Em(o,l){o=o.updateQueue,l.updateQueue===o&&(l.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function bi(o,l){return{eventTime:o,lane:l,tag:0,payload:null,callback:null,next:null}}function Sa(o,l,h){var p=o.updateQueue;if(p===null)return null;if(p=p.shared,rt&2){var S=p.pending;return S===null?l.next=l:(l.next=S.next,S.next=l),p.pending=l,Ti(o,h)}return S=p.interleaved,S===null?(l.next=l,Ld(p)):(l.next=S.next,S.next=l),p.interleaved=l,Ti(o,h)}function U0(o,l,h){if(l=l.updateQueue,l!==null&&(l=l.shared,(h&4194240)!==0)){var p=l.lanes;p&=o.pendingLanes,h|=p,l.lanes=h,Sd(o,h)}}function Tm(o,l){var h=o.updateQueue,p=o.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var S=null,k=null;if(h=h.firstBaseUpdate,h!==null){do{var D={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};k===null?S=k=D:k=k.next=D,h=h.next}while(h!==null);k===null?S=k=l:k=k.next=l}else S=k=l;h={baseState:p.baseState,firstBaseUpdate:S,lastBaseUpdate:k,shared:p.shared,effects:p.effects},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=l:o.next=l,h.lastBaseUpdate=l}function z0(o,l,h,p){var S=o.updateQueue;ya=!1;var k=S.firstBaseUpdate,D=S.lastBaseUpdate,X=S.shared.pending;if(X!==null){S.shared.pending=null;var ie=X,Te=ie.next;ie.next=null,D===null?k=Te:D.next=Te,D=ie;var Me=o.alternate;Me!==null&&(Me=Me.updateQueue,X=Me.lastBaseUpdate,X!==D&&(X===null?Me.firstBaseUpdate=Te:X.next=Te,Me.lastBaseUpdate=ie))}if(k!==null){var $e=S.baseState;D=0,Me=Te=ie=null,X=k;do{var Re=X.lane,Nt=X.eventTime;if((p&Re)===Re){Me!==null&&(Me=Me.next={eventTime:Nt,lane:0,tag:X.tag,payload:X.payload,callback:X.callback,next:null});e:{var Ct=o,dn=X;switch(Re=l,Nt=h,dn.tag){case 1:if(Ct=dn.payload,typeof Ct=="function"){$e=Ct.call(Nt,$e,Re);break e}$e=Ct;break e;case 3:Ct.flags=Ct.flags&-65537|128;case 0:if(Ct=dn.payload,Re=typeof Ct=="function"?Ct.call(Nt,$e,Re):Ct,Re==null)break e;$e=a({},$e,Re);break e;case 2:ya=!0}}X.callback!==null&&X.lane!==0&&(o.flags|=64,Re=S.effects,Re===null?S.effects=[X]:Re.push(X))}else Nt={eventTime:Nt,lane:Re,tag:X.tag,payload:X.payload,callback:X.callback,next:null},Me===null?(Te=Me=Nt,ie=$e):Me=Me.next=Nt,D|=Re;if(X=X.next,X===null){if(X=S.shared.pending,X===null)break;Re=X,X=Re.next,Re.next=null,S.lastBaseUpdate=Re,S.shared.pending=null}}while(!0);if(Me===null&&(ie=$e),S.baseState=ie,S.firstBaseUpdate=Te,S.lastBaseUpdate=Me,l=S.shared.interleaved,l!==null){S=l;do D|=S.lane,S=S.next;while(S!==l)}else k===null&&(S.shared.lanes=0);vs|=D,o.lanes=D,o.memoizedState=$e}}function Cm(o,l,h){if(o=l.effects,l.effects=null,o!==null)for(l=0;l<o.length;l++){var p=o[l],S=p.callback;if(S!==null){if(p.callback=null,p=h,typeof S!="function")throw Error(s(191,S));S.call(p)}}}var Nl={},Gn=Ur(Nl),Rl=Ur(Nl),ho=Ur(Nl);function Ci(o){if(o===Nl)throw Error(s(174));return o}function Bd(o,l){at(ho,l),at(Rl,o),at(Gn,Nl),o=Ge(l),mt(Gn),at(Gn,o)}function po(){mt(Gn),mt(Rl),mt(ho)}function km(o){var l=Ci(ho.current),h=Ci(Gn.current);l=ue(h,o.type,l),h!==l&&(at(Rl,o),at(Gn,l))}function Ud(o){Rl.current===o&&(mt(Gn),mt(Rl))}var zt=Ur(0);function G0(o){for(var l=o;l!==null;){if(l.tag===13){var h=l.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||E0(h)||Cl(h)))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if(l.flags&128)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var zd=[];function Gd(){for(var o=0;o<zd.length;o++){var l=zd[o];ge?l._workInProgressVersionPrimary=null:l._workInProgressVersionSecondary=null}zd.length=0}var W0=u.ReactCurrentDispatcher,Wd=u.ReactCurrentBatchConfig,ms=0,Gt=null,or=null,vr=null,H0=!1,Ol=!1,Il=0,S8=0;function Gr(){throw Error(s(321))}function Hd(o,l){if(l===null)return!1;for(var h=0;h<l.length&&h<o.length;h++)if(!ti(o[h],l[h]))return!1;return!0}function jd(o,l,h,p,S,k){if(ms=k,Gt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,W0.current=o===null||o.memoizedState===null?C8:k8,o=h(p,S),Ol){k=0;do{if(Ol=!1,Il=0,25<=k)throw Error(s(301));k+=1,vr=or=null,l.updateQueue=null,W0.current=A8,o=h(p,S)}while(Ol)}if(W0.current=b0,l=or!==null&&or.next!==null,ms=0,vr=or=Gt=null,H0=!1,l)throw Error(s(300));return o}function Vd(){var o=Il!==0;return Il=0,o}function ki(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vr===null?Gt.memoizedState=vr=o:vr=vr.next=o,vr}function Wn(){if(or===null){var o=Gt.alternate;o=o!==null?o.memoizedState:null}else o=or.next;var l=vr===null?Gt.memoizedState:vr.next;if(l!==null)vr=l,or=o;else{if(o===null)throw Error(s(310));or=o,o={memoizedState:or.memoizedState,baseState:or.baseState,baseQueue:or.baseQueue,queue:or.queue,next:null},vr===null?Gt.memoizedState=vr=o:vr=vr.next=o}return vr}function Dl(o,l){return typeof l=="function"?l(o):l}function bd(o){var l=Wn(),h=l.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=o;var p=or,S=p.baseQueue,k=h.pending;if(k!==null){if(S!==null){var D=S.next;S.next=k.next,k.next=D}p.baseQueue=S=k,h.pending=null}if(S!==null){k=S.next,p=p.baseState;var X=D=null,ie=null,Te=k;do{var Me=Te.lane;if((ms&Me)===Me)ie!==null&&(ie=ie.next={lane:0,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null}),p=Te.hasEagerState?Te.eagerState:o(p,Te.action);else{var $e={lane:Me,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null};ie===null?(X=ie=$e,D=p):ie=ie.next=$e,Gt.lanes|=Me,vs|=Me}Te=Te.next}while(Te!==null&&Te!==k);ie===null?D=p:ie.next=X,ti(p,l.memoizedState)||(cn=!0),l.memoizedState=p,l.baseState=D,l.baseQueue=ie,h.lastRenderedState=p}if(o=h.interleaved,o!==null){S=o;do k=S.lane,Gt.lanes|=k,vs|=k,S=S.next;while(S!==o)}else S===null&&(h.lanes=0);return[l.memoizedState,h.dispatch]}function Xd(o){var l=Wn(),h=l.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=o;var p=h.dispatch,S=h.pending,k=l.memoizedState;if(S!==null){h.pending=null;var D=S=S.next;do k=o(k,D.action),D=D.next;while(D!==S);ti(k,l.memoizedState)||(cn=!0),l.memoizedState=k,l.baseQueue===null&&(l.baseState=k),h.lastRenderedState=k}return[k,p]}function Am(){}function Fm(o,l){var h=Gt,p=Wn(),S=l(),k=!ti(p.memoizedState,S);if(k&&(p.memoizedState=S,cn=!0),p=p.queue,Kd(Rm.bind(null,h,p,o),[o]),p.getSnapshot!==l||k||vr!==null&&vr.memoizedState.tag&1){if(h.flags|=2048,Ll(9,Nm.bind(null,h,p,S,l),void 0,null),xr===null)throw Error(s(349));ms&30||Pm(h,l,S)}return S}function Pm(o,l,h){o.flags|=16384,o={getSnapshot:l,value:h},l=Gt.updateQueue,l===null?(l={lastEffect:null,stores:null},Gt.updateQueue=l,l.stores=[o]):(h=l.stores,h===null?l.stores=[o]:h.push(o))}function Nm(o,l,h,p){l.value=h,l.getSnapshot=p,Om(l)&&Im(o)}function Rm(o,l,h){return h(function(){Om(l)&&Im(o)})}function Om(o){var l=o.getSnapshot;o=o.value;try{var h=l();return!ti(o,h)}catch{return!0}}function Im(o){var l=Ti(o,1);l!==null&&Hn(l,o,1,-1)}function Dm(o){var l=ki();return typeof o=="function"&&(o=o()),l.memoizedState=l.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dl,lastRenderedState:o},l.queue=o,o=o.dispatch=T8.bind(null,Gt,o),[l.memoizedState,o]}function Ll(o,l,h,p){return o={tag:o,create:l,destroy:h,deps:p,next:null},l=Gt.updateQueue,l===null?(l={lastEffect:null,stores:null},Gt.updateQueue=l,l.lastEffect=o.next=o):(h=l.lastEffect,h===null?l.lastEffect=o.next=o:(p=h.next,h.next=o,o.next=p,l.lastEffect=o)),o}function Lm(){return Wn().memoizedState}function j0(o,l,h,p){var S=ki();Gt.flags|=o,S.memoizedState=Ll(1|l,h,void 0,p===void 0?null:p)}function V0(o,l,h,p){var S=Wn();p=p===void 0?null:p;var k=void 0;if(or!==null){var D=or.memoizedState;if(k=D.destroy,p!==null&&Hd(p,D.deps)){S.memoizedState=Ll(l,h,k,p);return}}Gt.flags|=o,S.memoizedState=Ll(1|l,h,k,p)}function Mm(o,l){return j0(8390656,8,o,l)}function Kd(o,l){return V0(2048,8,o,l)}function Bm(o,l){return V0(4,2,o,l)}function Um(o,l){return V0(4,4,o,l)}function zm(o,l){if(typeof l=="function")return o=o(),l(o),function(){l(null)};if(l!=null)return o=o(),l.current=o,function(){l.current=null}}function Gm(o,l,h){return h=h!=null?h.concat([o]):null,V0(4,4,zm.bind(null,l,o),h)}function Yd(){}function Wm(o,l){var h=Wn();l=l===void 0?null:l;var p=h.memoizedState;return p!==null&&l!==null&&Hd(l,p[1])?p[0]:(h.memoizedState=[o,l],o)}function Hm(o,l){var h=Wn();l=l===void 0?null:l;var p=h.memoizedState;return p!==null&&l!==null&&Hd(l,p[1])?p[0]:(o=o(),h.memoizedState=[o,l],o)}function jm(o,l,h){return ms&21?(ti(h,l)||(h=um(),Gt.lanes|=h,vs|=h,o.baseState=!0),l):(o.baseState&&(o.baseState=!1,cn=!0),o.memoizedState=h)}function w8(o,l){var h=ut;ut=h!==0&&4>h?h:4,o(!0);var p=Wd.transition;Wd.transition={};try{o(!1),l()}finally{ut=h,Wd.transition=p}}function Vm(){return Wn().memoizedState}function E8(o,l,h){var p=Ta(o);if(h={lane:p,action:h,hasEagerState:!1,eagerState:null,next:null},bm(o))Xm(l,h);else if(h=wm(o,l,h,p),h!==null){var S=jr();Hn(h,o,p,S),Km(h,l,p)}}function T8(o,l,h){var p=Ta(o),S={lane:p,action:h,hasEagerState:!1,eagerState:null,next:null};if(bm(o))Xm(l,S);else{var k=o.alternate;if(o.lanes===0&&(k===null||k.lanes===0)&&(k=l.lastRenderedReducer,k!==null))try{var D=l.lastRenderedState,X=k(D,h);if(S.hasEagerState=!0,S.eagerState=X,ti(X,D)){var ie=l.interleaved;ie===null?(S.next=S,Ld(l)):(S.next=ie.next,ie.next=S),l.interleaved=S;return}}catch{}finally{}h=wm(o,l,S,p),h!==null&&(S=jr(),Hn(h,o,p,S),Km(h,l,p))}}function bm(o){var l=o.alternate;return o===Gt||l!==null&&l===Gt}function Xm(o,l){Ol=H0=!0;var h=o.pending;h===null?l.next=l:(l.next=h.next,h.next=l),o.pending=l}function Km(o,l,h){if(h&4194240){var p=l.lanes;p&=o.pendingLanes,h|=p,l.lanes=h,Sd(o,h)}}var b0={readContext:zn,useCallback:Gr,useContext:Gr,useEffect:Gr,useImperativeHandle:Gr,useInsertionEffect:Gr,useLayoutEffect:Gr,useMemo:Gr,useReducer:Gr,useRef:Gr,useState:Gr,useDebugValue:Gr,useDeferredValue:Gr,useTransition:Gr,useMutableSource:Gr,useSyncExternalStore:Gr,useId:Gr,unstable_isNewReconciler:!1},C8={readContext:zn,useCallback:function(o,l){return ki().memoizedState=[o,l===void 0?null:l],o},useContext:zn,useEffect:Mm,useImperativeHandle:function(o,l,h){return h=h!=null?h.concat([o]):null,j0(4194308,4,zm.bind(null,l,o),h)},useLayoutEffect:function(o,l){return j0(4194308,4,o,l)},useInsertionEffect:function(o,l){return j0(4,2,o,l)},useMemo:function(o,l){var h=ki();return l=l===void 0?null:l,o=o(),h.memoizedState=[o,l],o},useReducer:function(o,l,h){var p=ki();return l=h!==void 0?h(l):l,p.memoizedState=p.baseState=l,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:l},p.queue=o,o=o.dispatch=E8.bind(null,Gt,o),[p.memoizedState,o]},useRef:function(o){var l=ki();return o={current:o},l.memoizedState=o},useState:Dm,useDebugValue:Yd,useDeferredValue:function(o){return ki().memoizedState=o},useTransition:function(){var o=Dm(!1),l=o[0];return o=w8.bind(null,o[1]),ki().memoizedState=o,[l,o]},useMutableSource:function(){},useSyncExternalStore:function(o,l,h){var p=Gt,S=ki();if(Lt){if(h===void 0)throw Error(s(407));h=h()}else{if(h=l(),xr===null)throw Error(s(349));ms&30||Pm(p,l,h)}S.memoizedState=h;var k={value:h,getSnapshot:l};return S.queue=k,Mm(Rm.bind(null,p,k,o),[o]),p.flags|=2048,Ll(9,Nm.bind(null,p,k,h,l),void 0,null),h},useId:function(){var o=ki(),l=xr.identifierPrefix;if(Lt){var h=Vi,p=ji;h=(p&~(1<<32-ei(p)-1)).toString(32)+h,l=":"+l+"R"+h,h=Il++,0<h&&(l+="H"+h.toString(32)),l+=":"}else h=S8++,l=":"+l+"r"+h.toString(32)+":";return o.memoizedState=l},unstable_isNewReconciler:!1},k8={readContext:zn,useCallback:Wm,useContext:zn,useEffect:Kd,useImperativeHandle:Gm,useInsertionEffect:Bm,useLayoutEffect:Um,useMemo:Hm,useReducer:bd,useRef:Lm,useState:function(){return bd(Dl)},useDebugValue:Yd,useDeferredValue:function(o){var l=Wn();return jm(l,or.memoizedState,o)},useTransition:function(){var o=bd(Dl)[0],l=Wn().memoizedState;return[o,l]},useMutableSource:Am,useSyncExternalStore:Fm,useId:Vm,unstable_isNewReconciler:!1},A8={readContext:zn,useCallback:Wm,useContext:zn,useEffect:Kd,useImperativeHandle:Gm,useInsertionEffect:Bm,useLayoutEffect:Um,useMemo:Hm,useReducer:Xd,useRef:Lm,useState:function(){return Xd(Dl)},useDebugValue:Yd,useDeferredValue:function(o){var l=Wn();return or===null?l.memoizedState=o:jm(l,or.memoizedState,o)},useTransition:function(){var o=Xd(Dl)[0],l=Wn().memoizedState;return[o,l]},useMutableSource:Am,useSyncExternalStore:Fm,useId:Vm,unstable_isNewReconciler:!1};function ni(o,l){if(o&&o.defaultProps){l=a({},l),o=o.defaultProps;for(var h in o)l[h]===void 0&&(l[h]=o[h]);return l}return l}function $d(o,l,h,p){l=o.memoizedState,h=h(p,l),h=h==null?l:a({},l,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var X0={isMounted:function(o){return(o=o._reactInternals)?L(o)===o:!1},enqueueSetState:function(o,l,h){o=o._reactInternals;var p=jr(),S=Ta(o),k=bi(p,S);k.payload=l,h!=null&&(k.callback=h),l=Sa(o,k,S),l!==null&&(Hn(l,o,S,p),U0(l,o,S))},enqueueReplaceState:function(o,l,h){o=o._reactInternals;var p=jr(),S=Ta(o),k=bi(p,S);k.tag=1,k.payload=l,h!=null&&(k.callback=h),l=Sa(o,k,S),l!==null&&(Hn(l,o,S,p),U0(l,o,S))},enqueueForceUpdate:function(o,l){o=o._reactInternals;var h=jr(),p=Ta(o),S=bi(h,p);S.tag=2,l!=null&&(S.callback=l),l=Sa(o,S,p),l!==null&&(Hn(l,o,p,h),U0(l,o,p))}};function Ym(o,l,h,p,S,k,D){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(p,k,D):l.prototype&&l.prototype.isPureReactComponent?!D0(h,p)||!D0(S,k):!0}function $m(o,l,h){var p=!1,S=_a,k=l.contextType;return typeof k=="object"&&k!==null?k=zn(k):(S=un(l)?hs:zr.current,p=l.contextTypes,k=(p=p!=null)?ao(o,S):_a),l=new l(h,k),o.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=X0,o.stateNode=l,l._reactInternals=o,p&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=S,o.__reactInternalMemoizedMaskedChildContext=k),l}function Qm(o,l,h,p){o=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(h,p),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(h,p),l.state!==o&&X0.enqueueReplaceState(l,l.state,null)}function Qd(o,l,h,p){var S=o.stateNode;S.props=h,S.state=o.memoizedState,S.refs={},Md(o);var k=l.contextType;typeof k=="object"&&k!==null?S.context=zn(k):(k=un(l)?hs:zr.current,S.context=ao(o,k)),S.state=o.memoizedState,k=l.getDerivedStateFromProps,typeof k=="function"&&($d(o,l,k,h),S.state=o.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(l=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),l!==S.state&&X0.enqueueReplaceState(S,S.state,null),z0(o,h,S,p),S.state=o.memoizedState),typeof S.componentDidMount=="function"&&(o.flags|=4194308)}function go(o,l){try{var h="",p=l;do h+=y8(p),p=p.return;while(p);var S=h}catch(k){S=`
Error generating stack: `+k.message+`
`+k.stack}return{value:o,source:l,stack:S,digest:null}}function qd(o,l,h){return{value:o,source:null,stack:h??null,digest:l??null}}function Jd(o,l){try{console.error(l.value)}catch(h){setTimeout(function(){throw h})}}var F8=typeof WeakMap=="function"?WeakMap:Map;function qm(o,l,h){h=bi(-1,h),h.tag=3,h.payload={element:null};var p=l.value;return h.callback=function(){sc||(sc=!0,x1=p),Jd(o,l)},h}function Jm(o,l,h){h=bi(-1,h),h.tag=3;var p=o.type.getDerivedStateFromError;if(typeof p=="function"){var S=l.value;h.payload=function(){return p(S)},h.callback=function(){Jd(o,l)}}var k=o.stateNode;return k!==null&&typeof k.componentDidCatch=="function"&&(h.callback=function(){Jd(o,l),typeof p!="function"&&(wa===null?wa=new Set([this]):wa.add(this));var D=l.stack;this.componentDidCatch(l.value,{componentStack:D!==null?D:""})}),h}function Zm(o,l,h){var p=o.pingCache;if(p===null){p=o.pingCache=new F8;var S=new Set;p.set(l,S)}else S=p.get(l),S===void 0&&(S=new Set,p.set(l,S));S.has(h)||(S.add(h),o=H8.bind(null,o,l,h),l.then(o,o))}function ev(o){do{var l;if((l=o.tag===13)&&(l=o.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return o;o=o.return}while(o!==null);return null}function tv(o,l,h,p,S){return o.mode&1?(o.flags|=65536,o.lanes=S,o):(o===l?o.flags|=65536:(o.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(l=bi(-1,1),l.tag=2,Sa(h,l,1))),h.lanes|=1),o)}var P8=u.ReactCurrentOwner,cn=!1;function Zr(o,l,h,p){l.child=o===null?ym(l,null,h,p):uo(l,o.child,h,p)}function rv(o,l,h,p,S){h=h.render;var k=l.ref;return fo(l,S),p=jd(o,l,h,p,k,S),h=Vd(),o!==null&&!cn?(l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~S,Xi(o,l,S)):(Lt&&h&&kd(l),l.flags|=1,Zr(o,l,p,S),l.child)}function nv(o,l,h,p,S){if(o===null){var k=h.type;return typeof k=="function"&&!T1(k)&&k.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(l.tag=15,l.type=k,iv(o,l,k,p,S)):(o=hc(h.type,null,p,l,l.mode,S),o.ref=l.ref,o.return=l,l.child=o)}if(k=o.child,!(o.lanes&S)){var D=k.memoizedProps;if(h=h.compare,h=h!==null?h:D0,h(D,p)&&o.ref===l.ref)return Xi(o,l,S)}return l.flags|=1,o=ka(k,p),o.ref=l.ref,o.return=l,l.child=o}function iv(o,l,h,p,S){if(o!==null){var k=o.memoizedProps;if(D0(k,p)&&o.ref===l.ref)if(cn=!1,l.pendingProps=p=k,(o.lanes&S)!==0)o.flags&131072&&(cn=!0);else return l.lanes=o.lanes,Xi(o,l,S)}return Zd(o,l,h,p,S)}function av(o,l,h){var p=l.pendingProps,S=p.children,k=o!==null?o.memoizedState:null;if(p.mode==="hidden")if(!(l.mode&1))l.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(vo,En),En|=h;else{if(!(h&1073741824))return o=k!==null?k.baseLanes|h:h,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:o,cachePool:null,transitions:null},l.updateQueue=null,at(vo,En),En|=o,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=k!==null?k.baseLanes:h,at(vo,En),En|=p}else k!==null?(p=k.baseLanes|h,l.memoizedState=null):p=h,at(vo,En),En|=p;return Zr(o,l,S,h),l.child}function sv(o,l){var h=l.ref;(o===null&&h!==null||o!==null&&o.ref!==h)&&(l.flags|=512,l.flags|=2097152)}function Zd(o,l,h,p,S){var k=un(h)?hs:zr.current;return k=ao(l,k),fo(l,S),h=jd(o,l,h,p,k,S),p=Vd(),o!==null&&!cn?(l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~S,Xi(o,l,S)):(Lt&&p&&kd(l),l.flags|=1,Zr(o,l,h,S),l.child)}function ov(o,l,h,p,S){if(un(h)){var k=!0;C0(l)}else k=!1;if(fo(l,S),l.stateNode===null)Y0(o,l),$m(l,h,p),Qd(l,h,p,S),p=!0;else if(o===null){var D=l.stateNode,X=l.memoizedProps;D.props=X;var ie=D.context,Te=h.contextType;typeof Te=="object"&&Te!==null?Te=zn(Te):(Te=un(h)?hs:zr.current,Te=ao(l,Te));var Me=h.getDerivedStateFromProps,$e=typeof Me=="function"||typeof D.getSnapshotBeforeUpdate=="function";$e||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(X!==p||ie!==Te)&&Qm(l,D,p,Te),ya=!1;var Re=l.memoizedState;D.state=Re,z0(l,p,D,S),ie=l.memoizedState,X!==p||Re!==ie||ln.current||ya?(typeof Me=="function"&&($d(l,h,Me,p),ie=l.memoizedState),(X=ya||Ym(l,h,X,p,Re,ie,Te))?($e||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(l.flags|=4194308)):(typeof D.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=p,l.memoizedState=ie),D.props=p,D.state=ie,D.context=Te,p=X):(typeof D.componentDidMount=="function"&&(l.flags|=4194308),p=!1)}else{D=l.stateNode,Em(o,l),X=l.memoizedProps,Te=l.type===l.elementType?X:ni(l.type,X),D.props=Te,$e=l.pendingProps,Re=D.context,ie=h.contextType,typeof ie=="object"&&ie!==null?ie=zn(ie):(ie=un(h)?hs:zr.current,ie=ao(l,ie));var Nt=h.getDerivedStateFromProps;(Me=typeof Nt=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(X!==$e||Re!==ie)&&Qm(l,D,p,ie),ya=!1,Re=l.memoizedState,D.state=Re,z0(l,p,D,S);var Ct=l.memoizedState;X!==$e||Re!==Ct||ln.current||ya?(typeof Nt=="function"&&($d(l,h,Nt,p),Ct=l.memoizedState),(Te=ya||Ym(l,h,Te,p,Re,Ct,ie)||!1)?(Me||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(p,Ct,ie),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(p,Ct,ie)),typeof D.componentDidUpdate=="function"&&(l.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof D.componentDidUpdate!="function"||X===o.memoizedProps&&Re===o.memoizedState||(l.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||X===o.memoizedProps&&Re===o.memoizedState||(l.flags|=1024),l.memoizedProps=p,l.memoizedState=Ct),D.props=p,D.state=Ct,D.context=ie,p=Te):(typeof D.componentDidUpdate!="function"||X===o.memoizedProps&&Re===o.memoizedState||(l.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||X===o.memoizedProps&&Re===o.memoizedState||(l.flags|=1024),p=!1)}return e1(o,l,h,p,k,S)}function e1(o,l,h,p,S,k){sv(o,l);var D=(l.flags&128)!==0;if(!p&&!D)return S&&lm(l,h,!1),Xi(o,l,k);p=l.stateNode,P8.current=l;var X=D&&typeof h.getDerivedStateFromError!="function"?null:p.render();return l.flags|=1,o!==null&&D?(l.child=uo(l,o.child,null,k),l.child=uo(l,null,X,k)):Zr(o,l,X,k),l.memoizedState=p.state,S&&lm(l,h,!0),l.child}function lv(o){var l=o.stateNode;l.pendingContext?sm(o,l.pendingContext,l.pendingContext!==l.context):l.context&&sm(o,l.context,!1),Bd(o,l.containerInfo)}function uv(o,l,h,p,S){return lo(),Nd(S),l.flags|=256,Zr(o,l,h,p),l.child}var t1={dehydrated:null,treeContext:null,retryLane:0};function r1(o){return{baseLanes:o,cachePool:null,transitions:null}}function cv(o,l,h){var p=l.pendingProps,S=zt.current,k=!1,D=(l.flags&128)!==0,X;if((X=D)||(X=o!==null&&o.memoizedState===null?!1:(S&2)!==0),X?(k=!0,l.flags&=-129):(o===null||o.memoizedState!==null)&&(S|=1),at(zt,S&1),o===null)return Pd(l),o=l.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?(l.mode&1?Cl(o)?l.lanes=8:l.lanes=1073741824:l.lanes=1,null):(D=p.children,o=p.fallback,k?(p=l.mode,k=l.child,D={mode:"hidden",children:D},!(p&1)&&k!==null?(k.childLanes=0,k.pendingProps=D):k=dc(D,p,0,null),o=Ss(o,p,h,null),k.return=l,o.return=l,k.sibling=o,l.child=k,l.child.memoizedState=r1(h),l.memoizedState=t1,o):n1(l,D));if(S=o.memoizedState,S!==null&&(X=S.dehydrated,X!==null))return N8(o,l,D,p,X,S,h);if(k){k=p.fallback,D=l.mode,S=o.child,X=S.sibling;var ie={mode:"hidden",children:p.children};return!(D&1)&&l.child!==S?(p=l.child,p.childLanes=0,p.pendingProps=ie,l.deletions=null):(p=ka(S,ie),p.subtreeFlags=S.subtreeFlags&14680064),X!==null?k=ka(X,k):(k=Ss(k,D,h,null),k.flags|=2),k.return=l,p.return=l,p.sibling=k,l.child=p,p=k,k=l.child,D=o.child.memoizedState,D=D===null?r1(h):{baseLanes:D.baseLanes|h,cachePool:null,transitions:D.transitions},k.memoizedState=D,k.childLanes=o.childLanes&~h,l.memoizedState=t1,p}return k=o.child,o=k.sibling,p=ka(k,{mode:"visible",children:p.children}),!(l.mode&1)&&(p.lanes=h),p.return=l,p.sibling=null,o!==null&&(h=l.deletions,h===null?(l.deletions=[o],l.flags|=16):h.push(o)),l.child=p,l.memoizedState=null,p}function n1(o,l){return l=dc({mode:"visible",children:l},o.mode,0,null),l.return=o,o.child=l}function K0(o,l,h,p){return p!==null&&Nd(p),uo(l,o.child,null,h),o=n1(l,l.pendingProps.children),o.flags|=2,l.memoizedState=null,o}function N8(o,l,h,p,S,k,D){if(h)return l.flags&256?(l.flags&=-257,p=qd(Error(s(422))),K0(o,l,D,p)):l.memoizedState!==null?(l.child=o.child,l.flags|=128,null):(k=p.fallback,S=l.mode,p=dc({mode:"visible",children:p.children},S,0,null),k=Ss(k,S,D,null),k.flags|=2,p.return=l,k.return=l,p.sibling=k,l.child=p,l.mode&1&&uo(l,o.child,null,D),l.child.memoizedState=r1(D),l.memoizedState=t1,k);if(!(l.mode&1))return K0(o,l,D,null);if(Cl(S))return p=xd(S).digest,k=Error(s(419)),p=qd(k,p,void 0),K0(o,l,D,p);if(h=(D&o.childLanes)!==0,cn||h){if(p=xr,p!==null){switch(D&-D){case 4:S=2;break;case 16:S=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:S=32;break;case 536870912:S=268435456;break;default:S=0}S=S&(p.suspendedLanes|D)?0:S,S!==0&&S!==k.retryLane&&(k.retryLane=S,Ti(o,S),Hn(p,o,S,-1))}return E1(),p=qd(Error(s(421))),K0(o,l,D,p)}return E0(S)?(l.flags|=128,l.child=o.child,l=j8.bind(null,o),P(S,l),null):(o=k.treeContext,Ke&&(Un=U(S),wn=l,Lt=!0,ri=null,Fl=!1,o!==null&&(Mn[Bn++]=ji,Mn[Bn++]=Vi,Mn[Bn++]=ds,ji=o.id,Vi=o.overflow,ds=l)),l=n1(l,p.children),l.flags|=4096,l)}function fv(o,l,h){o.lanes|=l;var p=o.alternate;p!==null&&(p.lanes|=l),Dd(o.return,l,h)}function i1(o,l,h,p,S){var k=o.memoizedState;k===null?o.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:S}:(k.isBackwards=l,k.rendering=null,k.renderingStartTime=0,k.last=p,k.tail=h,k.tailMode=S)}function hv(o,l,h){var p=l.pendingProps,S=p.revealOrder,k=p.tail;if(Zr(o,l,p.children,h),p=zt.current,p&2)p=p&1|2,l.flags|=128;else{if(o!==null&&o.flags&128)e:for(o=l.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&fv(o,h,l);else if(o.tag===19)fv(o,h,l);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===l)break e;for(;o.sibling===null;){if(o.return===null||o.return===l)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}p&=1}if(at(zt,p),!(l.mode&1))l.memoizedState=null;else switch(S){case"forwards":for(h=l.child,S=null;h!==null;)o=h.alternate,o!==null&&G0(o)===null&&(S=h),h=h.sibling;h=S,h===null?(S=l.child,l.child=null):(S=h.sibling,h.sibling=null),i1(l,!1,S,h,k);break;case"backwards":for(h=null,S=l.child,l.child=null;S!==null;){if(o=S.alternate,o!==null&&G0(o)===null){l.child=S;break}o=S.sibling,S.sibling=h,h=S,S=o}i1(l,!0,h,null,k);break;case"together":i1(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Y0(o,l){!(l.mode&1)&&o!==null&&(o.alternate=null,l.alternate=null,l.flags|=2)}function Xi(o,l,h){if(o!==null&&(l.dependencies=o.dependencies),vs|=l.lanes,!(h&l.childLanes))return null;if(o!==null&&l.child!==o.child)throw Error(s(153));if(l.child!==null){for(o=l.child,h=ka(o,o.pendingProps),l.child=h,h.return=l;o.sibling!==null;)o=o.sibling,h=h.sibling=ka(o,o.pendingProps),h.return=l;h.sibling=null}return l.child}function R8(o,l,h){switch(l.tag){case 3:lv(l),lo();break;case 5:km(l);break;case 1:un(l.type)&&C0(l);break;case 4:Bd(l,l.stateNode.containerInfo);break;case 10:Sm(l,l.type._context,l.memoizedProps.value);break;case 13:var p=l.memoizedState;if(p!==null)return p.dehydrated!==null?(at(zt,zt.current&1),l.flags|=128,null):h&l.child.childLanes?cv(o,l,h):(at(zt,zt.current&1),o=Xi(o,l,h),o!==null?o.sibling:null);at(zt,zt.current&1);break;case 19:if(p=(h&l.childLanes)!==0,o.flags&128){if(p)return hv(o,l,h);l.flags|=128}var S=l.memoizedState;if(S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),at(zt,zt.current),p)break;return null;case 22:case 23:return l.lanes=0,av(o,l,h)}return Xi(o,l,h)}function Ai(o){o.flags|=4}function dv(o,l){if(o!==null&&o.child===l.child)return!0;if(l.flags&16)return!1;for(o=l.child;o!==null;){if(o.flags&12854||o.subtreeFlags&12854)return!1;o=o.sibling}return!0}var Ml,Bl,$0,Q0;if(Ne)Ml=function(o,l){for(var h=l.child;h!==null;){if(h.tag===5||h.tag===6)z(o,h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===l)break;for(;h.sibling===null;){if(h.return===null||h.return===l)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},Bl=function(){},$0=function(o,l,h,p,S){if(o=o.memoizedProps,o!==p){var k=l.stateNode,D=Ci(Gn.current);h=b(k,h,o,p,S,D),(l.updateQueue=h)&&Ai(l)}},Q0=function(o,l,h,p){h!==p&&Ai(l)};else if(Be){Ml=function(o,l,h,p){for(var S=l.child;S!==null;){if(S.tag===5){var k=S.stateNode;h&&p&&(k=S0(k,S.type,S.memoizedProps,S)),z(o,k)}else if(S.tag===6)k=S.stateNode,h&&p&&(k=w0(k,S.memoizedProps,S)),z(o,k);else if(S.tag!==4){if(S.tag===22&&S.memoizedState!==null)k=S.child,k!==null&&(k.return=S),Ml(o,S,!0,!0);else if(S.child!==null){S.child.return=S,S=S.child;continue}}if(S===l)break;for(;S.sibling===null;){if(S.return===null||S.return===l)return;S=S.return}S.sibling.return=S.return,S=S.sibling}};var pv=function(o,l,h,p){for(var S=l.child;S!==null;){if(S.tag===5){var k=S.stateNode;h&&p&&(k=S0(k,S.type,S.memoizedProps,S)),y0(o,k)}else if(S.tag===6)k=S.stateNode,h&&p&&(k=w0(k,S.memoizedProps,S)),y0(o,k);else if(S.tag!==4){if(S.tag===22&&S.memoizedState!==null)k=S.child,k!==null&&(k.return=S),pv(o,S,!0,!0);else if(S.child!==null){S.child.return=S,S=S.child;continue}}if(S===l)break;for(;S.sibling===null;){if(S.return===null||S.return===l)return;S=S.return}S.sibling.return=S.return,S=S.sibling}};Bl=function(o,l){var h=l.stateNode;if(!dv(o,l)){o=h.containerInfo;var p=_0(o);pv(p,l,!1,!1),h.pendingChildren=p,Ai(l),gd(o,p)}},$0=function(o,l,h,p,S){var k=o.stateNode,D=o.memoizedProps;if((o=dv(o,l))&&D===p)l.stateNode=k;else{var X=l.stateNode,ie=Ci(Gn.current),Te=null;D!==p&&(Te=b(X,h,D,p,S,ie)),o&&Te===null?l.stateNode=k:(k=io(k,Te,h,D,p,l,o,X),K(k,h,p,S,ie)&&Ai(l),l.stateNode=k,o?Ai(l):Ml(k,l,!1,!1))}},Q0=function(o,l,h,p){h!==p?(o=Ci(ho.current),h=Ci(Gn.current),l.stateNode=oe(p,o,h,l),Ai(l)):l.stateNode=o.stateNode}}else Bl=function(){},$0=function(){},Q0=function(){};function Ul(o,l){if(!Lt)switch(o.tailMode){case"hidden":l=o.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?l||o.tail===null?o.tail=null:o.tail.sibling=null:p.sibling=null}}function Wr(o){var l=o.alternate!==null&&o.alternate.child===o.child,h=0,p=0;if(l)for(var S=o.child;S!==null;)h|=S.lanes|S.childLanes,p|=S.subtreeFlags&14680064,p|=S.flags&14680064,S.return=o,S=S.sibling;else for(S=o.child;S!==null;)h|=S.lanes|S.childLanes,p|=S.subtreeFlags,p|=S.flags,S.return=o,S=S.sibling;return o.subtreeFlags|=p,o.childLanes=h,l}function O8(o,l,h){var p=l.pendingProps;switch(Ad(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wr(l),null;case 1:return un(l.type)&&T0(),Wr(l),null;case 3:return h=l.stateNode,po(),mt(ln),mt(zr),Gd(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(o===null||o.child===null)&&(I0(l)?Ai(l):o===null||o.memoizedState.isDehydrated&&!(l.flags&256)||(l.flags|=1024,ri!==null&&(S1(ri),ri=null))),Bl(o,l),Wr(l),null;case 5:Ud(l),h=Ci(ho.current);var S=l.type;if(o!==null&&l.stateNode!=null)$0(o,l,S,p,h),o.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!p){if(l.stateNode===null)throw Error(s(166));return Wr(l),null}if(o=Ci(Gn.current),I0(l)){if(!Ke)throw Error(s(175));o=G(l.stateNode,l.type,l.memoizedProps,h,o,l,!Fl),l.updateQueue=o,o!==null&&Ai(l)}else{var k=we(S,p,h,o,l);Ml(k,l,!1,!1),l.stateNode=k,K(k,S,p,h,o)&&Ai(l)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Wr(l),null;case 6:if(o&&l.stateNode!=null)Q0(o,l,o.memoizedProps,p);else{if(typeof p!="string"&&l.stateNode===null)throw Error(s(166));if(o=Ci(ho.current),h=Ci(Gn.current),I0(l)){if(!Ke)throw Error(s(176));if(o=l.stateNode,h=l.memoizedProps,(p=ee(o,h,l,!Fl))&&(S=wn,S!==null))switch(S.tag){case 3:Ee(S.stateNode.containerInfo,o,h,(S.mode&1)!==0);break;case 5:Pe(S.type,S.memoizedProps,S.stateNode,o,h,(S.mode&1)!==0)}p&&Ai(l)}else l.stateNode=oe(p,o,h,l)}return Wr(l),null;case 13:if(mt(zt),p=l.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(Lt&&Un!==null&&l.mode&1&&!(l.flags&128))vm(),lo(),l.flags|=98560,S=!1;else if(S=I0(l),p!==null&&p.dehydrated!==null){if(o===null){if(!S)throw Error(s(318));if(!Ke)throw Error(s(344));if(S=l.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(s(317));fe(S,l)}else lo(),!(l.flags&128)&&(l.memoizedState=null),l.flags|=4;Wr(l),S=!1}else ri!==null&&(S1(ri),ri=null),S=!0;if(!S)return l.flags&65536?l:null}return l.flags&128?(l.lanes=h,l):(h=p!==null,h!==(o!==null&&o.memoizedState!==null)&&h&&(l.child.flags|=8192,l.mode&1&&(o===null||zt.current&1?lr===0&&(lr=3):E1())),l.updateQueue!==null&&(l.flags|=4),Wr(l),null);case 4:return po(),Bl(o,l),o===null&&et(l.stateNode.containerInfo),Wr(l),null;case 10:return Id(l.type._context),Wr(l),null;case 17:return un(l.type)&&T0(),Wr(l),null;case 19:if(mt(zt),S=l.memoizedState,S===null)return Wr(l),null;if(p=(l.flags&128)!==0,k=S.rendering,k===null)if(p)Ul(S,!1);else{if(lr!==0||o!==null&&o.flags&128)for(o=l.child;o!==null;){if(k=G0(o),k!==null){for(l.flags|=128,Ul(S,!1),o=k.updateQueue,o!==null&&(l.updateQueue=o,l.flags|=4),l.subtreeFlags=0,o=h,h=l.child;h!==null;)p=h,S=o,p.flags&=14680066,k=p.alternate,k===null?(p.childLanes=0,p.lanes=S,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=k.childLanes,p.lanes=k.lanes,p.child=k.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=k.memoizedProps,p.memoizedState=k.memoizedState,p.updateQueue=k.updateQueue,p.type=k.type,S=k.dependencies,p.dependencies=S===null?null:{lanes:S.lanes,firstContext:S.firstContext}),h=h.sibling;return at(zt,zt.current&1|2),l.child}o=o.sibling}S.tail!==null&&mr()>v1&&(l.flags|=128,p=!0,Ul(S,!1),l.lanes=4194304)}else{if(!p)if(o=G0(k),o!==null){if(l.flags|=128,p=!0,o=o.updateQueue,o!==null&&(l.updateQueue=o,l.flags|=4),Ul(S,!0),S.tail===null&&S.tailMode==="hidden"&&!k.alternate&&!Lt)return Wr(l),null}else 2*mr()-S.renderingStartTime>v1&&h!==1073741824&&(l.flags|=128,p=!0,Ul(S,!1),l.lanes=4194304);S.isBackwards?(k.sibling=l.child,l.child=k):(o=S.last,o!==null?o.sibling=k:l.child=k,S.last=k)}return S.tail!==null?(l=S.tail,S.rendering=l,S.tail=l.sibling,S.renderingStartTime=mr(),l.sibling=null,o=zt.current,at(zt,p?o&1|2:o&1),l):(Wr(l),null);case 22:case 23:return w1(),h=l.memoizedState!==null,o!==null&&o.memoizedState!==null!==h&&(l.flags|=8192),h&&l.mode&1?En&1073741824&&(Wr(l),Ne&&l.subtreeFlags&6&&(l.flags|=8192)):Wr(l),null;case 24:return null;case 25:return null}throw Error(s(156,l.tag))}function I8(o,l){switch(Ad(l),l.tag){case 1:return un(l.type)&&T0(),o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 3:return po(),mt(ln),mt(zr),Gd(),o=l.flags,o&65536&&!(o&128)?(l.flags=o&-65537|128,l):null;case 5:return Ud(l),null;case 13:if(mt(zt),o=l.memoizedState,o!==null&&o.dehydrated!==null){if(l.alternate===null)throw Error(s(340));lo()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 19:return mt(zt),null;case 4:return po(),null;case 10:return Id(l.type._context),null;case 22:case 23:return w1(),null;case 24:return null;default:return null}}var q0=!1,Hr=!1,D8=typeof WeakSet=="function"?WeakSet:Set,De=null;function mo(o,l){var h=o.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(p){Mt(o,l,p)}else h.current=null}function a1(o,l,h){try{h()}catch(p){Mt(o,l,p)}}var gv=!1;function L8(o,l){for(xe(o.containerInfo),De=l;De!==null;)if(o=De,l=o.child,(o.subtreeFlags&1028)!==0&&l!==null)l.return=o,De=l;else for(;De!==null;){o=De;try{var h=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var p=h.memoizedProps,S=h.memoizedState,k=o.stateNode,D=k.getSnapshotBeforeUpdate(o.elementType===o.type?p:ni(o.type,p),S);k.__reactInternalSnapshotBeforeUpdate=D}break;case 3:Ne&&pd(o.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(X){Mt(o,o.return,X)}if(l=o.sibling,l!==null){l.return=o.return,De=l;break}De=o.return}return h=gv,gv=!1,h}function zl(o,l,h){var p=l.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var S=p=p.next;do{if((S.tag&o)===o){var k=S.destroy;S.destroy=void 0,k!==void 0&&a1(l,h,k)}S=S.next}while(S!==p)}}function J0(o,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var h=l=l.next;do{if((h.tag&o)===o){var p=h.create;h.destroy=p()}h=h.next}while(h!==l)}}function s1(o){var l=o.ref;if(l!==null){var h=o.stateNode;switch(o.tag){case 5:o=Ae(h);break;default:o=h}typeof l=="function"?l(o):l.current=o}}function mv(o){var l=o.alternate;l!==null&&(o.alternate=null,mv(l)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(l=o.stateNode,l!==null&&ae(l)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function vv(o){return o.tag===5||o.tag===3||o.tag===4}function xv(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||vv(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function o1(o,l,h){var p=o.tag;if(p===5||p===6)o=o.stateNode,l?no(h,o,l):Cr(h,o);else if(p!==4&&(o=o.child,o!==null))for(o1(o,l,h),o=o.sibling;o!==null;)o1(o,l,h),o=o.sibling}function l1(o,l,h){var p=o.tag;if(p===5||p===6)o=o.stateNode,l?xa(h,o,l):Ft(h,o);else if(p!==4&&(o=o.child,o!==null))for(l1(o,l,h),o=o.sibling;o!==null;)l1(o,l,h),o=o.sibling}var kr=null,ii=!1;function Fi(o,l,h){for(h=h.child;h!==null;)u1(o,l,h),h=h.sibling}function u1(o,l,h){if(wi&&typeof wi.onCommitFiberUnmount=="function")try{wi.onCommitFiberUnmount(P0,h)}catch{}switch(h.tag){case 5:Hr||mo(h,l);case 6:if(Ne){var p=kr,S=ii;kr=null,Fi(o,l,h),kr=p,ii=S,kr!==null&&(ii?hd(kr,h.stateNode):p0(kr,h.stateNode))}else Fi(o,l,h);break;case 18:Ne&&kr!==null&&(ii?Fe(kr,h.stateNode):_e(kr,h.stateNode));break;case 4:Ne?(p=kr,S=ii,kr=h.stateNode.containerInfo,ii=!0,Fi(o,l,h),kr=p,ii=S):(Be&&(p=h.stateNode.containerInfo,S=_0(p),El(p,S)),Fi(o,l,h));break;case 0:case 11:case 14:case 15:if(!Hr&&(p=h.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){S=p=p.next;do{var k=S,D=k.destroy;k=k.tag,D!==void 0&&(k&2||k&4)&&a1(h,l,D),S=S.next}while(S!==p)}Fi(o,l,h);break;case 1:if(!Hr&&(mo(h,l),p=h.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=h.memoizedProps,p.state=h.memoizedState,p.componentWillUnmount()}catch(X){Mt(h,l,X)}Fi(o,l,h);break;case 21:Fi(o,l,h);break;case 22:h.mode&1?(Hr=(p=Hr)||h.memoizedState!==null,Fi(o,l,h),Hr=p):Fi(o,l,h);break;default:Fi(o,l,h)}}function _v(o){var l=o.updateQueue;if(l!==null){o.updateQueue=null;var h=o.stateNode;h===null&&(h=o.stateNode=new D8),l.forEach(function(p){var S=V8.bind(null,o,p);h.has(p)||(h.add(p),p.then(S,S))})}}function ai(o,l){var h=l.deletions;if(h!==null)for(var p=0;p<h.length;p++){var S=h[p];try{var k=o,D=l;if(Ne){var X=D;e:for(;X!==null;){switch(X.tag){case 5:kr=X.stateNode,ii=!1;break e;case 3:kr=X.stateNode.containerInfo,ii=!0;break e;case 4:kr=X.stateNode.containerInfo,ii=!0;break e}X=X.return}if(kr===null)throw Error(s(160));u1(k,D,S),kr=null,ii=!1}else u1(k,D,S);var ie=S.alternate;ie!==null&&(ie.return=null),S.return=null}catch(Te){Mt(S,l,Te)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)yv(l,o),l=l.sibling}function yv(o,l){var h=o.alternate,p=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(ai(l,o),Pi(o),p&4){try{zl(3,o,o.return),J0(3,o)}catch(Re){Mt(o,o.return,Re)}try{zl(5,o,o.return)}catch(Re){Mt(o,o.return,Re)}}break;case 1:ai(l,o),Pi(o),p&512&&h!==null&&mo(h,h.return);break;case 5:if(ai(l,o),Pi(o),p&512&&h!==null&&mo(h,h.return),Ne){if(o.flags&32){var S=o.stateNode;try{g0(S)}catch(Re){Mt(o,o.return,Re)}}if(p&4&&(S=o.stateNode,S!=null)){var k=o.memoizedProps;if(h=h!==null?h.memoizedProps:k,p=o.type,l=o.updateQueue,o.updateQueue=null,l!==null)try{Si(S,l,p,h,k,o)}catch(Re){Mt(o,o.return,Re)}}}break;case 6:if(ai(l,o),Pi(o),p&4&&Ne){if(o.stateNode===null)throw Error(s(162));S=o.stateNode,k=o.memoizedProps,h=h!==null?h.memoizedProps:k;try{Br(S,h,k)}catch(Re){Mt(o,o.return,Re)}}break;case 3:if(ai(l,o),Pi(o),p&4){if(Ne&&Ke&&h!==null&&h.memoizedState.isDehydrated)try{te(l.containerInfo)}catch(Re){Mt(o,o.return,Re)}if(Be){S=l.containerInfo,k=l.pendingChildren;try{El(S,k)}catch(Re){Mt(o,o.return,Re)}}}break;case 4:if(ai(l,o),Pi(o),p&4&&Be){k=o.stateNode,S=k.containerInfo,k=k.pendingChildren;try{El(S,k)}catch(Re){Mt(o,o.return,Re)}}break;case 13:ai(l,o),Pi(o),S=o.child,S.flags&8192&&(k=S.memoizedState!==null,S.stateNode.isHidden=k,!k||S.alternate!==null&&S.alternate.memoizedState!==null||(m1=mr())),p&4&&_v(o);break;case 22:var D=h!==null&&h.memoizedState!==null;if(o.mode&1?(Hr=(h=Hr)||D,ai(l,o),Hr=h):ai(l,o),Pi(o),p&8192){if(h=o.memoizedState!==null,(o.stateNode.isHidden=h)&&!D&&o.mode&1)for(De=o,p=o.child;p!==null;){for(l=De=p;De!==null;){D=De;var X=D.child;switch(D.tag){case 0:case 11:case 14:case 15:zl(4,D,D.return);break;case 1:mo(D,D.return);var ie=D.stateNode;if(typeof ie.componentWillUnmount=="function"){var Te=D,Me=D.return;try{var $e=Te;ie.props=$e.memoizedProps,ie.state=$e.memoizedState,ie.componentWillUnmount()}catch(Re){Mt(Te,Me,Re)}}break;case 5:mo(D,D.return);break;case 22:if(D.memoizedState!==null){Ev(l);continue}}X!==null?(X.return=D,De=X):Ev(l)}p=p.sibling}if(Ne){e:if(p=null,Ne)for(l=o;;){if(l.tag===5){if(p===null){p=l;try{S=l.stateNode,h?m0(S):x0(l.stateNode,l.memoizedProps)}catch(Re){Mt(o,o.return,Re)}}}else if(l.tag===6){if(p===null)try{k=l.stateNode,h?v0(k):dd(k,l.memoizedProps)}catch(Re){Mt(o,o.return,Re)}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===o)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break e;for(;l.sibling===null;){if(l.return===null||l.return===o)break e;p===l&&(p=null),l=l.return}p===l&&(p=null),l.sibling.return=l.return,l=l.sibling}}}break;case 19:ai(l,o),Pi(o),p&4&&_v(o);break;case 21:break;default:ai(l,o),Pi(o)}}function Pi(o){var l=o.flags;if(l&2){try{if(Ne){e:{for(var h=o.return;h!==null;){if(vv(h)){var p=h;break e}h=h.return}throw Error(s(160))}switch(p.tag){case 5:var S=p.stateNode;p.flags&32&&(g0(S),p.flags&=-33);var k=xv(o);l1(o,k,S);break;case 3:case 4:var D=p.stateNode.containerInfo,X=xv(o);o1(o,X,D);break;default:throw Error(s(161))}}}catch(ie){Mt(o,o.return,ie)}o.flags&=-3}l&4096&&(o.flags&=-4097)}function M8(o,l,h){De=o,Sv(o)}function Sv(o,l,h){for(var p=(o.mode&1)!==0;De!==null;){var S=De,k=S.child;if(S.tag===22&&p){var D=S.memoizedState!==null||q0;if(!D){var X=S.alternate,ie=X!==null&&X.memoizedState!==null||Hr;X=q0;var Te=Hr;if(q0=D,(Hr=ie)&&!Te)for(De=S;De!==null;)D=De,ie=D.child,D.tag===22&&D.memoizedState!==null?Tv(S):ie!==null?(ie.return=D,De=ie):Tv(S);for(;k!==null;)De=k,Sv(k),k=k.sibling;De=S,q0=X,Hr=Te}wv(o)}else S.subtreeFlags&8772&&k!==null?(k.return=S,De=k):wv(o)}}function wv(o){for(;De!==null;){var l=De;if(l.flags&8772){var h=l.alternate;try{if(l.flags&8772)switch(l.tag){case 0:case 11:case 15:Hr||J0(5,l);break;case 1:var p=l.stateNode;if(l.flags&4&&!Hr)if(h===null)p.componentDidMount();else{var S=l.elementType===l.type?h.memoizedProps:ni(l.type,h.memoizedProps);p.componentDidUpdate(S,h.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var k=l.updateQueue;k!==null&&Cm(l,k,p);break;case 3:var D=l.updateQueue;if(D!==null){if(h=null,l.child!==null)switch(l.child.tag){case 5:h=Ae(l.child.stateNode);break;case 1:h=l.child.stateNode}Cm(l,D,h)}break;case 5:var X=l.stateNode;h===null&&l.flags&4&&gr(X,l.type,l.memoizedProps,l);break;case 6:break;case 4:break;case 12:break;case 13:if(Ke&&l.memoizedState===null){var ie=l.alternate;if(ie!==null){var Te=ie.memoizedState;if(Te!==null){var Me=Te.dehydrated;Me!==null&&re(Me)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}Hr||l.flags&512&&s1(l)}catch($e){Mt(l,l.return,$e)}}if(l===o){De=null;break}if(h=l.sibling,h!==null){h.return=l.return,De=h;break}De=l.return}}function Ev(o){for(;De!==null;){var l=De;if(l===o){De=null;break}var h=l.sibling;if(h!==null){h.return=l.return,De=h;break}De=l.return}}function Tv(o){for(;De!==null;){var l=De;try{switch(l.tag){case 0:case 11:case 15:var h=l.return;try{J0(4,l)}catch(ie){Mt(l,h,ie)}break;case 1:var p=l.stateNode;if(typeof p.componentDidMount=="function"){var S=l.return;try{p.componentDidMount()}catch(ie){Mt(l,S,ie)}}var k=l.return;try{s1(l)}catch(ie){Mt(l,k,ie)}break;case 5:var D=l.return;try{s1(l)}catch(ie){Mt(l,D,ie)}}}catch(ie){Mt(l,l.return,ie)}if(l===o){De=null;break}var X=l.sibling;if(X!==null){X.return=l.return,De=X;break}De=l.return}}var Z0=0,ec=1,tc=2,rc=3,nc=4;if(typeof Symbol=="function"&&Symbol.for){var Gl=Symbol.for;Z0=Gl("selector.component"),ec=Gl("selector.has_pseudo_class"),tc=Gl("selector.role"),rc=Gl("selector.test_id"),nc=Gl("selector.text")}function c1(o){var l=Ye(o);if(l!=null){if(typeof l.memoizedProps["data-testname"]!="string")throw Error(s(364));return l}if(o=Xe(o),o===null)throw Error(s(362));return o.stateNode.current}function f1(o,l){switch(l.$$typeof){case Z0:if(o.type===l.value)return!0;break;case ec:e:{l=l.value,o=[o,0];for(var h=0;h<o.length;){var p=o[h++],S=o[h++],k=l[S];if(p.tag!==5||!tt(p)){for(;k!=null&&f1(p,k);)S++,k=l[S];if(S===l.length){l=!0;break e}else for(p=p.child;p!==null;)o.push(p,S),p=p.sibling}}l=!1}return l;case tc:if(o.tag===5&&Dt(o.stateNode,l.value))return!0;break;case nc:if((o.tag===5||o.tag===6)&&(o=At(o),o!==null&&0<=o.indexOf(l.value)))return!0;break;case rc:if(o.tag===5&&(o=o.memoizedProps["data-testname"],typeof o=="string"&&o.toLowerCase()===l.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function h1(o){switch(o.$$typeof){case Z0:return"<"+(N(o.value)||"Unknown")+">";case ec:return":has("+(h1(o)||"")+")";case tc:return'[role="'+o.value+'"]';case nc:return'"'+o.value+'"';case rc:return'[data-testname="'+o.value+'"]';default:throw Error(s(365))}}function Cv(o,l){var h=[];o=[o,0];for(var p=0;p<o.length;){var S=o[p++],k=o[p++],D=l[k];if(S.tag!==5||!tt(S)){for(;D!=null&&f1(S,D);)k++,D=l[k];if(k===l.length)h.push(S);else for(S=S.child;S!==null;)o.push(S,k),S=S.sibling}}return h}function d1(o,l){if(!Ue)throw Error(s(363));o=c1(o),o=Cv(o,l),l=[],o=Array.from(o);for(var h=0;h<o.length;){var p=o[h++];if(p.tag===5)tt(p)||l.push(p.stateNode);else for(p=p.child;p!==null;)o.push(p),p=p.sibling}return l}var B8=Math.ceil,ic=u.ReactCurrentDispatcher,p1=u.ReactCurrentOwner,Qt=u.ReactCurrentBatchConfig,rt=0,xr=null,tr=null,Ar=0,En=0,vo=Ur(0),lr=0,Wl=null,vs=0,ac=0,g1=0,Hl=null,fn=null,m1=0,v1=1/0,Ki=null;function xo(){v1=mr()+500}var sc=!1,x1=null,wa=null,oc=!1,Ea=null,lc=0,jl=0,_1=null,uc=-1,cc=0;function jr(){return rt&6?mr():uc!==-1?uc:uc=mr()}function Ta(o){return o.mode&1?rt&2&&Ar!==0?Ar&-Ar:_8.transition!==null?(cc===0&&(cc=um()),cc):(o=ut,o!==0?o:se()):1}function Hn(o,l,h,p){if(50<jl)throw jl=0,_1=null,Error(s(185));Al(o,h,p),(!(rt&2)||o!==xr)&&(o===xr&&(!(rt&2)&&(ac|=h),lr===4&&Ca(o,Ar)),hn(o,p),h===1&&rt===0&&!(l.mode&1)&&(xo(),N0&&Ei()))}function hn(o,l){var h=o.callbackNode;c8(o,l);var p=F0(o,o===xr?Ar:0);if(p===0)h!==null&&fm(h),o.callbackNode=null,o.callbackPriority=0;else if(l=p&-p,o.callbackPriority!==l){if(h!=null&&fm(h),l===1)o.tag===0?x8(Av.bind(null,o)):hm(Av.bind(null,o)),me?ze(function(){!(rt&6)&&Ei()}):wd(Ed,Ei),h=null;else{switch(cm(p)){case 1:h=Ed;break;case 4:h=p8;break;case 16:h=Td;break;case 536870912:h=g8;break;default:h=Td}h=Mv(h,kv.bind(null,o))}o.callbackPriority=l,o.callbackNode=h}}function kv(o,l){if(uc=-1,cc=0,rt&6)throw Error(s(327));var h=o.callbackNode;if(ys()&&o.callbackNode!==h)return null;var p=F0(o,o===xr?Ar:0);if(p===0)return null;if(p&30||p&o.expiredLanes||l)l=fc(o,p);else{l=p;var S=rt;rt|=2;var k=Nv();(xr!==o||Ar!==l)&&(Ki=null,xo(),xs(o,l));do try{G8();break}catch(X){Pv(o,X)}while(!0);Od(),ic.current=k,rt=S,tr!==null?l=0:(xr=null,Ar=0,l=lr)}if(l!==0){if(l===2&&(S=_d(o),S!==0&&(p=S,l=y1(o,S))),l===1)throw h=Wl,xs(o,0),Ca(o,p),hn(o,mr()),h;if(l===6)Ca(o,p);else{if(S=o.current.alternate,!(p&30)&&!U8(S)&&(l=fc(o,p),l===2&&(k=_d(o),k!==0&&(p=k,l=y1(o,k))),l===1))throw h=Wl,xs(o,0),Ca(o,p),hn(o,mr()),h;switch(o.finishedWork=S,o.finishedLanes=p,l){case 0:case 1:throw Error(s(345));case 2:_s(o,fn,Ki);break;case 3:if(Ca(o,p),(p&130023424)===p&&(l=m1+500-mr(),10<l)){if(F0(o,0)!==0)break;if(S=o.suspendedLanes,(S&p)!==p){jr(),o.pingedLanes|=o.suspendedLanes&S;break}o.timeoutHandle=W(_s.bind(null,o,fn,Ki),l);break}_s(o,fn,Ki);break;case 4:if(Ca(o,p),(p&4194240)===p)break;for(l=o.eventTimes,S=-1;0<p;){var D=31-ei(p);k=1<<D,D=l[D],D>S&&(S=D),p&=~k}if(p=S,p=mr()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*B8(p/1960))-p,10<p){o.timeoutHandle=W(_s.bind(null,o,fn,Ki),p);break}_s(o,fn,Ki);break;case 5:_s(o,fn,Ki);break;default:throw Error(s(329))}}}return hn(o,mr()),o.callbackNode===h?kv.bind(null,o):null}function y1(o,l){var h=Hl;return o.current.memoizedState.isDehydrated&&(xs(o,l).flags|=256),o=fc(o,l),o!==2&&(l=fn,fn=h,l!==null&&S1(l)),o}function S1(o){fn===null?fn=o:fn.push.apply(fn,o)}function U8(o){for(var l=o;;){if(l.flags&16384){var h=l.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var p=0;p<h.length;p++){var S=h[p],k=S.getSnapshot;S=S.value;try{if(!ti(k(),S))return!1}catch{return!1}}}if(h=l.child,l.subtreeFlags&16384&&h!==null)h.return=l,l=h;else{if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Ca(o,l){for(l&=~g1,l&=~ac,o.suspendedLanes|=l,o.pingedLanes&=~l,o=o.expirationTimes;0<l;){var h=31-ei(l),p=1<<h;o[h]=-1,l&=~p}}function Av(o){if(rt&6)throw Error(s(327));ys();var l=F0(o,0);if(!(l&1))return hn(o,mr()),null;var h=fc(o,l);if(o.tag!==0&&h===2){var p=_d(o);p!==0&&(l=p,h=y1(o,p))}if(h===1)throw h=Wl,xs(o,0),Ca(o,l),hn(o,mr()),h;if(h===6)throw Error(s(345));return o.finishedWork=o.current.alternate,o.finishedLanes=l,_s(o,fn,Ki),hn(o,mr()),null}function Fv(o){Ea!==null&&Ea.tag===0&&!(rt&6)&&ys();var l=rt;rt|=1;var h=Qt.transition,p=ut;try{if(Qt.transition=null,ut=1,o)return o()}finally{ut=p,Qt.transition=h,rt=l,!(rt&6)&&Ei()}}function w1(){En=vo.current,mt(vo)}function xs(o,l){o.finishedWork=null,o.finishedLanes=0;var h=o.timeoutHandle;if(h!==he&&(o.timeoutHandle=he,Z(h)),tr!==null)for(h=tr.return;h!==null;){var p=h;switch(Ad(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&T0();break;case 3:po(),mt(ln),mt(zr),Gd();break;case 5:Ud(p);break;case 4:po();break;case 13:mt(zt);break;case 19:mt(zt);break;case 10:Id(p.type._context);break;case 22:case 23:w1()}h=h.return}if(xr=o,tr=o=ka(o.current,null),Ar=En=l,lr=0,Wl=null,g1=ac=vs=0,fn=Hl=null,gs!==null){for(l=0;l<gs.length;l++)if(h=gs[l],p=h.interleaved,p!==null){h.interleaved=null;var S=p.next,k=h.pending;if(k!==null){var D=k.next;k.next=S,p.next=D}h.pending=p}gs=null}return o}function Pv(o,l){do{var h=tr;try{if(Od(),W0.current=b0,H0){for(var p=Gt.memoizedState;p!==null;){var S=p.queue;S!==null&&(S.pending=null),p=p.next}H0=!1}if(ms=0,vr=or=Gt=null,Ol=!1,Il=0,p1.current=null,h===null||h.return===null){lr=1,Wl=l,tr=null;break}e:{var k=o,D=h.return,X=h,ie=l;if(l=Ar,X.flags|=32768,ie!==null&&typeof ie=="object"&&typeof ie.then=="function"){var Te=ie,Me=X,$e=Me.tag;if(!(Me.mode&1)&&($e===0||$e===11||$e===15)){var Re=Me.alternate;Re?(Me.updateQueue=Re.updateQueue,Me.memoizedState=Re.memoizedState,Me.lanes=Re.lanes):(Me.updateQueue=null,Me.memoizedState=null)}var Nt=ev(D);if(Nt!==null){Nt.flags&=-257,tv(Nt,D,X,k,l),Nt.mode&1&&Zm(k,Te,l),l=Nt,ie=Te;var Ct=l.updateQueue;if(Ct===null){var dn=new Set;dn.add(ie),l.updateQueue=dn}else Ct.add(ie);break e}else{if(!(l&1)){Zm(k,Te,l),E1();break e}ie=Error(s(426))}}else if(Lt&&X.mode&1){var Yi=ev(D);if(Yi!==null){!(Yi.flags&65536)&&(Yi.flags|=256),tv(Yi,D,X,k,l),Nd(go(ie,X));break e}}k=ie=go(ie,X),lr!==4&&(lr=2),Hl===null?Hl=[k]:Hl.push(k),k=D;do{switch(k.tag){case 3:k.flags|=65536,l&=-l,k.lanes|=l;var ne=qm(k,ie,l);Tm(k,ne);break e;case 1:X=ie;var Y=k.type,le=k.stateNode;if(!(k.flags&128)&&(typeof Y.getDerivedStateFromError=="function"||le!==null&&typeof le.componentDidCatch=="function"&&(wa===null||!wa.has(le)))){k.flags|=65536,l&=-l,k.lanes|=l;var Oe=Jm(k,X,l);Tm(k,Oe);break e}}k=k.return}while(k!==null)}Ov(h)}catch(He){l=He,tr===h&&h!==null&&(tr=h=h.return);continue}break}while(!0)}function Nv(){var o=ic.current;return ic.current=b0,o===null?b0:o}function E1(){(lr===0||lr===3||lr===2)&&(lr=4),xr===null||!(vs&268435455)&&!(ac&268435455)||Ca(xr,Ar)}function fc(o,l){var h=rt;rt|=2;var p=Nv();(xr!==o||Ar!==l)&&(Ki=null,xs(o,l));do try{z8();break}catch(S){Pv(o,S)}while(!0);if(Od(),rt=h,ic.current=p,tr!==null)throw Error(s(261));return xr=null,Ar=0,lr}function z8(){for(;tr!==null;)Rv(tr)}function G8(){for(;tr!==null&&!h8();)Rv(tr)}function Rv(o){var l=Lv(o.alternate,o,En);o.memoizedProps=o.pendingProps,l===null?Ov(o):tr=l,p1.current=null}function Ov(o){var l=o;do{var h=l.alternate;if(o=l.return,l.flags&32768){if(h=I8(h,l),h!==null){h.flags&=32767,tr=h;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{lr=6,tr=null;return}}else if(h=O8(h,l,En),h!==null){tr=h;return}if(l=l.sibling,l!==null){tr=l;return}tr=l=o}while(l!==null);lr===0&&(lr=5)}function _s(o,l,h){var p=ut,S=Qt.transition;try{Qt.transition=null,ut=1,W8(o,l,h,p)}finally{Qt.transition=S,ut=p}return null}function W8(o,l,h,p){do ys();while(Ea!==null);if(rt&6)throw Error(s(327));h=o.finishedWork;var S=o.finishedLanes;if(h===null)return null;if(o.finishedWork=null,o.finishedLanes=0,h===o.current)throw Error(s(177));o.callbackNode=null,o.callbackPriority=0;var k=h.lanes|h.childLanes;if(f8(o,k),o===xr&&(tr=xr=null,Ar=0),!(h.subtreeFlags&2064)&&!(h.flags&2064)||oc||(oc=!0,Mv(Td,function(){return ys(),null})),k=(h.flags&15990)!==0,h.subtreeFlags&15990||k){k=Qt.transition,Qt.transition=null;var D=ut;ut=1;var X=rt;rt|=4,p1.current=null,L8(o,h),yv(h,o),ve(o.containerInfo),o.current=h,M8(h),d8(),rt=X,ut=D,Qt.transition=k}else o.current=h;if(oc&&(oc=!1,Ea=o,lc=S),k=o.pendingLanes,k===0&&(wa=null),m8(h.stateNode),hn(o,mr()),l!==null)for(p=o.onRecoverableError,h=0;h<l.length;h++)S=l[h],p(S.value,{componentStack:S.stack,digest:S.digest});if(sc)throw sc=!1,o=x1,x1=null,o;return lc&1&&o.tag!==0&&ys(),k=o.pendingLanes,k&1?o===_1?jl++:(jl=0,_1=o):jl=0,Ei(),null}function ys(){if(Ea!==null){var o=cm(lc),l=Qt.transition,h=ut;try{if(Qt.transition=null,ut=16>o?16:o,Ea===null)var p=!1;else{if(o=Ea,Ea=null,lc=0,rt&6)throw Error(s(331));var S=rt;for(rt|=4,De=o.current;De!==null;){var k=De,D=k.child;if(De.flags&16){var X=k.deletions;if(X!==null){for(var ie=0;ie<X.length;ie++){var Te=X[ie];for(De=Te;De!==null;){var Me=De;switch(Me.tag){case 0:case 11:case 15:zl(8,Me,k)}var $e=Me.child;if($e!==null)$e.return=Me,De=$e;else for(;De!==null;){Me=De;var Re=Me.sibling,Nt=Me.return;if(mv(Me),Me===Te){De=null;break}if(Re!==null){Re.return=Nt,De=Re;break}De=Nt}}}var Ct=k.alternate;if(Ct!==null){var dn=Ct.child;if(dn!==null){Ct.child=null;do{var Yi=dn.sibling;dn.sibling=null,dn=Yi}while(dn!==null)}}De=k}}if(k.subtreeFlags&2064&&D!==null)D.return=k,De=D;else e:for(;De!==null;){if(k=De,k.flags&2048)switch(k.tag){case 0:case 11:case 15:zl(9,k,k.return)}var ne=k.sibling;if(ne!==null){ne.return=k.return,De=ne;break e}De=k.return}}var Y=o.current;for(De=Y;De!==null;){D=De;var le=D.child;if(D.subtreeFlags&2064&&le!==null)le.return=D,De=le;else e:for(D=Y;De!==null;){if(X=De,X.flags&2048)try{switch(X.tag){case 0:case 11:case 15:J0(9,X)}}catch(He){Mt(X,X.return,He)}if(X===D){De=null;break e}var Oe=X.sibling;if(Oe!==null){Oe.return=X.return,De=Oe;break e}De=X.return}}if(rt=S,Ei(),wi&&typeof wi.onPostCommitFiberRoot=="function")try{wi.onPostCommitFiberRoot(P0,o)}catch{}p=!0}return p}finally{ut=h,Qt.transition=l}}return!1}function Iv(o,l,h){l=go(h,l),l=qm(o,l,1),o=Sa(o,l,1),l=jr(),o!==null&&(Al(o,1,l),hn(o,l))}function Mt(o,l,h){if(o.tag===3)Iv(o,o,h);else for(;l!==null;){if(l.tag===3){Iv(l,o,h);break}else if(l.tag===1){var p=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(wa===null||!wa.has(p))){o=go(h,o),o=Jm(l,o,1),l=Sa(l,o,1),o=jr(),l!==null&&(Al(l,1,o),hn(l,o));break}}l=l.return}}function H8(o,l,h){var p=o.pingCache;p!==null&&p.delete(l),l=jr(),o.pingedLanes|=o.suspendedLanes&h,xr===o&&(Ar&h)===h&&(lr===4||lr===3&&(Ar&130023424)===Ar&&500>mr()-m1?xs(o,0):g1|=h),hn(o,l)}function Dv(o,l){l===0&&(o.mode&1?(l=A0,A0<<=1,!(A0&130023424)&&(A0=4194304)):l=1);var h=jr();o=Ti(o,l),o!==null&&(Al(o,l,h),hn(o,h))}function j8(o){var l=o.memoizedState,h=0;l!==null&&(h=l.retryLane),Dv(o,h)}function V8(o,l){var h=0;switch(o.tag){case 13:var p=o.stateNode,S=o.memoizedState;S!==null&&(h=S.retryLane);break;case 19:p=o.stateNode;break;default:throw Error(s(314))}p!==null&&p.delete(l),Dv(o,h)}var Lv;Lv=function(o,l,h){if(o!==null)if(o.memoizedProps!==l.pendingProps||ln.current)cn=!0;else{if(!(o.lanes&h)&&!(l.flags&128))return cn=!1,R8(o,l,h);cn=!!(o.flags&131072)}else cn=!1,Lt&&l.flags&1048576&&dm(l,O0,l.index);switch(l.lanes=0,l.tag){case 2:var p=l.type;Y0(o,l),o=l.pendingProps;var S=ao(l,zr.current);fo(l,h),S=jd(null,l,p,o,S,h);var k=Vd();return l.flags|=1,typeof S=="object"&&S!==null&&typeof S.render=="function"&&S.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,un(p)?(k=!0,C0(l)):k=!1,l.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,Md(l),S.updater=X0,l.stateNode=S,S._reactInternals=l,Qd(l,p,o,h),l=e1(null,l,p,!0,k,h)):(l.tag=0,Lt&&k&&kd(l),Zr(null,l,S,h),l=l.child),l;case 16:p=l.elementType;e:{switch(Y0(o,l),o=l.pendingProps,S=p._init,p=S(p._payload),l.type=p,S=l.tag=X8(p),o=ni(p,o),S){case 0:l=Zd(null,l,p,o,h);break e;case 1:l=ov(null,l,p,o,h);break e;case 11:l=rv(null,l,p,o,h);break e;case 14:l=nv(null,l,p,ni(p.type,o),h);break e}throw Error(s(306,p,""))}return l;case 0:return p=l.type,S=l.pendingProps,S=l.elementType===p?S:ni(p,S),Zd(o,l,p,S,h);case 1:return p=l.type,S=l.pendingProps,S=l.elementType===p?S:ni(p,S),ov(o,l,p,S,h);case 3:e:{if(lv(l),o===null)throw Error(s(387));p=l.pendingProps,k=l.memoizedState,S=k.element,Em(o,l),z0(l,p,null,h);var D=l.memoizedState;if(p=D.element,Ke&&k.isDehydrated)if(k={element:p,isDehydrated:!1,cache:D.cache,pendingSuspenseBoundaries:D.pendingSuspenseBoundaries,transitions:D.transitions},l.updateQueue.baseState=k,l.memoizedState=k,l.flags&256){S=go(Error(s(423)),l),l=uv(o,l,p,h,S);break e}else if(p!==S){S=go(Error(s(424)),l),l=uv(o,l,p,h,S);break e}else for(Ke&&(Un=M(l.stateNode.containerInfo),wn=l,Lt=!0,ri=null,Fl=!1),h=ym(l,null,p,h),l.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(lo(),p===S){l=Xi(o,l,h);break e}Zr(o,l,p,h)}l=l.child}return l;case 5:return km(l),o===null&&Pd(l),p=l.type,S=l.pendingProps,k=o!==null?o.memoizedProps:null,D=S.children,V(p,S)?D=null:k!==null&&V(p,k)&&(l.flags|=32),sv(o,l),Zr(o,l,D,h),l.child;case 6:return o===null&&Pd(l),null;case 13:return cv(o,l,h);case 4:return Bd(l,l.stateNode.containerInfo),p=l.pendingProps,o===null?l.child=uo(l,null,p,h):Zr(o,l,p,h),l.child;case 11:return p=l.type,S=l.pendingProps,S=l.elementType===p?S:ni(p,S),rv(o,l,p,S,h);case 7:return Zr(o,l,l.pendingProps,h),l.child;case 8:return Zr(o,l,l.pendingProps.children,h),l.child;case 12:return Zr(o,l,l.pendingProps.children,h),l.child;case 10:e:{if(p=l.type._context,S=l.pendingProps,k=l.memoizedProps,D=S.value,Sm(l,p,D),k!==null)if(ti(k.value,D)){if(k.children===S.children&&!ln.current){l=Xi(o,l,h);break e}}else for(k=l.child,k!==null&&(k.return=l);k!==null;){var X=k.dependencies;if(X!==null){D=k.child;for(var ie=X.firstContext;ie!==null;){if(ie.context===p){if(k.tag===1){ie=bi(-1,h&-h),ie.tag=2;var Te=k.updateQueue;if(Te!==null){Te=Te.shared;var Me=Te.pending;Me===null?ie.next=ie:(ie.next=Me.next,Me.next=ie),Te.pending=ie}}k.lanes|=h,ie=k.alternate,ie!==null&&(ie.lanes|=h),Dd(k.return,h,l),X.lanes|=h;break}ie=ie.next}}else if(k.tag===10)D=k.type===l.type?null:k.child;else if(k.tag===18){if(D=k.return,D===null)throw Error(s(341));D.lanes|=h,X=D.alternate,X!==null&&(X.lanes|=h),Dd(D,h,l),D=k.sibling}else D=k.child;if(D!==null)D.return=k;else for(D=k;D!==null;){if(D===l){D=null;break}if(k=D.sibling,k!==null){k.return=D.return,D=k;break}D=D.return}k=D}Zr(o,l,S.children,h),l=l.child}return l;case 9:return S=l.type,p=l.pendingProps.children,fo(l,h),S=zn(S),p=p(S),l.flags|=1,Zr(o,l,p,h),l.child;case 14:return p=l.type,S=ni(p,l.pendingProps),S=ni(p.type,S),nv(o,l,p,S,h);case 15:return iv(o,l,l.type,l.pendingProps,h);case 17:return p=l.type,S=l.pendingProps,S=l.elementType===p?S:ni(p,S),Y0(o,l),l.tag=1,un(p)?(o=!0,C0(l)):o=!1,fo(l,h),$m(l,p,S),Qd(l,p,S,h),e1(null,l,p,!0,o,h);case 19:return hv(o,l,h);case 22:return av(o,l,h)}throw Error(s(156,l.tag))};function Mv(o,l){return wd(o,l)}function b8(o,l,h,p){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jn(o,l,h,p){return new b8(o,l,h,p)}function T1(o){return o=o.prototype,!(!o||!o.isReactComponent)}function X8(o){if(typeof o=="function")return T1(o)?1:0;if(o!=null){if(o=o.$$typeof,o===y)return 11;if(o===T)return 14}return 2}function ka(o,l){var h=o.alternate;return h===null?(h=jn(o.tag,l,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=l,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&14680064,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,l=o.dependencies,h.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h}function hc(o,l,h,p,S,k){var D=2;if(p=o,typeof o=="function")T1(o)&&(D=1);else if(typeof o=="string")D=5;else e:switch(o){case d:return Ss(h.children,S,k,l);case v:D=8,S|=8;break;case g:return o=jn(12,h,l,S|2),o.elementType=g,o.lanes=k,o;case E:return o=jn(13,h,l,S),o.elementType=E,o.lanes=k,o;case C:return o=jn(19,h,l,S),o.elementType=C,o.lanes=k,o;case w:return dc(h,S,k,l);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case x:D=10;break e;case _:D=9;break e;case y:D=11;break e;case T:D=14;break e;case m:D=16,p=null;break e}throw Error(s(130,o==null?o:typeof o,""))}return l=jn(D,h,l,S),l.elementType=o,l.type=p,l.lanes=k,l}function Ss(o,l,h,p){return o=jn(7,o,p,l),o.lanes=h,o}function dc(o,l,h,p){return o=jn(22,o,p,l),o.elementType=w,o.lanes=h,o.stateNode={isHidden:!1},o}function C1(o,l,h){return o=jn(6,o,null,l),o.lanes=h,o}function k1(o,l,h){return l=jn(4,o.children!==null?o.children:[],o.key,l),l.lanes=h,l.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},l}function K8(o,l,h,p,S){this.tag=l,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=he,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yd(0),this.expirationTimes=yd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yd(0),this.identifierPrefix=p,this.onRecoverableError=S,Ke&&(this.mutableSourceEagerHydrationData=null)}function Bv(o,l,h,p,S,k,D,X,ie){return o=new K8(o,l,h,X,ie),l===1?(l=1,k===!0&&(l|=8)):l=0,k=jn(3,null,null,l),o.current=k,k.stateNode=o,k.memoizedState={element:p,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Md(k),o}function Uv(o){if(!o)return _a;o=o._reactInternals;e:{if(L(o)!==o||o.tag!==1)throw Error(s(170));var l=o;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(un(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(s(171))}if(o.tag===1){var h=o.type;if(un(h))return om(o,h,l)}return l}function zv(o){var l=o._reactInternals;if(l===void 0)throw typeof o.render=="function"?Error(s(188)):(o=Object.keys(o).join(","),Error(s(268,o)));return o=j(l),o===null?null:o.stateNode}function Gv(o,l){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<l?h:l}}function pc(o,l){Gv(o,l),(o=o.alternate)&&Gv(o,l)}function Y8(o){return o=j(o),o===null?null:o.stateNode}function $8(){return null}return r.attemptContinuousHydration=function(o){if(o.tag===13){var l=Ti(o,134217728);if(l!==null){var h=jr();Hn(l,o,134217728,h)}pc(o,134217728)}},r.attemptDiscreteHydration=function(o){if(o.tag===13){var l=Ti(o,1);if(l!==null){var h=jr();Hn(l,o,1,h)}pc(o,1)}},r.attemptHydrationAtCurrentPriority=function(o){if(o.tag===13){var l=Ta(o),h=Ti(o,l);if(h!==null){var p=jr();Hn(h,o,l,p)}pc(o,l)}},r.attemptSynchronousHydration=function(o){switch(o.tag){case 3:var l=o.stateNode;if(l.current.memoizedState.isDehydrated){var h=kl(l.pendingLanes);h!==0&&(Sd(l,h|1),hn(l,mr()),!(rt&6)&&(xo(),Ei()))}break;case 13:Fv(function(){var p=Ti(o,1);if(p!==null){var S=jr();Hn(p,o,1,S)}}),pc(o,1)}},r.batchedUpdates=function(o,l){var h=rt;rt|=1;try{return o(l)}finally{rt=h,rt===0&&(xo(),N0&&Ei())}},r.createComponentSelector=function(o){return{$$typeof:Z0,value:o}},r.createContainer=function(o,l,h,p,S,k,D){return Bv(o,l,!1,null,h,p,S,k,D)},r.createHasPseudoClassSelector=function(o){return{$$typeof:ec,value:o}},r.createHydrationContainer=function(o,l,h,p,S,k,D,X,ie){return o=Bv(h,p,!0,o,S,k,D,X,ie),o.context=Uv(null),h=o.current,p=jr(),S=Ta(h),k=bi(p,S),k.callback=l??null,Sa(h,k,S),o.current.lanes=S,Al(o,S,p),hn(o,p),o},r.createPortal=function(o,l,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:p==null?null:""+p,children:o,containerInfo:l,implementation:h}},r.createRoleSelector=function(o){return{$$typeof:tc,value:o}},r.createTestNameSelector=function(o){return{$$typeof:rc,value:o}},r.createTextSelector=function(o){return{$$typeof:nc,value:o}},r.deferredUpdates=function(o){var l=ut,h=Qt.transition;try{return Qt.transition=null,ut=16,o()}finally{ut=l,Qt.transition=h}},r.discreteUpdates=function(o,l,h,p,S){var k=ut,D=Qt.transition;try{return Qt.transition=null,ut=1,o(l,h,p,S)}finally{ut=k,Qt.transition=D,rt===0&&xo()}},r.findAllNodes=d1,r.findBoundingRects=function(o,l){if(!Ue)throw Error(s(363));l=d1(o,l),o=[];for(var h=0;h<l.length;h++)o.push(sr(l[h]));for(l=o.length-1;0<l;l--){h=o[l];for(var p=h.x,S=p+h.width,k=h.y,D=k+h.height,X=l-1;0<=X;X--)if(l!==X){var ie=o[X],Te=ie.x,Me=Te+ie.width,$e=ie.y,Re=$e+ie.height;if(p>=Te&&k>=$e&&S<=Me&&D<=Re){o.splice(l,1);break}else if(p!==Te||h.width!==ie.width||Re<k||$e>D){if(!(k!==$e||h.height!==ie.height||Me<p||Te>S)){Te>p&&(ie.width+=Te-p,ie.x=p),Me<S&&(ie.width=S-Te),o.splice(l,1);break}}else{$e>k&&(ie.height+=$e-k,ie.y=k),Re<D&&(ie.height=D-$e),o.splice(l,1);break}}}return o},r.findHostInstance=zv,r.findHostInstanceWithNoPortals=function(o){return o=H(o),o=o!==null?ye(o):null,o===null?null:o.stateNode},r.findHostInstanceWithWarning=function(o){return zv(o)},r.flushControlled=function(o){var l=rt;rt|=1;var h=Qt.transition,p=ut;try{Qt.transition=null,ut=1,o()}finally{ut=p,Qt.transition=h,rt=l,rt===0&&(xo(),Ei())}},r.flushPassiveEffects=ys,r.flushSync=Fv,r.focusWithin=function(o,l){if(!Ue)throw Error(s(363));for(o=c1(o),l=Cv(o,l),l=Array.from(l),o=0;o<l.length;){var h=l[o++];if(!tt(h)){if(h.tag===5&&Jr(h.stateNode))return!0;for(h=h.child;h!==null;)l.push(h),h=h.sibling}}return!1},r.getCurrentUpdatePriority=function(){return ut},r.getFindAllNodesFailureDescription=function(o,l){if(!Ue)throw Error(s(363));var h=0,p=[];o=[c1(o),0];for(var S=0;S<o.length;){var k=o[S++],D=o[S++],X=l[D];if((k.tag!==5||!tt(k))&&(f1(k,X)&&(p.push(h1(X)),D++,D>h&&(h=D)),D<l.length))for(k=k.child;k!==null;)o.push(k,D),k=k.sibling}if(h<l.length){for(o=[];h<l.length;h++)o.push(h1(l[h]));return`findAllNodes was able to match part of the selector:
  `+(p.join(" > ")+`

No matching component was found for:
  `)+o.join(" > ")}return null},r.getPublicRootInstance=function(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return Ae(o.child.stateNode);default:return o.child.stateNode}},r.injectIntoDevTools=function(o){if(o={bundleType:o.bundleType,version:o.version,rendererPackageName:o.rendererPackageName,rendererConfig:o.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:u.ReactCurrentDispatcher,findHostInstanceByFiber:Y8,findFiberByHostInstance:o.findFiberByHostInstance||$8,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")o=!1;else{var l=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(l.isDisabled||!l.supportsFiber)o=!0;else{try{P0=l.inject(o),wi=l}catch{}o=!!l.checkDCE}}return o},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(o,l,h,p){if(!Ue)throw Error(s(363));o=d1(o,l);var S=Zt(o,h,p).disconnect;return{disconnect:function(){S()}}},r.registerMutableSourceForHydration=function(o,l){var h=l._getVersion;h=h(l._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[l,h]:o.mutableSourceEagerHydrationData.push(l,h)},r.runWithPriority=function(o,l){var h=ut;try{return ut=o,l()}finally{ut=h}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(o,l,h,p){var S=l.current,k=jr(),D=Ta(S);return h=Uv(h),l.context===null?l.context=h:l.pendingContext=h,l=bi(k,D),l.payload={element:o},p=p===void 0?null:p,p!==null&&(l.callback=p),o=Sa(S,l,D),o!==null&&(Hn(o,S,D,k),U0(o,S,D)),D},r};x5.exports=CC;var kC=x5.exports;const AC=Ag(kC);var _5={exports:{}},qs={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */qs.ConcurrentRoot=1;qs.ContinuousEventPriority=4;qs.DefaultEventPriority=16;qs.DiscreteEventPriority=1;qs.IdleEventPriority=536870912;qs.LegacyRoot=0;_5.exports=qs;var y5=_5.exports;const N4={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let R4=!1,O4=!1;const B2=".react-konva-event",FC=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,PC=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,NC={};function nd(t,e,r=NC){if(!R4&&"zIndex"in e&&(console.warn(PC),R4=!0),!O4&&e.draggable){var n=e.x!==void 0||e.y!==void 0,i=e.onDragEnd||e.onDragMove;n&&!i&&(console.warn(FC),O4=!0)}for(var a in r)if(!N4[a]){var s=a.slice(0,2)==="on",u=r[a]!==e[a];if(s&&u){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),t.off(c,r[a])}var f=!e.hasOwnProperty(a);f&&t.setAttr(a,void 0)}var d=e._useStrictMode,v={},g=!1;const x={};for(var a in e)if(!N4[a]){var s=a.slice(0,2)==="on",_=r[a]!==e[a];if(s&&_){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e[a]&&(x[c]=e[a])}!s&&(e[a]!==r[a]||d&&e[a]!==t.getAttr(a))&&(g=!0,v[a]=e[a])}g&&(t.setAttrs(v),us(t));for(var c in x)t.on(c+B2,x[c])}function us(t){if(!Ze.Konva.autoDrawEnabled){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}}const S5={},RC={};Vu.Node.prototype._applyProps=nd;function OC(t,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}t.add(e),us(t)}function IC(t,e,r){let n=Vu[t];n||(console.error(`Konva has no node with the type ${t}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${t}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=Vu.Group);const i={},a={};for(var s in e){var u=s.slice(0,2)==="on";u?a[s]=e[s]:i[s]=e[s]}const c=new n(i);return nd(c,a),c}function DC(t,e,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${t}"`)}function LC(t,e,r){return!1}function MC(t){return t}function BC(){return null}function UC(){return null}function zC(t,e,r,n){return RC}function GC(){}function WC(t){}function HC(t,e){return!1}function jC(){return S5}function VC(){return S5}const bC=setTimeout,XC=clearTimeout,KC=-1;function YC(t,e){return!1}const $C=!1,QC=!0,qC=!0;function JC(t,e){e.parent===t?e.moveToTop():t.add(e),us(t)}function ZC(t,e){e.parent===t?e.moveToTop():t.add(e),us(t)}function w5(t,e,r){e._remove(),t.add(e),e.setZIndex(r.getZIndex()),us(t)}function ek(t,e,r){w5(t,e,r)}function tk(t,e){e.destroy(),e.off(B2),us(t)}function rk(t,e){e.destroy(),e.off(B2),us(t)}function nk(t,e,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function ik(t,e,r){}function ak(t,e,r,n,i){nd(t,i,n)}function sk(t){t.hide(),us(t)}function ok(t){}function lk(t,e){(e.visible==null||e.visible)&&t.show()}function uk(t,e){}function ck(t){}function fk(){}const hk=()=>y5.DefaultEventPriority,dk=Object.freeze(Object.defineProperty({__proto__:null,appendChild:JC,appendChildToContainer:ZC,appendInitialChild:OC,cancelTimeout:XC,clearContainer:ck,commitMount:ik,commitTextUpdate:nk,commitUpdate:ak,createInstance:IC,createTextInstance:DC,detachDeletedInstance:fk,finalizeInitialChildren:LC,getChildHostContext:VC,getCurrentEventPriority:hk,getPublicInstance:MC,getRootHostContext:jC,hideInstance:sk,hideTextInstance:ok,idlePriority:uu.unstable_IdlePriority,insertBefore:w5,insertInContainerBefore:ek,isPrimaryRenderer:$C,noTimeout:KC,now:uu.unstable_now,prepareForCommit:BC,preparePortalMount:UC,prepareUpdate:zC,removeChild:tk,removeChildFromContainer:rk,resetAfterCommit:GC,resetTextContent:WC,run:uu.unstable_runWithPriority,scheduleTimeout:bC,shouldDeprioritizeSubtree:HC,shouldSetTextContent:YC,supportsMutation:qC,unhideInstance:lk,unhideTextInstance:uk,warnsIfNotActing:QC},Symbol.toStringTag,{value:"Module"}));var pk=Object.defineProperty,gk=Object.defineProperties,mk=Object.getOwnPropertyDescriptors,I4=Object.getOwnPropertySymbols,vk=Object.prototype.hasOwnProperty,xk=Object.prototype.propertyIsEnumerable,D4=(t,e,r)=>e in t?pk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,L4=(t,e)=>{for(var r in e||(e={}))vk.call(e,r)&&D4(t,r,e[r]);if(I4)for(var r of I4(e))xk.call(e,r)&&D4(t,r,e[r]);return t},_k=(t,e)=>gk(t,mk(e)),M4,B4;typeof window<"u"&&((M4=window.document)!=null&&M4.createElement||((B4=window.navigator)==null?void 0:B4.product)==="ReactNative")?We.useLayoutEffect:We.useEffect;function E5(t,e,r){if(!t)return;if(r(t)===!0)return t;let n=t.child;for(;n;){const i=E5(n,e,r);if(i)return i;n=n.sibling}}function T5(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const U4=console.error;console.error=function(){const t=[...arguments].join("");if(t!=null&&t.startsWith("Warning:")&&t.includes("useContext")){console.error=U4;return}return U4.apply(this,arguments)};const U2=T5(We.createContext(null));class C5 extends We.Component{render(){return We.createElement(U2.Provider,{value:this._reactInternals},this.props.children)}}function yk(){const t=We.useContext(U2);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=We.useId();return We.useMemo(()=>{for(const n of[t,t==null?void 0:t.alternate]){if(!n)continue;const i=E5(n,!1,a=>{let s=a.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(i)return i}},[t,e])}function Sk(){const t=yk(),[e]=We.useState(()=>new Map);e.clear();let r=t;for(;r;){if(r.type&&typeof r.type=="object"){const i=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;i&&i!==U2&&!e.has(i)&&e.set(i,We.useContext(T5(i)))}r=r.return}return e}function wk(){const t=Sk();return We.useMemo(()=>Array.from(t.keys()).reduce((e,r)=>n=>We.createElement(e,null,We.createElement(r.Provider,_k(L4({},n),{value:t.get(r)}))),e=>We.createElement(C5,L4({},e))),[t])}function Ek(t){const e=Xr.useRef({});return Xr.useLayoutEffect(()=>{e.current=t}),Xr.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const Tk=t=>{const e=Xr.useRef(),r=Xr.useRef(),n=Xr.useRef(),i=Ek(t),a=wk(),s=u=>{const{forwardedRef:c}=t;c&&(typeof c=="function"?c(u):c.current=u)};return Xr.useLayoutEffect(()=>(r.current=new Vu.Stage({width:t.width,height:t.height,container:e.current}),s(r.current),n.current=ou.createContainer(r.current,y5.LegacyRoot,!1,null),ou.updateContainer(Xr.createElement(a,{},t.children),n.current),()=>{Vu.isBrowser&&(s(null),ou.updateContainer(null,n.current,null),r.current.destroy())}),[]),Xr.useLayoutEffect(()=>{s(r.current),nd(r.current,t,i),ou.updateContainer(Xr.createElement(a,{},t.children),n.current,null)}),Xr.createElement("div",{ref:e,id:t.id,accessKey:t.accessKey,className:t.className,role:t.role,style:t.style,tabIndex:t.tabIndex,title:t.title})},Ck="Layer",cp="Group",To="Rect",kk="Image",tu="Text",Ak="Transformer",ou=AC(dk);ou.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Xr.version,rendererPackageName:"react-konva"});const Fk=Xr.forwardRef((t,e)=>Xr.createElement(C5,{},Xr.createElement(Tk,{...t,forwardedRef:e}))),Pk=({image:t,referenceFields:e,measurements:r,onReferenceFieldsUpdate:n,onMeasurementsUpdate:i,onImageUpload:a})=>{const s=We.useRef(),u=We.useRef(),c=We.useRef(null),f=We.useRef(null),[d,v]=We.useState(null),[g,x]=We.useState({width:800,height:600}),[_,y]=We.useState(1),[E,C]=We.useState({x:0,y:0}),[T,m]=We.useState(1),[w,F]=We.useState(null),[R,N]=We.useState("measurement"),[A,L]=We.useState(e||[]),[O,H]=We.useState(!1),[j,q]=We.useState(null),[ye,de]=We.useState(null),Ae=w,Ge=()=>{m(1),x({width:800,height:600});const se=s.current;se&&(se.position({x:0,y:0}),se.scale({x:1,y:1}),se.batchDraw()),console.log("CanvasEditor - Zoom reset applied")},[ue,xe]=We.useState(!1),[ve,we]=We.useState(null),[z,K]=We.useState(null),b=se=>{se.evt.preventDefault();const ae=s.current;if(!ae)return;const me=1.05,ze=ae.scaleX(),Ue=ae.getPointerPosition();if(!Ue)return;const Xe={x:(Ue.x-ae.x())/ze,y:(Ue.y-ae.y())/ze},At=(se.evt.deltaY>0?-1:1)>0?ze*me:ze/me,tt=Math.max(.2,Math.min(At,30));ae.scale({x:tt,y:tt});const Dt={x:Ue.x-Xe.x*tt,y:Ue.y-Xe.y*tt};ae.position(Dt),m(tt),ae.batchDraw()},V=se=>{if(!O||!j)return;const me=se.target.getStage().getPointerPosition();if(!me||!f.current)return;const ze=f.current.getAbsoluteTransform().copy();ze.invert();const Ue=ze.point(me);de({x:Math.min(j.x,Ue.x),y:Math.min(j.y,Ue.y),width:Math.abs(Ue.x-j.x),height:Math.abs(Ue.y-j.y)})},oe=se=>{if(!Ae||!Ae.width||!Ae.height||A.length===0)return 0;const ae=A[0];ae.albedoValue;const me=document.createElement("canvas"),ze=me.getContext("2d");if(me.width=Ae.width,me.height=Ae.height,ze.drawImage(Ae,0,0),ae.hasThreeRectangles){const Zt=Math.round((ae.rectWidth||25)*(me.width/g.width)),Ft=Math.round((ae.spacing||5)*(me.width/g.width)),Cr=Math.round(ae.height*(me.height/g.height)),Br=Math.round(ae.x*(me.width/g.width)),gr=Math.round(ae.y*(me.height/g.height)),Si=Br+Zt+Ft,xa=ze.getImageData(Si,gr,Zt,Cr);W(xa)}else if(ae.hasTwoRectangles){const Zt=Math.round((ae.rectWidth||25)*(me.width/g.width)),Ft=Math.round((ae.spacing||20)*(me.width/g.width)),Cr=Math.round(ae.height*(me.height/g.height)),Br=Math.round(ae.x*(me.width/g.width)),gr=Math.round(ae.y*(me.height/g.height)),Si=Br+Zt+Ft,xa=ze.getImageData(Br,gr,Zt,Cr);W(xa);const no=ze.getImageData(Si,gr,Zt,Cr);W(no)}else{const Zt=Math.round(ae.x*(me.width/g.width)),Ft=Math.round(ae.y*(me.height/g.height)),Cr=Math.round(ae.width*(me.width/g.width)),Br=Math.round(ae.height*(me.height/g.height)),gr=ze.getImageData(Zt,Ft,Cr,Br);W(gr)}const Ue=Math.round(se.x*(me.width/g.width)),Xe=Math.round(se.y*(me.height/g.height)),sr=Math.round(se.width*(me.width/g.width)),At=Math.round(se.height*(me.height/g.height)),tt=ze.getImageData(Ue,Xe,sr,At),Dt=W(tt),Jr=Dt/256;return console.log("CanvasEditor - Albedo calculation:",{measurement:se,measurementMeanPixelValue:Dt,calculatedAlbedo:Jr,formula:`${Dt} / 256 = ${Jr}`}),Math.max(0,Math.min(1,Jr))},W=se=>{const ae=se.data;let me=0,ze=0,Ue=0,Xe=0,sr=0;for(let Ft=0;Ft<ae.length;Ft+=4){const Cr=ae[Ft],Br=ae[Ft+1],gr=ae[Ft+2],Si=(Cr+Br+gr)/3;me+=Si,Ue+=Cr,Xe+=Br,sr+=gr,ze++}const At=ze>0?me/ze:0,tt=ze>0?Ue/ze:0,Dt=ze>0?Xe/ze:0,Jr=ze>0?sr/ze:0,Zt=At/256;return console.log("Pixel Analysis:"),console.log("- Total pixels:",ze),console.log("- Mean R:",tt.toFixed(2)),console.log("- Mean G:",Dt.toFixed(2)),console.log("- Mean B:",Jr.toFixed(2)),console.log("- Mean Grayscale:",At.toFixed(2)),console.log("- Albedo (grayscale/256):",Zt.toFixed(2)),At},Z=()=>{if(A.length===0&&Ae){const Ue={id:`ref_${Date.now()}`,x:50,y:50,width:82,height:30,albedoValue:.85,type:"standard",label:"Reference"},Xe=[...A,Ue];L(Xe),n&&n(Xe),console.log("CanvasEditor - Auto-added reference field")}};We.useEffect(()=>{if(t!=null&&t.url){console.log("CanvasEditor - Loading image:",t.url);const se=new Image;se.crossOrigin="anonymous",se.onload=()=>{console.log("CanvasEditor - Image loaded successfully:",se.width,"x",se.height),F(se)},se.onerror=ae=>{console.error("CanvasEditor - Image loading failed:",ae)},se.src=t.url}else F(null)},[t==null?void 0:t.url]),We.useEffect(()=>{w&&A.length===0&&Z()},[w,A.length]);const he=w?"loaded":t!=null&&t.url?"loading":"failed";We.useEffect(()=>{e&&(L(e),e.length>0&&R==="reference"&&N("measurement"))},[e,R]),We.useEffect(()=>{e&&e!==A&&(L(e),console.log("CanvasEditor - Synced localReferenceFields with props:",e))},[e]),console.log("CanvasEditor - image:",t),console.log("CanvasEditor - image.url:",t==null?void 0:t.url),console.log("CanvasEditor - konvaImage:",Ae),console.log("CanvasEditor - imageStatus:",he),console.log("CanvasEditor - stageSize:",g),console.log("CanvasEditor - imageScale:",_),console.log("CanvasEditor - imagePosition:",E),console.log("CanvasEditor - mode:",R),console.log("CanvasEditor - localReferenceFields:",A),console.log("CanvasEditor - referenceFields prop:",e),console.log("CanvasEditor - measurements:",r),console.log("CanvasEditor - measurements.length:",r==null?void 0:r.length),We.useEffect(()=>{const se=()=>{var me;const ae=(me=s.current)==null?void 0:me.container();if(ae){const ze=ae.getBoundingClientRect();x({width:Math.min(800,ze.width-40),height:Math.min(600,ze.height-40)})}};return se(),window.addEventListener("resize",se),()=>window.removeEventListener("resize",se)},[]),We.useEffect(()=>{if(Ae&&Ae.width&&Ae.height&&g.width&&g.height){const se=g.width/Ae.width,ae=g.height/Ae.height,me=Math.min(se,ae,1);y(me),C({x:(g.width-Ae.width*me)/2,y:(g.height-Ae.height*me)/2}),console.log("CanvasEditor - Image scale calculated:",{imageSize:{width:Ae.width,height:Ae.height},stageSize:g,scale:me,position:{x:(g.width-Ae.width*me)/2,y:(g.height-Ae.height*me)/2}})}},[Ae,g]);const ge=se=>{se.target===se.target.getStage()&&v(null)};We.useEffect(()=>{if(d&&u.current){const ae=s.current.findOne(`#${d}`);ae&&(u.current.nodes([ae]),u.current.getLayer().batchDraw())}},[d]);const Ne=se=>{console.log("CORRECT marking - Mouse down!");const me=se.target.getStage().getPointerPosition();if(!me||!f.current)return;const ze=f.current.getAbsoluteTransform().copy();ze.invert();const Ue=ze.point(me);console.log("Click position (stage):",me),console.log("Image position:",E),console.log("Image scale:",_);const Xe=Ue.x,sr=Ue.y;console.log("Converted to image coords:",{imageX:Xe,imageY:sr}),H(!0),q({x:Xe,y:sr}),de({x:Xe,y:sr,width:0,height:0}),console.log("Started drawing with CORRECT coords!")},Be=se=>{if(console.log("CORRECT marking - Mouse up!"),!O||!ye||!j){console.log("Not drawing - ignoring");return}const me=se.target.getStage().getPointerPosition();if(!me||!f.current)return;console.log("End position (stage):",me);const ze=f.current.getAbsoluteTransform().copy();ze.invert();const Ue=ze.point(me),Xe=Ue.x,sr=Ue.y,At=Math.abs(Xe-j.x),tt=Math.abs(sr-j.y);if(console.log("Rectangle size:",{width:At,height:tt}),console.log("Drawing start:",j),console.log("End position:",{imageX:Xe,imageY:sr}),At>10&&tt>10){const Dt={x:Math.min(j.x,Xe),y:Math.min(j.y,sr),width:At,height:tt},Jr=oe(Dt);console.log("Calculated albedo:",Jr);const Zt=`Måling ${((r==null?void 0:r.length)||0)+1}`,Ft={id:`meas_${Date.now()}`,x:Dt.x,y:Dt.y,width:Dt.width,height:Dt.height,albedoValue:Jr,description:Zt,type:"measurement"};console.log("=== MEASUREMENT CREATED ==="),console.log("Measurement data:",Ft),console.log("Calculated albedo:",Jr),console.log("Current measurements count:",(r==null?void 0:r.length)||0),console.log("New measurements array:",[...r||[],Ft]),i?(i([...r||[],Ft]),console.log("Called onMeasurementsUpdate with new measurement")):console.log("ERROR: onMeasurementsUpdate is not available!"),setTimeout(()=>{const Cr=prompt("Navn for denne måling:",Zt);if(Cr!==null&&Cr!==Zt){const Br=(r||[]).map(gr=>gr.id===Ft.id?{...gr,description:Cr}:gr);i&&i(Br)}},100)}else console.log("Rectangle too small - ignoring");H(!1),q(null),de(null),console.log("Reset drawing state")},Ke=se=>{if(R==="reference"&&(console.log("CanvasEditor - Stage clicked:",se.target),se.target===se.target.getStage())){const me=se.target.getStage().getPointerPosition();console.log("CanvasEditor - Click position:",me),console.log("CanvasEditor - Image position:",E),console.log("CanvasEditor - Image scale:",_);const ze=(me.x-E.x)/_,Ue=(me.y-E.y)/_;if(console.log("CanvasEditor - Converted to image coords:",{imageX:ze,imageY:Ue}),Ae&&Ae.width&&Ae.height&&ze>=0&&ze<=Ae.width&&Ue>=0&&Ue<=Ae.height){if(console.log("CanvasEditor - Click within image bounds, creating",R),R==="reference"){const Xe={id:`ref_${Date.now()}`,x:me.x-25,y:me.y-25,width:50,height:50,albedoValue:.7,description:`Reference Field ${A.length+1}`,type:"reference"};console.log("Creating new reference field:",Xe),L([...A,Xe]),N("measurement"),console.log("CanvasEditor - Switched to measurement mode after reference creation")}}else console.log("CanvasEditor - Click outside image bounds or no image loaded")}},Ye=se=>{const ae=se.target.id();if(A.find(Ue=>Ue.id===ae)){const Ue=A.map(Xe=>Xe.id===ae?{...Xe,x:se.target.x(),y:se.target.y()}:Xe);L(Ue),n(Ue);return}if(r.find(Ue=>Ue.id===ae)){const Ue=r.map(Xe=>Xe.id===ae?{...Xe,x:se.target.x(),y:se.target.y()}:Xe);i(Ue)}},et=se=>{const ae=se.target.id(),me=se.target,ze=me.scaleX(),Ue=me.scaleY();if(me.scaleX(1),me.scaleY(1),A.find(At=>At.id===ae)){const At=A.map(tt=>tt.id===ae?{...tt,x:me.x(),y:me.y(),width:Math.max(5,me.width()*ze),height:Math.max(5,me.height()*Ue)}:tt);L(At),n&&n(At);return}if(r.find(At=>At.id===ae)){const At=r.map(tt=>{if(tt.id===ae){const Dt={...tt,x:me.x(),y:me.y(),width:Math.max(5,me.width()*ze),height:Math.max(5,me.height()*Ue)};return Dt.albedoValue=oe(Dt),Dt}return tt});i(At)}};return t?he==="loading"?Q.jsxs("div",{className:"card",children:[Q.jsx("h3",{style:{marginBottom:"16px",color:"#212529"},children:"Canvas Editor"}),Q.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#6c757d",background:"#f8f9fa",borderRadius:"12px",border:"1px solid #dee2e6"},children:[Q.jsx("div",{className:"loading",style:{margin:"0 auto 16px"}}),Q.jsx("p",{children:"Indlæser billede..."})]})]}):he==="failed"?Q.jsxs("div",{className:"card",children:[Q.jsx("h3",{style:{marginBottom:"16px",color:"#212529"},children:"Canvas Editor"}),Q.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#dc3545",background:"#f8d7da",borderRadius:"12px",border:"1px solid #f5c6cb"},children:Q.jsx("p",{children:"Fejl ved indlæsning af billede. Prøv at uploade igen."})})]}):Q.jsxs("div",{className:"card",children:[Q.jsx("h3",{style:{marginBottom:"16px",color:"#212529"},children:"Canvas Editor"}),Q.jsxs("div",{style:{display:"flex",gap:"20px",height:"calc(100vh - 200px)"},children:[Q.jsx("div",{style:{width:"300px",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #dee2e6",padding:"20px",display:"flex",flexDirection:"column",gap:"15px",overflowY:"auto"},children:Q.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(A.length>0||r.length>0)&&Q.jsx("button",{className:"btn btn-warning",onClick:()=>{L([]),i([]),v(null),console.log("CanvasEditor - Cleared all fields and measurements")},style:{fontSize:"0.9rem",width:"100%"},children:"Slet Alle"}),Q.jsx("button",{className:"btn btn-success",style:{fontSize:"0.9rem",width:"100%"},title:"Klik og træk for at markere!",children:"Markering Aktiv"}),Q.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[Q.jsx("button",{className:"btn btn-secondary",onClick:Ge,style:{fontSize:"0.9rem",width:"100%"},title:"Reset Zoom",children:"Reset Zoom"}),Q.jsxs("div",{style:{textAlign:"center"},children:[Q.jsxs("span",{style:{fontSize:"1rem",fontWeight:"600",color:"#495057"},children:[Math.round(T*100),"%"]}),Q.jsx("br",{}),Q.jsx("span",{style:{fontSize:"0.8rem",color:"#6c757d"},children:"Træk firkant for zoom"})]})]})]})}),Q.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:Q.jsx("div",{style:{border:"2px solid #dee2e6",borderRadius:"12px",overflow:"hidden",background:"#f8f9fa",flex:1},children:Q.jsx(Fk,{width:g.width,height:g.height,onMouseDown:se=>{ge(se),Ne(se)},onMouseUp:se=>{ge(se),Be(se)},onClick:Ke,onMouseMove:V,onWheel:b,ref:s,children:Q.jsxs(Ck,{children:[Q.jsxs(cp,{ref:f,x:E.x,y:E.y,scaleX:_,scaleY:_,children:[Ae&&Q.jsx(kk,{ref:c,image:Ae,x:0,y:0,scaleX:1,scaleY:1,onLoad:()=>{console.log("CanvasEditor - KonvaImage loaded");const se=s.current;se&&se.batchDraw()}}),A.map(se=>{const Ue=se.height;return Q.jsxs(cp,{id:se.id,draggable:!0,onDragEnd:Ye,onClick:Xe=>{Xe.cancelBubble=!0,v(se.id)},onTap:Xe=>{Xe.cancelBubble=!0,v(se.id)},children:[Q.jsx(To,{x:se.x-2,y:se.y-2,width:86,height:Ue+20,fill:"rgb(255, 255, 255)",stroke:"#000000",strokeWidth:2}),Q.jsx(To,{x:se.x,y:se.y,width:40,height:Ue,fill:"rgb(255, 255, 255)"}),Q.jsx(tu,{x:se.x+40/2,y:se.y+Ue/2,text:"100%",fontSize:12,fontFamily:"Arial",fontStyle:"normal",fill:"#000000",align:"center",verticalAlign:"middle",offsetX:0,offsetY:0}),Q.jsx(To,{x:se.x+40+2,y:se.y,width:40,height:Ue,fill:"rgb(220, 220, 220)"}),Q.jsx(tu,{x:se.x+40+2+40/2,y:se.y+Ue/2,text:"70%",fontSize:12,fontFamily:"Arial",fontStyle:"normal",fill:"#000000",align:"center",verticalAlign:"middle",offsetX:0,offsetY:0}),Q.jsx(tu,{x:se.x+82/2,y:se.y-2,text:"Reference",fontSize:10,fontFamily:"Arial",fontStyle:"bold",fill:"#000000",align:"center",verticalAlign:"middle",offsetX:0,offsetY:0})]},se.id)}),z&&Q.jsx(To,{x:z.x,y:z.y,width:z.width,height:z.height,fill:"rgba(255, 0, 0, 0.2)",stroke:"#ff0000",strokeWidth:2,dash:[5,5]}),ye&&Q.jsx(To,{x:ye.x,y:ye.y,width:ye.width,height:ye.height,fill:"rgba(255, 255, 0, 0.3)",stroke:"#ffd700",strokeWidth:3,dash:[8,4]}),r&&r.map(se=>Q.jsxs(cp,{children:[Q.jsx(To,{x:se.x,y:se.y,width:se.width,height:se.height,fill:"rgba(255, 255, 0, 0.2)",stroke:"#ffd700",strokeWidth:2,dash:[]}),Q.jsx(tu,{x:se.x+se.width/2,y:se.y+se.height/2,text:se.albedoValue?se.albedoValue.toFixed(2):"0.000",fontSize:14,fontFamily:"Arial",fontStyle:"bold",fill:"#000000",align:"center",verticalAlign:"middle",offsetX:0,offsetY:6}),Q.jsx(tu,{x:se.x,y:se.y-20,text:se.description||"Måling",fontSize:12,fontFamily:"Arial",fill:"#000000",align:"left"})]},se.id))]}),d&&Q.jsx(Ak,{ref:u,boundBoxFunc:(se,ae)=>ae.width<5||ae.height<5?se:ae,onTransformEnd:et})]})})})})]})]}):Q.jsxs("div",{className:"card",children:[Q.jsx("h3",{style:{marginBottom:"16px",color:"#212529"},children:"Canvas Editor"}),Q.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#6c757d",background:"#f8f9fa",borderRadius:"12px",border:"1px solid #dee2e6"},children:[Q.jsx("p",{style:{fontSize:"1.1rem",marginBottom:"20px"},children:"Ingen billede uploadet endnu"}),Q.jsx("p",{style:{fontSize:"0.9rem",marginBottom:"20px"},children:"Upload et billede for at starte albedo måling"}),Q.jsx("div",{style:{marginTop:"20px"},children:Q.jsx("button",{className:"btn btn-primary",onClick:()=>{const se=document.createElement("input");se.type="file",se.accept="image/*",se.onchange=ae=>{const me=ae.target.files[0];if(me&&a){const ze=new FileReader;ze.onload=Ue=>{const Xe={url:Ue.target.result,name:me.name,size:me.size,type:me.type,lastModified:me.lastModified};a(Xe)},ze.readAsDataURL(me)}else me&&alert("Upload funktionalitet ikke tilgængelig")},se.click()},style:{fontSize:"1rem",padding:"12px 24px",fontWeight:"600"},children:"Upload Billede"})})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Lf={};Lf.version="0.18.5";var k5=1252,Nk=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],A5=function(t){Nk.indexOf(t)!=-1&&(k5=t)};function Rk(){A5(1252)}var bu=function(t){A5(t)};function Ok(){bu(1200),Rk()}var Bc=function(e){return String.fromCharCode(e)},z4=function(e){return String.fromCharCode(e)},Mf,Ua="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xu(t){for(var e="",r=0,n=0,i=0,a=0,s=0,u=0,c=0,f=0;f<t.length;)r=t.charCodeAt(f++),a=r>>2,n=t.charCodeAt(f++),s=(r&3)<<4|n>>4,i=t.charCodeAt(f++),u=(n&15)<<2|i>>6,c=i&63,isNaN(n)?u=c=64:isNaN(i)&&(c=64),e+=Ua.charAt(a)+Ua.charAt(s)+Ua.charAt(u)+Ua.charAt(c);return e}function ca(t){var e="",r=0,n=0,i=0,a=0,s=0,u=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<t.length;)a=Ua.indexOf(t.charAt(f++)),s=Ua.indexOf(t.charAt(f++)),r=a<<2|s>>4,e+=String.fromCharCode(r),u=Ua.indexOf(t.charAt(f++)),n=(s&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),c=Ua.indexOf(t.charAt(f++)),i=(u&3)<<6|c,c!==64&&(e+=String.fromCharCode(i));return e}var dt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),va=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Us(t){return dt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function G4(t){return dt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var di=function(e){return dt?va(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function id(t){if(typeof ArrayBuffer>"u")return di(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function l0(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Ik(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var Rr=dt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:va(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Dk(t){for(var e=[],r=0,n=t.length+250,i=Us(t.length+255),a=0;a<t.length;++a){var s=t.charCodeAt(a);if(s<128)i[r++]=s;else if(s<2048)i[r++]=192|s>>6&31,i[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var u=t.charCodeAt(++a)&1023;i[r++]=240|s>>8&7,i[r++]=128|s>>2&63,i[r++]=128|u>>6&15|(s&3)<<4,i[r++]=128|u&63}else i[r++]=224|s>>12&15,i[r++]=128|s>>6&63,i[r++]=128|s&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Us(65535),n=65530)}return e.push(i.slice(0,r)),Rr(e)}var _u=/\u0000/g,Uc=/[\u0001-\u0006]/g;function Yo(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function pi(t,e){var r=""+t;return r.length>=e?r:Xt("0",e-r.length)+r}function z2(t,e){var r=""+t;return r.length>=e?r:Xt(" ",e-r.length)+r}function Bf(t,e){var r=""+t;return r.length>=e?r:r+Xt(" ",e-r.length)}function Lk(t,e){var r=""+Math.round(t);return r.length>=e?r:Xt("0",e-r.length)+r}function Mk(t,e){var r=""+t;return r.length>=e?r:Xt("0",e-r.length)+r}var W4=Math.pow(2,32);function Co(t,e){if(t>W4||t<-W4)return Lk(t,e);var r=Math.round(t);return Mk(r,e)}function Uf(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var H4=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],fp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Bk(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var Yt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},j4={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Uk={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function zf(t,e,r){for(var n=t<0?-1:1,i=t*n,a=0,s=1,u=0,c=1,f=0,d=0,v=Math.floor(i);f<e&&(v=Math.floor(i),u=v*s+a,d=v*f+c,!(i-v<5e-8));)i=1/(i-v),a=s,s=u,c=f,f=d;if(d>e&&(f>e?(d=c,u=a):(d=f,u=s)),!r)return[0,n*u,d];var g=Math.floor(n*u/d);return[g,n*u-g*d,d]}function zc(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),a=0,s=[],u={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++i==86400&&(u.T=i=0,++n,++u.D)),n===60)s=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=bk(c,s))}return u.y=s[0],u.m=s[1],u.d=s[2],u.S=i%60,i=Math.floor(i/60),u.M=i%60,i=Math.floor(i/60),u.H=i,u.q=a,u}var F5=new Date(1899,11,31,0,0,0),zk=F5.getTime(),Gk=new Date(1900,2,1,0,0,0);function P5(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Gk&&(r+=24*60*60*1e3),(r-(zk+(t.getTimezoneOffset()-F5.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function G2(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Wk(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Hk(t){var e=t<0?12:11,r=G2(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function jk(t){var e=G2(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Vk(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Hk(t):e===10?r=t.toFixed(10).substr(0,12):r=jk(t),G2(Wk(r.toUpperCase()))}function Eg(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Vk(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return qa(14,P5(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function bk(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function Xk(t,e,r,n){var i="",a=0,s=0,u=r.y,c,f=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:c=u%100,f=2;break;default:c=u%1e4,f=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,f=e.length;break;case 3:return fp[r.m-1][1];case 5:return fp[r.m-1][0];default:return fp[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,f=e.length;break;case 3:return H4[r.q][0];default:return H4[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,f=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,f=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,f=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?pi(r.S,e.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(r.S+r.u)),a>=60*s&&(a=0),e==="s"?a===0?"0":""+a/s:(i=pi(a,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}f=e.length===3?1:2;break;case 101:c=u,f=1;break}var d=f>0?pi(c,f):"";return d}function za(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var N5=/%/g;function Kk(t,e,r){var n=e.replace(N5,""),i=e.length-n.length;return na(t,n,r*Math.pow(10,2*i))+Xt("%",i)}function Yk(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return na(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function R5(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+R5(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(e/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var s=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,c,f,d){return c+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var O5=/# (\?+)( ?)\/( ?)(\d+)/;function $k(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),a=Math.floor(i/n),s=i-a*n,u=n;return r+(a===0?"":""+a)+" "+(s===0?Xt(" ",t[1].length+1+t[4].length):z2(s,t[1].length)+t[2]+"/"+t[3]+pi(u,t[4].length))}function Qk(t,e,r){return r+(e===0?"":""+e)+Xt(" ",t[1].length+2+t[4].length)}var I5=/^#*0*\.([0#]+)/,D5=/\).*[0#]/,L5=/\(###\) ###\\?-####/;function tn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function V4(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function b4(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function qk(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Jk(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function bn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(D5)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?bn("n",n,r):"("+bn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Yk(t,e,r);if(e.indexOf("%")!==-1)return Kk(t,e,r);if(e.indexOf("E")!==-1)return R5(e,r);if(e.charCodeAt(0)===36)return"$"+bn(t,e.substr(e.charAt(1)==" "?2:1),r);var i,a,s,u,c=Math.abs(r),f=r<0?"-":"";if(e.match(/^00+$/))return f+Co(c,e.length);if(e.match(/^[#?]+$/))return i=Co(r,0),i==="0"&&(i=""),i.length>e.length?i:tn(e.substr(0,e.length-i.length))+i;if(a=e.match(O5))return $k(a,c,f);if(e.match(/^#+0+$/))return f+Co(c,e.length-e.indexOf("0"));if(a=e.match(I5))return i=V4(r,a[1].length).replace(/^([^\.]+)$/,"$1."+tn(a[1])).replace(/\.$/,"."+tn(a[1])).replace(/\.(\d*)$/,function(_,y){return"."+y+Xt("0",tn(a[1]).length-y.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return f+V4(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return f+za(Co(c,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+bn(t,e,-r):za(""+(Math.floor(r)+qk(r,a[1].length)))+"."+pi(b4(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return bn(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Yo(bn(t,e.replace(/[\\-]/g,""),r)),s=0,Yo(Yo(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return s<i.length?i.charAt(s++):_==="0"?"0":""}));if(e.match(L5))return i=bn(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),u=zf(c,Math.pow(10,s)-1,!1),i=""+f,d=na("n",a[1],u[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Bf(u[2],s),d.length<a[4].length&&(d=tn(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),u=zf(c,Math.pow(10,s)-1,!0),f+(u[0]||(u[1]?"":"0"))+" "+(u[1]?z2(u[1],s)+a[2]+"/"+a[3]+Bf(u[2],s):Xt(" ",2*s+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=Co(r,0),e.length<=i.length?i:tn(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var v=e.indexOf(".")-s,g=e.length-i.length-v;return tn(e.substr(0,v)+i+e.substr(e.length-g))}if(a=e.match(/^00,000\.([#0]*0)$/))return s=b4(r,a[1].length),r<0?"-"+bn(t,e,-r):za(Jk(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?pi(0,3-_.length):"")+_})+"."+pi(s,a[1].length);switch(e){case"###,##0.00":return bn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=za(Co(c,0));return x!=="0"?f+x:"";case"###,###.00":return bn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return bn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Zk(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return na(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function eA(t,e,r){var n=e.replace(N5,""),i=e.length-n.length;return na(t,n,r*Math.pow(10,2*i))+Xt("%",i)}function M5(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+M5(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(e/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var s=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,c,f,d){return c+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ri(t,e,r){if(t.charCodeAt(0)===40&&!e.match(D5)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ri("n",n,r):"("+Ri("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Zk(t,e,r);if(e.indexOf("%")!==-1)return eA(t,e,r);if(e.indexOf("E")!==-1)return M5(e,r);if(e.charCodeAt(0)===36)return"$"+Ri(t,e.substr(e.charAt(1)==" "?2:1),r);var i,a,s,u,c=Math.abs(r),f=r<0?"-":"";if(e.match(/^00+$/))return f+pi(c,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:tn(e.substr(0,e.length-i.length))+i;if(a=e.match(O5))return Qk(a,c,f);if(e.match(/^#+0+$/))return f+pi(c,e.length-e.indexOf("0"));if(a=e.match(I5))return i=(""+r).replace(/^([^\.]+)$/,"$1."+tn(a[1])).replace(/\.$/,"."+tn(a[1])),i=i.replace(/\.(\d*)$/,function(_,y){return"."+y+Xt("0",tn(a[1]).length-y.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return f+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return f+za(""+c);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ri(t,e,-r):za(""+r)+"."+Xt("0",a[1].length);if(a=e.match(/^#,#*,#0/))return Ri(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Yo(Ri(t,e.replace(/[\\-]/g,""),r)),s=0,Yo(Yo(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return s<i.length?i.charAt(s++):_==="0"?"0":""}));if(e.match(L5))return i=Ri(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),u=zf(c,Math.pow(10,s)-1,!1),i=""+f,d=na("n",a[1],u[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Bf(u[2],s),d.length<a[4].length&&(d=tn(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),u=zf(c,Math.pow(10,s)-1,!0),f+(u[0]||(u[1]?"":"0"))+" "+(u[1]?z2(u[1],s)+a[2]+"/"+a[3]+Bf(u[2],s):Xt(" ",2*s+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:tn(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var v=e.indexOf(".")-s,g=e.length-i.length-v;return tn(e.substr(0,v)+i+e.substr(e.length-g))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ri(t,e,-r):za(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?pi(0,3-_.length):"")+_})+"."+pi(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var x=za(""+c);return x!=="0"?f+x:"";default:if(e.match(/\.[0#?]*$/))return Ri(t,e.slice(0,e.lastIndexOf(".")),r)+tn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function na(t,e,r){return(r|0)===r?Ri(t,e,r):bn(t,e,r)}function tA(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var B5=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function U5(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Uf(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(B5))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function rA(t,e,r,n){for(var i=[],a="",s=0,u="",c="t",f,d,v,g="H";s<t.length;)switch(u=t.charAt(s)){case"G":if(!Uf(t,s))throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(v=t.charCodeAt(++s))!==34&&s<t.length;)a+=String.fromCharCode(v);i[i.length]={t:"t",v:a},++s;break;case"\\":var x=t.charAt(++s),_=x==="("||x===")"?x:"t";i[i.length]={t:_,v:x},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:e},++s;break;case"B":case"b":if(t.charAt(s+1)==="1"||t.charAt(s+1)==="2"){if(f==null&&(f=zc(e,r,t.charAt(s+1)==="2"),f==null))return"";i[i.length]={t:"X",v:t.substr(s,2)},c=u,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||f==null&&(f=zc(e,r),f==null))return"";for(a=u;++s<t.length&&t.charAt(s).toLowerCase()===u;)a+=u;u==="m"&&c.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=g),i[i.length]={t:u,v:a},c=u;break;case"A":case"a":case"上":var y={t:u,v:u};if(f==null&&(f=zc(e,r)),t.substr(s,3).toUpperCase()==="A/P"?(f!=null&&(y.v=f.H>=12?"P":"A"),y.t="T",g="h",s+=3):t.substr(s,5).toUpperCase()==="AM/PM"?(f!=null&&(y.v=f.H>=12?"PM":"AM"),y.t="T",s+=5,g="h"):t.substr(s,5).toUpperCase()==="上午/下午"?(f!=null&&(y.v=f.H>=12?"下午":"上午"),y.t="T",s+=5,g="h"):(y.t="t",++s),f==null&&y.t==="T")return"";i[i.length]=y,c=u;break;case"[":for(a=u;t.charAt(s++)!=="]"&&s<t.length;)a+=t.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(B5)){if(f==null&&(f=zc(e,r),f==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",U5(t)||(i[i.length]={t:"t",v:a}));break;case".":if(f!=null){for(a=u;++s<t.length&&(u=t.charAt(s))==="0";)a+=u;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=u;++s<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(s))>-1;)a+=u;i[i.length]={t:"n",v:a};break;case"?":for(a=u;t.charAt(++s)===u;)a+=u;i[i.length]={t:u,v:a},c=u;break;case"*":++s,(t.charAt(s)==" "||t.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:n===1?"t":u,v:u},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=u;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;)a+=t.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:u,v:u},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"t",v:u},++s;break}var E=0,C=0,T;for(s=i.length-1,c="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=g,c="h",E<1&&(E=1);break;case"s":(T=i[s].v.match(/\.0+$/))&&(C=Math.max(C,T[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":c=i[s].t;break;case"m":c==="s"&&(i[s].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[s].v.match(/[Hh]/)&&(E=1),E<2&&i[s].v.match(/[Mm]/)&&(E=2),E<3&&i[s].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var m="",w;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=Xk(i[s].t.charCodeAt(0),i[s].v,f,C),i[s].t="t";break;case"n":case"?":for(w=s+1;i[w]!=null&&((u=i[w].t)==="?"||u==="D"||(u===" "||u==="t")&&i[w+1]!=null&&(i[w+1].t==="?"||i[w+1].t==="t"&&i[w+1].v==="/")||i[s].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(i[w].v==="/"||i[w].v===" "&&i[w+1]!=null&&i[w+1].t=="?"));)i[s].v+=i[w].v,i[w]={v:"",t:";"},++w;m+=i[s].v,s=w-1;break;case"G":i[s].t="t",i[s].v=Eg(e,r);break}var F="",R,N;if(m.length>0){m.charCodeAt(0)==40?(R=e<0&&m.charCodeAt(0)===45?-e:e,N=na("n",m,R)):(R=e<0&&n>1?-e:e,N=na("n",m,R),R<0&&i[0]&&i[0].t=="t"&&(N=N.substr(1),i[0].v="-"+i[0].v)),w=N.length-1;var A=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){A=s;break}var L=i.length;if(A===i.length&&N.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(w>=i[s].v.length-1?(w-=i[s].v.length,i[s].v=N.substr(w+1,i[s].v.length)):w<0?i[s].v="":(i[s].v=N.substr(0,w+1),w=-1),i[s].t="t",L=s);w>=0&&L<i.length&&(i[L].v=N.substr(0,w+1)+i[L].v)}else if(A!==i.length&&N.indexOf("E")===-1){for(w=N.indexOf(".")-1,s=A;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(d=i[s].v.indexOf(".")>-1&&s===A?i[s].v.indexOf(".")-1:i[s].v.length-1,F=i[s].v.substr(d+1);d>=0;--d)w>=0&&(i[s].v.charAt(d)==="0"||i[s].v.charAt(d)==="#")&&(F=N.charAt(w--)+F);i[s].v=F,i[s].t="t",L=s}for(w>=0&&L<i.length&&(i[L].v=N.substr(0,w+1)+i[L].v),w=N.indexOf(".")+1,s=A;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==A)){for(d=i[s].v.indexOf(".")>-1&&s===A?i[s].v.indexOf(".")+1:0,F=i[s].v.substr(0,d);d<i[s].v.length;++d)w<N.length&&(F+=N.charAt(w++));i[s].v=F,i[s].t="t",L=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(R=n>1&&e<0&&s>0&&i[s-1].v==="-"?-e:e,i[s].v=na(i[s].t,i[s].v,R),i[s].t="t");var O="";for(s=0;s!==i.length;++s)i[s]!=null&&(O+=i[s].v);return O}var X4=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function K4(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function nA(t,e){var r=tA(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(X4),u=r[1].match(X4);return K4(e,s)?[n,r[0]]:K4(e,u)?[n,r[1]]:[n,r[s!=null&&u!=null?2:1]]}return[n,a]}function qa(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Yt)[t],n==null&&(n=r.table&&r.table[j4[t]]||Yt[j4[t]]),n==null&&(n=Uk[t]||"General");break}if(Uf(n,0))return Eg(e,r);e instanceof Date&&(e=P5(e,r.date1904));var i=nA(n,e);if(Uf(i[1]))return Eg(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return rA(i[1],e,r,i[0])}function z5(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Yt[r]==null){e<0&&(e=r);continue}if(Yt[r]==t){e=r;break}}e<0&&(e=391)}return Yt[e]=t,e}function ad(t){for(var e=0;e!=392;++e)t[e]!==void 0&&z5(t[e],e)}function sd(){Yt=Bk()}var G5=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function iA(t){var e=typeof t=="number"?Yt[t]:t;return e=e.replace(G5,"(\\d+)"),new RegExp("^"+e+"$")}function aA(t,e,r){var n=-1,i=-1,a=-1,s=-1,u=-1,c=-1;(e.match(G5)||[]).forEach(function(v,g){var x=parseInt(r[g+1],10);switch(v.toLowerCase().charAt(0)){case"y":n=x;break;case"d":a=x;break;case"h":s=x;break;case"s":c=x;break;case"m":s>=0?u=x:i=x;break}}),c>=0&&u==-1&&i>=0&&(u=i,i=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&u==-1&&c==-1?f:n==-1&&i==-1&&a==-1?d:f+"T"+d}var sA=function(){var t={};t.version="1.2.0";function e(){for(var N=0,A=new Array(256),L=0;L!=256;++L)N=L,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,A[L]=N;return typeof Int32Array<"u"?new Int32Array(A):A}var r=e();function n(N){var A=0,L=0,O=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)H[O]=N[O];for(O=0;O!=256;++O)for(L=N[O],A=256+O;A<4096;A+=256)L=H[A]=L>>>8^N[L&255];var j=[];for(O=1;O!=16;++O)j[O-1]=typeof Int32Array<"u"?H.subarray(O*256,O*256+256):H.slice(O*256,O*256+256);return j}var i=n(r),a=i[0],s=i[1],u=i[2],c=i[3],f=i[4],d=i[5],v=i[6],g=i[7],x=i[8],_=i[9],y=i[10],E=i[11],C=i[12],T=i[13],m=i[14];function w(N,A){for(var L=A^-1,O=0,H=N.length;O<H;)L=L>>>8^r[(L^N.charCodeAt(O++))&255];return~L}function F(N,A){for(var L=A^-1,O=N.length-15,H=0;H<O;)L=m[N[H++]^L&255]^T[N[H++]^L>>8&255]^C[N[H++]^L>>16&255]^E[N[H++]^L>>>24]^y[N[H++]]^_[N[H++]]^x[N[H++]]^g[N[H++]]^v[N[H++]]^d[N[H++]]^f[N[H++]]^c[N[H++]]^u[N[H++]]^s[N[H++]]^a[N[H++]]^r[N[H++]];for(O+=15;H<O;)L=L>>>8^r[(L^N[H++])&255];return~L}function R(N,A){for(var L=A^-1,O=0,H=N.length,j=0,q=0;O<H;)j=N.charCodeAt(O++),j<128?L=L>>>8^r[(L^j)&255]:j<2048?(L=L>>>8^r[(L^(192|j>>6&31))&255],L=L>>>8^r[(L^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,q=N.charCodeAt(O++)&1023,L=L>>>8^r[(L^(240|j>>8&7))&255],L=L>>>8^r[(L^(128|j>>2&63))&255],L=L>>>8^r[(L^(128|q>>6&15|(j&3)<<4))&255],L=L>>>8^r[(L^(128|q&63))&255]):(L=L>>>8^r[(L^(224|j>>12&15))&255],L=L>>>8^r[(L^(128|j>>6&63))&255],L=L>>>8^r[(L^(128|j&63))&255]);return~L}return t.table=r,t.bstr=w,t.buf=F,t.str=R,t}(),Et=function(){var e={};e.version="1.2.1";function r(P,B){for(var I=P.split("/"),M=B.split("/"),U=0,G=0,ee=Math.min(I.length,M.length);U<ee;++U){if(G=I[U].length-M[U].length)return G;if(I[U]!=M[U])return I[U]<M[U]?-1:1}return I.length-M.length}function n(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:n(P.slice(0,-1));var B=P.lastIndexOf("/");return B===-1?P:P.slice(0,B+1)}function i(P){if(P.charAt(P.length-1)=="/")return i(P.slice(0,-1));var B=P.lastIndexOf("/");return B===-1?P:P.slice(B+1)}function a(P,B){typeof B=="string"&&(B=new Date(B));var I=B.getHours();I=I<<6|B.getMinutes(),I=I<<5|B.getSeconds()>>>1,P.write_shift(2,I);var M=B.getFullYear()-1980;M=M<<4|B.getMonth()+1,M=M<<5|B.getDate(),P.write_shift(2,M)}function s(P){var B=P.read_shift(2)&65535,I=P.read_shift(2)&65535,M=new Date,U=I&31;I>>>=5;var G=I&15;I>>>=4,M.setMilliseconds(0),M.setFullYear(I+1980),M.setMonth(G-1),M.setDate(U);var ee=B&31;B>>>=5;var fe=B&63;return B>>>=6,M.setHours(B),M.setMinutes(fe),M.setSeconds(ee<<1),M}function u(P){kn(P,0);for(var B={},I=0;P.l<=P.length-4;){var M=P.read_shift(2),U=P.read_shift(2),G=P.l+U,ee={};switch(M){case 21589:I=P.read_shift(1),I&1&&(ee.mtime=P.read_shift(4)),U>5&&(I&2&&(ee.atime=P.read_shift(4)),I&4&&(ee.ctime=P.read_shift(4))),ee.mtime&&(ee.mt=new Date(ee.mtime*1e3));break}P.l=G,B[M]=ee}return B}var c;function f(){return c||(c={})}function d(P,B){if(P[0]==80&&P[1]==75)return x0(P,B);if((P[0]|32)==109&&(P[1]|32)==105)return w0(P,B);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var I=3,M=512,U=0,G=0,ee=0,fe=0,J=0,te=[],re=P.slice(0,512);kn(re,0);var _e=v(re);switch(I=_e[0],I){case 3:M=512;break;case 4:M=4096;break;case 0:if(_e[1]==0)return x0(P,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}M!==512&&(re=P.slice(0,M),kn(re,28));var Fe=P.slice(0,M);g(re,I);var Ie=re.read_shift(4,"i");if(I===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);re.l+=4,ee=re.read_shift(4,"i"),re.l+=4,re.chk("00100000","Mini Stream Cutoff Size: "),fe=re.read_shift(4,"i"),U=re.read_shift(4,"i"),J=re.read_shift(4,"i"),G=re.read_shift(4,"i");for(var Ee=-1,Pe=0;Pe<109&&(Ee=re.read_shift(4,"i"),!(Ee<0));++Pe)te[Pe]=Ee;var Ve=x(P,M);E(J,G,Ve,M,te);var gt=T(Ve,ee,te,M);gt[ee].name="!Directory",U>0&&fe!==q&&(gt[fe].name="!MiniFAT"),gt[te[0]].name="!FAT",gt.fat_addrs=te,gt.ssz=M;var Tt={},er=[],fs=[],Wi=[];m(ee,gt,Ve,er,U,Tt,fs,fe),_(fs,Wi,er),er.shift();var Ln={FileIndex:fs,FullPaths:Wi};return B&&B.raw&&(Ln.raw={header:Fe,sectors:Ve}),Ln}function v(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(ye,"Header Signature: "),P.l+=16;var B=P.read_shift(2,"u");return[P.read_shift(2,"u"),B]}function g(P,B){var I=9;switch(P.l+=2,I=P.read_shift(2)){case 9:if(B!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(B!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function x(P,B){for(var I=Math.ceil(P.length/B)-1,M=[],U=1;U<I;++U)M[U-1]=P.slice(U*B,(U+1)*B);return M[I-1]=P.slice(I*B),M}function _(P,B,I){for(var M=0,U=0,G=0,ee=0,fe=0,J=I.length,te=[],re=[];M<J;++M)te[M]=re[M]=M,B[M]=I[M];for(;fe<re.length;++fe)M=re[fe],U=P[M].L,G=P[M].R,ee=P[M].C,te[M]===M&&(U!==-1&&te[U]!==U&&(te[M]=te[U]),G!==-1&&te[G]!==G&&(te[M]=te[G])),ee!==-1&&(te[ee]=M),U!==-1&&M!=te[M]&&(te[U]=te[M],re.lastIndexOf(U)<fe&&re.push(U)),G!==-1&&M!=te[M]&&(te[G]=te[M],re.lastIndexOf(G)<fe&&re.push(G));for(M=1;M<J;++M)te[M]===M&&(G!==-1&&te[G]!==G?te[M]=te[G]:U!==-1&&te[U]!==U&&(te[M]=te[U]));for(M=1;M<J;++M)if(P[M].type!==0){if(fe=M,fe!=te[fe])do fe=te[fe],B[M]=B[fe]+"/"+B[M];while(fe!==0&&te[fe]!==-1&&fe!=te[fe]);te[M]=-1}for(B[0]+="/",M=1;M<J;++M)P[M].type!==2&&(B[M]+="/")}function y(P,B,I){for(var M=P.start,U=P.size,G=[],ee=M;I&&U>0&&ee>=0;)G.push(B.slice(ee*j,ee*j+j)),U-=j,ee=ks(I,ee*4);return G.length===0?ce(0):Rr(G).slice(0,P.size)}function E(P,B,I,M,U){var G=q;if(P===q){if(B!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var ee=I[P],fe=(M>>>2)-1;if(!ee)return;for(var J=0;J<fe&&(G=ks(ee,J*4))!==q;++J)U.push(G);E(ks(ee,M-4),B-1,I,M,U)}}function C(P,B,I,M,U){var G=[],ee=[];U||(U=[]);var fe=M-1,J=0,te=0;for(J=B;J>=0;){U[J]=!0,G[G.length]=J,ee.push(P[J]);var re=I[Math.floor(J*4/M)];if(te=J*4&fe,M<4+te)throw new Error("FAT boundary crossed: "+J+" 4 "+M);if(!P[re])break;J=ks(P[re],te)}return{nodes:G,data:t3([ee])}}function T(P,B,I,M){var U=P.length,G=[],ee=[],fe=[],J=[],te=M-1,re=0,_e=0,Fe=0,Ie=0;for(re=0;re<U;++re)if(fe=[],Fe=re+B,Fe>=U&&(Fe-=U),!ee[Fe]){J=[];var Ee=[];for(_e=Fe;_e>=0;){Ee[_e]=!0,ee[_e]=!0,fe[fe.length]=_e,J.push(P[_e]);var Pe=I[Math.floor(_e*4/M)];if(Ie=_e*4&te,M<4+Ie)throw new Error("FAT boundary crossed: "+_e+" 4 "+M);if(!P[Pe]||(_e=ks(P[Pe],Ie),Ee[_e]))break}G[Fe]={nodes:fe,data:t3([J])}}return G}function m(P,B,I,M,U,G,ee,fe){for(var J=0,te=M.length?2:0,re=B[P].data,_e=0,Fe=0,Ie;_e<re.length;_e+=128){var Ee=re.slice(_e,_e+128);kn(Ee,64),Fe=Ee.read_shift(2),Ie=b2(Ee,0,Fe-te),M.push(Ie);var Pe={name:Ie,type:Ee.read_shift(1),color:Ee.read_shift(1),L:Ee.read_shift(4,"i"),R:Ee.read_shift(4,"i"),C:Ee.read_shift(4,"i"),clsid:Ee.read_shift(16),state:Ee.read_shift(4,"i"),start:0,size:0},Ve=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);Ve!==0&&(Pe.ct=w(Ee,Ee.l-8));var gt=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);gt!==0&&(Pe.mt=w(Ee,Ee.l-8)),Pe.start=Ee.read_shift(4,"i"),Pe.size=Ee.read_shift(4,"i"),Pe.size<0&&Pe.start<0&&(Pe.size=Pe.type=0,Pe.start=q,Pe.name=""),Pe.type===5?(J=Pe.start,U>0&&J!==q&&(B[J].name="!StreamData")):Pe.size>=4096?(Pe.storage="fat",B[Pe.start]===void 0&&(B[Pe.start]=C(I,Pe.start,B.fat_addrs,B.ssz)),B[Pe.start].name=Pe.name,Pe.content=B[Pe.start].data.slice(0,Pe.size)):(Pe.storage="minifat",Pe.size<0?Pe.size=0:J!==q&&Pe.start!==q&&B[J]&&(Pe.content=y(Pe,B[J].data,(B[fe]||{}).data))),Pe.content&&kn(Pe.content,0),G[Ie]=Pe,ee.push(Pe)}}function w(P,B){return new Date((Fn(P,B+4)/1e7*Math.pow(2,32)+Fn(P,B)/1e7-11644473600)*1e3)}function F(P,B){return f(),d(c.readFileSync(P),B)}function R(P,B){var I=B&&B.type;switch(I||dt&&Buffer.isBuffer(P)&&(I="buffer"),I||"base64"){case"file":return F(P,B);case"base64":return d(di(ca(P)),B);case"binary":return d(di(P),B)}return d(P,B)}function N(P,B){var I=B||{},M=I.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=M+"/",P.FileIndex[0]={name:M,type:5}),I.CLSID&&(P.FileIndex[0].clsid=I.CLSID),A(P)}function A(P){var B="Sh33tJ5";if(!Et.find(P,"/"+B)){var I=ce(4);I[0]=55,I[1]=I[3]=50,I[2]=54,P.FileIndex.push({name:B,type:2,content:I,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+B),L(P)}}function L(P,B){N(P);for(var I=!1,M=!1,U=P.FullPaths.length-1;U>=0;--U){var G=P.FileIndex[U];switch(G.type){case 0:M?I=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(G.R*G.L*G.C)&&(I=!0),G.R>-1&&G.L>-1&&G.R==G.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!B)){var ee=new Date(1987,1,19),fe=0,J=Object.create?Object.create(null):{},te=[];for(U=0;U<P.FullPaths.length;++U)J[P.FullPaths[U]]=!0,P.FileIndex[U].type!==0&&te.push([P.FullPaths[U],P.FileIndex[U]]);for(U=0;U<te.length;++U){var re=n(te[U][0]);M=J[re],M||(te.push([re,{name:i(re).replace("/",""),type:1,clsid:Ae,ct:ee,mt:ee,content:null}]),J[re]=!0)}for(te.sort(function(Ie,Ee){return r(Ie[0],Ee[0])}),P.FullPaths=[],P.FileIndex=[],U=0;U<te.length;++U)P.FullPaths[U]=te[U][0],P.FileIndex[U]=te[U][1];for(U=0;U<te.length;++U){var _e=P.FileIndex[U],Fe=P.FullPaths[U];if(_e.name=i(Fe).replace("/",""),_e.L=_e.R=_e.C=-(_e.color=1),_e.size=_e.content?_e.content.length:0,_e.start=0,_e.clsid=_e.clsid||Ae,U===0)_e.C=te.length>1?1:-1,_e.size=0,_e.type=5;else if(Fe.slice(-1)=="/"){for(fe=U+1;fe<te.length&&n(P.FullPaths[fe])!=Fe;++fe);for(_e.C=fe>=te.length?-1:fe,fe=U+1;fe<te.length&&n(P.FullPaths[fe])!=n(Fe);++fe);_e.R=fe>=te.length?-1:fe,_e.type=1}else n(P.FullPaths[U+1]||"")==n(Fe)&&(_e.R=U+1),_e.type=2}}}function O(P,B){var I=B||{};if(I.fileType=="mad")return md(P,I);switch(L(P),I.fileType){case"zip":return pd(P,I)}var M=function(Ie){for(var Ee=0,Pe=0,Ve=0;Ve<Ie.FileIndex.length;++Ve){var gt=Ie.FileIndex[Ve];if(gt.content){var Tt=gt.content.length;Tt>0&&(Tt<4096?Ee+=Tt+63>>6:Pe+=Tt+511>>9)}}for(var er=Ie.FullPaths.length+3>>2,fs=Ee+7>>3,Wi=Ee+127>>7,Ln=fs+Pe+er+Wi,Ur=Ln+127>>7,mt=Ur<=109?0:Math.ceil((Ur-109)/127);Ln+Ur+mt+127>>7>Ur;)mt=++Ur<=109?0:Math.ceil((Ur-109)/127);var at=[1,mt,Ur,Wi,er,Pe,Ee,0];return Ie.FileIndex[0].size=Ee<<6,at[7]=(Ie.FileIndex[0].start=at[0]+at[1]+at[2]+at[3]+at[4]+at[5])+(at[6]+7>>3),at}(P),U=ce(M[7]<<9),G=0,ee=0;{for(G=0;G<8;++G)U.write_shift(1,de[G]);for(G=0;G<8;++G)U.write_shift(2,0);for(U.write_shift(2,62),U.write_shift(2,3),U.write_shift(2,65534),U.write_shift(2,9),U.write_shift(2,6),G=0;G<3;++G)U.write_shift(2,0);for(U.write_shift(4,0),U.write_shift(4,M[2]),U.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),U.write_shift(4,0),U.write_shift(4,4096),U.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:q),U.write_shift(4,M[3]),U.write_shift(-4,M[1]?M[0]-1:q),U.write_shift(4,M[1]),G=0;G<109;++G)U.write_shift(-4,G<M[2]?M[1]+G:-1)}if(M[1])for(ee=0;ee<M[1];++ee){for(;G<236+ee*127;++G)U.write_shift(-4,G<M[2]?M[1]+G:-1);U.write_shift(-4,ee===M[1]-1?q:ee+1)}var fe=function(Ie){for(ee+=Ie;G<ee-1;++G)U.write_shift(-4,G+1);Ie&&(++G,U.write_shift(-4,q))};for(ee=G=0,ee+=M[1];G<ee;++G)U.write_shift(-4,Ge.DIFSECT);for(ee+=M[2];G<ee;++G)U.write_shift(-4,Ge.FATSECT);fe(M[3]),fe(M[4]);for(var J=0,te=0,re=P.FileIndex[0];J<P.FileIndex.length;++J)re=P.FileIndex[J],re.content&&(te=re.content.length,!(te<4096)&&(re.start=ee,fe(te+511>>9)));for(fe(M[6]+7>>3);U.l&511;)U.write_shift(-4,Ge.ENDOFCHAIN);for(ee=G=0,J=0;J<P.FileIndex.length;++J)re=P.FileIndex[J],re.content&&(te=re.content.length,!(!te||te>=4096)&&(re.start=ee,fe(te+63>>6)));for(;U.l&511;)U.write_shift(-4,Ge.ENDOFCHAIN);for(G=0;G<M[4]<<2;++G){var _e=P.FullPaths[G];if(!_e||_e.length===0){for(J=0;J<17;++J)U.write_shift(4,0);for(J=0;J<3;++J)U.write_shift(4,-1);for(J=0;J<12;++J)U.write_shift(4,0);continue}re=P.FileIndex[G],G===0&&(re.start=re.size?re.start-1:q);var Fe=G===0&&I.root||re.name;if(te=2*(Fe.length+1),U.write_shift(64,Fe,"utf16le"),U.write_shift(2,te),U.write_shift(1,re.type),U.write_shift(1,re.color),U.write_shift(-4,re.L),U.write_shift(-4,re.R),U.write_shift(-4,re.C),re.clsid)U.write_shift(16,re.clsid,"hex");else for(J=0;J<4;++J)U.write_shift(4,0);U.write_shift(4,re.state||0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,re.start),U.write_shift(4,re.size),U.write_shift(4,0)}for(G=1;G<P.FileIndex.length;++G)if(re=P.FileIndex[G],re.size>=4096)if(U.l=re.start+1<<9,dt&&Buffer.isBuffer(re.content))re.content.copy(U,U.l,0,re.size),U.l+=re.size+511&-512;else{for(J=0;J<re.size;++J)U.write_shift(1,re.content[J]);for(;J&511;++J)U.write_shift(1,0)}for(G=1;G<P.FileIndex.length;++G)if(re=P.FileIndex[G],re.size>0&&re.size<4096)if(dt&&Buffer.isBuffer(re.content))re.content.copy(U,U.l,0,re.size),U.l+=re.size+63&-64;else{for(J=0;J<re.size;++J)U.write_shift(1,re.content[J]);for(;J&63;++J)U.write_shift(1,0)}if(dt)U.l=U.length;else for(;U.l<U.length;)U.write_shift(1,0);return U}function H(P,B){var I=P.FullPaths.map(function(J){return J.toUpperCase()}),M=I.map(function(J){var te=J.split("/");return te[te.length-(J.slice(-1)=="/"?2:1)]}),U=!1;B.charCodeAt(0)===47?(U=!0,B=I[0].slice(0,-1)+B):U=B.indexOf("/")!==-1;var G=B.toUpperCase(),ee=U===!0?I.indexOf(G):M.indexOf(G);if(ee!==-1)return P.FileIndex[ee];var fe=!G.match(Uc);for(G=G.replace(_u,""),fe&&(G=G.replace(Uc,"!")),ee=0;ee<I.length;++ee)if((fe?I[ee].replace(Uc,"!"):I[ee]).replace(_u,"")==G||(fe?M[ee].replace(Uc,"!"):M[ee]).replace(_u,"")==G)return P.FileIndex[ee];return null}var j=64,q=-2,ye="d0cf11e0a1b11ae1",de=[208,207,17,224,161,177,26,225],Ae="00000000000000000000000000000000",Ge={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:ye,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ue(P,B,I){f();var M=O(P,I);c.writeFileSync(B,M)}function xe(P){for(var B=new Array(P.length),I=0;I<P.length;++I)B[I]=String.fromCharCode(P[I]);return B.join("")}function ve(P,B){var I=O(P,B);switch(B&&B.type||"buffer"){case"file":return f(),c.writeFileSync(B.filename,I),I;case"binary":return typeof I=="string"?I:xe(I);case"base64":return Xu(typeof I=="string"?I:xe(I));case"buffer":if(dt)return Buffer.isBuffer(I)?I:va(I);case"array":return typeof I=="string"?di(I):I}return I}var we;function z(P){try{var B=P.InflateRaw,I=new B;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)we=P;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function K(P,B){if(!we)return m0(P,B);var I=we.InflateRaw,M=new I,U=M._processChunk(P.slice(P.l),M._finishFlushFlag);return P.l+=M.bytesRead,U}function b(P){return we?we.deflateRawSync(P):Br(P)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],W=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Z(P){var B=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(B>>16|B>>8|B)&255}for(var he=typeof Uint8Array<"u",ge=he?new Uint8Array(256):[],Ne=0;Ne<256;++Ne)ge[Ne]=Z(Ne);function Be(P,B){var I=ge[P&255];return B<=8?I>>>8-B:(I=I<<8|ge[P>>8&255],B<=16?I>>>16-B:(I=I<<8|ge[P>>16&255],I>>>24-B))}function Ke(P,B){var I=B&7,M=B>>>3;return(P[M]|(I<=6?0:P[M+1]<<8))>>>I&3}function Ye(P,B){var I=B&7,M=B>>>3;return(P[M]|(I<=5?0:P[M+1]<<8))>>>I&7}function et(P,B){var I=B&7,M=B>>>3;return(P[M]|(I<=4?0:P[M+1]<<8))>>>I&15}function se(P,B){var I=B&7,M=B>>>3;return(P[M]|(I<=3?0:P[M+1]<<8))>>>I&31}function ae(P,B){var I=B&7,M=B>>>3;return(P[M]|(I<=1?0:P[M+1]<<8))>>>I&127}function me(P,B,I){var M=B&7,U=B>>>3,G=(1<<I)-1,ee=P[U]>>>M;return I<8-M||(ee|=P[U+1]<<8-M,I<16-M)||(ee|=P[U+2]<<16-M,I<24-M)||(ee|=P[U+3]<<24-M),ee&G}function ze(P,B,I){var M=B&7,U=B>>>3;return M<=5?P[U]|=(I&7)<<M:(P[U]|=I<<M&255,P[U+1]=(I&7)>>8-M),B+3}function Ue(P,B,I){var M=B&7,U=B>>>3;return I=(I&1)<<M,P[U]|=I,B+1}function Xe(P,B,I){var M=B&7,U=B>>>3;return I<<=M,P[U]|=I&255,I>>>=8,P[U+1]=I,B+8}function sr(P,B,I){var M=B&7,U=B>>>3;return I<<=M,P[U]|=I&255,I>>>=8,P[U+1]=I&255,P[U+2]=I>>>8,B+16}function At(P,B){var I=P.length,M=2*I>B?2*I:B+5,U=0;if(I>=B)return P;if(dt){var G=G4(M);if(P.copy)P.copy(G);else for(;U<P.length;++U)G[U]=P[U];return G}else if(he){var ee=new Uint8Array(M);if(ee.set)ee.set(P);else for(;U<I;++U)ee[U]=P[U];return ee}return P.length=M,P}function tt(P){for(var B=new Array(P),I=0;I<P;++I)B[I]=0;return B}function Dt(P,B,I){var M=1,U=0,G=0,ee=0,fe=0,J=P.length,te=he?new Uint16Array(32):tt(32);for(G=0;G<32;++G)te[G]=0;for(G=J;G<I;++G)P[G]=0;J=P.length;var re=he?new Uint16Array(J):tt(J);for(G=0;G<J;++G)te[U=P[G]]++,M<U&&(M=U),re[G]=0;for(te[0]=0,G=1;G<=M;++G)te[G+16]=fe=fe+te[G-1]<<1;for(G=0;G<J;++G)fe=P[G],fe!=0&&(re[G]=te[fe+16]++);var _e=0;for(G=0;G<J;++G)if(_e=P[G],_e!=0)for(fe=Be(re[G],M)>>M-_e,ee=(1<<M+4-_e)-1;ee>=0;--ee)B[fe|ee<<_e]=_e&15|G<<4;return M}var Jr=he?new Uint16Array(512):tt(512),Zt=he?new Uint16Array(32):tt(32);if(!he){for(var Ft=0;Ft<512;++Ft)Jr[Ft]=0;for(Ft=0;Ft<32;++Ft)Zt[Ft]=0}(function(){for(var P=[],B=0;B<32;B++)P.push(5);Dt(P,Zt,32);var I=[];for(B=0;B<=143;B++)I.push(8);for(;B<=255;B++)I.push(9);for(;B<=279;B++)I.push(7);for(;B<=287;B++)I.push(8);Dt(I,Jr,288)})();var Cr=function(){for(var B=he?new Uint8Array(32768):[],I=0,M=0;I<W.length-1;++I)for(;M<W[I+1];++M)B[M]=I;for(;M<32768;++M)B[M]=29;var U=he?new Uint8Array(259):[];for(I=0,M=0;I<oe.length-1;++I)for(;M<oe[I+1];++M)U[M]=I;function G(fe,J){for(var te=0;te<fe.length;){var re=Math.min(65535,fe.length-te),_e=te+re==fe.length;for(J.write_shift(1,+_e),J.write_shift(2,re),J.write_shift(2,~re&65535);re-- >0;)J[J.l++]=fe[te++]}return J.l}function ee(fe,J){for(var te=0,re=0,_e=he?new Uint16Array(32768):[];re<fe.length;){var Fe=Math.min(65535,fe.length-re);if(Fe<10){for(te=ze(J,te,+(re+Fe==fe.length)),te&7&&(te+=8-(te&7)),J.l=te/8|0,J.write_shift(2,Fe),J.write_shift(2,~Fe&65535);Fe-- >0;)J[J.l++]=fe[re++];te=J.l*8;continue}te=ze(J,te,+(re+Fe==fe.length)+2);for(var Ie=0;Fe-- >0;){var Ee=fe[re];Ie=(Ie<<5^Ee)&32767;var Pe=-1,Ve=0;if((Pe=_e[Ie])&&(Pe|=re&-32768,Pe>re&&(Pe-=32768),Pe<re))for(;fe[Pe+Ve]==fe[re+Ve]&&Ve<250;)++Ve;if(Ve>2){Ee=U[Ve],Ee<=22?te=Xe(J,te,ge[Ee+1]>>1)-1:(Xe(J,te,3),te+=5,Xe(J,te,ge[Ee-23]>>5),te+=3);var gt=Ee<8?0:Ee-4>>2;gt>0&&(sr(J,te,Ve-oe[Ee]),te+=gt),Ee=B[re-Pe],te=Xe(J,te,ge[Ee]>>3),te-=3;var Tt=Ee<4?0:Ee-2>>1;Tt>0&&(sr(J,te,re-Pe-W[Ee]),te+=Tt);for(var er=0;er<Ve;++er)_e[Ie]=re&32767,Ie=(Ie<<5^fe[re])&32767,++re;Fe-=Ve-1}else Ee<=143?Ee=Ee+48:te=Ue(J,te,1),te=Xe(J,te,ge[Ee]),_e[Ie]=re&32767,++re}te=Xe(J,te,0)-1}return J.l=(te+7)/8|0,J.l}return function(J,te){return J.length<8?G(J,te):ee(J,te)}}();function Br(P){var B=ce(50+Math.floor(P.length*1.1)),I=Cr(P,B);return B.slice(0,I)}var gr=he?new Uint16Array(32768):tt(32768),Si=he?new Uint16Array(32768):tt(32768),xa=he?new Uint16Array(128):tt(128),no=1,p0=1;function hd(P,B){var I=se(P,B)+257;B+=5;var M=se(P,B)+1;B+=5;var U=et(P,B)+4;B+=4;for(var G=0,ee=he?new Uint8Array(19):tt(19),fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],J=1,te=he?new Uint8Array(8):tt(8),re=he?new Uint8Array(8):tt(8),_e=ee.length,Fe=0;Fe<U;++Fe)ee[V[Fe]]=G=Ye(P,B),J<G&&(J=G),te[G]++,B+=3;var Ie=0;for(te[0]=0,Fe=1;Fe<=J;++Fe)re[Fe]=Ie=Ie+te[Fe-1]<<1;for(Fe=0;Fe<_e;++Fe)(Ie=ee[Fe])!=0&&(fe[Fe]=re[Ie]++);var Ee=0;for(Fe=0;Fe<_e;++Fe)if(Ee=ee[Fe],Ee!=0){Ie=ge[fe[Fe]]>>8-Ee;for(var Pe=(1<<7-Ee)-1;Pe>=0;--Pe)xa[Ie|Pe<<Ee]=Ee&7|Fe<<3}var Ve=[];for(J=1;Ve.length<I+M;)switch(Ie=xa[ae(P,B)],B+=Ie&7,Ie>>>=3){case 16:for(G=3+Ke(P,B),B+=2,Ie=Ve[Ve.length-1];G-- >0;)Ve.push(Ie);break;case 17:for(G=3+Ye(P,B),B+=3;G-- >0;)Ve.push(0);break;case 18:for(G=11+ae(P,B),B+=7;G-- >0;)Ve.push(0);break;default:Ve.push(Ie),J<Ie&&(J=Ie);break}var gt=Ve.slice(0,I),Tt=Ve.slice(I);for(Fe=I;Fe<286;++Fe)gt[Fe]=0;for(Fe=M;Fe<30;++Fe)Tt[Fe]=0;return no=Dt(gt,gr,286),p0=Dt(Tt,Si,30),B}function g0(P,B){if(P[0]==3&&!(P[1]&3))return[Us(B),2];for(var I=0,M=0,U=G4(B||1<<18),G=0,ee=U.length>>>0,fe=0,J=0;!(M&1);){if(M=Ye(P,I),I+=3,M>>>1)M>>1==1?(fe=9,J=5):(I=hd(P,I),fe=no,J=p0);else{I&7&&(I+=8-(I&7));var te=P[I>>>3]|P[(I>>>3)+1]<<8;if(I+=32,te>0)for(!B&&ee<G+te&&(U=At(U,G+te),ee=U.length);te-- >0;)U[G++]=P[I>>>3],I+=8;continue}for(;;){!B&&ee<G+32767&&(U=At(U,G+32767),ee=U.length);var re=me(P,I,fe),_e=M>>>1==1?Jr[re]:gr[re];if(I+=_e&15,_e>>>=4,!(_e>>>8&255))U[G++]=_e;else{if(_e==256)break;_e-=257;var Fe=_e<8?0:_e-4>>2;Fe>5&&(Fe=0);var Ie=G+oe[_e];Fe>0&&(Ie+=me(P,I,Fe),I+=Fe),re=me(P,I,J),_e=M>>>1==1?Zt[re]:Si[re],I+=_e&15,_e>>>=4;var Ee=_e<4?0:_e-2>>1,Pe=W[_e];for(Ee>0&&(Pe+=me(P,I,Ee),I+=Ee),!B&&ee<Ie&&(U=At(U,Ie+100),ee=U.length);G<Ie;)U[G]=U[G-Pe],++G}}}return B?[U,I+7>>>3]:[U.slice(0,G),I+7>>>3]}function m0(P,B){var I=P.slice(P.l||0),M=g0(I,B);return P.l+=M[1],M[0]}function v0(P,B){if(P)typeof console<"u"&&console.error(B);else throw new Error(B)}function x0(P,B){var I=P;kn(I,0);var M=[],U=[],G={FileIndex:M,FullPaths:U};N(G,{root:B.root});for(var ee=I.length-4;(I[ee]!=80||I[ee+1]!=75||I[ee+2]!=5||I[ee+3]!=6)&&ee>=0;)--ee;I.l=ee+4,I.l+=4;var fe=I.read_shift(2);I.l+=6;var J=I.read_shift(4);for(I.l=J,ee=0;ee<fe;++ee){I.l+=20;var te=I.read_shift(4),re=I.read_shift(4),_e=I.read_shift(2),Fe=I.read_shift(2),Ie=I.read_shift(2);I.l+=8;var Ee=I.read_shift(4),Pe=u(I.slice(I.l+_e,I.l+_e+Fe));I.l+=_e+Fe+Ie;var Ve=I.l;I.l=Ee+4,dd(I,te,re,G,Pe),I.l=Ve}return G}function dd(P,B,I,M,U){P.l+=2;var G=P.read_shift(2),ee=P.read_shift(2),fe=s(P);if(G&8257)throw new Error("Unsupported ZIP encryption");for(var J=P.read_shift(4),te=P.read_shift(4),re=P.read_shift(4),_e=P.read_shift(2),Fe=P.read_shift(2),Ie="",Ee=0;Ee<_e;++Ee)Ie+=String.fromCharCode(P[P.l++]);if(Fe){var Pe=u(P.slice(P.l,P.l+Fe));(Pe[21589]||{}).mt&&(fe=Pe[21589].mt),((U||{})[21589]||{}).mt&&(fe=U[21589].mt)}P.l+=Fe;var Ve=P.slice(P.l,P.l+te);switch(ee){case 8:Ve=K(P,re);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ee)}var gt=!1;G&8&&(J=P.read_shift(4),J==134695760&&(J=P.read_shift(4),gt=!0),te=P.read_shift(4),re=P.read_shift(4)),te!=B&&v0(gt,"Bad compressed size: "+B+" != "+te),re!=I&&v0(gt,"Bad uncompressed size: "+I+" != "+re),Tl(M,Ie,Ve,{unsafe:!0,mt:fe})}function pd(P,B){var I=B||{},M=[],U=[],G=ce(1),ee=I.compression?8:0,fe=0,J=0,te=0,re=0,_e=0,Fe=P.FullPaths[0],Ie=Fe,Ee=P.FileIndex[0],Pe=[],Ve=0;for(J=1;J<P.FullPaths.length;++J)if(Ie=P.FullPaths[J].slice(Fe.length),Ee=P.FileIndex[J],!(!Ee.size||!Ee.content||Ie=="Sh33tJ5")){var gt=re,Tt=ce(Ie.length);for(te=0;te<Ie.length;++te)Tt.write_shift(1,Ie.charCodeAt(te)&127);Tt=Tt.slice(0,Tt.l),Pe[_e]=sA.buf(Ee.content,0);var er=Ee.content;ee==8&&(er=b(er)),G=ce(30),G.write_shift(4,67324752),G.write_shift(2,20),G.write_shift(2,fe),G.write_shift(2,ee),Ee.mt?a(G,Ee.mt):G.write_shift(4,0),G.write_shift(-4,Pe[_e]),G.write_shift(4,er.length),G.write_shift(4,Ee.content.length),G.write_shift(2,Tt.length),G.write_shift(2,0),re+=G.length,M.push(G),re+=Tt.length,M.push(Tt),re+=er.length,M.push(er),G=ce(46),G.write_shift(4,33639248),G.write_shift(2,0),G.write_shift(2,20),G.write_shift(2,fe),G.write_shift(2,ee),G.write_shift(4,0),G.write_shift(-4,Pe[_e]),G.write_shift(4,er.length),G.write_shift(4,Ee.content.length),G.write_shift(2,Tt.length),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(4,0),G.write_shift(4,gt),Ve+=G.l,U.push(G),Ve+=Tt.length,U.push(Tt),++_e}return G=ce(22),G.write_shift(4,101010256),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,_e),G.write_shift(2,_e),G.write_shift(4,Ve),G.write_shift(4,re),G.write_shift(2,0),Rr([Rr(M),Rr(U),G])}var io={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _0(P,B){if(P.ctype)return P.ctype;var I=P.name||"",M=I.match(/\.([^\.]+)$/);return M&&io[M[1]]||B&&(M=(I=B).match(/[\.\\]([^\.\\])+$/),M&&io[M[1]])?io[M[1]]:"application/octet-stream"}function y0(P){for(var B=Xu(P),I=[],M=0;M<B.length;M+=76)I.push(B.slice(M,M+76));return I.join(`\r
`)+`\r
`}function gd(P){var B=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(te){var re=te.charCodeAt(0).toString(16).toUpperCase();return"="+(re.length==1?"0"+re:re)});B=B.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),B.charAt(0)==`
`&&(B="=0D"+B.slice(1)),B=B.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],M=B.split(`\r
`),U=0;U<M.length;++U){var G=M[U];if(G.length==0){I.push("");continue}for(var ee=0;ee<G.length;){var fe=76,J=G.slice(ee,ee+fe);J.charAt(fe-1)=="="?fe--:J.charAt(fe-2)=="="?fe-=2:J.charAt(fe-3)=="="&&(fe-=3),J=G.slice(ee,ee+fe),ee+=fe,ee<G.length&&(J+="="),I.push(J)}}return I.join(`\r
`)}function El(P){for(var B=[],I=0;I<P.length;++I){for(var M=P[I];I<=P.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+P[++I];B.push(M)}for(var U=0;U<B.length;++U)B[U]=B[U].replace(/[=][0-9A-Fa-f]{2}/g,function(G){return String.fromCharCode(parseInt(G.slice(1),16))});return di(B.join(`\r
`))}function S0(P,B,I){for(var M="",U="",G="",ee,fe=0;fe<10;++fe){var J=B[fe];if(!J||J.match(/^\s*$/))break;var te=J.match(/^(.*?):\s*([^\s].*)$/);if(te)switch(te[1].toLowerCase()){case"content-location":M=te[2].trim();break;case"content-type":G=te[2].trim();break;case"content-transfer-encoding":U=te[2].trim();break}}switch(++fe,U.toLowerCase()){case"base64":ee=di(ca(B.slice(fe).join("")));break;case"quoted-printable":ee=El(B.slice(fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+U)}var re=Tl(P,M.slice(I.length),ee,{unsafe:!0});G&&(re.ctype=G)}function w0(P,B){if(xe(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=B&&B.root||"",M=(dt&&Buffer.isBuffer(P)?P.toString("binary"):xe(P)).split(`\r
`),U=0,G="";for(U=0;U<M.length;++U)if(G=M[U],!!/^Content-Location:/i.test(G)&&(G=G.slice(G.indexOf("file")),I||(I=G.slice(0,G.lastIndexOf("/")+1)),G.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),G.slice(0,I.length)!=I););var ee=(M[1]||"").match(/boundary="(.*?)"/);if(!ee)throw new Error("MAD cannot find boundary");var fe="--"+(ee[1]||""),J=[],te=[],re={FileIndex:J,FullPaths:te};N(re);var _e,Fe=0;for(U=0;U<M.length;++U){var Ie=M[U];Ie!==fe&&Ie!==fe+"--"||(Fe++&&S0(re,M.slice(_e,U),I),_e=U)}return re}function md(P,B){var I=B||{},M=I.boundary||"SheetJS";M="------="+M;for(var U=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],G=P.FullPaths[0],ee=G,fe=P.FileIndex[0],J=1;J<P.FullPaths.length;++J)if(ee=P.FullPaths[J].slice(G.length),fe=P.FileIndex[J],!(!fe.size||!fe.content||ee=="Sh33tJ5")){ee=ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ve){return"_x"+Ve.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ve){return"_u"+Ve.charCodeAt(0).toString(16)+"_"});for(var te=fe.content,re=dt&&Buffer.isBuffer(te)?te.toString("binary"):xe(te),_e=0,Fe=Math.min(1024,re.length),Ie=0,Ee=0;Ee<=Fe;++Ee)(Ie=re.charCodeAt(Ee))>=32&&Ie<128&&++_e;var Pe=_e>=Fe*4/5;U.push(M),U.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+ee),U.push("Content-Transfer-Encoding: "+(Pe?"quoted-printable":"base64")),U.push("Content-Type: "+_0(fe,ee)),U.push(""),U.push(Pe?gd(re):y0(re))}return U.push(M+`--\r
`),U.join(`\r
`)}function vd(P){var B={};return N(B,P),B}function Tl(P,B,I,M){var U=M&&M.unsafe;U||N(P);var G=!U&&Et.find(P,B);if(!G){var ee=P.FullPaths[0];B.slice(0,ee.length)==ee?ee=B:(ee.slice(-1)!="/"&&(ee+="/"),ee=(ee+B).replace("//","/")),G={name:i(B),type:2},P.FileIndex.push(G),P.FullPaths.push(ee),U||Et.utils.cfb_gc(P)}return G.content=I,G.size=I?I.length:0,M&&(M.CLSID&&(G.clsid=M.CLSID),M.mt&&(G.mt=M.mt),M.ct&&(G.ct=M.ct)),G}function E0(P,B){N(P);var I=Et.find(P,B);if(I){for(var M=0;M<P.FileIndex.length;++M)if(P.FileIndex[M]==I)return P.FileIndex.splice(M,1),P.FullPaths.splice(M,1),!0}return!1}function Cl(P,B,I){N(P);var M=Et.find(P,B);if(M){for(var U=0;U<P.FileIndex.length;++U)if(P.FileIndex[U]==M)return P.FileIndex[U].name=i(I),P.FullPaths[U]=I,!0}return!1}function xd(P){L(P,!0)}return e.find=H,e.read=R,e.parse=d,e.write=ve,e.writeFile=ue,e.utils={cfb_new:vd,cfb_add:Tl,cfb_del:E0,cfb_mov:Cl,cfb_gc:xd,ReadShift:Su,CheckField:i6,prep_blob:kn,bconcat:Rr,use_zlib:z,_deflateRaw:Br,_inflateRaw:m0,consts:Ge},e}();function oA(t){return typeof t=="string"?id(t):Array.isArray(t)?Ik(t):t}function u0(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=id(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Yu(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([oA(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:t,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=t,s.href=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=l0(e)),u.write(e),u.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function Mr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Y4(t,e){for(var r=[],n=Mr(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function W2(t){for(var e=[],r=Mr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function od(t){for(var e=[],r=Mr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function lA(t){for(var e=[],r=Mr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Gf=new Date(1899,11,30,0,0,0);function yn(t,e){var r=t.getTime(),n=Gf.getTime()+(t.getTimezoneOffset()-Gf.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var W5=new Date,uA=Gf.getTime()+(W5.getTimezoneOffset()-Gf.getTimezoneOffset())*6e4,$4=W5.getTimezoneOffset();function H5(t){var e=new Date;return e.setTime(t*24*60*60*1e3+uA),e.getTimezoneOffset()!==$4&&e.setTime(e.getTime()+(e.getTimezoneOffset()-$4)*6e4),e}var Q4=new Date("2017-02-19T19:06:09.000Z"),j5=isNaN(Q4.getFullYear())?new Date("2/19/17"):Q4,cA=j5.getFullYear()==2017;function an(t,e){var r=new Date(t);if(cA)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(j5.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function ld(t,e){if(dt&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Sn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Sn(t[r]));return e}function Xt(t,e){for(var r="";r.length<e;)r+=t;return r}function ia(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var fA=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ku(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var s=t.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&fA.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function Je(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return dt?n=va(r):n=Dk(r),Et.utils.cfb_add(t,e,n)}Et.utils.cfb_add(t,e,r)}else t.file(e,r)}function H2(){return Et.utils.cfb_new()}var ar=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,hA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},j2=W2(hA),V2=/[&<>'"]/g,dA=/[\u0000-\u0008\u000b-\u001f]/g;function _t(t){var e=t+"";return e.replace(V2,function(r){return j2[r]}).replace(dA,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function q4(t){return _t(t).replace(/ /g,"_x0020_")}var V5=/[\u0000-\u001f]/g;function pA(t){var e=t+"";return e.replace(V2,function(r){return j2[r]}).replace(/\n/g,"<br/>").replace(V5,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function gA(t){var e=t+"";return e.replace(V2,function(r){return j2[r]}).replace(V5,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function mA(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function vA(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function hp(t){for(var e="",r=0,n=0,i=0,a=0,s=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=i&63,e+=String.fromCharCode(s);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}s=t.charCodeAt(r++),u=((n&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function J4(t){var e=Us(2*t.length),r,n,i=1,a=0,s=0,u;for(n=0;n<t.length;n+=i)i=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),i=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(e[a++]=s&255,e[a++]=s>>>8,s=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function Z4(t){return va(t,"binary").toString("utf8")}var Gc="foo bar bazâð£",yu=dt&&(Z4(Gc)==hp(Gc)&&Z4||J4(Gc)==hp(Gc)&&J4)||hp,Yu=dt?function(t){return va(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},xA=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),b5=/(^\s|\s$|\n)/;function Or(t,e){return"<"+t+(e.match(b5)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function $u(t){return Mr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ce(t,e,r){return"<"+t+(r!=null?$u(r):"")+(e!=null?(e.match(b5)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Tg(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function _A(t,e){switch(typeof t){case"string":var r=Ce("vt:lpwstr",_t(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ce((t|0)==t?"vt:i4":"vt:r8",_t(String(t)));case"boolean":return Ce("vt:bool",t?"true":"false")}if(t instanceof Date)return Ce("vt:filetime",Tg(t));throw new Error("Unable to serialize "+t)}var Sr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},_l=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],An={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function yA(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,a=5;a>=0;--a)i=i*256+t[e+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function SA(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,a=0,s=n?-e:e;isFinite(s)?s==0?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(e)?26985:0);for(var u=0;u<=5;++u,a/=256)t[r+u]=a&255;t[r+6]=(i&15)<<4|a&15,t[r+7]=i>>4|n}var e3=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,a=t[0][n].length;i<a;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},t3=dt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:va(e)})):e3(t)}:e3,r3=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(lu(t,i)));return n.join("").replace(_u,"")},b2=dt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(_u,""):r3(t,e,r)}:r3,n3=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},X5=dt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):n3(t,e,r)}:n3,i3=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Fo(t,i)));return n.join("")},c0=dt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):i3(e,r,n)}:i3,K5=function(t,e){var r=Fn(t,e);return r>0?c0(t,e+4,e+4+r-1):""},Y5=K5,$5=function(t,e){var r=Fn(t,e);return r>0?c0(t,e+4,e+4+r-1):""},Q5=$5,q5=function(t,e){var r=2*Fn(t,e);return r>0?c0(t,e+4,e+4+r-1):""},J5=q5,Z5=function(e,r){var n=Fn(e,r);return n>0?b2(e,r+4,r+4+n):""},e6=Z5,t6=function(t,e){var r=Fn(t,e);return r>0?c0(t,e+4,e+4+r):""},r6=t6,n6=function(t,e){return yA(t,e)},Wf=n6,X2=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};dt&&(Y5=function(e,r){if(!Buffer.isBuffer(e))return K5(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Q5=function(e,r){if(!Buffer.isBuffer(e))return $5(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},J5=function(e,r){if(!Buffer.isBuffer(e))return q5(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},e6=function(e,r){if(!Buffer.isBuffer(e))return Z5(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},r6=function(e,r){if(!Buffer.isBuffer(e))return t6(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Wf=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):n6(e,r)},X2=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Fo=function(t,e){return t[e]},lu=function(t,e){return t[e+1]*256+t[e]},wA=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Fn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},ks=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},EA=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Su(t,e){var r="",n,i,a=[],s,u,c,f;switch(e){case"dbcs":if(f=this.l,dt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(lu(this,f)),f+=2;t*=2;break;case"utf8":r=c0(this,this.l,this.l+t);break;case"utf16le":t*=2,r=b2(this,this.l,this.l+t);break;case"wstr":return Su.call(this,t,"dbcs");case"lpstr-ansi":r=Y5(this,this.l),t=4+Fn(this,this.l);break;case"lpstr-cp":r=Q5(this,this.l),t=4+Fn(this,this.l);break;case"lpwstr":r=J5(this,this.l),t=4+2*Fn(this,this.l);break;case"lpp4":t=4+Fn(this,this.l),r=e6(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Fn(this,this.l),r=r6(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(s=Fo(this,this.l+t++))!==0;)a.push(Bc(s));r=a.join("");break;case"_wstr":for(t=0,r="";(s=lu(this,this.l+t))!==0;)a.push(Bc(s)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",f=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return s=Fo(this,f),this.l=f+1,u=Su.call(this,t-c,s?"dbcs-cont":"sbcs-cont"),a.join("")+u;a.push(Bc(lu(this,f))),f+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return s=Fo(this,f),this.l=f+1,u=Su.call(this,t-c,s?"dbcs-cont":"sbcs-cont"),a.join("")+u;a.push(Bc(Fo(this,f))),f+=1}r=a.join("");break;default:switch(t){case 1:return n=Fo(this,this.l),this.l++,n;case 2:return n=(e==="i"?wA:lu)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?ks:EA)(this,this.l),this.l+=4,n):(i=Fn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Wf(this,this.l):i=Wf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=X5(this,this.l,t);break}}return this.l+=t,r}var TA=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},CA=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},kA=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function AA(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)kA(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var s=e.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,TA(this,e,this.l);break;case 8:if(n=8,r==="f"){SA(this,e,this.l);break}case 16:break;case-4:n=4,CA(this,e,this.l);break}return this.l+=n,this}function i6(t,e){var r=X5(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function kn(t,e){t.l=e,t.read_shift=Su,t.chk=i6,t.write_shift=AA}function Ui(t,e){t.l+=e}function ce(t){var e=Us(t);return kn(e,0),e}function _n(){var t=[],e=dt?256:2048,r=function(f){var d=ce(f);return kn(d,0),d},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(f){return n&&f<n.length-n.l?n:(i(),n=r(Math.max(f+1,e)))},s=function(){return i(),Rr(t)},u=function(f){i(),n=f,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:u,end:s,_bufs:t}}function pe(t,e,r,n){var i=+e,a;if(!isNaN(i)){n||(n=yI[i].p||(r||[]).length||0),a=1+(i>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var s=t.next(a);i<=127?s.write_shift(1,i):(s.write_shift(1,(i&127)+128),s.write_shift(1,i>>7));for(var u=0;u!=4;++u)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&X2(r)&&t.push(r)}}function wu(t,e,r){var n=Sn(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function a3(t,e,r){var n=Sn(t);return n.s=wu(n.s,e.s,r),n.e=wu(n.e,e.s,r),n}function Eu(t,e){if(t.cRel&&t.c<0)for(t=Sn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Sn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=St(t);return!t.cRel&&t.cRel!=null&&(r=NA(r)),!t.rRel&&t.rRel!=null&&(r=FA(r)),r}function dp(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Yr(t.s.c)+":"+(t.e.cRel?"":"$")+Yr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Dr(t.s.r)+":"+(t.e.rRel?"":"$")+Dr(t.e.r):Eu(t.s,e.biff)+":"+Eu(t.e,e.biff)}function K2(t){return parseInt(PA(t),10)-1}function Dr(t){return""+(t+1)}function FA(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function PA(t){return t.replace(/\$(\d+)$/,"$1")}function Y2(t){for(var e=RA(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Yr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function NA(t){return t.replace(/^([A-Z])/,"$$$1")}function RA(t){return t.replace(/^\$([A-Z])/,"$1")}function OA(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function wr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function St(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function On(t){var e=t.indexOf(":");return e==-1?{s:wr(t),e:wr(t)}:{s:wr(t.slice(0,e)),e:wr(t.slice(e+1))}}function ir(t,e){return typeof e>"u"||typeof e=="number"?ir(t.s,t.e):(typeof t!="string"&&(t=St(t)),typeof e!="string"&&(e=St(e)),t==e?t:t+":"+e)}function It(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=t.length;for(r=0;n<a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===a||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function s3(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=qa(t.z,r?yn(e):e)}catch{}try{return t.w=qa((t.XF||{}).numFmtId||(r?14:0),r?yn(e):e)}catch{return""+e}}function fa(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?f0[t.v]||t.v:e==null?s3(t,t.v):s3(t,e))}function Js(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function a6(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,a=t||(i?[]:{}),s=0,u=0;if(a&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?wr(n.origin):n.origin;s=c.r,u=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=It(a["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),s==-1&&(f.e.r=s=d.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=e[v].length;++g)if(!(typeof e[v][g]>"u")){var x={v:e[v][g]},_=s+v,y=u+g;if(f.s.r>_&&(f.s.r=_),f.s.c>y&&(f.s.c=y),f.e.r<_&&(f.e.r=_),f.e.c<y&&(f.e.c=y),e[v][g]&&typeof e[v][g]=="object"&&!Array.isArray(e[v][g])&&!(e[v][g]instanceof Date))x=e[v][g];else if(Array.isArray(x.v)&&(x.f=e[v][g][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||Yt[14],n.cellDates?(x.t="d",x.w=qa(x.z,yn(x.v))):(x.t="n",x.v=yn(x.v),x.w=qa(x.z,x.v))):x.t="s";if(i)a[_]||(a[_]=[]),a[_][y]&&a[_][y].z&&(x.z=a[_][y].z),a[_][y]=x;else{var E=St({c:y,r:_});a[E]&&a[E].z&&(x.z=a[E].z),a[E]=x}}}return f.s.c<1e7&&(a["!ref"]=ir(f)),a}function yl(t,e){return a6(null,t,e)}function IA(t){return t.read_shift(4,"i")}function xi(t,e){return e||(e=ce(4)),e.write_shift(4,t),e}function $r(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Er(t,e){var r=!1;return e==null&&(r=!0,e=ce(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function DA(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function LA(t,e){return e||(e=ce(4)),e.write_shift(2,0),e.write_shift(2,0),e}function $2(t,e){var r=t.l,n=t.read_shift(1),i=$r(t),a=[],s={t:i,h:i};if(n&1){for(var u=t.read_shift(4),c=0;c!=u;++c)a.push(DA(t));s.r=a}else s.r=[{ich:0,ifnt:0}];return t.l=r+e,s}function MA(t,e){var r=!1;return e==null&&(r=!0,e=ce(15+4*t.t.length)),e.write_shift(1,0),Er(t.t,e),r?e.slice(0,e.l):e}var BA=$2;function UA(t,e){var r=!1;return e==null&&(r=!0,e=ce(23+4*t.t.length)),e.write_shift(1,1),Er(t.t,e),e.write_shift(4,1),LA({},e),r?e.slice(0,e.l):e}function Zn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Zs(t,e){return e==null&&(e=ce(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function eo(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function to(t,e){return e==null&&(e=ce(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var zA=$r,s6=Er;function Q2(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Hf(t,e){var r=!1;return e==null&&(r=!0,e=ce(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var GA=$r,Cg=Q2,q2=Hf;function o6(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Wf([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ks(e,0)>>2;return r?i/100:i}function l6(t,e){e==null&&(e=ce(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function u6(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function WA(t,e){return e||(e=ce(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var ro=u6,Sl=WA;function wl(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function zs(t,e){return(e||ce(8)).write_shift(8,t,"f")}function HA(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),a=t.read_shift(2,"i"),s=t.read_shift(1),u=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var f=qA[i];f&&(e.rgb=v3(f));break;case 2:e.rgb=v3([s,u,c]);break;case 3:e.theme=i;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function jf(t,e){if(e||(e=ce(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function jA(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function VA(t,e){e||(e=ce(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var c6=2,Tn=3,Wc=11,Vf=19,Hc=64,bA=65,XA=71,KA=4108,YA=4126,Nr=80,o3={1:{n:"CodePage",t:c6},2:{n:"Category",t:Nr},3:{n:"PresentationFormat",t:Nr},4:{n:"ByteCount",t:Tn},5:{n:"LineCount",t:Tn},6:{n:"ParagraphCount",t:Tn},7:{n:"SlideCount",t:Tn},8:{n:"NoteCount",t:Tn},9:{n:"HiddenCount",t:Tn},10:{n:"MultimediaClipCount",t:Tn},11:{n:"ScaleCrop",t:Wc},12:{n:"HeadingPairs",t:KA},13:{n:"TitlesOfParts",t:YA},14:{n:"Manager",t:Nr},15:{n:"Company",t:Nr},16:{n:"LinksUpToDate",t:Wc},17:{n:"CharacterCount",t:Tn},19:{n:"SharedDoc",t:Wc},22:{n:"HyperlinksChanged",t:Wc},23:{n:"AppVersion",t:Tn,p:"version"},24:{n:"DigSig",t:bA},26:{n:"ContentType",t:Nr},27:{n:"ContentStatus",t:Nr},28:{n:"Language",t:Nr},29:{n:"Version",t:Nr},255:{},2147483648:{n:"Locale",t:Vf},2147483651:{n:"Behavior",t:Vf},1919054434:{}},l3={1:{n:"CodePage",t:c6},2:{n:"Title",t:Nr},3:{n:"Subject",t:Nr},4:{n:"Author",t:Nr},5:{n:"Keywords",t:Nr},6:{n:"Comments",t:Nr},7:{n:"Template",t:Nr},8:{n:"LastAuthor",t:Nr},9:{n:"RevNumber",t:Nr},10:{n:"EditTime",t:Hc},11:{n:"LastPrinted",t:Hc},12:{n:"CreatedDate",t:Hc},13:{n:"ModifiedDate",t:Hc},14:{n:"PageCount",t:Tn},15:{n:"WordCount",t:Tn},16:{n:"CharCount",t:Tn},17:{n:"Thumbnail",t:XA},18:{n:"Application",t:Nr},19:{n:"DocSecurity",t:Tn},255:{},2147483648:{n:"Locale",t:Vf},2147483651:{n:"Behavior",t:Vf},1919054434:{}};function $A(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var QA=$A([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),qA=Sn(QA),f0={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},JA={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},jc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function f6(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function h6(t,e){var r=lA(JA),n=[],i;n[n.length]=ar,n[n.length]=Ce("Types",null,{xmlns:Sr.CT,"xmlns:xsd":Sr.xsd,"xmlns:xsi":Sr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Ce("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){t[c]&&t[c].length>0&&(i=t[c][0],n[n.length]=Ce("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:jc[c][e.bookType]||jc[c].xlsx}))},s=function(c){(t[c]||[]).forEach(function(f){n[n.length]=Ce("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:jc[c][e.bookType]||jc[c].xlsx})})},u=function(c){(t[c]||[]).forEach(function(f){n[n.length]=Ce("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[c][0]})})};return a("workbooks"),s("sheets"),s("charts"),u("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),s("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ht={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function d6(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function $o(t){var e=[ar,Ce("Relationships",null,{xmlns:Sr.RELS})];return Mr(t["!id"]).forEach(function(r){e[e.length]=Ce("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function xt(t,e,r,n,i,a){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[ht.HLINK,ht.XPATH,ht.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function ZA(t){var e=[ar];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function u3(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function eF(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function tF(t){var e=[ar];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(u3(t[r][0],t[r][1])),e.push(eF("",t[r][0]));return e.push(u3("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function p6(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Lf.version+"</meta:generator></office:meta></office:document-meta>"}var Os=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function pp(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=_t(e),n[n.length]=r?Ce(t,e,r):Or(t,e))}function g6(t,e){var r=e||{},n=[ar,Ce("cp:coreProperties",null,{"xmlns:cp":Sr.CORE_PROPS,"xmlns:dc":Sr.dc,"xmlns:dcterms":Sr.dcterms,"xmlns:dcmitype":Sr.dcmitype,"xmlns:xsi":Sr.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&pp("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Tg(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&pp("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Tg(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var a=0;a!=Os.length;++a){var s=Os[a],u=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:t?t[s[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&pp(s[0],u,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Qo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],m6=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function v6(t){var e=[],r=Ce;return t||(t={}),t.Application="SheetJS",e[e.length]=ar,e[e.length]=Ce("Properties",null,{xmlns:Sr.EXT_PROPS,"xmlns:vt":Sr.vt}),Qo.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=_t(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+_t(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function x6(t){var e=[ar,Ce("Properties",null,{xmlns:Sr.CUST_PROPS,"xmlns:vt":Sr.vt})];if(!t)return e.join("");var r=1;return Mr(t).forEach(function(i){++r,e[e.length]=Ce("property",_A(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:_t(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var c3={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function rF(t,e){var r=[];return Mr(c3).map(function(n){for(var i=0;i<Os.length;++i)if(Os[i][1]==n)return Os[i];for(i=0;i<Qo.length;++i)if(Qo[i][1]==n)return Qo[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Or(c3[n[1]]||n[1],i))}}),Ce("DocumentProperties",r.join(""),{xmlns:An.o})}function nF(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Mr(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)){for(var s=0;s<Os.length;++s)if(a==Os[s][1])return;for(s=0;s<Qo.length;++s)if(a==Qo[s][1])return;for(s=0;s<r.length;++s)if(a==r[s])return;var u=t[a],c="string";typeof u=="number"?(c="float",u=String(u)):u===!0||u===!1?(c="boolean",u=u?"1":"0"):u=String(u),i.push(Ce(q4(a),u,{"dt:dt":c}))}}),e&&Mr(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)&&!(t&&Object.prototype.hasOwnProperty.call(t,a))){var s=e[a],u="string";typeof s=="number"?(u="float",s=String(s)):s===!0||s===!1?(u="boolean",s=s?"1":"0"):s instanceof Date?(u="dateTime.tz",s=s.toISOString()):s=String(s),i.push(Ce(q4(a),s,{"dt:dt":u}))}}),"<"+n+' xmlns="'+An.o+'">'+i.join("")+"</"+n+">"}function iF(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),i+=a);var s=ce(8);return s.write_shift(4,n),s.write_shift(4,i),s}function f3(t,e){var r=ce(4),n=ce(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ce(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=iF(e);break;case 31:case 80:for(n=ce(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Rr([r,n])}var _6=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function aF(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function h3(t,e,r){var n=ce(8),i=[],a=[],s=8,u=0,c=ce(8),f=ce(8);if(c.write_shift(4,2),c.write_shift(4,1200),f.write_shift(4,1),a.push(c),i.push(f),s+=8+c.length,!e){f=ce(8),f.write_shift(4,0),i.unshift(f);var d=[ce(4)];for(d[0].write_shift(4,t.length),u=0;u<t.length;++u){var v=t[u][0];for(c=ce(8+2*(v.length+1)+(v.length%2?0:2)),c.write_shift(4,u+2),c.write_shift(4,v.length+1),c.write_shift(0,v,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Rr(d),a.unshift(c),s+=8+c.length}for(u=0;u<t.length;++u)if(!(e&&!e[t[u][0]])&&!(_6.indexOf(t[u][0])>-1||m6.indexOf(t[u][0])>-1)&&t[u][1]!=null){var g=t[u][1],x=0;if(e){x=+e[t[u][0]];var _=r[x];if(_.p=="version"&&typeof g=="string"){var y=g.split(".");g=(+y[0]<<16)+(+y[1]||0)}c=f3(_.t,g)}else{var E=aF(g);E==-1&&(E=31,g=String(g)),c=f3(E,g)}a.push(c),f=ce(8),f.write_shift(4,e?x:2+u),i.push(f),s+=8+c.length}var C=8*(a.length+1);for(u=0;u<a.length;++u)i[u].write_shift(4,C),C+=a[u].length;return n.write_shift(4,s),n.write_shift(4,a.length),Rr([n].concat(i).concat(a))}function d3(t,e,r,n,i,a){var s=ce(i?68:48),u=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Et.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,e,"hex"),s.write_shift(4,i?68:48);var c=h3(t,r,n);if(u.push(c),i){var f=h3(i,null,null);s.write_shift(16,a,"hex"),s.write_shift(4,68+c.length),u.push(f)}return Rr(u)}function sF(t,e){e||(e=ce(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function oF(t,e){return t.read_shift(e)===1}function rn(t,e){return e||(e=ce(2)),e.write_shift(2,+!!t),e}function y6(t){return t.read_shift(2,"u")}function Xn(t,e){return e||(e=ce(2)),e.write_shift(2,t),e}function S6(t,e,r){return r||(r=ce(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function w6(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var s=n?t.read_shift(n,i):"";return s}function lF(t){var e=t.t||"",r=ce(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ce(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return Rr(i)}function uF(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function cF(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):uF(t,n,r)}function fF(t,e,r){if(r.biff>5)return cF(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function E6(t,e,r){return r||(r=ce(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function p3(t,e){e||(e=ce(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function hF(t){var e=ce(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),a=i>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}e.write_shift(4,2),e.write_shift(4,a);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)e.write_shift(4,s[r]);if(a==28)n=n.slice(1),p3(n,e);else if(a&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)e.write_shift(1,parseInt(s[r],16));var u=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)e.write_shift(2,u.charCodeAt(r));e.write_shift(2,0),a&8&&p3(i>-1?n.slice(i+1):"",e)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)e.write_shift(1,parseInt(s[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function Gs(t,e,r,n){return n||(n=ce(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function dF(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),a=t.read_shift(n,"i"),s=t.read_shift(n,"i");return[i,a,s]}function pF(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function T6(t,e){return e||(e=ce(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function J2(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=ce(i);return a.write_shift(2,n),a.write_shift(2,e),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function gF(t,e){var r=!e||e.biff==8,n=ce(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function mF(t,e){var r=!e||e.biff>=8?2:1,n=ce(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function vF(t,e){var r=ce(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=lF(t[i]);var a=Rr([r].concat(n));return a.parts=[r.length].concat(n.map(function(s){return s.length})),a}function xF(){var t=ce(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function _F(t){var e=ce(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function yF(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,a=ce(i);return a.write_shift(2,t.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function SF(t,e,r,n){var i=ce(10);return Gs(t,e,n,i),i.write_shift(4,r),i}function wF(t,e,r,n,i){var a=!i||i.biff==8,s=ce(8+ +a+(1+a)*r.length);return Gs(t,e,n,s),s.write_shift(2,r.length),a&&s.write_shift(1,1),s.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),s}function EF(t,e,r,n){var i=r&&r.biff==5;n||(n=ce(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}function TF(t,e){var r=e.biff==8||!e.biff?4:2,n=ce(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function g3(t,e,r,n){var i=r&&r.biff==5;n||(n=ce(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var a=0;return t.numFmtId>0&&i&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function CF(t){var e=ce(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function kF(t,e,r,n,i,a){var s=ce(8);return Gs(t,e,n,s),S6(r,a,s),s}function AF(t,e,r,n){var i=ce(14);return Gs(t,e,n,i),zs(r,i),i}function FF(t,e,r){if(r.biff<8)return PF(t,e,r);for(var n=[],i=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(dF(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function PF(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=w6(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function NF(t){var e=ce(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)T6(t[r],e);return e}function RF(t){var e=ce(24),r=wr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Rr([e,hF(t[1])])}function OF(t){var e=t[1].Tooltip,r=ce(10+2*(e.length+1));r.write_shift(2,2048);var n=wr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function IF(t){return t||(t=ce(4)),t.write_shift(2,1),t.write_shift(2,1),t}function DF(t,e,r){if(!r.cellStyles)return Ui(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),a=t.read_shift(n),s=t.read_shift(n),u=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var f={s:i,e:a,w:s,ixfe:u,flags:c};return(r.biff>=5||!r.biff)&&(f.level=c>>8&7),f}function LF(t,e){var r=ce(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function MF(t){for(var e=ce(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function BF(t,e,r){var n=ce(15);return d0(n,t,e),n.write_shift(8,r,"f"),n}function UF(t,e,r){var n=ce(9);return d0(n,t,e),n.write_shift(2,r),n}var zF=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=W2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,c){var f=[],d=Us(1);switch(c.type){case"base64":d=di(ca(u));break;case"binary":d=di(u);break;case"buffer":case"array":d=u;break}kn(d,0);var v=d.read_shift(1),g=!!(v&136),x=!1,_=!1;switch(v){case 2:break;case 3:break;case 48:x=!0,g=!0;break;case 49:x=!0,g=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var y=0,E=521;v==2&&(y=d.read_shift(2)),d.l+=3,v!=2&&(y=d.read_shift(4)),y>1048576&&(y=1e6),v!=2&&(E=d.read_shift(2));var C=d.read_shift(2),T=c.codepage||1252;v!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(T=t[d[d.l]]),d.l+=1,d.l+=2),_&&(d.l+=36);for(var m=[],w={},F=Math.min(d.length,v==2?521:E-10-(x?264:0)),R=_?32:11;d.l<F&&d[d.l]!=13;)switch(w={},w.name=Mf.utils.decode(T,d.slice(d.l,d.l+R)).replace(/[\u0000\r\n].*$/g,""),d.l+=R,w.type=String.fromCharCode(d.read_shift(1)),v!=2&&!_&&(w.offset=d.read_shift(4)),w.len=d.read_shift(1),v==2&&(w.offset=d.read_shift(2)),w.dec=d.read_shift(1),w.name.length&&m.push(w),v!=2&&(d.l+=_?13:14),w.type){case"B":(!x||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(d[d.l]!==13&&(d.l=E-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=E;var N=0,A=0;for(f[0]=[],A=0;A!=m.length;++A)f[0][A]=m[A].name;for(;y-- >0;){if(d[d.l]===42){d.l+=C;continue}for(++d.l,f[++N]=[],A=0,A=0;A!=m.length;++A){var L=d.slice(d.l,d.l+m[A].len);d.l+=m[A].len,kn(L,0);var O=Mf.utils.decode(T,L);switch(m[A].type){case"C":O.trim().length&&(f[N][A]=O.replace(/\s+$/,""));break;case"D":O.length===8?f[N][A]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):f[N][A]=O;break;case"F":f[N][A]=parseFloat(O.trim());break;case"+":case"I":f[N][A]=_?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":f[N][A]=!0;break;case"N":case"F":f[N][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));f[N][A]="##MEMO##"+(_?parseInt(O.trim(),10):L.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(f[N][A]=+O||0);break;case"@":f[N][A]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":f[N][A]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":f[N][A]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[N][A]=-L.read_shift(-8,"f");break;case"B":if(x&&m[A].len==8){f[N][A]=L.read_shift(8,"f");break}case"G":case"P":L.l+=m[A].len;break;case"0":if(m[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+m[A].type)}}}if(v!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(f=f.slice(0,c.sheetRows)),c.DBF=m,f}function n(u,c){var f=c||{};f.dateNF||(f.dateNF="yyyymmdd");var d=yl(r(u,f),f);return d["!cols"]=f.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete f.DBF,d}function i(u,c){try{return Js(n(u,c),c)}catch(f){if(c&&c.WTF)throw f}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(u,c){var f=c||{};if(+f.codepage>=0&&bu(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=_n(),v=$f(u,{header:1,raw:!0,cellDates:!0}),g=v[0],x=v.slice(1),_=u["!cols"]||[],y=0,E=0,C=0,T=1;for(y=0;y<g.length;++y){if(((_[y]||{}).DBF||{}).name){g[y]=_[y].DBF.name,++C;continue}if(g[y]!=null){if(++C,typeof g[y]=="number"&&(g[y]=g[y].toString(10)),typeof g[y]!="string")throw new Error("DBF Invalid column name "+g[y]+" |"+typeof g[y]+"|");if(g.indexOf(g[y])!==y){for(E=0;E<1024;++E)if(g.indexOf(g[y]+"_"+E)==-1){g[y]+="_"+E;break}}}}var m=It(u["!ref"]),w=[],F=[],R=[];for(y=0;y<=m.e.c-m.s.c;++y){var N="",A="",L=0,O=[];for(E=0;E<x.length;++E)x[E][y]!=null&&O.push(x[E][y]);if(O.length==0||g[y]==null){w[y]="?";continue}for(E=0;E<O.length;++E){switch(typeof O[E]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=O[E]instanceof Date?"D":"C";break;default:A="C"}L=Math.max(L,String(O[E]).length),N=N&&N!=A?"C":A}L>250&&(L=250),A=((_[y]||{}).DBF||{}).type,A=="C"&&_[y].DBF.len>L&&(L=_[y].DBF.len),N=="B"&&A=="N"&&(N="N",R[y]=_[y].DBF.dec,L=_[y].DBF.len),F[y]=N=="C"||A=="N"?L:a[N]||0,T+=F[y],w[y]=N}var H=d.next(32);for(H.write_shift(4,318902576),H.write_shift(4,x.length),H.write_shift(2,296+32*C),H.write_shift(2,T),y=0;y<4;++y)H.write_shift(4,0);for(H.write_shift(4,0|(+e[k5]||3)<<8),y=0,E=0;y<g.length;++y)if(g[y]!=null){var j=d.next(32),q=(g[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,q,"sbcs"),j.write_shift(1,w[y]=="?"?"C":w[y],"sbcs"),j.write_shift(4,E),j.write_shift(1,F[y]||a[w[y]]||0),j.write_shift(1,R[y]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),E+=F[y]||a[w[y]]||0}var ye=d.next(264);for(ye.write_shift(4,13),y=0;y<65;++y)ye.write_shift(4,0);for(y=0;y<x.length;++y){var de=d.next(T);for(de.write_shift(1,0),E=0;E<g.length;++E)if(g[E]!=null)switch(w[E]){case"L":de.write_shift(1,x[y][E]==null?63:x[y][E]?84:70);break;case"B":de.write_shift(8,x[y][E]||0,"f");break;case"N":var Ae="0";for(typeof x[y][E]=="number"&&(Ae=x[y][E].toFixed(R[E]||0)),C=0;C<F[E]-Ae.length;++C)de.write_shift(1,32);de.write_shift(1,Ae,"sbcs");break;case"D":x[y][E]?(de.write_shift(4,("0000"+x[y][E].getFullYear()).slice(-4),"sbcs"),de.write_shift(2,("00"+(x[y][E].getMonth()+1)).slice(-2),"sbcs"),de.write_shift(2,("00"+x[y][E].getDate()).slice(-2),"sbcs")):de.write_shift(8,"00000000","sbcs");break;case"C":var Ge=String(x[y][E]!=null?x[y][E]:"").slice(0,F[E]);for(de.write_shift(1,Ge,"sbcs"),C=0;C<F[E]-Ge.length;++C)de.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}}(),GF=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Mr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,x){var _=t[x];return typeof _=="number"?z4(_):_},n=function(g,x,_){var y=x.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return y==59?g:z4(y)};t["|"]=254;function i(g,x){switch(x.type){case"base64":return a(ca(g),x);case"binary":return a(g,x);case"buffer":return a(dt&&Buffer.isBuffer(g)?g.toString("binary"):l0(g),x);case"array":return a(ld(g),x)}throw new Error("Unrecognized type "+x.type)}function a(g,x){var _=g.split(/[\n\r]+/),y=-1,E=-1,C=0,T=0,m=[],w=[],F=null,R={},N=[],A=[],L=[],O=0,H;for(+x.codepage>=0&&bu(+x.codepage);C!==_.length;++C){O=0;var j=_[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),q=j.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),ye=q[0],de;if(j.length>0)switch(ye){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&w.push(j.slice(3).replace(/;;/g,";"));break;case"C":var Ae=!1,Ge=!1,ue=!1,xe=!1,ve=-1,we=-1;for(T=1;T<q.length;++T)switch(q[T].charAt(0)){case"A":break;case"X":E=parseInt(q[T].slice(1))-1,Ge=!0;break;case"Y":for(y=parseInt(q[T].slice(1))-1,Ge||(E=0),H=m.length;H<=y;++H)m[H]=[];break;case"K":de=q[T].slice(1),de.charAt(0)==='"'?de=de.slice(1,de.length-1):de==="TRUE"?de=!0:de==="FALSE"?de=!1:isNaN(ia(de))?isNaN(Ku(de).getDate())||(de=an(de)):(de=ia(de),F!==null&&U5(F)&&(de=H5(de))),Ae=!0;break;case"E":xe=!0;var z=UP(q[T].slice(1),{r:y,c:E});m[y][E]=[m[y][E],z];break;case"S":ue=!0,m[y][E]=[m[y][E],"S5S"];break;case"G":break;case"R":ve=parseInt(q[T].slice(1))-1;break;case"C":we=parseInt(q[T].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+j)}if(Ae&&(m[y][E]&&m[y][E].length==2?m[y][E][0]=de:m[y][E]=de,F=null),ue){if(xe)throw new Error("SYLK shared formula cannot have own formula");var K=ve>-1&&m[ve][we];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");m[y][E][1]=zP(K[1],{r:y-ve,c:E-we})}break;case"F":var b=0;for(T=1;T<q.length;++T)switch(q[T].charAt(0)){case"X":E=parseInt(q[T].slice(1))-1,++b;break;case"Y":for(y=parseInt(q[T].slice(1))-1,H=m.length;H<=y;++H)m[H]=[];break;case"M":O=parseInt(q[T].slice(1))/20;break;case"F":break;case"G":break;case"P":F=w[parseInt(q[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=q[T].slice(1).split(" "),H=parseInt(L[0],10);H<=parseInt(L[1],10);++H)O=parseInt(L[2],10),A[H-1]=O===0?{hidden:!0}:{wch:O},Z2(A[H-1]);break;case"C":E=parseInt(q[T].slice(1))-1,A[E]||(A[E]={});break;case"R":y=parseInt(q[T].slice(1))-1,N[y]||(N[y]={}),O>0?(N[y].hpt=O,N[y].hpx=P6(O)):O===0&&(N[y].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+j)}b<1&&(F=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+j)}}return N.length>0&&(R["!rows"]=N),A.length>0&&(R["!cols"]=A),x&&x.sheetRows&&(m=m.slice(0,x.sheetRows)),[m,R]}function s(g,x){var _=i(g,x),y=_[0],E=_[1],C=yl(y,x);return Mr(E).forEach(function(T){C[T]=E[T]}),C}function u(g,x){return Js(s(g,x),x)}function c(g,x,_,y){var E="C;Y"+(_+1)+";X"+(y+1)+";K";switch(g.t){case"n":E+=g.v||0,g.f&&!g.F&&(E+=";E"+tm(g.f,{r:_,c:y}));break;case"b":E+=g.v?"TRUE":"FALSE";break;case"e":E+=g.w||g.v;break;case"d":E+='"'+(g.w||g.v)+'"';break;case"s":E+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function f(g,x){x.forEach(function(_,y){var E="F;W"+(y+1)+" "+(y+1)+" ";_.hidden?E+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=bf(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=Xf(_.wpx)),typeof _.wch=="number"&&(E+=Math.round(_.wch))),E.charAt(E.length-1)!=" "&&g.push(E)})}function d(g,x){x.forEach(function(_,y){var E="F;";_.hidden?E+="M0;":_.hpt?E+="M"+20*_.hpt+";":_.hpx&&(E+="M"+20*Kf(_.hpx)+";"),E.length>2&&g.push(E+"R"+(y+1))})}function v(g,x){var _=["ID;PWXL;N;E"],y=[],E=It(g["!ref"]),C,T=Array.isArray(g),m=`\r
`;_.push("P;PGeneral"),_.push("F;P0;DG0G8;M255"),g["!cols"]&&f(_,g["!cols"]),g["!rows"]&&d(_,g["!rows"]),_.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var w=E.s.r;w<=E.e.r;++w)for(var F=E.s.c;F<=E.e.c;++F){var R=St({r:w,c:F});C=T?(g[w]||[])[F]:g[R],!(!C||C.v==null&&(!C.f||C.F))&&y.push(c(C,g,w,F))}return _.join(m)+m+y.join(m)+m+"E"+m}return{to_workbook:u,to_sheet:s,from_sheet:v}}(),WF=function(){function t(a,s){switch(s.type){case"base64":return e(ca(a),s);case"binary":return e(a,s);case"buffer":return e(dt&&Buffer.isBuffer(a)?a.toString("binary"):l0(a),s);case"array":return e(ld(a),s)}throw new Error("Unrecognized type "+s.type)}function e(a,s){for(var u=a.split(`
`),c=-1,f=-1,d=0,v=[];d!==u.length;++d){if(u[d].trim()==="BOT"){v[++c]=[],f=0;continue}if(!(c<0)){var g=u[d].trim().split(","),x=g[0],_=g[1];++d;for(var y=u[d]||"";(y.match(/["]/g)||[]).length&1&&d<u.length-1;)y+=`
`+u[++d];switch(y=y.trim(),+x){case-1:if(y==="BOT"){v[++c]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?v[c][f]=!0:y==="FALSE"?v[c][f]=!1:isNaN(ia(_))?isNaN(Ku(_).getDate())?v[c][f]=_:v[c][f]=an(_):v[c][f]=ia(_),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),v[c][f++]=y!==""?y:null;break}if(y==="EOD")break}}return s&&s.sheetRows&&(v=v.slice(0,s.sheetRows)),v}function r(a,s){return yl(t(a,s),s)}function n(a,s){return Js(r(a,s),s)}var i=function(){var a=function(c,f,d,v,g){c.push(f),c.push(d+","+v),c.push('"'+g.replace(/"/g,'""')+'"')},s=function(c,f,d,v){c.push(f+","+d),c.push(f==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(c){var f=[],d=It(c["!ref"]),v,g=Array.isArray(c);a(f,"TABLE",0,1,"sheetjs"),a(f,"VECTORS",0,d.e.r-d.s.r+1,""),a(f,"TUPLES",0,d.e.c-d.s.c+1,""),a(f,"DATA",0,0,"");for(var x=d.s.r;x<=d.e.r;++x){s(f,-1,0,"BOT");for(var _=d.s.c;_<=d.e.c;++_){var y=St({r:x,c:_});if(v=g?(c[x]||[])[_]:c[y],!v){s(f,1,0,"");continue}switch(v.t){case"n":var E=v.w;!E&&v.v!=null&&(E=v.v),E==null?v.f&&!v.F?s(f,1,0,"="+v.f):s(f,1,0,""):s(f,0,E,"V");break;case"b":s(f,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":s(f,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=qa(v.z||Yt[14],yn(an(v.v)))),s(f,0,v.w,"V");break;default:s(f,1,0,"")}}}s(f,-1,0,"EOD");var C=`\r
`,T=f.join(C);return T}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),C6=function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,g){for(var x=v.split(`
`),_=-1,y=-1,E=0,C=[];E!==x.length;++E){var T=x[E].trim().split(":");if(T[0]==="cell"){var m=wr(T[1]);if(C.length<=m.r)for(_=C.length;_<=m.r;++_)C[_]||(C[_]=[]);switch(_=m.r,y=m.c,T[2]){case"t":C[_][y]=t(T[3]);break;case"v":C[_][y]=+T[3];break;case"vtf":var w=T[T.length-1];case"vtc":switch(T[3]){case"nl":C[_][y]=!!+T[4];break;default:C[_][y]=+T[4];break}T[2]=="vtf"&&(C[_][y]=[C[_][y],w])}}}return g&&g.sheetRows&&(C=C.slice(0,g.sheetRows)),C}function n(v,g){return yl(r(v,g),g)}function i(v,g){return Js(n(v,g),g)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function f(v){if(!v||!v["!ref"])return"";for(var g=[],x=[],_,y="",E=On(v["!ref"]),C=Array.isArray(v),T=E.s.r;T<=E.e.r;++T)for(var m=E.s.c;m<=E.e.c;++m)if(y=St({r:T,c:m}),_=C?(v[T]||[])[m]:v[y],!(!_||_.v==null||_.t==="z")){switch(x=["cell",y,"t"],_.t){case"s":case"str":x.push(e(_.v));break;case"n":_.f?(x[2]="vtf",x[3]="n",x[4]=_.v,x[5]=e(_.f)):(x[2]="v",x[3]=_.v);break;case"b":x[2]="vt"+(_.f?"f":"c"),x[3]="nl",x[4]=_.v?"1":"0",x[5]=e(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var w=yn(an(_.v));x[2]="vtc",x[3]="nd",x[4]=""+w,x[5]=_.w||qa(_.z||Yt[14],w);break;case"e":continue}g.push(x.join(":"))}return g.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(v){return[a,s,u,s,f(v),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),HF=function(){function t(d,v,g,x,_){_.raw?v[g][x]=d:d===""||(d==="TRUE"?v[g][x]=!0:d==="FALSE"?v[g][x]=!1:isNaN(ia(d))?isNaN(Ku(d).getDate())?v[g][x]=d:v[g][x]=an(d):v[g][x]=ia(d))}function e(d,v){var g=v||{},x=[];if(!d||d.length===0)return x;for(var _=d.split(/[\r\n]/),y=_.length-1;y>=0&&_[y].length===0;)--y;for(var E=10,C=0,T=0;T<=y;++T)C=_[T].indexOf(" "),C==-1?C=_[T].length:C++,E=Math.max(E,C);for(T=0;T<=y;++T){x[T]=[];var m=0;for(t(_[T].slice(0,E).trim(),x,T,m,g),m=1;m<=(_[T].length-E)/10+1;++m)t(_[T].slice(E+(m-1)*10,E+m*10).trim(),x,T,m,g)}return g.sheetRows&&(x=x.slice(0,g.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var v={},g=!1,x=0,_=0;x<d.length;++x)(_=d.charCodeAt(x))==34?g=!g:!g&&_ in r&&(v[_]=(v[_]||0)+1);_=[];for(x in v)Object.prototype.hasOwnProperty.call(v,x)&&_.push([v[x],x]);if(!_.length){v=n;for(x in v)Object.prototype.hasOwnProperty.call(v,x)&&_.push([v[x],x])}return _.sort(function(y,E){return y[0]-E[0]||n[y[1]]-n[E[1]]}),r[_.pop()[1]]||44}function a(d,v){var g=v||{},x="",_=g.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(x=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(x=d.charAt(4),d=d.slice(6)):x=i(d.slice(0,1024)):g&&g.FS?x=g.FS:x=i(d.slice(0,1024));var E=0,C=0,T=0,m=0,w=0,F=x.charCodeAt(0),R=!1,N=0,A=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var L=g.dateNF!=null?iA(g.dateNF):null;function O(){var H=d.slice(m,w),j={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)j.t="z";else if(g.raw)j.t="s",j.v=H;else if(H.trim().length===0)j.t="s",j.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(j.t="s",j.v=H.slice(2,-1).replace(/""/g,'"')):GP(H)?(j.t="n",j.f=H.slice(1)):(j.t="s",j.v=H);else if(H=="TRUE")j.t="b",j.v=!0;else if(H=="FALSE")j.t="b",j.v=!1;else if(!isNaN(T=ia(H)))j.t="n",g.cellText!==!1&&(j.w=H),j.v=T;else if(!isNaN(Ku(H).getDate())||L&&H.match(L)){j.z=g.dateNF||Yt[14];var q=0;L&&H.match(L)&&(H=aA(H,g.dateNF,H.match(L)||[]),q=1),g.cellDates?(j.t="d",j.v=an(H,q)):(j.t="n",j.v=yn(an(H,q))),g.cellText!==!1&&(j.w=qa(j.z,j.v instanceof Date?yn(j.v):j.v)),g.cellNF||delete j.z}else j.t="s",j.v=H;if(j.t=="z"||(g.dense?(_[E]||(_[E]=[]),_[E][C]=j):_[St({c:C,r:E})]=j),m=w+1,A=d.charCodeAt(m),y.e.c<C&&(y.e.c=C),y.e.r<E&&(y.e.r=E),N==F)++C;else if(C=0,++E,g.sheetRows&&g.sheetRows<=E)return!0}e:for(;w<d.length;++w)switch(N=d.charCodeAt(w)){case 34:A===34&&(R=!R);break;case F:case 10:case 13:if(!R&&O())break e;break}return w-m>0&&O(),_["!ref"]=ir(y),_}function s(d,v){return!(v&&v.PRN)||v.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,v):yl(e(d,v),v)}function u(d,v){var g="",x=v.type=="string"?[0,0,0,0]:eD(d,v);switch(v.type){case"base64":g=ca(d);break;case"binary":g=d;break;case"buffer":v.codepage==65001?g=d.toString("utf8"):v.codepage&&typeof Mf<"u"||(g=dt&&Buffer.isBuffer(d)?d.toString("binary"):l0(d));break;case"array":g=ld(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+v.type)}return x[0]==239&&x[1]==187&&x[2]==191?g=yu(g.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?g=yu(g):v.type=="binary"&&typeof Mf<"u",g.slice(0,19)=="socialcalc:version:"?C6.to_sheet(v.type=="string"?g:yu(g),v):s(g,v)}function c(d,v){return Js(u(d,v),v)}function f(d){for(var v=[],g=It(d["!ref"]),x,_=Array.isArray(d),y=g.s.r;y<=g.e.r;++y){for(var E=[],C=g.s.c;C<=g.e.c;++C){var T=St({r:y,c:C});if(x=_?(d[y]||[])[C]:d[T],!x||x.v==null){E.push("          ");continue}for(var m=(x.w||(fa(x),x.w)||"").slice(0,10);m.length<10;)m+=" ";E.push(m+(C===0?" ":""))}v.push(E.join(""))}return v.join(`
`)}return{to_workbook:c,to_sheet:u,from_sheet:f}}(),m3=function(){function t(z,K,b){if(z){kn(z,z.l||0);for(var V=b.Enum||ve;z.l<z.length;){var oe=z.read_shift(2),W=V[oe]||V[65535],Z=z.read_shift(2),he=z.l+Z,ge=W.f&&W.f(z,Z,b);if(z.l=he,K(ge,W,oe))return}}}function e(z,K){switch(K.type){case"base64":return r(di(ca(z)),K);case"binary":return r(di(z),K);case"buffer":case"array":return r(z,K)}throw"Unsupported type "+K.type}function r(z,K){if(!z)return z;var b=K||{},V=b.dense?[]:{},oe="Sheet1",W="",Z=0,he={},ge=[],Ne=[],Be={s:{r:0,c:0},e:{r:0,c:0}},Ke=b.sheetRows||0;if(z[2]==0&&(z[3]==8||z[3]==9)&&z.length>=16&&z[14]==5&&z[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(z[2]==2)b.Enum=ve,t(z,function(ae,me,ze){switch(ze){case 0:b.vers=ae,ae>=4096&&(b.qpro=!0);break;case 6:Be=ae;break;case 204:ae&&(W=ae);break;case 222:W=ae;break;case 15:case 51:b.qpro||(ae[1].v=ae[1].v.slice(1));case 13:case 14:case 16:ze==14&&(ae[2]&112)==112&&(ae[2]&15)>1&&(ae[2]&15)<15&&(ae[1].z=b.dateNF||Yt[14],b.cellDates&&(ae[1].t="d",ae[1].v=H5(ae[1].v))),b.qpro&&ae[3]>Z&&(V["!ref"]=ir(Be),he[oe]=V,ge.push(oe),V=b.dense?[]:{},Be={s:{r:0,c:0},e:{r:0,c:0}},Z=ae[3],oe=W||"Sheet"+(Z+1),W="");var Ue=b.dense?(V[ae[0].r]||[])[ae[0].c]:V[St(ae[0])];if(Ue){Ue.t=ae[1].t,Ue.v=ae[1].v,ae[1].z!=null&&(Ue.z=ae[1].z),ae[1].f!=null&&(Ue.f=ae[1].f);break}b.dense?(V[ae[0].r]||(V[ae[0].r]=[]),V[ae[0].r][ae[0].c]=ae[1]):V[St(ae[0])]=ae[1];break}},b);else if(z[2]==26||z[2]==14)b.Enum=we,z[2]==14&&(b.qpro=!0,z.l=0),t(z,function(ae,me,ze){switch(ze){case 204:oe=ae;break;case 22:ae[1].v=ae[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ae[3]>Z&&(V["!ref"]=ir(Be),he[oe]=V,ge.push(oe),V=b.dense?[]:{},Be={s:{r:0,c:0},e:{r:0,c:0}},Z=ae[3],oe="Sheet"+(Z+1)),Ke>0&&ae[0].r>=Ke)break;b.dense?(V[ae[0].r]||(V[ae[0].r]=[]),V[ae[0].r][ae[0].c]=ae[1]):V[St(ae[0])]=ae[1],Be.e.c<ae[0].c&&(Be.e.c=ae[0].c),Be.e.r<ae[0].r&&(Be.e.r=ae[0].r);break;case 27:ae[14e3]&&(Ne[ae[14e3][0]]=ae[14e3][1]);break;case 1537:Ne[ae[0]]=ae[1],ae[0]==Z&&(oe=ae[1]);break}},b);else throw new Error("Unrecognized LOTUS BOF "+z[2]);if(V["!ref"]=ir(Be),he[W||oe]=V,ge.push(W||oe),!Ne.length)return{SheetNames:ge,Sheets:he};for(var Ye={},et=[],se=0;se<Ne.length;++se)he[ge[se]]?(et.push(Ne[se]||ge[se]),Ye[Ne[se]]=he[Ne[se]]||he[ge[se]]):(et.push(Ne[se]),Ye[Ne[se]]={"!ref":"A1"});return{SheetNames:et,Sheets:Ye}}function n(z,K){var b=K||{};if(+b.codepage>=0&&bu(+b.codepage),b.type=="string")throw new Error("Cannot write WK1 to JS string");var V=_n(),oe=It(z["!ref"]),W=Array.isArray(z),Z=[];ke(V,0,a(1030)),ke(V,6,c(oe));for(var he=Math.min(oe.e.r,8191),ge=oe.s.r;ge<=he;++ge)for(var Ne=Dr(ge),Be=oe.s.c;Be<=oe.e.c;++Be){ge===oe.s.r&&(Z[Be]=Yr(Be));var Ke=Z[Be]+Ne,Ye=W?(z[ge]||[])[Be]:z[Ke];if(!(!Ye||Ye.t=="z"))if(Ye.t=="n")(Ye.v|0)==Ye.v&&Ye.v>=-32768&&Ye.v<=32767?ke(V,13,x(ge,Be,Ye.v)):ke(V,14,y(ge,Be,Ye.v));else{var et=fa(Ye);ke(V,15,v(ge,Be,et.slice(0,239)))}}return ke(V,1),V.end()}function i(z,K){var b=K||{};if(+b.codepage>=0&&bu(+b.codepage),b.type=="string")throw new Error("Cannot write WK3 to JS string");var V=_n();ke(V,0,s(z));for(var oe=0,W=0;oe<z.SheetNames.length;++oe)(z.Sheets[z.SheetNames[oe]]||{})["!ref"]&&ke(V,27,xe(z.SheetNames[oe],W++));var Z=0;for(oe=0;oe<z.SheetNames.length;++oe){var he=z.Sheets[z.SheetNames[oe]];if(!(!he||!he["!ref"])){for(var ge=It(he["!ref"]),Ne=Array.isArray(he),Be=[],Ke=Math.min(ge.e.r,8191),Ye=ge.s.r;Ye<=Ke;++Ye)for(var et=Dr(Ye),se=ge.s.c;se<=ge.e.c;++se){Ye===ge.s.r&&(Be[se]=Yr(se));var ae=Be[se]+et,me=Ne?(he[Ye]||[])[se]:he[ae];if(!(!me||me.t=="z"))if(me.t=="n")ke(V,23,O(Ye,se,Z,me.v));else{var ze=fa(me);ke(V,22,N(Ye,se,Z,ze.slice(0,239)))}}++Z}}return ke(V,1),V.end()}function a(z){var K=ce(2);return K.write_shift(2,z),K}function s(z){var K=ce(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var b=0,V=0,oe=0,W=0;W<z.SheetNames.length;++W){var Z=z.SheetNames[W],he=z.Sheets[Z];if(!(!he||!he["!ref"])){++oe;var ge=On(he["!ref"]);b<ge.e.r&&(b=ge.e.r),V<ge.e.c&&(V=ge.e.c)}}return b>8191&&(b=8191),K.write_shift(2,b),K.write_shift(1,oe),K.write_shift(1,V),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function u(z,K,b){var V={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&b.qpro?(V.s.c=z.read_shift(1),z.l++,V.s.r=z.read_shift(2),V.e.c=z.read_shift(1),z.l++,V.e.r=z.read_shift(2),V):(V.s.c=z.read_shift(2),V.s.r=z.read_shift(2),K==12&&b.qpro&&(z.l+=2),V.e.c=z.read_shift(2),V.e.r=z.read_shift(2),K==12&&b.qpro&&(z.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function c(z){var K=ce(8);return K.write_shift(2,z.s.c),K.write_shift(2,z.s.r),K.write_shift(2,z.e.c),K.write_shift(2,z.e.r),K}function f(z,K,b){var V=[{c:0,r:0},{t:"n",v:0},0,0];return b.qpro&&b.vers!=20768?(V[0].c=z.read_shift(1),V[3]=z.read_shift(1),V[0].r=z.read_shift(2),z.l+=2):(V[2]=z.read_shift(1),V[0].c=z.read_shift(2),V[0].r=z.read_shift(2)),V}function d(z,K,b){var V=z.l+K,oe=f(z,K,b);if(oe[1].t="s",b.vers==20768){z.l++;var W=z.read_shift(1);return oe[1].v=z.read_shift(W,"utf8"),oe}return b.qpro&&z.l++,oe[1].v=z.read_shift(V-z.l,"cstr"),oe}function v(z,K,b){var V=ce(7+b.length);V.write_shift(1,255),V.write_shift(2,K),V.write_shift(2,z),V.write_shift(1,39);for(var oe=0;oe<V.length;++oe){var W=b.charCodeAt(oe);V.write_shift(1,W>=128?95:W)}return V.write_shift(1,0),V}function g(z,K,b){var V=f(z,K,b);return V[1].v=z.read_shift(2,"i"),V}function x(z,K,b){var V=ce(7);return V.write_shift(1,255),V.write_shift(2,K),V.write_shift(2,z),V.write_shift(2,b,"i"),V}function _(z,K,b){var V=f(z,K,b);return V[1].v=z.read_shift(8,"f"),V}function y(z,K,b){var V=ce(13);return V.write_shift(1,255),V.write_shift(2,K),V.write_shift(2,z),V.write_shift(8,b,"f"),V}function E(z,K,b){var V=z.l+K,oe=f(z,K,b);if(oe[1].v=z.read_shift(8,"f"),b.qpro)z.l=V;else{var W=z.read_shift(2);w(z.slice(z.l,z.l+W),oe),z.l+=W}return oe}function C(z,K,b){var V=K&32768;return K&=-32769,K=(V?z:0)+(K>=8192?K-16384:K),(V?"":"$")+(b?Yr(K):Dr(K))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},m=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(z,K){kn(z,0);for(var b=[],V=0,oe="",W="",Z="",he="";z.l<z.length;){var ge=z[z.l++];switch(ge){case 0:b.push(z.read_shift(8,"f"));break;case 1:W=C(K[0].c,z.read_shift(2),!0),oe=C(K[0].r,z.read_shift(2),!1),b.push(W+oe);break;case 2:{var Ne=C(K[0].c,z.read_shift(2),!0),Be=C(K[0].r,z.read_shift(2),!1);W=C(K[0].c,z.read_shift(2),!0),oe=C(K[0].r,z.read_shift(2),!1),b.push(Ne+Be+":"+W+oe)}break;case 3:if(z.l<z.length){console.error("WK1 premature formula end");return}break;case 4:b.push("("+b.pop()+")");break;case 5:b.push(z.read_shift(2));break;case 6:{for(var Ke="";ge=z[z.l++];)Ke+=String.fromCharCode(ge);b.push('"'+Ke.replace(/"/g,'""')+'"')}break;case 8:b.push("-"+b.pop());break;case 23:b.push("+"+b.pop());break;case 22:b.push("NOT("+b.pop()+")");break;case 20:case 21:he=b.pop(),Z=b.pop(),b.push(["AND","OR"][ge-20]+"("+Z+","+he+")");break;default:if(ge<32&&m[ge])he=b.pop(),Z=b.pop(),b.push(Z+m[ge]+he);else if(T[ge]){if(V=T[ge][1],V==69&&(V=z[z.l++]),V>b.length){console.error("WK1 bad formula parse 0x"+ge.toString(16)+":|"+b.join("|")+"|");return}var Ye=b.slice(-V);b.length-=V,b.push(T[ge][0]+"("+Ye.join(",")+")")}else return ge<=7?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=24?console.error("WK1 unsupported op "+ge.toString(16)):ge<=30?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=115?console.error("WK1 unsupported function opcode "+ge.toString(16)):console.error("WK1 unrecognized opcode "+ge.toString(16))}}b.length==1?K[1].f=""+b[0]:console.error("WK1 bad formula parse |"+b.join("|")+"|")}function F(z){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=z.read_shift(2),K[3]=z[z.l++],K[0].c=z[z.l++],K}function R(z,K){var b=F(z);return b[1].t="s",b[1].v=z.read_shift(K-4,"cstr"),b}function N(z,K,b,V){var oe=ce(6+V.length);oe.write_shift(2,z),oe.write_shift(1,b),oe.write_shift(1,K),oe.write_shift(1,39);for(var W=0;W<V.length;++W){var Z=V.charCodeAt(W);oe.write_shift(1,Z>=128?95:Z)}return oe.write_shift(1,0),oe}function A(z,K){var b=F(z);b[1].v=z.read_shift(2);var V=b[1].v>>1;if(b[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return b[1].v=V,b}function L(z,K){var b=F(z),V=z.read_shift(4),oe=z.read_shift(4),W=z.read_shift(2);if(W==65535)return V===0&&oe===3221225472?(b[1].t="e",b[1].v=15):V===0&&oe===3489660928?(b[1].t="e",b[1].v=42):b[1].v=0,b;var Z=W&32768;return W=(W&32767)-16446,b[1].v=(1-Z*2)*(oe*Math.pow(2,W+32)+V*Math.pow(2,W)),b}function O(z,K,b,V){var oe=ce(14);if(oe.write_shift(2,z),oe.write_shift(1,b),oe.write_shift(1,K),V==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var W=0,Z=0,he=0,ge=0;return V<0&&(W=1,V=-V),Z=Math.log2(V)|0,V/=Math.pow(2,Z-31),ge=V>>>0,ge&2147483648||(V/=2,++Z,ge=V>>>0),V-=ge,ge|=2147483648,ge>>>=0,V*=Math.pow(2,32),he=V>>>0,oe.write_shift(4,he),oe.write_shift(4,ge),Z+=16383+(W?32768:0),oe.write_shift(2,Z),oe}function H(z,K){var b=L(z);return z.l+=K-14,b}function j(z,K){var b=F(z),V=z.read_shift(4);return b[1].v=V>>6,b}function q(z,K){var b=F(z),V=z.read_shift(8,"f");return b[1].v=V,b}function ye(z,K){var b=q(z);return z.l+=K-10,b}function de(z,K){return z[z.l+K-1]==0?z.read_shift(K,"cstr"):""}function Ae(z,K){var b=z[z.l++];b>K-1&&(b=K-1);for(var V="";V.length<b;)V+=String.fromCharCode(z[z.l++]);return V}function Ge(z,K,b){if(!(!b.qpro||K<21)){var V=z.read_shift(1);z.l+=17,z.l+=1,z.l+=2;var oe=z.read_shift(K-21,"cstr");return[V,oe]}}function ue(z,K){for(var b={},V=z.l+K;z.l<V;){var oe=z.read_shift(2);if(oe==14e3){for(b[oe]=[0,""],b[oe][0]=z.read_shift(2);z[z.l];)b[oe][1]+=String.fromCharCode(z[z.l]),z.l++;z.l++}}return b}function xe(z,K){var b=ce(5+z.length);b.write_shift(2,14e3),b.write_shift(2,K);for(var V=0;V<z.length;++V){var oe=z.charCodeAt(V);b[b.l++]=oe>127?95:oe}return b[b.l++]=0,b}var ve={0:{n:"BOF",f:y6},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:_},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:de},222:{n:"SHEETNAMELP",f:Ae},65535:{n:""}},we={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ue},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:ye},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:de},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ge},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}(),jF=/^\s|\s$|[\t\n\r]/;function k6(t,e){if(!e.bookSST)return"";var r=[ar];r[r.length]=Ce("sst",null,{xmlns:_l[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(jF)&&(a+=' xml:space="preserve"'),a+=">"+_t(i.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function VF(t){return[t.read_shift(4),t.read_shift(4)]}function bF(t,e){return e||(e=ce(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var XF=MA;function KF(t){var e=_n();pe(e,159,bF(t));for(var r=0;r<t.length;++r)pe(e,19,XF(t[r]));return pe(e,160),e.end()}function YF(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function A6(t){var e=0,r,n=YF(t),i=n.length+1,a,s,u,c,f;for(r=Us(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)s=r[a],u=e&16384?1:0,c=e<<1&32767,f=u|c,e=f^s;return e^52811}var $F=function(){function t(i,a){switch(a.type){case"base64":return e(ca(i),a);case"binary":return e(i,a);case"buffer":return e(dt&&Buffer.isBuffer(i)?i.toString("binary"):l0(i),a);case"array":return e(ld(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){var s=a||{},u=s.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,v){Array.isArray(u)&&(u[v]=[]);for(var g=/\\\w+\b/g,x=0,_,y=-1;_=g.exec(d);){switch(_[0]){case"\\cell":var E=d.slice(x,g.lastIndex-_[0].length);if(E[0]==" "&&(E=E.slice(1)),++y,E.length){var C={v:E,t:"s"};Array.isArray(u)?u[v][y]=C:u[St({r:v,c:y})]=C}break}x=g.lastIndex}y>f.e.c&&(f.e.c=y)}),u["!ref"]=ir(f),u}function r(i,a){return Js(t(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],s=It(i["!ref"]),u,c=Array.isArray(i),f=s.s.r;f<=s.e.r;++f){a.push("\\trowd\\trautofit1");for(var d=s.s.c;d<=s.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=s.s.c;d<=s.e.c;++d){var v=St({r:f,c:d});u=c?(i[f]||[])[d]:i[v],!(!u||u.v==null&&(!u.f||u.F))&&(a.push(" "+(u.w||(fa(u),u.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function v3(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var QF=6,aa=QF;function bf(t){return Math.floor((t+Math.round(128/aa)/256)*aa)}function Xf(t){return Math.floor((t-5)/aa*100+.5)/100}function kg(t){return Math.round((t*aa+5)/aa*256)/256}function Z2(t){t.width?(t.wpx=bf(t.width),t.wch=Xf(t.wpx),t.MDW=aa):t.wpx?(t.wch=Xf(t.wpx),t.width=kg(t.wch),t.MDW=aa):typeof t.wch=="number"&&(t.width=kg(t.wch),t.wpx=bf(t.width),t.MDW=aa),t.customWidth&&delete t.customWidth}var qF=96,F6=qF;function Kf(t){return t*96/F6}function P6(t){return t*F6/96}function JF(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Ce("numFmt",null,{numFmtId:n,formatCode:_t(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ce("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function ZF(t){var e=[];return e[e.length]=Ce("cellXfs",null),t.forEach(function(r){e[e.length]=Ce("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ce("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function N6(t,e){var r=[ar,Ce("styleSheet",null,{xmlns:_l[0],"xmlns:vt":Sr.vt})],n;return t.SSF&&(n=JF(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=ZF(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function eP(t,e){var r=t.read_shift(2),n=$r(t);return[r,n]}function tP(t,e,r){r||(r=ce(6+4*e.length)),r.write_shift(2,t),Er(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function rP(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=jA(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=t.read_shift(1);s!=0&&(n.underline=s);var u=t.read_shift(1);u>0&&(n.family=u);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=HA(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=$r(t),n}function nP(t,e){e||(e=ce(25+4*32)),e.write_shift(2,t.sz*20),VA(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),jf(t.color,e);var n=0;return n=2,e.write_shift(1,n),Er(t.name,e),e.length>e.l?e.slice(0,e.l):e}var iP=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],gp,aP=Ui;function x3(t,e){e||(e=ce(4*3+8*7+16*1)),gp||(gp=W2(iP));var r=gp[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(jf({auto:1},e),jf({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function sP(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function R6(t,e,r){r||(r=ce(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ru(t,e){return e||(e=ce(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var oP=Ui;function lP(t,e){return e||(e=ce(51)),e.write_shift(1,0),ru(null,e),ru(null,e),ru(null,e),ru(null,e),ru(null,e),e.length>e.l?e.slice(0,e.l):e}function uP(t,e){return e||(e=ce(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Hf(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function cP(t,e,r){var n=ce(2052);return n.write_shift(4,t),Hf(e,n),Hf(r,n),n.length>n.l?n.slice(0,n.l):n}function fP(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(pe(t,615,xi(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&pe(t,44,tP(i,e[i]))}),pe(t,616))}}function hP(t){var e=1;pe(t,611,xi(e)),pe(t,43,nP({sz:12,color:{theme:1},name:"Calibri",family:2})),pe(t,612)}function dP(t){var e=2;pe(t,603,xi(e)),pe(t,45,x3({patternType:"none"})),pe(t,45,x3({patternType:"gray125"})),pe(t,604)}function pP(t){var e=1;pe(t,613,xi(e)),pe(t,46,lP()),pe(t,614)}function gP(t){var e=1;pe(t,626,xi(e)),pe(t,47,R6({numFmtId:0},65535)),pe(t,627)}function mP(t,e){pe(t,617,xi(e.length)),e.forEach(function(r){pe(t,47,R6(r,0))}),pe(t,618)}function vP(t){var e=1;pe(t,619,xi(e)),pe(t,48,uP({xfId:0,name:"Normal"})),pe(t,620)}function xP(t){var e=0;pe(t,505,xi(e)),pe(t,506)}function _P(t){var e=0;pe(t,508,cP(e,"TableStyleMedium9","PivotStyleMedium4")),pe(t,509)}function yP(t,e){var r=_n();return pe(r,278),fP(r,t.SSF),hP(r),dP(r),pP(r),gP(r),mP(r,e.cellXfs),vP(r),xP(r),_P(r),pe(r,279),r.end()}function O6(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[ar];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function SP(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:$r(t)}}function wP(t){var e=ce(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Er(t.name,e),e.slice(0,e.l)}function EP(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function TP(t){var e=ce(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function CP(t,e){var r=ce(8+2*e.length);return r.write_shift(4,t),Er(e,r),r.slice(0,r.l)}function kP(t){return t.l+=4,t.read_shift(4)!=0}function AP(t,e){var r=ce(8);return r.write_shift(4,t),r.write_shift(4,1),r}function FP(){var t=_n();return pe(t,332),pe(t,334,xi(1)),pe(t,335,wP({name:"XLDAPR",version:12e4,flags:3496657072})),pe(t,336),pe(t,339,CP(1,"XLDAPR")),pe(t,52),pe(t,35,xi(514)),pe(t,4096,xi(0)),pe(t,4097,Xn(1)),pe(t,36),pe(t,53),pe(t,340),pe(t,337,AP(1)),pe(t,51,TP([[1,0]])),pe(t,338),pe(t,333),t.end()}function I6(){var t=[ar];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function PP(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=St(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var Wo=1024;function D6(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Ce("xml",null,{"xmlns:v":An.v,"xmlns:o":An.o,"xmlns:x":An.x,"xmlns:mv":An.mv}).replace(/\/>/,">"),Ce("o:shapelayout",Ce("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ce("v:shapetype",[Ce("v:stroke",null,{joinstyle:"miter"}),Ce("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Wo<t*1e3;)Wo+=1e3;return e.forEach(function(a){var s=wr(a[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var c=u.type=="gradient"?Ce("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Ce("v:fill",c,u),d={on:"t",obscured:"t"};++Wo,i=i.concat(["<v:shape"+$u({id:"_x0000_s"+Wo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Ce("v:shadow",null,d),Ce("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Or("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Or("x:AutoFill","False"),Or("x:Row",String(s.r)),Or("x:Column",String(s.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function L6(t){var e=[ar,Ce("comments",null,{xmlns:_l[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var a=_t(i.a);r.indexOf(a)==-1&&(r.push(a),e.push("<author>"+a+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=r.indexOf(_t(c.a))),a.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),a.length<=1)e.push(Or("t",_t(a[0]||"")));else{for(var s=`Comment:
    `+a[0]+`
`,u=1;u<a.length;++u)s+=`Reply:
    `+a[u]+`
`;e.push(Or("t",_t(s)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function NP(t,e,r){var n=[ar,Ce("ThreadedComments",null,{xmlns:Sr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var a="";(i[1]||[]).forEach(function(s,u){if(!s.T){delete s.ID;return}s.a&&e.indexOf(s.a)==-1&&e.push(s.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?a=c.id:c.parentId=a,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(s.a)).slice(-12)+"}"),n.push(Ce("threadedComment",Or("text",s.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function RP(t){var e=[ar,Ce("personList",null,{xmlns:Sr.TCMNT,"xmlns:x":_l[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Ce("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function OP(t){var e={};e.iauthor=t.read_shift(4);var r=ro(t);return e.rfx=r.s,e.ref=St(r.s),t.l+=16,e}function IP(t,e){return e==null&&(e=ce(36)),e.write_shift(4,t[1].iauthor),Sl(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var DP=$r;function LP(t){return Er(t.slice(0,54))}function MP(t){var e=_n(),r=[];return pe(e,628),pe(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),pe(e,632,LP(i.a)))})}),pe(e,631),pe(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var a={s:wr(n[0]),e:wr(n[0])};pe(e,635,IP([a,i])),i.t&&i.t.length>0&&pe(e,637,UA(i)),pe(e,636),delete i.iauthor})}),pe(e,634),pe(e,629),e.end()}function BP(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Et.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var M6=["xlsb","xlsm","xlam","biff8","xla"],UP=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,a,s){var u=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1));var f=a.length>0?parseInt(a,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return u?d+=e.c:--d,c?f+=e.r:--f,i+(u?"":"$")+Yr(d)+(c?"":"$")+Dr(f)}return function(i,a){return e=a,i.replace(t,r)}}(),em=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,tm=function(){return function(e,r){return e.replace(em,function(n,i,a,s,u,c){var f=Y2(s)-(a?0:r.c),d=K2(c)-(u?0:r.r),v=d==0?"":u?d+1:"["+d+"]",g=f==0?"":a?f+1:"["+f+"]";return i+"R"+v+"C"+g})}}();function zP(t,e){return t.replace(em,function(r,n,i,a,s,u){return n+(i=="$"?i+a:Yr(Y2(a)+e.c))+(s=="$"?s+u:Dr(K2(u)+e.r))})}function GP(t){return t.length!=1}function rr(t){t.l+=1}function Ja(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function B6(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return U6(t);r.biff==12&&(n=4)}var i=t.read_shift(n),a=t.read_shift(n),s=Ja(t),u=Ja(t);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:u[0],cRel:u[1],rRel:u[2]}}}function U6(t){var e=Ja(t),r=Ja(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function WP(t,e,r){if(r.biff<8)return U6(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),a=Ja(t),s=Ja(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function z6(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return HP(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Ja(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function HP(t){var e=Ja(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function jP(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function VP(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return bP(t);var i=t.read_shift(n>=12?4:2),a=t.read_shift(2),s=(a&16384)>>14,u=(a&32768)>>15;if(a&=16383,u==1)for(;i>524287;)i-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:s,rRel:u}}function bP(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function XP(t,e,r){var n=(t[t.l++]&96)>>5,i=B6(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function KP(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var s=B6(t,a,r);return[n,i,s]}function YP(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function $P(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,i]}function QP(t,e,r){var n=(t[t.l++]&96)>>5,i=WP(t,e-1,r);return[n,i]}function qP(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function _3(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function JP(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function ZP(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function eN(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function tN(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function rN(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function G6(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function nN(t){return t.read_shift(2),G6(t)}function iN(t){return t.read_shift(2),G6(t)}function aN(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=z6(t,0,r);return[n,i]}function sN(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=VP(t,0,r);return[n,i]}function oN(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=z6(t,0,r);return[n,i,a]}function lN(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[lR[i],j6[i],n]}function uN(t,e,r){var n=t[t.l++],i=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:cN(t);return[i,(a[0]===0?j6:oR)[a[1]]]}function cN(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function fN(t,e,r){t.l+=r&&r.biff==2?3:4}function hN(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function dN(t){return t.l++,f0[t.read_shift(1)]}function pN(t){return t.l++,t.read_shift(2)}function gN(t){return t.l++,t.read_shift(1)!==0}function mN(t){return t.l++,wl(t)}function vN(t,e,r){return t.l++,w6(t,e-1,r)}function xN(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=oF(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=f0[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=wl(t);break;case 2:r[1]=fF(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function _N(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?ro:pF)(t));return i}function yN(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var u=0;u!=i;++u)s[a][u]=xN(t,r.biff);return s}function SN(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function wN(t,e,r){if(r.biff==5)return EN(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),a=t.read_shift(4);return[n,i,a]}function EN(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function TN(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function CN(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function kN(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function AN(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,i]}var FN=Ui,PN=Ui,NN=Ui;function h0(t,e,r){return t.l+=2,[jP(t)]}function rm(t){return t.l+=6,[]}var RN=h0,ON=rm,IN=rm,DN=h0;function W6(t){return t.l+=2,[y6(t),t.read_shift(2)&1]}var LN=h0,MN=W6,BN=rm,UN=h0,zN=h0,GN=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function WN(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),a=t.read_shift(2),s=GN[r>>2&31];return{ixti:e,coltype:r&3,rt:s,idx:n,c:i,C:a}}function HN(t){return t.l+=2,[t.read_shift(4)]}function jN(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function VN(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function bN(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function XN(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function KN(t){return t.l+=4,[0,0]}var y3={1:{n:"PtgExp",f:hN},2:{n:"PtgTbl",f:NN},3:{n:"PtgAdd",f:rr},4:{n:"PtgSub",f:rr},5:{n:"PtgMul",f:rr},6:{n:"PtgDiv",f:rr},7:{n:"PtgPower",f:rr},8:{n:"PtgConcat",f:rr},9:{n:"PtgLt",f:rr},10:{n:"PtgLe",f:rr},11:{n:"PtgEq",f:rr},12:{n:"PtgGe",f:rr},13:{n:"PtgGt",f:rr},14:{n:"PtgNe",f:rr},15:{n:"PtgIsect",f:rr},16:{n:"PtgUnion",f:rr},17:{n:"PtgRange",f:rr},18:{n:"PtgUplus",f:rr},19:{n:"PtgUminus",f:rr},20:{n:"PtgPercent",f:rr},21:{n:"PtgParen",f:rr},22:{n:"PtgMissArg",f:rr},23:{n:"PtgStr",f:vN},26:{n:"PtgSheet",f:jN},27:{n:"PtgEndSheet",f:VN},28:{n:"PtgErr",f:dN},29:{n:"PtgBool",f:gN},30:{n:"PtgInt",f:pN},31:{n:"PtgNum",f:mN},32:{n:"PtgArray",f:qP},33:{n:"PtgFunc",f:lN},34:{n:"PtgFuncVar",f:uN},35:{n:"PtgName",f:SN},36:{n:"PtgRef",f:aN},37:{n:"PtgArea",f:XP},38:{n:"PtgMemArea",f:TN},39:{n:"PtgMemErr",f:FN},40:{n:"PtgMemNoMem",f:PN},41:{n:"PtgMemFunc",f:CN},42:{n:"PtgRefErr",f:kN},43:{n:"PtgAreaErr",f:YP},44:{n:"PtgRefN",f:sN},45:{n:"PtgAreaN",f:QP},46:{n:"PtgMemAreaN",f:bN},47:{n:"PtgMemNoMemN",f:XN},57:{n:"PtgNameX",f:wN},58:{n:"PtgRef3d",f:oN},59:{n:"PtgArea3d",f:KP},60:{n:"PtgRefErr3d",f:AN},61:{n:"PtgAreaErr3d",f:$P},255:{}},YN={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},$N={1:{n:"PtgElfLel",f:W6},2:{n:"PtgElfRw",f:UN},3:{n:"PtgElfCol",f:RN},6:{n:"PtgElfRwV",f:zN},7:{n:"PtgElfColV",f:DN},10:{n:"PtgElfRadical",f:LN},11:{n:"PtgElfRadicalS",f:BN},13:{n:"PtgElfColS",f:ON},15:{n:"PtgElfColSV",f:IN},16:{n:"PtgElfRadicalLel",f:MN},25:{n:"PtgList",f:WN},29:{n:"PtgSxName",f:HN},255:{}},QN={0:{n:"PtgAttrNoop",f:KN},1:{n:"PtgAttrSemi",f:rN},2:{n:"PtgAttrIf",f:eN},4:{n:"PtgAttrChoose",f:JP},8:{n:"PtgAttrGoto",f:ZP},16:{n:"PtgAttrSum",f:fN},32:{n:"PtgAttrBaxcel",f:_3},33:{n:"PtgAttrBaxcel",f:_3},64:{n:"PtgAttrSpace",f:nN},65:{n:"PtgAttrSpaceSemi",f:iN},128:{n:"PtgAttrIfError",f:tN},255:{}};function qN(t,e,r,n){if(n.biff<8)return Ui(t,e);for(var i=t.l+e,a=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=yN(t,0,n),a.push(r[s][1]);break;case"PtgMemArea":r[s][2]=_N(t,r[s][1],n),a.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=t.read_shift(4),a.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return e=i-t.l,e!==0&&a.push(Ui(t,e)),a}function JN(t,e,r){for(var n=t.l+e,i,a,s=[];n!=t.l;)e=n-t.l,a=t[t.l],i=y3[a]||y3[YN[a]],(a===24||a===25)&&(i=(a===24?$N:QN)[t[t.l+1]]),!i||!i.f?Ui(t,e):s.push([i.n,i.f(t,e,r)]);return s}function ZN(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var eR={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function tR(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function H6(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function S3(t,e,r){var n=H6(t,e,r);return n=="#REF"?n:tR(n,r)}function ll(t,e,r,n,i){var a=i&&i.biff||8,s={s:{c:0,r:0}},u=[],c,f,d,v=0,g=0,x,_="";if(!t[0]||!t[0][0])return"";for(var y=-1,E="",C=0,T=t[0].length;C<T;++C){var m=t[0][C];switch(m[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=u.pop(),f=u.pop(),y>=0){switch(t[0][y][1][0]){case 0:E=Xt(" ",t[0][y][1][1]);break;case 1:E=Xt("\r",t[0][y][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}f=f+E,y=-1}u.push(f+eR[m[0]]+c);break;case"PtgIsect":c=u.pop(),f=u.pop(),u.push(f+" "+c);break;case"PtgUnion":c=u.pop(),f=u.pop(),u.push(f+","+c);break;case"PtgRange":c=u.pop(),f=u.pop(),u.push(f+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=wu(m[1][1],s,i),u.push(Eu(d,a));break;case"PtgRefN":d=r?wu(m[1][1],r,i):m[1][1],u.push(Eu(d,a));break;case"PtgRef3d":v=m[1][1],d=wu(m[1][2],s,i),_=S3(n,v,i),u.push(_+"!"+Eu(d,a));break;case"PtgFunc":case"PtgFuncVar":var w=m[1][0],F=m[1][1];w||(w=0),w&=127;var R=w==0?[]:u.slice(-w);u.length-=w,F==="User"&&(F=R.shift()),u.push(F+"("+R.join(",")+")");break;case"PtgBool":u.push(m[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(m[1]);break;case"PtgNum":u.push(String(m[1]));break;case"PtgStr":u.push('"'+m[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(m[1]);break;case"PtgAreaN":x=a3(m[1][1],r?{s:r}:s,i),u.push(dp(x,i));break;case"PtgArea":x=a3(m[1][1],s,i),u.push(dp(x,i));break;case"PtgArea3d":v=m[1][1],x=m[1][2],_=S3(n,v,i),u.push(_+"!"+dp(x,i));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=m[1][2];var N=(n.names||[])[g-1]||(n[0]||[])[g],A=N?N.Name:"SH33TJSNAME"+String(g);A&&A.slice(0,6)=="_xlfn."&&!i.xlfn&&(A=A.slice(6)),u.push(A);break;case"PtgNameX":var L=m[1][1];g=m[1][2];var O;if(i.biff<=5)L<0&&(L=-L),n[L]&&(O=n[L][g]);else{var H="";if(((n[L]||[])[0]||[])[0]==14849||(((n[L]||[])[0]||[])[0]==1025?n[L][g]&&n[L][g].itab>0&&(H=n.SheetNames[n[L][g].itab-1]+"!"):H=n.SheetNames[g-1]+"!"),n[L]&&n[L][g])H+=n[L][g].Name;else if(n[0]&&n[0][g])H+=n[0][g].Name;else{var j=(H6(n,L,i)||"").split(";;");j[g-1]?H=j[g-1]:H+="SH33TJSERRX"}u.push(H);break}O||(O={Name:"SH33TJSERRY"}),u.push(O.Name);break;case"PtgParen":var q="(",ye=")";if(y>=0){switch(E="",t[0][y][1][0]){case 2:q=Xt(" ",t[0][y][1][1])+q;break;case 3:q=Xt("\r",t[0][y][1][1])+q;break;case 4:ye=Xt(" ",t[0][y][1][1])+ye;break;case 5:ye=Xt("\r",t[0][y][1][1])+ye;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}y=-1}u.push(q+u.pop()+ye);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":d={c:m[1][1],r:m[1][0]};var de={c:r.c,r:r.r};if(n.sharedf[St(d)]){var Ae=n.sharedf[St(d)];u.push(ll(Ae,s,de,n,i))}else{var Ge=!1;for(c=0;c!=n.arrayf.length;++c)if(f=n.arrayf[c],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){u.push(ll(f[1],s,de,n,i)),Ge=!0;break}Ge||u.push(m[1])}break;case"PtgArray":u.push("{"+ZN(m[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+m[1].idx+"[#"+m[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(m));default:throw new Error("Unrecognized Formula Token: "+String(m))}var ue=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&y>=0&&ue.indexOf(t[0][C][0])==-1){m=t[0][y];var xe=!0;switch(m[1][0]){case 4:xe=!1;case 0:E=Xt(" ",m[1][1]);break;case 5:xe=!1;case 1:E=Xt("\r",m[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+m[1][0])}u.push((xe?E:"")+u.pop()+(xe?"":E)),y=-1}}if(u.length>1&&i.WTF)throw new Error("bad formula stack");return u[0]}function rR(t){if(t==null){var e=ce(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return zs(t);return zs(0)}function nR(t,e,r,n,i){var a=Gs(e,r,i),s=rR(t.v),u=ce(6),c=33;u.write_shift(2,c),u.write_shift(4,0);for(var f=ce(t.bf.length),d=0;d<t.bf.length;++d)f[d]=t.bf[d];var v=Rr([a,s,u,f]);return v}function ud(t,e,r){var n=t.read_shift(4),i=JN(t,n,r),a=t.read_shift(4),s=a>0?qN(t,a,i,r):null;return[i,s]}var iR=ud,cd=ud,aR=ud,sR=ud,oR={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},j6={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},lR={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function uR(t){var e="of:="+t.replace(em,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function cR(t){return t.replace(/\./,"!")}var Tu=typeof Map<"u";function nm(t,e,r){var n=0,i=t.length;if(r){if(Tu?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var a=Tu?r.get(e):r[e];n<a.length;++n)if(t[a[n]].t===e)return t.Count++,a[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Tu?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function fd(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(aa=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Xf(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=kg(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function V6(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function cs(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,a=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){z5(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=a;++i)if(t[i].numFmtId===n)return i;return t[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function fR(t,e,r){if(t&&t["!ref"]){var n=It(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function hR(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+ir(t[r])+'"/>';return e+"</mergeCells>"}function dR(t,e,r,n,i){var a=!1,s={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,s.codeName=Yu(_t(c))}if(t&&t["!outline"]){var f={summaryBelow:1,summaryRight:1};t["!outline"].above&&(f.summaryBelow=0),t["!outline"].left&&(f.summaryRight=0),u=(u||"")+Ce("outlinePr",null,f)}!a&&!u||(i[i.length]=Ce("sheetPr",u,s))}var pR=["objects","scenarios","selectLockedCells","selectUnlockedCells"],gR=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function mR(t){var e={sheet:1};return pR.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),gR.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=A6(t.password).toString(16).toUpperCase()),Ce("sheetProtection",null,e)}function vR(t){return V6(t),Ce("pageMargins",null,t)}function xR(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=Ce("col",null,fd(i,n)));return r[r.length]="</cols>",r.join("")}function _R(t,e,r,n){var i=typeof t.ref=="string"?t.ref:ir(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,s=On(i);s.s.r==s.e.r&&(s.e.r=On(e["!ref"]).e.r,i=ir(s));for(var u=0;u<a.length;++u){var c=a[u];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return u==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ce("autoFilter",null,{ref:i})}function yR(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ce("sheetViews",Ce("sheetView",null,i),{})}function SR(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",a=t.t,s=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=f0[t.v];break;case"d":n&&n.cellDates?i=an(t.v,-1).toISOString():(t=Sn(t),t.t="n",i=""+(t.v=yn(an(t.v)))),typeof t.z>"u"&&(t.z=Yt[14]);break;default:i=t.v;break}var u=Or("v",_t(i)),c={r:e},f=cs(n.cellXfs,t,n);switch(f!==0&&(c.s=f),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=Or("v",""+nm(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=a&&(t.t=a,t.v=s),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;u=Ce("f",_t(t.f),d)+(t.v!=null?u:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),Ce("c",u,c)}function wR(t,e,r,n){var i=[],a=[],s=It(t["!ref"]),u="",c,f="",d=[],v=0,g=0,x=t["!rows"],_=Array.isArray(t),y={r:f},E,C=-1;for(g=s.s.c;g<=s.e.c;++g)d[g]=Yr(g);for(v=s.s.r;v<=s.e.r;++v){for(a=[],f=Dr(v),g=s.s.c;g<=s.e.c;++g){c=d[g]+f;var T=_?(t[v]||[])[g]:t[c];T!==void 0&&(u=SR(T,c,t,e))!=null&&a.push(u)}(a.length>0||x&&x[v])&&(y={r:f},x&&x[v]&&(E=x[v],E.hidden&&(y.hidden=1),C=-1,E.hpx?C=Kf(E.hpx):E.hpt&&(C=E.hpt),C>-1&&(y.ht=C,y.customHeight=1),E.level&&(y.outlineLevel=E.level)),i[i.length]=Ce("row",a.join(""),y))}if(x)for(;v<x.length;++v)x&&x[v]&&(y={r:v+1},E=x[v],E.hidden&&(y.hidden=1),C=-1,E.hpx?C=Kf(E.hpx):E.hpt&&(C=E.hpt),C>-1&&(y.ht=C,y.customHeight=1),E.level&&(y.outlineLevel=E.level),i[i.length]=Ce("row","",y));return i.join("")}function b6(t,e,r,n){var i=[ar,Ce("worksheet",null,{xmlns:_l[0],"xmlns:r":Sr.r})],a=r.SheetNames[t],s=0,u="",c=r.Sheets[a];c==null&&(c={});var f=c["!ref"]||"A1",d=It(f);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),f=ir(d)}n||(n={}),c["!comments"]=[];var v=[];dR(c,r,t,e,i),i[i.length]=Ce("dimension",null,{ref:f}),i[i.length]=yR(c,e,t,r),e.sheetFormat&&(i[i.length]=Ce("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=xR(c,c["!cols"])),i[s=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(u=wR(c,e),u.length>0&&(i[i.length]=u)),i.length>s+1&&(i[i.length]="</sheetData>",i[s]=i[s].replace("/>",">")),c["!protect"]&&(i[i.length]=mR(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=_R(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=hR(c["!merges"]));var g=-1,x,_=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(y){y[1].Target&&(x={ref:y[0]},y[1].Target.charAt(0)!="#"&&(_=xt(n,-1,_t(y[1].Target).replace(/#.*$/,""),ht.HLINK),x["r:id"]="rId"+_),(g=y[1].Target.indexOf("#"))>-1&&(x.location=_t(y[1].Target.slice(g+1))),y[1].Tooltip&&(x.tooltip=_t(y[1].Tooltip)),i[i.length]=Ce("hyperlink",null,x))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=vR(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Or("ignoredErrors",Ce("ignoredError",null,{numberStoredAsText:1,sqref:f}))),v.length>0&&(_=xt(n,-1,"../drawings/drawing"+(t+1)+".xml",ht.DRAW),i[i.length]=Ce("drawing",null,{"r:id":"rId"+_}),c["!drawing"]=v),c["!comments"].length>0&&(_=xt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ht.VML),i[i.length]=Ce("legacyDrawing",null,{"r:id":"rId"+_}),c["!legacy"]=_),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function ER(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}function TR(t,e,r){var n=ce(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var a=320;i.hpx?a=Kf(i.hpx)*20:i.hpt&&(a=i.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var u=0,c=n.l;n.l+=4;for(var f={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var v=-1,g=-1,x=d<<10;x<d+1<<10;++x){f.c=x;var _=Array.isArray(r)?(r[f.r]||[])[f.c]:r[St(f)];_&&(v<0&&(v=x),g=x)}v<0||(++u,n.write_shift(4,v),n.write_shift(4,g))}var y=n.l;return n.l=c,n.write_shift(4,u),n.l=y,n.length>n.l?n.slice(0,n.l):n}function CR(t,e,r,n){var i=TR(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&pe(t,0,i)}var kR=ro,AR=Sl;function FR(){}function PR(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=zA(t),r}function NR(t,e,r){r==null&&(r=ce(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return jf({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),s6(t,r),r.slice(0,r.l)}function RR(t){var e=Zn(t);return[e]}function OR(t,e,r){return r==null&&(r=ce(8)),Zs(e,r)}function IR(t){var e=eo(t);return[e]}function DR(t,e,r){return r==null&&(r=ce(4)),to(e,r)}function LR(t){var e=Zn(t),r=t.read_shift(1);return[e,r,"b"]}function MR(t,e,r){return r==null&&(r=ce(9)),Zs(e,r),r.write_shift(1,t.v?1:0),r}function BR(t){var e=eo(t),r=t.read_shift(1);return[e,r,"b"]}function UR(t,e,r){return r==null&&(r=ce(5)),to(e,r),r.write_shift(1,t.v?1:0),r}function zR(t){var e=Zn(t),r=t.read_shift(1);return[e,r,"e"]}function GR(t,e,r){return r==null&&(r=ce(9)),Zs(e,r),r.write_shift(1,t.v),r}function WR(t){var e=eo(t),r=t.read_shift(1);return[e,r,"e"]}function HR(t,e,r){return r==null&&(r=ce(8)),to(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function jR(t){var e=Zn(t),r=t.read_shift(4);return[e,r,"s"]}function VR(t,e,r){return r==null&&(r=ce(12)),Zs(e,r),r.write_shift(4,e.v),r}function bR(t){var e=eo(t),r=t.read_shift(4);return[e,r,"s"]}function XR(t,e,r){return r==null&&(r=ce(8)),to(e,r),r.write_shift(4,e.v),r}function KR(t){var e=Zn(t),r=wl(t);return[e,r,"n"]}function YR(t,e,r){return r==null&&(r=ce(16)),Zs(e,r),zs(t.v,r),r}function $R(t){var e=eo(t),r=wl(t);return[e,r,"n"]}function QR(t,e,r){return r==null&&(r=ce(12)),to(e,r),zs(t.v,r),r}function qR(t){var e=Zn(t),r=o6(t);return[e,r,"n"]}function JR(t,e,r){return r==null&&(r=ce(12)),Zs(e,r),l6(t.v,r),r}function ZR(t){var e=eo(t),r=o6(t);return[e,r,"n"]}function eO(t,e,r){return r==null&&(r=ce(8)),to(e,r),l6(t.v,r),r}function tO(t){var e=Zn(t),r=$2(t);return[e,r,"is"]}function rO(t){var e=Zn(t),r=$r(t);return[e,r,"str"]}function nO(t,e,r){return r==null&&(r=ce(12+4*t.v.length)),Zs(e,r),Er(t.v,r),r.length>r.l?r.slice(0,r.l):r}function iO(t){var e=eo(t),r=$r(t);return[e,r,"str"]}function aO(t,e,r){return r==null&&(r=ce(8+4*t.v.length)),to(e,r),Er(t.v,r),r.length>r.l?r.slice(0,r.l):r}function sO(t,e,r){var n=t.l+e,i=Zn(t);i.r=r["!row"];var a=t.read_shift(1),s=[i,a,"b"];if(r.cellFormula){t.l+=2;var u=cd(t,n-t.l,r);s[3]=ll(u,null,i,r.supbooks,r)}else t.l=n;return s}function oO(t,e,r){var n=t.l+e,i=Zn(t);i.r=r["!row"];var a=t.read_shift(1),s=[i,a,"e"];if(r.cellFormula){t.l+=2;var u=cd(t,n-t.l,r);s[3]=ll(u,null,i,r.supbooks,r)}else t.l=n;return s}function lO(t,e,r){var n=t.l+e,i=Zn(t);i.r=r["!row"];var a=wl(t),s=[i,a,"n"];if(r.cellFormula){t.l+=2;var u=cd(t,n-t.l,r);s[3]=ll(u,null,i,r.supbooks,r)}else t.l=n;return s}function uO(t,e,r){var n=t.l+e,i=Zn(t);i.r=r["!row"];var a=$r(t),s=[i,a,"str"];if(r.cellFormula){t.l+=2;var u=cd(t,n-t.l,r);s[3]=ll(u,null,i,r.supbooks,r)}else t.l=n;return s}var cO=ro,fO=Sl;function hO(t,e){return e==null&&(e=ce(4)),e.write_shift(4,t),e}function dO(t,e){var r=t.l+e,n=ro(t),i=Q2(t),a=$r(t),s=$r(t),u=$r(t);t.l=r;var c={rfx:n,relId:i,loc:a,display:u};return s&&(c.Tooltip=s),c}function pO(t,e){var r=ce(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Sl({s:wr(t[0]),e:wr(t[0])},r),q2("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Er(i||"",r),Er(t[1].Tooltip||"",r),Er("",r),r.slice(0,r.l)}function gO(){}function mO(t,e,r){var n=t.l+e,i=u6(t),a=t.read_shift(1),s=[i];if(s[2]=a,r.cellFormula){var u=iR(t,n-t.l,r);s[1]=u}else t.l=n;return s}function vO(t,e,r){var n=t.l+e,i=ro(t),a=[i];if(r.cellFormula){var s=sR(t,n-t.l,r);a[1]=s,t.l=n}else t.l=n;return a}function xO(t,e,r){r==null&&(r=ce(18));var n=fd(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var X6=["left","right","top","bottom","header","footer"];function _O(t){var e={};return X6.forEach(function(r){e[r]=wl(t)}),e}function yO(t,e){return e==null&&(e=ce(6*8)),V6(t),X6.forEach(function(r){zs(t[r],e)}),e}function SO(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function wO(t,e,r){r==null&&(r=ce(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function EO(t){var e=ce(24);return e.write_shift(4,4),e.write_shift(4,1),Sl(t,e),e}function TO(t,e){return e==null&&(e=ce(16*4+2)),e.write_shift(2,t.password?A6(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function CO(){}function kO(){}function AO(t,e,r,n,i,a,s){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=Sn(e),e.z=e.z||Yt[14],e.v=yn(an(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var c={r,c:n};switch(c.s=cs(i.cellXfs,e,i),e.l&&a["!links"].push([St(c),e.l]),e.c&&a["!comments"].push([St(c),e.c]),e.t){case"s":case"str":return i.bookSST?(u=nm(i.Strings,e.v,i.revStrings),c.t="s",c.v=u,s?pe(t,18,XR(e,c)):pe(t,7,VR(e,c))):(c.t="str",s?pe(t,17,aO(e,c)):pe(t,6,nO(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?s?pe(t,13,eO(e,c)):pe(t,2,JR(e,c)):s?pe(t,16,QR(e,c)):pe(t,5,YR(e,c)),!0;case"b":return c.t="b",s?pe(t,15,UR(e,c)):pe(t,4,MR(e,c)),!0;case"e":return c.t="e",s?pe(t,14,HR(e,c)):pe(t,3,GR(e,c)),!0}return s?pe(t,12,DR(e,c)):pe(t,1,OR(e,c)),!0}function FO(t,e,r,n){var i=It(e["!ref"]||"A1"),a,s="",u=[];pe(t,145);var c=Array.isArray(e),f=i.e.r;e["!rows"]&&(f=Math.max(i.e.r,e["!rows"].length-1));for(var d=i.s.r;d<=f;++d){s=Dr(d),CR(t,e,i,d);var v=!1;if(d<=i.e.r)for(var g=i.s.c;g<=i.e.c;++g){d===i.s.r&&(u[g]=Yr(g)),a=u[g]+s;var x=c?(e[d]||[])[g]:e[a];if(!x){v=!1;continue}v=AO(t,x,d,g,n,e,v)}}pe(t,146)}function PO(t,e){!e||!e["!merges"]||(pe(t,177,hO(e["!merges"].length)),e["!merges"].forEach(function(r){pe(t,176,fO(r))}),pe(t,178))}function NO(t,e){!e||!e["!cols"]||(pe(t,390),e["!cols"].forEach(function(r,n){r&&pe(t,60,xO(n,r))}),pe(t,391))}function RO(t,e){!e||!e["!ref"]||(pe(t,648),pe(t,649,EO(It(e["!ref"]))),pe(t,650))}function OO(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=xt(r,-1,n[1].Target.replace(/#.*$/,""),ht.HLINK);pe(t,494,pO(n,i))}}),delete e["!links"]}function IO(t,e,r,n){if(e["!comments"].length>0){var i=xt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ht.VML);pe(t,551,q2("rId"+i)),e["!legacy"]=i}}function DO(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],a=typeof i.ref=="string"?i.ref:ir(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,u=On(a);u.s.r==u.e.r&&(u.e.r=On(e["!ref"]).e.r,a=ir(u));for(var c=0;c<s.length;++c){var f=s[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),pe(t,161,Sl(It(a))),pe(t,162)}}function LO(t,e,r){pe(t,133),pe(t,137,wO(e,r)),pe(t,138),pe(t,134)}function MO(t,e){e["!protect"]&&pe(t,535,TO(e["!protect"]))}function BO(t,e,r,n){var i=_n(),a=r.SheetNames[t],s=r.Sheets[a]||{},u=a;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var c=It(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],pe(i,129),(r.vbaraw||s["!outline"])&&pe(i,147,NR(u,s["!outline"])),pe(i,148,AR(c)),LO(i,s,r.Workbook),NO(i,s),FO(i,s,t,e),MO(i,s),DO(i,s,r,t),PO(i,s),OO(i,s,n),s["!margins"]&&pe(i,476,yO(s["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&RO(i,s),IO(i,s,t,n),pe(i,130),i.end()}function UO(t,e){t.l+=10;var r=$r(t);return{name:r}}var zO=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function GO(t){return!t.Workbook||!t.Workbook.WBProps?"false":vA(t.Workbook.WBProps.date1904)?"true":"false"}var WO="][*?/\\".split("");function K6(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return WO.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function HO(t,e,r){t.forEach(function(n,i){K6(n);for(var a=0;a<i;++a)if(n==t[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=e&&e[i]&&e[i].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function jO(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];HO(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)fR(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function Y6(t){var e=[ar];e[e.length]=Ce("workbook",null,{xmlns:_l[0],"xmlns:r":Sr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(zO.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ce("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",a=0;a!=t.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==t.SheetNames.length&&(a=0),e[e.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",a=0;a!=t.SheetNames.length;++a){var s={name:_t(t.SheetNames[a].slice(0,31))};if(s.sheetId=""+(a+1),s["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}e[e.length]=Ce("sheet",null,s)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var c={name:u.Name};u.Comment&&(c.comment=u.Comment),u.Sheet!=null&&(c.localSheetId=""+u.Sheet),u.Hidden&&(c.hidden="1"),u.Ref&&(e[e.length]=Ce("definedName",_t(u.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function VO(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Cg(t),r.name=$r(t),r}function bO(t,e){return e||(e=ce(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),q2(t.strRelID,e),Er(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function XO(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?$r(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function KO(t,e){e||(e=ce(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),s6(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function YO(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),a=GA(t),s=aR(t,0,r),u=Q2(t);t.l=n;var c={Name:a,Ptg:s};return i<268435455&&(c.Sheet=i),u&&(c.Comment=u),c}function $O(t,e){pe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};pe(t,156,bO(i))}pe(t,144)}function QO(t,e){e||(e=ce(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Er("SheetJS",e),Er(Lf.version,e),Er(Lf.version,e),Er("7262",e),e.length>e.l?e.slice(0,e.l):e}function qO(t,e){e||(e=ce(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function JO(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&a==-1&&(a=n);a>i||(pe(t,135),pe(t,158,qO(i)),pe(t,136))}}function ZO(t,e){var r=_n();return pe(r,131),pe(r,128,QO()),pe(r,153,KO(t.Workbook&&t.Workbook.WBProps||null)),JO(r,t),$O(r,t),pe(r,132),r.end()}function eI(t,e,r){return(e.slice(-4)===".bin"?ZO:Y6)(t)}function tI(t,e,r,n,i){return(e.slice(-4)===".bin"?BO:b6)(t,r,n,i)}function rI(t,e,r){return(e.slice(-4)===".bin"?yP:N6)(t,r)}function nI(t,e,r){return(e.slice(-4)===".bin"?KF:k6)(t,r)}function iI(t,e,r){return(e.slice(-4)===".bin"?MP:L6)(t)}function aI(t){return(t.slice(-4)===".bin"?FP:I6)()}function sI(t,e){var r=[];return t.Props&&r.push(rF(t.Props,e)),t.Custprops&&r.push(nF(t.Props,t.Custprops)),r.join("")}function oI(){return""}function lI(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var a=[];a.push(Ce("NumberFormat",null,{"ss:Format":_t(Yt[n.numFmtId])}));var s={"ss:ID":"s"+(21+i)};r.push(Ce("Style",a.join(""),s))}),Ce("Styles",r.join(""))}function $6(t){return Ce("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+tm(t.Ref,{r:0,c:0})})}function uI(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push($6(i)))}return Ce("Names",r.join(""))}function cI(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,a=[],s=0;s<i.length;++s){var u=i[s];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||a.push($6(u)))}return a.join("")}function fI(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Ce("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Ce("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Ce("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Ce("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Or("ProtectContents","True")),t["!protect"].objects&&i.push(Or("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Or("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Or("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Or("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){t["!protect"][s[0]]&&i.push("<"+s[1]+"/>")})),i.length==0?"":Ce("WorksheetOptions",i.join(""),{xmlns:An.x})}function hI(t){return t.map(function(e){var r=mA(e.t||""),n=Ce("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ce("Comment",n,{"ss:Author":e.a})}).join("")}function dI(t,e,r,n,i,a,s){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+_t(tm(t.f,s))),t.F&&t.F.slice(0,e.length)==e){var c=wr(t.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=_t(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=_t(t.l.Tooltip))),r["!merges"])for(var f=r["!merges"],d=0;d!=f.length;++d)f[d].s.c!=s.c||f[d].s.r!=s.r||(f[d].e.c>f[d].s.c&&(u["ss:MergeAcross"]=f[d].e.c-f[d].s.c),f[d].e.r>f[d].s.r&&(u["ss:MergeDown"]=f[d].e.r-f[d].s.r));var v="",g="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":v="Number",g=String(t.v);break;case"b":v="Boolean",g=t.v?"1":"0";break;case"e":v="Error",g=f0[t.v];break;case"d":v="DateTime",g=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Yt[14]);break;case"s":v="String",g=gA(t.v||"");break}var x=cs(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+x),u["ss:Index"]=s.c+1;var _=t.v!=null?g:"",y=t.t=="z"?"":'<Data ss:Type="'+v+'">'+_+"</Data>";return(t.c||[]).length>0&&(y+=hI(t.c)),Ce("Cell",y,u)}function pI(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=P6(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function gI(t,e,r,n){if(!t["!ref"])return"";var i=It(t["!ref"]),a=t["!merges"]||[],s=0,u=[];t["!cols"]&&t["!cols"].forEach(function(E,C){Z2(E);var T=!!E.width,m=fd(C,E),w={"ss:Index":C+1};T&&(w["ss:Width"]=bf(m.width)),E.hidden&&(w["ss:Hidden"]="1"),u.push(Ce("Column",null,w))});for(var c=Array.isArray(t),f=i.s.r;f<=i.e.r;++f){for(var d=[pI(f,(t["!rows"]||[])[f])],v=i.s.c;v<=i.e.c;++v){var g=!1;for(s=0;s!=a.length;++s)if(!(a[s].s.c>v)&&!(a[s].s.r>f)&&!(a[s].e.c<v)&&!(a[s].e.r<f)){(a[s].s.c!=v||a[s].s.r!=f)&&(g=!0);break}if(!g){var x={r:f,c:v},_=St(x),y=c?(t[f]||[])[v]:t[_];d.push(dI(y,_,t,e,r,n,x))}}d.push("</Row>"),d.length>2&&u.push(d.join(""))}return u.join("")}function mI(t,e,r){var n=[],i=r.SheetNames[t],a=r.Sheets[i],s=a?cI(a,e,t,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=a?gI(a,e,t,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(fI(a,e,t,r)),n.join("")}function vI(t,e){e||(e={}),t.SSF||(t.SSF=Sn(Yt)),t.SSF&&(sd(),ad(t.SSF),e.revssf=od(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],cs(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(sI(t,e)),r.push(oI()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ce("Worksheet",mI(n,e,t),{"ss:Name":_t(t.SheetNames[n])}));return r[2]=lI(t,e),r[3]=uI(t),ar+Ce("Workbook",r.join(""),{xmlns:An.ss,"xmlns:o":An.o,"xmlns:x":An.x,"xmlns:ss":An.ss,"xmlns:dt":An.dt,"xmlns:html":An.html})}var mp={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function xI(t,e){var r=[],n=[],i=[],a=0,s,u=Y4(o3,"n"),c=Y4(l3,"n");if(t.Props)for(s=Mr(t.Props),a=0;a<s.length;++a)(Object.prototype.hasOwnProperty.call(u,s[a])?r:Object.prototype.hasOwnProperty.call(c,s[a])?n:i).push([s[a],t.Props[s[a]]]);if(t.Custprops)for(s=Mr(t.Custprops),a=0;a<s.length;++a)Object.prototype.hasOwnProperty.call(t.Props||{},s[a])||(Object.prototype.hasOwnProperty.call(u,s[a])?r:Object.prototype.hasOwnProperty.call(c,s[a])?n:i).push([s[a],t.Custprops[s[a]]]);var f=[];for(a=0;a<i.length;++a)_6.indexOf(i[a][0])>-1||m6.indexOf(i[a][0])>-1||i[a][1]!=null&&f.push(i[a]);n.length&&Et.utils.cfb_add(e,"/SummaryInformation",d3(n,mp.SI,c,l3)),(r.length||f.length)&&Et.utils.cfb_add(e,"/DocumentSummaryInformation",d3(r,mp.DSI,u,o3,f.length?f:null,mp.UDI))}function _I(t,e){var r=e||{},n=Et.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Et.utils.cfb_add(n,i,Q6(t,r)),r.biff==8&&(t.Props||t.Custprops)&&xI(t,n),r.biff==8&&t.vbaraw&&BP(n,Et.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var yI={0:{f:ER},1:{f:RR},2:{f:qR},3:{f:zR},4:{f:LR},5:{f:KR},6:{f:rO},7:{f:jR},8:{f:uO},9:{f:lO},10:{f:sO},11:{f:oO},12:{f:IR},13:{f:ZR},14:{f:WR},15:{f:BR},16:{f:$R},17:{f:iO},18:{f:bR},19:{f:$2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:YO},40:{},42:{},43:{f:rP},44:{f:eP},45:{f:aP},46:{f:oP},47:{f:sP},48:{},49:{f:IA},50:{},51:{f:EP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:DF},62:{f:tO},63:{f:PP},64:{f:CO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ui,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:SO},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:PR},148:{f:kR,p:16},151:{f:gO},152:{},153:{f:XO},154:{},155:{},156:{f:VO},157:{},158:{},159:{T:1,f:VF},160:{T:-1},161:{T:1,f:ro},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:cO},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:SP},336:{T:-1},337:{f:kP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Cg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:FF},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:mO},427:{f:vO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:_O},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:FR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:dO},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Cg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:DP},633:{T:1},634:{T:-1},635:{T:1,f:OP},636:{T:-1},637:{f:BA},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:UO},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:kO},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ke(t,e,r,n){var i=e;if(!isNaN(i)){var a=n||(r||[]).length||0,s=t.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&X2(r)&&t.push(r)}}function SI(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return ke(t,e,r,i);var a=e;if(!isNaN(a)){for(var s=r.parts||[],u=0,c=0,f=0;f+(s[u]||8224)<=8224;)f+=s[u]||8224,u++;var d=t.next(4);for(d.write_shift(2,a),d.write_shift(2,f),t.push(r.slice(c,c+f)),c+=f;c<i;){for(d=t.next(4),d.write_shift(2,60),f=0;f+(s[u]||8224)<=8224;)f+=s[u]||8224,u++;d.write_shift(2,f),t.push(r.slice(c,c+f)),c+=f}}}function d0(t,e,r){return t||(t=ce(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function wI(t,e,r,n){var i=ce(9);return d0(i,t,e),S6(r,n||"b",i),i}function EI(t,e,r){var n=ce(8+2*r.length);return d0(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function TI(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?yn(an(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?ke(t,2,UF(r,n,i)):ke(t,3,BF(r,n,i));return;case"b":case"e":ke(t,5,wI(r,n,e.v,e.t));return;case"s":case"str":ke(t,4,EI(r,n,(e.v||"").slice(0,255)));return}ke(t,1,d0(null,r,n))}function CI(t,e,r,n){var i=Array.isArray(e),a=It(e["!ref"]||"A1"),s,u="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),s=ir(a)}for(var f=a.s.r;f<=a.e.r;++f){u=Dr(f);for(var d=a.s.c;d<=a.e.c;++d){f===a.s.r&&(c[d]=Yr(d)),s=c[d]+u;var v=i?(e[f]||[])[d]:e[s];v&&TI(t,v,f,d)}}}function kI(t,e){for(var r=e||{},n=_n(),i=0,a=0;a<t.SheetNames.length;++a)t.SheetNames[a]==r.sheet&&(i=a);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ke(n,r.biff==4?1033:r.biff==3?521:9,J2(t,16,r)),CI(n,t.Sheets[t.SheetNames[i]],i,r),ke(n,10),n.end()}function AI(t,e,r){ke(t,49,yF({sz:12,name:"Arial"},r))}function FI(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ke(t,1054,EF(i,e[i],r))})}function PI(t,e){var r=ce(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ke(t,2151,r),r=ce(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),T6(It(e["!ref"]||"A1"),r),r.write_shift(4,4),ke(t,2152,r)}function NI(t,e){for(var r=0;r<16;++r)ke(t,224,g3({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ke(t,224,g3(n,0,e))})}function RI(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];ke(t,440,RF(n)),n[1].Tooltip&&ke(t,2048,OF(n))}delete e["!links"]}function OI(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&ke(t,125,LF(fd(i,n),i))})}}function II(t,e,r,n,i){var a=16+cs(i.cellXfs,e,i);if(e.v==null&&!e.bf){ke(t,513,Gs(r,n,a));return}if(e.bf)ke(t,6,nR(e,r,n,i,a));else switch(e.t){case"d":case"n":var s=e.t=="d"?yn(an(e.v)):e.v;ke(t,515,AF(r,n,s,a));break;case"b":case"e":ke(t,517,kF(r,n,e.v,a,i,e.t));break;case"s":case"str":if(i.bookSST){var u=nm(i.Strings,e.v,i.revStrings);ke(t,253,SF(r,n,u,a))}else ke(t,516,wF(r,n,(e.v||"").slice(0,255),a,i));break;default:ke(t,513,Gs(r,n,a))}}function DI(t,e,r){var n=_n(),i=r.SheetNames[t],a=r.Sheets[i]||{},s=(r||{}).Workbook||{},u=(s.Sheets||[])[t]||{},c=Array.isArray(a),f=e.biff==8,d,v="",g=[],x=It(a["!ref"]||"A1"),_=f?65536:16384;if(x.e.c>255||x.e.r>=_){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,_-1)}ke(n,2057,J2(r,16,e)),ke(n,13,Xn(1)),ke(n,12,Xn(100)),ke(n,15,rn(!0)),ke(n,17,rn(!1)),ke(n,16,zs(.001)),ke(n,95,rn(!0)),ke(n,42,rn(!1)),ke(n,43,rn(!1)),ke(n,130,Xn(1)),ke(n,128,CF()),ke(n,131,rn(!1)),ke(n,132,rn(!1)),f&&OI(n,a["!cols"]),ke(n,512,TF(x,e)),f&&(a["!links"]=[]);for(var y=x.s.r;y<=x.e.r;++y){v=Dr(y);for(var E=x.s.c;E<=x.e.c;++E){y===x.s.r&&(g[E]=Yr(E)),d=g[E]+v;var C=c?(a[y]||[])[E]:a[d];C&&(II(n,C,y,E,e),f&&C.l&&a["!links"].push([d,C.l]))}}var T=u.CodeName||u.name||i;return f&&ke(n,574,_F((s.Views||[])[0])),f&&(a["!merges"]||[]).length&&ke(n,229,NF(a["!merges"])),f&&RI(n,a),ke(n,442,E6(T)),f&&PI(n,a),ke(n,10),n.end()}function LI(t,e,r){var n=_n(),i=(t||{}).Workbook||{},a=i.Sheets||[],s=i.WBProps||{},u=r.biff==8,c=r.biff==5;if(ke(n,2057,J2(t,5,r)),r.bookType=="xla"&&ke(n,135),ke(n,225,u?Xn(1200):null),ke(n,193,sF(2)),c&&ke(n,191),c&&ke(n,192),ke(n,226),ke(n,92,gF("SheetJS",r)),ke(n,66,Xn(u?1200:1252)),u&&ke(n,353,Xn(0)),u&&ke(n,448),ke(n,317,MF(t.SheetNames.length)),u&&t.vbaraw&&ke(n,211),u&&t.vbaraw){var f=s.CodeName||"ThisWorkbook";ke(n,442,E6(f))}ke(n,156,Xn(17)),ke(n,25,rn(!1)),ke(n,18,rn(!1)),ke(n,19,Xn(0)),u&&ke(n,431,rn(!1)),u&&ke(n,444,Xn(0)),ke(n,61,xF()),ke(n,64,rn(!1)),ke(n,141,Xn(0)),ke(n,34,rn(GO(t)=="true")),ke(n,14,rn(!0)),u&&ke(n,439,rn(!1)),ke(n,218,Xn(0)),AI(n,t,r),FI(n,t.SSF,r),NI(n,r),u&&ke(n,352,rn(!1));var d=n.end(),v=_n();u&&ke(v,140,IF()),u&&r.Strings&&SI(v,252,vF(r.Strings)),ke(v,10);var g=v.end(),x=_n(),_=0,y=0;for(y=0;y<t.SheetNames.length;++y)_+=(u?12:11)+(u?2:1)*t.SheetNames[y].length;var E=d.length+_+g.length;for(y=0;y<t.SheetNames.length;++y){var C=a[y]||{};ke(x,133,mF({pos:E,hs:C.Hidden||0,dt:0,name:t.SheetNames[y]},r)),E+=e[y].length}var T=x.end();if(_!=T.length)throw new Error("BS8 "+_+" != "+T.length);var m=[];return d.length&&m.push(d),T.length&&m.push(T),g.length&&m.push(g),Rr(m)}function MI(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Sn(Yt)),t&&t.SSF&&(sd(),ad(t.SSF),r.revssf=od(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,im(r),r.cellXfs=[],cs(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=DI(i,r,t);return n.unshift(LI(t,n,r)),Rr(n)}function Q6(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=On(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=e||{};switch(a.biff||2){case 8:case 5:return MI(t,e);case 4:case 3:case 2:return kI(t,e)}throw new Error("invalid type "+a.bookType+" for BIFF")}function BI(t,e,r,n){for(var i=t["!merges"]||[],a=[],s=e.s.c;s<=e.e.c;++s){for(var u=0,c=0,f=0;f<i.length;++f)if(!(i[f].s.r>r||i[f].s.c>s)&&!(i[f].e.r<r||i[f].e.c<s)){if(i[f].s.r<r||i[f].s.c<s){u=-1;break}u=i[f].e.r-i[f].s.r+1,c=i[f].e.c-i[f].s.c+1;break}if(!(u<0)){var d=St({r,c:s}),v=n.dense?(t[r]||[])[s]:t[d],g=v&&v.v!=null&&(v.h||pA(v.w||(fa(v),v.w)||""))||"",x={};u>1&&(x.rowspan=u),c>1&&(x.colspan=c),n.editable?g='<span contenteditable="true">'+g+"</span>":v&&(x["data-t"]=v&&v.t||"z",v.v!=null&&(x["data-v"]=v.v),v.z!=null&&(x["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+v.l.Target+'">'+g+"</a>")),x.id=(n.id||"sjs")+"-"+d,a.push(Ce("td",g,x))}}var _="<tr>";return _+a.join("")+"</tr>"}var UI='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',zI="</body></html>";function GI(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function q6(t,e){var r=e||{},n=r.header!=null?r.header:UI,i=r.footer!=null?r.footer:zI,a=[n],s=On(t["!ref"]);r.dense=Array.isArray(t),a.push(GI(t,s,r));for(var u=s.s.r;u<=s.e.r;++u)a.push(BI(t,s,u,r));return a.push("</table>"+i),a.join("")}function J6(t,e,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var s=typeof n.origin=="string"?wr(n.origin):n.origin;i=s.r,a=s.c}var u=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,u.length),f={s:{r:0,c:0},e:{r:i,c:a}};if(t["!ref"]){var d=On(t["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),i==-1&&(f.e.r=i=d.e.r+1)}var v=[],g=0,x=t["!rows"]||(t["!rows"]=[]),_=0,y=0,E=0,C=0,T=0,m=0;for(t["!cols"]||(t["!cols"]=[]);_<u.length&&y<c;++_){var w=u[_];if(w3(w)){if(n.display)continue;x[y]={hidden:!0}}var F=w.children;for(E=C=0;E<F.length;++E){var R=F[E];if(!(n.display&&w3(R))){var N=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):xA(R.innerHTML),A=R.getAttribute("data-z")||R.getAttribute("z");for(g=0;g<v.length;++g){var L=v[g];L.s.c==C+a&&L.s.r<y+i&&y+i<=L.e.r&&(C=L.e.c+1-a,g=-1)}m=+R.getAttribute("colspan")||1,((T=+R.getAttribute("rowspan")||1)>1||m>1)&&v.push({s:{r:y+i,c:C+a},e:{r:y+i+(T||1)-1,c:C+a+(m||1)-1}});var O={t:"s",v:N},H=R.getAttribute("data-t")||R.getAttribute("t")||"";N!=null&&(N.length==0?O.t=H||"z":n.raw||N.trim().length==0||H=="s"||(N==="TRUE"?O={t:"b",v:!0}:N==="FALSE"?O={t:"b",v:!1}:isNaN(ia(N))?isNaN(Ku(N).getDate())||(O={t:"d",v:an(N)},n.cellDates||(O={t:"n",v:yn(O.v)}),O.z=n.dateNF||Yt[14]):O={t:"n",v:ia(N)})),O.z===void 0&&A!=null&&(O.z=A);var j="",q=R.getElementsByTagName("A");if(q&&q.length)for(var ye=0;ye<q.length&&!(q[ye].hasAttribute("href")&&(j=q[ye].getAttribute("href"),j.charAt(0)!="#"));++ye);j&&j.charAt(0)!="#"&&(O.l={Target:j}),n.dense?(t[y+i]||(t[y+i]=[]),t[y+i][C+a]=O):t[St({c:C+a,r:y+i})]=O,f.e.c<C+a&&(f.e.c=C+a),C+=m}}++y}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),f.e.r=Math.max(f.e.r,y-1+i),t["!ref"]=ir(f),y>=c&&(t["!fullref"]=ir((f.e.r=u.length-_+y-1+i,f))),t}function Z6(t,e){var r=e||{},n=r.dense?[]:{};return J6(n,t,e)}function WI(t,e){return Js(Z6(t,e),e)}function w3(t){var e="",r=HI(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function HI(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var jI=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+$u({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return ar+e}}(),E3=function(){var t=function(a){return _t(a).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,s,u){var c=[];c.push('      <table:table table:name="'+_t(s.SheetNames[u])+`" table:style-name="ta1">
`);var f=0,d=0,v=On(a["!ref"]||"A1"),g=a["!merges"]||[],x=0,_=Array.isArray(a);if(a["!cols"])for(d=0;d<=v.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var y="",E=a["!rows"]||[];for(f=0;f<v.s.r;++f)y=E[f]?' table:style-name="ro'+E[f].ods+'"':"",c.push("        <table:table-row"+y+`></table:table-row>
`);for(;f<=v.e.r;++f){for(y=E[f]?' table:style-name="ro'+E[f].ods+'"':"",c.push("        <table:table-row"+y+`>
`),d=0;d<v.s.c;++d)c.push(e);for(;d<=v.e.c;++d){var C=!1,T={},m="";for(x=0;x!=g.length;++x)if(!(g[x].s.c>d)&&!(g[x].s.r>f)&&!(g[x].e.c<d)&&!(g[x].e.r<f)){(g[x].s.c!=d||g[x].s.r!=f)&&(C=!0),T["table:number-columns-spanned"]=g[x].e.c-g[x].s.c+1,T["table:number-rows-spanned"]=g[x].e.r-g[x].s.r+1;break}if(C){c.push(r);continue}var w=St({r:f,c:d}),F=_?(a[f]||[])[d]:a[w];if(F&&F.f&&(T["table:formula"]=_t(uR(F.f)),F.F&&F.F.slice(0,w.length)==w)){var R=On(F.F);T["table:number-matrix-columns-spanned"]=R.e.c-R.s.c+1,T["table:number-matrix-rows-spanned"]=R.e.r-R.s.r+1}if(!F){c.push(e);continue}switch(F.t){case"b":m=F.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=F.v?"true":"false";break;case"n":m=F.w||String(F.v||0),T["office:value-type"]="float",T["office:value"]=F.v||0;break;case"s":case"str":m=F.v==null?"":F.v,T["office:value-type"]="string";break;case"d":m=F.w||an(F.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=an(F.v).toISOString(),T["table:style-name"]="ce1";break;default:c.push(e);continue}var N=t(m);if(F.l&&F.l.Target){var A=F.l.Target;A=A.charAt(0)=="#"?"#"+cR(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),N=Ce("text:a",N,{"xlink:href":A.replace(/&/g,"&amp;")})}c.push("          "+Ce("table:table-cell",Ce("text:p",N,{}),T)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(a,s){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var u=0;s.SheetNames.map(function(f){return s.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var d=0;d<f["!cols"].length;++d)if(f["!cols"][d]){var v=f["!cols"][d];if(v.width==null&&v.wpx==null&&v.wch==null)continue;Z2(v),v.ods=u;var g=f["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),a.push(`  </style:style>
`),++u}}});var c=0;s.SheetNames.map(function(f){return s.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var d=0;d<f["!rows"].length;++d)if(f["!rows"][d]){f["!rows"][d].ods=c;var v=f["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(s,u){var c=[ar],f=$u({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=$u({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(c.push("<office:document"+f+d+`>
`),c.push(p6().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+f+`>
`),i(c,s),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var v=0;v!=s.SheetNames.length;++v)c.push(n(s.Sheets[s.SheetNames[v]],s,v));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),u.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function e8(t,e){if(e.bookType=="fods")return E3(t,e);var r=H2(),n="",i=[],a=[];return n="mimetype",Je(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Je(r,n,E3(t,e)),i.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Je(r,n,jI(t,e)),i.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Je(r,n,ar+p6()),i.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Je(r,n,tF(a)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Je(r,n,ZA(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Yf(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function VI(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):di(Yu(t))}function bI(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Za(t){var e=t.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function XI(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var a=0;i>=1;++a,i/=256)t[e+a]=i&255;t[e+15]|=r>=0?0:128}function Qu(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function vt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function qo(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function ur(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Qu(t,r),a=i&7;i=Math.floor(i/8);var s=0,u;if(i==0)break;switch(a){case 0:{for(var c=r[0];t[r[0]++]>=128;);u=t.slice(c,r[0])}break;case 5:s=4,u=t.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,u=t.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Qu(t,r),u=t.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var f={data:u,type:a};e[i]==null?e[i]=[f]:e[i].push(f)}return e}function Fr(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(vt(n*8+i.type)),i.type==2&&e.push(vt(i.data.length)),e.push(i.data))})}),Za(e)}function oi(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Qu(t,n),a=ur(t.slice(n[0],n[0]+i));n[0]+=i;var s={id:qo(a[1][0].data),messages:[]};a[2].forEach(function(u){var c=ur(u.data),f=qo(c[3][0].data);s.messages.push({meta:c,data:t.slice(n[0],n[0]+f)}),n[0]+=f}),(e=a[3])!=null&&e[0]&&(s.merge=qo(a[3][0].data)>>>0>0),r.push(s)}return r}function ko(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:vt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:vt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(s){i.push(s.data),s.meta[3]=[{type:0,data:vt(s.data.length)}],n[2].push({data:Fr(s.meta),type:2})});var a=Fr(n);e.push(vt(a.length)),e.push(a),i.forEach(function(s){return e.push(s)})}),Za(e)}function KI(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Qu(e,r),i=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var s=e[r[0]++]>>2;if(s<60)++s;else{var u=s-59;s=e[r[0]],u>1&&(s|=e[r[0]+1]<<8),u>2&&(s|=e[r[0]+2]<<16),u>3&&(s|=e[r[0]+3]<<24),s>>>=0,s++,r[0]+=u}i.push(e.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var c=0,f=0;if(a==1?(f=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(f=(e[r[0]++]>>2)+1,a==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Za(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(f>=c)for(i.push(i[0].slice(-c)),f-=c;f>=i[i.length-1].length;)i.push(i[i.length-1]),f-=i[i.length-1].length;i.push(i[0].slice(-c,-c+f))}}var d=Za(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function li(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(KI(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Za(e)}function Ao(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var a=vt(n),s=a.length;e.push(a),n<=60?(s++,e.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),s+=n,i[0]=0,i[1]=s&255,i[2]=s>>8&255,i[3]=s>>16&255,r+=n}return Za(e)}function vp(t,e){var r=new Uint8Array(32),n=Yf(r),i=12,a=0;switch(r[0]=5,t.t){case"n":r[1]=2,XI(r,i,t.v),a|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),a|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,a,!0),r.slice(0,i)}function xp(t,e){var r=new Uint8Array(32),n=Yf(r),i=12,a=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),a|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),a|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,a,!0),r.slice(0,i)}function Na(t){var e=ur(t);return Qu(e[1][0].data)}function YI(t,e,r){var n,i,a,s;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var u=((s=(a=t[8])==null?void 0:a[0])==null?void 0:s.data)&&qo(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var c=0,f=Yf(t[7][0].data),d=0,v=[],g=Yf(t[4][0].data),x=0,_=[],y=0;y<e.length;++y){if(e[y]==null){f.setUint16(y*2,65535,!0),g.setUint16(y*2,65535);continue}f.setUint16(y*2,d,!0),g.setUint16(y*2,x,!0);var E,C;switch(typeof e[y]){case"string":E=vp({t:"s",v:e[y]},r),C=xp({t:"s",v:e[y]},r);break;case"number":E=vp({t:"n",v:e[y]},r),C=xp({t:"n",v:e[y]},r);break;case"boolean":E=vp({t:"b",v:e[y]},r),C=xp({t:"b",v:e[y]},r);break;default:throw new Error("Unsupported value "+e[y])}v.push(E),d+=E.length,_.push(C),x+=C.length,++c}for(t[2][0].data=vt(c);y<t[7][0].data.length/2;++y)f.setUint16(y*2,65535,!0),g.setUint16(y*2,65535,!0);return t[6][0].data=Za(v),t[3][0].data=Za(_),c}function $I(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=On(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ir(n)));var a=$f(r,{range:n,header:1}),s=["~Sh33tJ5~"];a.forEach(function(K){return K.forEach(function(b){typeof b=="string"&&s.push(b)})});var u={},c=[],f=Et.read(e.numbers,{type:"base64"});f.FileIndex.map(function(K,b){return[K,f.FullPaths[b]]}).forEach(function(K){var b=K[0],V=K[1];if(b.type==2&&b.name.match(/\.iwa/)){var oe=b.content,W=li(oe),Z=oi(W);Z.forEach(function(he){c.push(he.id),u[he.id]={deps:[],location:V,type:qo(he.messages[0].meta[1][0].data)}})}}),c.sort(function(K,b){return K-b});var d=c.filter(function(K){return K>1}).map(function(K){return[K,vt(K)]});f.FileIndex.map(function(K,b){return[K,f.FullPaths[b]]}).forEach(function(K){var b=K[0];if(K[1],!!b.name.match(/\.iwa/)){var V=oi(li(b.content));V.forEach(function(oe){oe.messages.forEach(function(W){d.forEach(function(Z){oe.messages.some(function(he){return qo(he.meta[1][0].data)!=11006&&bI(he.data,Z[1])})&&u[Z[0]].deps.push(oe.id)})})})}});for(var v=Et.find(f,u[1].location),g=oi(li(v.content)),x,_=0;_<g.length;++_){var y=g[_];y.id==1&&(x=y)}var E=Na(ur(x.messages[0].data)[1][0].data);for(v=Et.find(f,u[E].location),g=oi(li(v.content)),_=0;_<g.length;++_)y=g[_],y.id==E&&(x=y);for(E=Na(ur(x.messages[0].data)[2][0].data),v=Et.find(f,u[E].location),g=oi(li(v.content)),_=0;_<g.length;++_)y=g[_],y.id==E&&(x=y);for(E=Na(ur(x.messages[0].data)[2][0].data),v=Et.find(f,u[E].location),g=oi(li(v.content)),_=0;_<g.length;++_)y=g[_],y.id==E&&(x=y);var C=ur(x.messages[0].data);{C[6][0].data=vt(n.e.r+1),C[7][0].data=vt(n.e.c+1);var T=Na(C[46][0].data),m=Et.find(f,u[T].location),w=oi(li(m.content));{for(var F=0;F<w.length&&w[F].id!=T;++F);if(w[F].id!=T)throw"Bad ColumnRowUIDMapArchive";var R=ur(w[F].messages[0].data);R[1]=[],R[2]=[],R[3]=[];for(var N=0;N<=n.e.c;++N){var A=[];A[1]=A[2]=[{type:0,data:vt(N+420690)}],R[1].push({type:2,data:Fr(A)}),R[2].push({type:0,data:vt(N)}),R[3].push({type:0,data:vt(N)})}R[4]=[],R[5]=[],R[6]=[];for(var L=0;L<=n.e.r;++L)A=[],A[1]=A[2]=[{type:0,data:vt(L+726270)}],R[4].push({type:2,data:Fr(A)}),R[5].push({type:0,data:vt(L)}),R[6].push({type:0,data:vt(L)});w[F].messages[0].data=Fr(R)}m.content=Ao(ko(w)),m.size=m.content.length,delete C[46];var O=ur(C[4][0].data);{O[7][0].data=vt(n.e.r+1);var H=ur(O[1][0].data),j=Na(H[2][0].data);m=Et.find(f,u[j].location),w=oi(li(m.content));{if(w[0].id!=j)throw"Bad HeaderStorageBucket";var q=ur(w[0].messages[0].data);for(L=0;L<a.length;++L){var ye=ur(q[2][0].data);ye[1][0].data=vt(L),ye[4][0].data=vt(a[L].length),q[2][L]={type:q[2][0].type,data:Fr(ye)}}w[0].messages[0].data=Fr(q)}m.content=Ao(ko(w)),m.size=m.content.length;var de=Na(O[2][0].data);m=Et.find(f,u[de].location),w=oi(li(m.content));{if(w[0].id!=de)throw"Bad HeaderStorageBucket";for(q=ur(w[0].messages[0].data),N=0;N<=n.e.c;++N)ye=ur(q[2][0].data),ye[1][0].data=vt(N),ye[4][0].data=vt(n.e.r+1),q[2][N]={type:q[2][0].type,data:Fr(ye)};w[0].messages[0].data=Fr(q)}m.content=Ao(ko(w)),m.size=m.content.length;var Ae=Na(O[4][0].data);(function(){for(var K=Et.find(f,u[Ae].location),b=oi(li(K.content)),V,oe=0;oe<b.length;++oe){var W=b[oe];W.id==Ae&&(V=W)}var Z=ur(V.messages[0].data);{Z[3]=[];var he=[];s.forEach(function(Be,Ke){he[1]=[{type:0,data:vt(Ke)}],he[2]=[{type:0,data:vt(1)}],he[3]=[{type:2,data:VI(Be)}],Z[3].push({type:2,data:Fr(he)})})}V.messages[0].data=Fr(Z);var ge=ko(b),Ne=Ao(ge);K.content=Ne,K.size=K.content.length})();var Ge=ur(O[3][0].data);{var ue=Ge[1][0];delete Ge[2];var xe=ur(ue.data);{var ve=Na(xe[2][0].data);(function(){for(var K=Et.find(f,u[ve].location),b=oi(li(K.content)),V,oe=0;oe<b.length;++oe){var W=b[oe];W.id==ve&&(V=W)}var Z=ur(V.messages[0].data);{delete Z[6],delete Ge[7];var he=new Uint8Array(Z[5][0].data);Z[5]=[];for(var ge=0,Ne=0;Ne<=n.e.r;++Ne){var Be=ur(he);ge+=YI(Be,a[Ne],s),Be[1][0].data=vt(Ne),Z[5].push({data:Fr(Be),type:2})}Z[1]=[{type:0,data:vt(n.e.c+1)}],Z[2]=[{type:0,data:vt(n.e.r+1)}],Z[3]=[{type:0,data:vt(ge)}],Z[4]=[{type:0,data:vt(n.e.r+1)}]}V.messages[0].data=Fr(Z);var Ke=ko(b),Ye=Ao(Ke);K.content=Ye,K.size=K.content.length})()}ue.data=Fr(xe)}O[3][0].data=Fr(Ge)}C[4][0].data=Fr(O)}x.messages[0].data=Fr(C);var we=ko(g),z=Ao(we);return v.content=z,v.size=v.content.length,f}function QI(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function im(t){QI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function qI(t,e){return e.bookType=="ods"?e8(t,e):e.bookType=="numbers"?$I(t,e):e.bookType=="xlsb"?JI(t,e):ZI(t,e)}function JI(t,e){Wo=1024,t&&!t.SSF&&(t.SSF=Sn(Yt)),t&&t.SSF&&(sd(),ad(t.SSF),e.revssf=od(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Tu?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=M6.indexOf(e.bookType)>-1,i=f6();im(e=e||{});var a=H2(),s="",u=0;if(e.cellXfs=[],cs(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),s="docProps/core.xml",Je(a,s,g6(t.Props,e)),i.coreprops.push(s),xt(e.rels,2,s,ht.CORE_PROPS),s="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],f=0;f<t.SheetNames.length;++f)(t.Workbook.Sheets[f]||{}).Hidden!=2&&c.push(t.SheetNames[f]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,Je(a,s,v6(t.Props)),i.extprops.push(s),xt(e.rels,3,s,ht.EXT_PROPS),t.Custprops!==t.Props&&Mr(t.Custprops||{}).length>0&&(s="docProps/custom.xml",Je(a,s,x6(t.Custprops)),i.custprops.push(s),xt(e.rels,4,s,ht.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var d={"!id":{}},v=t.Sheets[t.SheetNames[u-1]],g=(v||{})["!type"]||"sheet";switch(g){case"chart":default:s="xl/worksheets/sheet"+u+"."+r,Je(a,s,tI(u-1,s,e,t,d)),i.sheets.push(s),xt(e.wbrels,-1,"worksheets/sheet"+u+"."+r,ht.WS[0])}if(v){var x=v["!comments"],_=!1,y="";x&&x.length>0&&(y="xl/comments"+u+"."+r,Je(a,y,iI(x,y)),i.comments.push(y),xt(d,-1,"../comments"+u+"."+r,ht.CMNT),_=!0),v["!legacy"]&&_&&Je(a,"xl/drawings/vmlDrawing"+u+".vml",D6(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}d["!id"].rId1&&Je(a,d6(s),$o(d))}return e.Strings!=null&&e.Strings.length>0&&(s="xl/sharedStrings."+r,Je(a,s,nI(e.Strings,s,e)),i.strs.push(s),xt(e.wbrels,-1,"sharedStrings."+r,ht.SST)),s="xl/workbook."+r,Je(a,s,eI(t,s)),i.workbooks.push(s),xt(e.rels,1,s,ht.WB),s="xl/theme/theme1.xml",Je(a,s,O6(t.Themes,e)),i.themes.push(s),xt(e.wbrels,-1,"theme/theme1.xml",ht.THEME),s="xl/styles."+r,Je(a,s,rI(t,s,e)),i.styles.push(s),xt(e.wbrels,-1,"styles."+r,ht.STY),t.vbaraw&&n&&(s="xl/vbaProject.bin",Je(a,s,t.vbaraw),i.vba.push(s),xt(e.wbrels,-1,"vbaProject.bin",ht.VBA)),s="xl/metadata."+r,Je(a,s,aI(s)),i.metadata.push(s),xt(e.wbrels,-1,"metadata."+r,ht.XLMETA),Je(a,"[Content_Types].xml",h6(i,e)),Je(a,"_rels/.rels",$o(e.rels)),Je(a,"xl/_rels/workbook."+r+".rels",$o(e.wbrels)),delete e.revssf,delete e.ssf,a}function ZI(t,e){Wo=1024,t&&!t.SSF&&(t.SSF=Sn(Yt)),t&&t.SSF&&(sd(),ad(t.SSF),e.revssf=od(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Tu?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=M6.indexOf(e.bookType)>-1,i=f6();im(e=e||{});var a=H2(),s="",u=0;if(e.cellXfs=[],cs(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),s="docProps/core.xml",Je(a,s,g6(t.Props,e)),i.coreprops.push(s),xt(e.rels,2,s,ht.CORE_PROPS),s="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],f=0;f<t.SheetNames.length;++f)(t.Workbook.Sheets[f]||{}).Hidden!=2&&c.push(t.SheetNames[f]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Je(a,s,v6(t.Props)),i.extprops.push(s),xt(e.rels,3,s,ht.EXT_PROPS),t.Custprops!==t.Props&&Mr(t.Custprops||{}).length>0&&(s="docProps/custom.xml",Je(a,s,x6(t.Custprops)),i.custprops.push(s),xt(e.rels,4,s,ht.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,u=1;u<=t.SheetNames.length;++u){var v={"!id":{}},g=t.Sheets[t.SheetNames[u-1]],x=(g||{})["!type"]||"sheet";switch(x){case"chart":default:s="xl/worksheets/sheet"+u+"."+r,Je(a,s,b6(u-1,e,t,v)),i.sheets.push(s),xt(e.wbrels,-1,"worksheets/sheet"+u+"."+r,ht.WS[0])}if(g){var _=g["!comments"],y=!1,E="";if(_&&_.length>0){var C=!1;_.forEach(function(T){T[1].forEach(function(m){m.T==!0&&(C=!0)})}),C&&(E="xl/threadedComments/threadedComment"+u+"."+r,Je(a,E,NP(_,d,e)),i.threadedcomments.push(E),xt(v,-1,"../threadedComments/threadedComment"+u+"."+r,ht.TCMNT)),E="xl/comments"+u+"."+r,Je(a,E,L6(_)),i.comments.push(E),xt(v,-1,"../comments"+u+"."+r,ht.CMNT),y=!0}g["!legacy"]&&y&&Je(a,"xl/drawings/vmlDrawing"+u+".vml",D6(u,g["!comments"])),delete g["!comments"],delete g["!legacy"]}v["!id"].rId1&&Je(a,d6(s),$o(v))}return e.Strings!=null&&e.Strings.length>0&&(s="xl/sharedStrings."+r,Je(a,s,k6(e.Strings,e)),i.strs.push(s),xt(e.wbrels,-1,"sharedStrings."+r,ht.SST)),s="xl/workbook."+r,Je(a,s,Y6(t)),i.workbooks.push(s),xt(e.rels,1,s,ht.WB),s="xl/theme/theme1.xml",Je(a,s,O6(t.Themes,e)),i.themes.push(s),xt(e.wbrels,-1,"theme/theme1.xml",ht.THEME),s="xl/styles."+r,Je(a,s,N6(t,e)),i.styles.push(s),xt(e.wbrels,-1,"styles."+r,ht.STY),t.vbaraw&&n&&(s="xl/vbaProject.bin",Je(a,s,t.vbaraw),i.vba.push(s),xt(e.wbrels,-1,"vbaProject.bin",ht.VBA)),s="xl/metadata."+r,Je(a,s,I6()),i.metadata.push(s),xt(e.wbrels,-1,"metadata."+r,ht.XLMETA),d.length>1&&(s="xl/persons/person.xml",Je(a,s,RP(d)),i.people.push(s),xt(e.wbrels,-1,"persons/person.xml",ht.PEOPLE)),Je(a,"[Content_Types].xml",h6(i,e)),Je(a,"_rels/.rels",$o(e.rels)),Je(a,"xl/_rels/workbook."+r+".rels",$o(e.wbrels)),delete e.revssf,delete e.ssf,a}function eD(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=ca(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function t8(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return u0(e.file,Et.write(t,{type:dt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Et.write(t,e)}function tD(t,e){var r=Sn(e||{}),n=qI(t,r);return rD(n,r)}function rD(t,e){var r={},n=dt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Et.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(id(i))}return e.password&&typeof encrypt_agile<"u"?t8(encrypt_agile(i,e.password),e):e.type==="file"?u0(e.file,i):e.type=="string"?yu(i):i}function nD(t,e){var r=e||{},n=_I(t,r);return t8(n,r)}function Oi(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Xu(Yu(n));case"binary":return Yu(n);case"string":return t;case"file":return u0(e.file,n,"utf8");case"buffer":return dt?va(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Oi(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function iD(t,e){switch(e.type){case"base64":return Xu(t);case"binary":return t;case"string":return t;case"file":return u0(e.file,t,"binary");case"buffer":return dt?va(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Vc(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Xu(r):e.type=="string"?yu(r):r;case"file":return u0(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function r8(t,e){Ok(),jO(t);var r=Sn(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=r8(t,r);return r.type="array",id(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Oi(vI(t,r),r);case"slk":case"sylk":return Oi(GF.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Oi(q6(t.Sheets[t.SheetNames[i]],r),r);case"txt":return iD(n8(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Oi(am(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Oi(WF.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return Vc(zF.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Oi(HF.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Oi($F.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Oi(C6.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Oi(e8(t,r),r);case"wk1":return Vc(m3.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return Vc(m3.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Vc(Q6(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),nD(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return tD(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function aD(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function sD(t,e,r){var n={};return n.type="file",n.file=e,aD(n),r8(t,n)}function oD(t,e,r,n,i,a,s,u){var c=Dr(r),f=u.defval,d=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!s||t[r])for(var x=e.s.c;x<=e.e.c;++x){var _=s?t[r][x]:t[n[x]+c];if(_===void 0||_.t===void 0){if(f===void 0)continue;a[x]!=null&&(g[a[x]]=f);continue}var y=_.v;switch(_.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(a[x]!=null){if(y==null)if(_.t=="e"&&y===null)g[a[x]]=null;else if(f!==void 0)g[a[x]]=f;else if(d&&y===null)g[a[x]]=null;else continue;else g[a[x]]=d&&(_.t!=="n"||_.t==="n"&&u.rawNumbers!==!1)?y:fa(_,y,u);y!=null&&(v=!1)}}return{row:g,isempty:v}}function $f(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],s=0,u="",c={s:{r:0,c:0},e:{r:0,c:0}},f=e||{},d=f.range!=null?f.range:t["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof d){case"string":c=It(d);break;case"number":c=It(t["!ref"]),c.s.r=d;break;default:c=d}n>0&&(i=0);var v=Dr(c.s.r),g=[],x=[],_=0,y=0,E=Array.isArray(t),C=c.s.r,T=0,m={};E&&!t[C]&&(t[C]=[]);var w=f.skipHidden&&t["!cols"]||[],F=f.skipHidden&&t["!rows"]||[];for(T=c.s.c;T<=c.e.c;++T)if(!(w[T]||{}).hidden)switch(g[T]=Yr(T),r=E?t[C][T]:t[g[T]+v],n){case 1:a[T]=T-c.s.c;break;case 2:a[T]=g[T];break;case 3:a[T]=f.header[T-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=s=fa(r,null,f),y=m[s]||0,!y)m[s]=1;else{do u=s+"_"+y++;while(m[u]);m[s]=y,m[u]=1}a[T]=u}for(C=c.s.r+i;C<=c.e.r;++C)if(!(F[C]||{}).hidden){var R=oD(t,c,C,g,n,a,E,f);(R.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(x[_++]=R.row)}return x.length=_,x}var T3=/"/g;function lD(t,e,r,n,i,a,s,u){for(var c=!0,f=[],d="",v=Dr(r),g=e.s.c;g<=e.e.c;++g)if(n[g]){var x=u.dense?(t[r]||[])[g]:t[n[g]+v];if(x==null)d="";else if(x.v!=null){c=!1,d=""+(u.rawNumbers&&x.t=="n"?x.v:fa(x,null,u));for(var _=0,y=0;_!==d.length;++_)if((y=d.charCodeAt(_))===i||y===a||y===34||u.forceQuotes){d='"'+d.replace(T3,'""')+'"';break}d=="ID"&&(d='"ID"')}else x.f!=null&&!x.F?(c=!1,d="="+x.f,d.indexOf(",")>=0&&(d='"'+d.replace(T3,'""')+'"')):d="";f.push(d)}return u.blankrows===!1&&c?null:f.join(s)}function am(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=It(t["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,c=u.charCodeAt(0),f=new RegExp((a=="|"?"\\|":a)+"+$"),d="",v=[];n.dense=Array.isArray(t);for(var g=n.skipHidden&&t["!cols"]||[],x=n.skipHidden&&t["!rows"]||[],_=i.s.c;_<=i.e.c;++_)(g[_]||{}).hidden||(v[_]=Yr(_));for(var y=0,E=i.s.r;E<=i.e.r;++E)(x[E]||{}).hidden||(d=lD(t,i,E,v,s,c,a,n),d!=null&&(n.strip&&(d=d.replace(f,"")),(d||n.blankrows!==!1)&&r.push((y++?u:"")+d)));return delete n.dense,r.join("")}function n8(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=am(t,e);return r}function uD(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=It(t["!ref"]),a="",s=[],u,c=[],f=Array.isArray(t);for(u=i.s.c;u<=i.e.c;++u)s[u]=Yr(u);for(var d=i.s.r;d<=i.e.r;++d)for(a=Dr(d),u=i.s.c;u<=i.e.c;++u)if(e=s[u]+a,r=f?(t[d]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function i8(t,e,r){var n=r||{},i=+!n.skipHeader,a=t||{},s=0,u=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?wr(n.origin):n.origin;s=c.r,u=c.c}var f,d={s:{c:0,r:0},e:{c:u,r:s+e.length-1+i}};if(a["!ref"]){var v=It(a["!ref"]);d.e.c=Math.max(d.e.c,v.e.c),d.e.r=Math.max(d.e.r,v.e.r),s==-1&&(s=v.e.r+1,d.e.r=s+e.length-1+i)}else s==-1&&(s=0,d.e.r=e.length-1+i);var g=n.header||[],x=0;e.forEach(function(y,E){Mr(y).forEach(function(C){(x=g.indexOf(C))==-1&&(g[x=g.length]=C);var T=y[C],m="z",w="",F=St({c:u+x,r:s+E+i});f=qu(a,F),T&&typeof T=="object"&&!(T instanceof Date)?a[F]=T:(typeof T=="number"?m="n":typeof T=="boolean"?m="b":typeof T=="string"?m="s":T instanceof Date?(m="d",n.cellDates||(m="n",T=yn(T)),w=n.dateNF||Yt[14]):T===null&&n.nullError&&(m="e",T=0),f?(f.t=m,f.v=T,delete f.w,delete f.R,w&&(f.z=w)):a[F]=f={t:m,v:T},w&&(f.z=w))})}),d.e.c=Math.max(d.e.c,u+g.length-1);var _=Dr(s);if(i)for(x=0;x<g.length;++x)a[Yr(x+u)+_]={t:"s",v:g[x]};return a["!ref"]=ir(d),a}function cD(t,e){return i8(null,t,e)}function qu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=wr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?qu(t,St(e)):qu(t,St({r:e,c:r||0}))}function fD(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function hD(){return{SheetNames:[],Sheets:{}}}function dD(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=s+i)!=-1;++i);}if(K6(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function pD(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=fD(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function gD(t,e){return t.z=e,t}function a8(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function mD(t,e,r){return a8(t,"#"+e,r)}function vD(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function xD(t,e,r,n){for(var i=typeof e!="string"?e:It(e),a=typeof e=="string"?e:ir(e),s=i.s.r;s<=i.e.r;++s)for(var u=i.s.c;u<=i.e.c;++u){var c=qu(t,s,u);c.t="n",c.F=a,delete c.v,s==i.s.r&&u==i.s.c&&(c.f=r,n&&(c.D=!0))}return t}var _p={encode_col:Yr,encode_row:Dr,encode_cell:St,encode_range:ir,decode_col:Y2,decode_row:K2,split_cell:OA,decode_cell:wr,decode_range:On,format_cell:fa,sheet_add_aoa:a6,sheet_add_json:i8,sheet_add_dom:J6,aoa_to_sheet:yl,json_to_sheet:cD,table_to_sheet:Z6,table_to_book:WI,sheet_to_csv:am,sheet_to_txt:n8,sheet_to_json:$f,sheet_to_html:q6,sheet_to_formulae:uD,sheet_to_row_object_array:$f,sheet_get_cell:qu,book_new:hD,book_append_sheet:dD,book_set_sheet_visibility:pD,cell_set_number_format:gD,cell_set_hyperlink:a8,cell_set_internal_link:mD,cell_add_comment:vD,sheet_set_array_formula:xD,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const _D=({measurements:t,referenceFields:e,onUpdate:r})=>{const n=()=>{if(!t||t.length===0){alert("Ingen målinger at eksportere");return}const s=[["Navn","Albedo Værdi","X Position","Y Position","Bredde","Højde"].join(";"),...t.map(d=>[d.description||"Unavngivet",d.albedoValue.toFixed(3).replace(".",","),Math.round(d.x),Math.round(d.y),Math.round(d.width),Math.round(d.height)].join(";"))].join(`
`),u=new Blob([s],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a"),f=URL.createObjectURL(u);c.setAttribute("href",f),c.setAttribute("download","albedo_maalinger.csv"),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)},i=()=>{if(!t||t.length===0){alert("Ingen målinger at eksportere");return}const a=t.map(c=>({Navn:c.description||"Unavngivet","Albedo Værdi":c.albedoValue,"X Position":Math.round(c.x),"Y Position":Math.round(c.y),Bredde:Math.round(c.width),Højde:Math.round(c.height)})),s=_p.book_new(),u=_p.json_to_sheet(a);u["!cols"]=[{wch:20},{wch:15},{wch:12},{wch:12},{wch:10},{wch:10}],_p.book_append_sheet(s,u,"Albedo Målinger"),sD(s,"albedo_maalinger.xlsx")};return!t||t.length===0?Q.jsxs("div",{className:"card",children:[Q.jsx("h3",{style:{marginBottom:"16px"},children:"Målinger"}),Q.jsx("p",{style:{color:"#6b7280",marginBottom:"20px"},children:"Ingen målinger endnu. Gå til Canvas fanen for at foretage målinger."})]}):Q.jsxs("div",{className:"card",children:[Q.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[Q.jsxs("h3",{style:{margin:0},children:["Målinger (",t.length,")"]}),Q.jsxs("div",{style:{display:"flex",gap:"8px"},children:[Q.jsx("button",{className:"btn btn-success",onClick:n,style:{fontSize:"0.9rem"},children:"Gem som CSV"}),Q.jsx("button",{className:"btn btn-primary",onClick:i,style:{fontSize:"0.9rem"},children:"Gem som Excel"})]})]}),Q.jsx("div",{style:{overflowX:"auto"},children:Q.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.9rem"},children:[Q.jsx("thead",{children:Q.jsxs("tr",{style:{backgroundColor:"#f8f9fa",borderBottom:"2px solid #dee2e6"},children:[Q.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"600"},children:"Navn"}),Q.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"600"},children:"Albedo"}),Q.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"600"},children:"Position"}),Q.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"600"},children:"Størrelse"})]})}),Q.jsx("tbody",{children:t.map((a,s)=>Q.jsxs("tr",{style:{borderBottom:"1px solid #dee2e6"},children:[Q.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:a.description||`Måling ${s+1}`}),Q.jsx("td",{style:{padding:"12px",textAlign:"center"},children:Q.jsx("span",{style:{backgroundColor:"#e3f2fd",padding:"4px 8px",borderRadius:"4px",fontWeight:"600",color:"#1976d2"},children:a.albedoValue.toFixed(3)})}),Q.jsxs("td",{style:{padding:"12px",textAlign:"center",color:"#6c757d"},children:["(",Math.round(a.x),", ",Math.round(a.y),")"]}),Q.jsxs("td",{style:{padding:"12px",textAlign:"center",color:"#6c757d"},children:[Math.round(a.width)," ×"," ",Math.round(a.height)]})]},a.id||s))})]})}),Q.jsxs("div",{style:{marginTop:"20px",padding:"16px",backgroundColor:"#f8f9fa",borderRadius:"8px"},children:[Q.jsx("h4",{style:{margin:"0 0 8px 0",fontSize:"1rem"},children:"Statistik"}),Q.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"16px"},children:[Q.jsxs("div",{children:[Q.jsx("strong",{children:"Gennemsnit:"})," ",(t.reduce((a,s)=>a+s.albedoValue,0)/t.length).toFixed(3)]}),Q.jsxs("div",{children:[Q.jsx("strong",{children:"Minimum:"})," ",Math.min(...t.map(a=>a.albedoValue)).toFixed(3)]}),Q.jsxs("div",{children:[Q.jsx("strong",{children:"Maximum:"})," ",Math.max(...t.map(a=>a.albedoValue)).toFixed(3)]}),Q.jsxs("div",{children:[Q.jsx("strong",{children:"Antal målinger:"})," ",t.length]})]})]})]})},yD=({investigation:t,onUpdate:e,onBack:r,onImageUpload:n})=>{var f;const[i,a]=We.useState("canvas"),s=d=>{console.log("InvestigationWorkspace - handleImageLoad:",d);const v={...t,image:d};e(v)},u=d=>{const v={...t,referenceFields:d};e(v)},c=d=>{console.log("InvestigationWorkspace - handleMeasurementsUpdate:",d);const v={...t,measurements:d};e(v)};return console.log("InvestigationWorkspace - investigation:",t),t?Q.jsxs("div",{className:"investigation-workspace",children:[Q.jsxs("div",{className:"workspace-header",children:[Q.jsxs("div",{className:"header-content",children:[Q.jsx("h1",{className:"workspace-title",children:t.name}),Q.jsxs("p",{className:"workspace-subtitle",children:[t.year," |"," ",((f=t.location)==null?void 0:f.name)||"Ukendt lokation"]})]}),Q.jsx("div",{className:"header-actions"})]}),Q.jsxs("div",{className:"tab-navigation",style:{display:"flex",borderBottom:"2px solid #e5e7eb",marginBottom:"20px",backgroundColor:"#f9fafb"},children:[Q.jsx("button",{className:`tab-button ${i==="canvas"?"active":""}`,onClick:()=>a("canvas"),style:{padding:"12px 24px",border:"none",backgroundColor:i==="canvas"?"#3b82f6":"transparent",color:i==="canvas"?"white":"#6b7280",cursor:"pointer",fontSize:"1rem",fontWeight:"600",borderTopLeftRadius:"8px",borderTopRightRadius:"8px",transition:"all 0.2s ease"},children:"Canvas"}),t.measurements&&t.measurements.length>0&&Q.jsx("button",{className:`tab-button ${i==="measurements"?"active":""}`,onClick:()=>a("measurements"),style:{padding:"12px 24px",border:"none",backgroundColor:i==="measurements"?"#3b82f6":"transparent",color:i==="measurements"?"white":"#6b7280",cursor:"pointer",fontSize:"1rem",fontWeight:"600",borderTopLeftRadius:"8px",borderTopRightRadius:"8px",transition:"all 0.2s ease"},children:"Målinger"})]}),Q.jsxs("div",{className:"tab-content",children:[i==="canvas"&&Q.jsx("div",{className:"full-width-canvas-container",children:Q.jsx(Pk,{image:t.image,referenceFields:t.referenceFields||[],measurements:t.measurements||[],onReferenceFieldsUpdate:u,onMeasurementsUpdate:c,onImageUpload:s})}),i==="measurements"&&t.measurements&&t.measurements.length>0&&Q.jsx("div",{className:"workspace-section",children:Q.jsx(_D,{measurements:t.measurements||[],onUpdate:c})})]})]}):Q.jsxs("div",{className:"info-card",children:[Q.jsx("div",{className:"card-header",children:Q.jsx("h2",{className:"card-title",children:"Ingen Undersøgelse Valgt"})}),Q.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#6c757d"},children:[Q.jsx("p",{children:"Der er ingen undersøgelse valgt. Gå tilbage til hovedmenuen."}),Q.jsx("button",{className:"btn btn-primary",onClick:r,style:{marginTop:"20px"},children:"← Tilbage til Hovedmenu"})]})]})},SD=({investigations:t,onBack:e,onOpenInvestigation:r})=>Q.jsxs("div",{className:"card",children:[Q.jsxs("div",{className:"card-header",children:[Q.jsx("h2",{className:"card-title",children:"Resultater"}),Q.jsx("button",{className:"btn btn-secondary",onClick:e,children:"← Tilbage"})]}),Q.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#6b7280",background:"#f9fafb",borderRadius:"8px"},children:[Q.jsx("div",{style:{fontSize:"3rem",marginBottom:"16px"}}),Q.jsx("p",{children:"Results overview kommer snart..."})]})]}),wD=()=>{const[t,e]=We.useState([]);We.useEffect(()=>{const d=localStorage.getItem("albedo-investigations");if(d)try{e(JSON.parse(d))}catch(v){console.error("Error loading investigations:",v)}},[]);const r=d=>d.map(v=>{var g,x,_;if(v.image&&v.image.url&&v.image.url.startsWith("data:")){const y=document.createElement("canvas"),E=y.getContext("2d"),C=new Image,T=800,m=((g=v.image.dimensions)==null?void 0:g.height)/((x=v.image.dimensions)==null?void 0:x.width)||1;return y.width=Math.min(T,((_=v.image.dimensions)==null?void 0:_.width)||T),y.height=y.width*m,C.onload=()=>{E.drawImage(C,0,0,y.width,y.height);const w=y.toDataURL("image/jpeg",.7),F={...v,image:{...v.image,url:w,compressed:!0}},R=d.map(N=>N.id===v.id?F:N);localStorage.setItem("albedo-investigations",JSON.stringify(R))},C.src=v.image.url,v}return v});return{investigations:t,addInvestigation:d=>{e(v=>[...v,d])},updateInvestigation:d=>{console.log("useInvestigation - updateInvestigation called with:",d),console.log("useInvestigation - current investigations:",t),e(v=>{const g=v.map(x=>x.id===d.id?d:x);return console.log("useInvestigation - updated investigations:",g),console.log("useInvestigation - found investigation to update:",v.find(x=>x.id===d.id)),g})},deleteInvestigation:d=>{e(v=>v.filter(g=>g.id!==d))},getInvestigationById:d=>t.find(v=>v.id===d),getInvestigationsByYear:d=>t.filter(v=>v.year===d),getInvestigationsByLocation:d=>t.filter(v=>v.location.name.toLowerCase().includes(d.toLowerCase())),saveInvestigations:()=>{if(t.length>0)try{const d=JSON.stringify(t);d.length>5*1024*1024?(console.warn("Data too large for localStorage, compressing images..."),r(t)):(localStorage.setItem("albedo-investigations",d),console.log("Investigations saved manually"))}catch(d){console.error("Error saving to localStorage:",d),d.name==="QuotaExceededError"&&(console.warn("localStorage quota exceeded, compressing images..."),r(t))}}}};function ED(){const[t,e]=We.useState("mainMenu"),[r,n]=We.useState(null),{investigations:i,addInvestigation:a,updateInvestigation:s,deleteInvestigation:u,saveInvestigations:c}=wD();console.log("App - investigations:",i),console.log("App - currentInvestigation:",r),We.useEffect(()=>{if(r&&i.length>0){const C=i.find(T=>T.id===r.id);C&&C!==r&&(console.log("App - Syncing currentInvestigation with updated data"),n(C))}},[i,r]),We.useEffect(()=>{!r&&i.length>0&&(console.log("App - Setting first investigation as current"),n(i[0]))},[i,r]);const f=()=>{const C=window.prompt("Indtast navn for undersøgelsen:",`Undersøgelse ${i.length+1}`);if(C===null)return;if(C.trim()===""){alert("Navnet kan ikke være tomt");return}const T={id:Date.now().toString(),name:C.trim(),year:new Date().getFullYear(),location:{lat:56.1572,lng:10.2107,name:"Aarhus"},image:null,referenceFields:[],measurements:[],createdAt:new Date().toISOString()};a(T),n(T),e("workspace")},d=C=>{console.log("Opening investigation:",C),n(C),e("workspace")},v=C=>{console.log("Deleting investigation:",C),u(C),r&&r.id===C&&(e("mainMenu"),n(null))},g=()=>{e("mainMenu"),n(null)},x=C=>{console.log("App - handleInvestigationUpdate:",C),s(C),n(C)},_=()=>{e("results")},y=C=>{const T={id:`inv_${Date.now()}`,name:`Undersøgelse ${i.length+1}`,year:new Date().getFullYear(),location:{name:"Uploadet billede",coordinates:{lat:0,lng:0}},image:C,referenceFields:[],measurements:[],createdAt:new Date().toISOString()};a(T),n(T),e("workspace")},E=()=>{switch(t){case"mainMenu":return Q.jsx(qx,{investigations:i,onNewInvestigation:f,onOpenInvestigation:d,onDeleteInvestigation:v,onShowResults:_,onImageUpload:y});case"workspace":return Q.jsx(yD,{investigation:r,onUpdate:x,onBack:g,onImageUpload:y});case"results":return Q.jsx(SD,{investigations:i,onBack:g,onOpenInvestigation:d});default:return Q.jsx(qx,{})}};return Q.jsxs("div",{className:"geoseis-app",children:[Q.jsx(w9,{currentView:t,onNavigate:e,investigations:i,currentInvestigation:r,onNewInvestigation:f,onShowResults:_,onSave:c}),Q.jsx("main",{className:"main-content",children:E()})]})}yp.createRoot(document.getElementById("root")).render(Q.jsx(Xr.StrictMode,{children:Q.jsx(ED,{})}));
//# sourceMappingURL=index-Y9UJpUkr.js.map
